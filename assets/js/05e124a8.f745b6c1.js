"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[64012],{262631:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var t=r(785893),i=r(603905);const a={sidebar_position:9020,slug:"2020-06-22",title:"NGINX Salt State",authors:"mpolinowski",tags:["LINUX","Salt"]},s=void 0,l={id:"DevOps/Salt/2020-06-22--salt-nginx-state/index",title:"NGINX Salt State",description:"TST, Hong Kong",source:"@site/docs/DevOps/Salt/2020-06-22--salt-nginx-state/index.md",sourceDirName:"DevOps/Salt/2020-06-22--salt-nginx-state",slug:"/DevOps/Salt/2020-06-22--salt-nginx-state/2020-06-22",permalink:"/docs/DevOps/Salt/2020-06-22--salt-nginx-state/2020-06-22",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Salt/2020-06-22--salt-nginx-state/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"},{label:"Salt",permalink:"/docs/tags/salt"}],version:"current",sidebarPosition:9020,frontMatter:{sidebar_position:9020,slug:"2020-06-22",title:"NGINX Salt State",authors:"mpolinowski",tags:["LINUX","Salt"]},sidebar:"tutorialSidebar",previous:{title:"Saltstack Refresh Course 1: Setup",permalink:"/docs/DevOps/Salt/2020-06-23--saltestack-refresh-course-1-setup/2020-06-23"},next:{title:"Salt Beacons Module",permalink:"/docs/DevOps/Salt/2020-06-21--salt-events-and-thirdparty-apps/2020-06-21"}},o={},c=[{value:"Nginx State File",id:"nginx-state-file",level:2},{value:"Nginx Package and Service States",id:"nginx-package-and-service-states",level:3},{value:"Nginx Configuration File States",id:"nginx-configuration-file-states",level:3},{value:"Creating the Master Files",id:"creating-the-master-files",level:2},{value:"NGINX Config",id:"nginx-config",level:3},{value:"NGINX Default Server",id:"nginx-default-server",level:3},{value:"NGINX Default Frontpage Template",id:"nginx-default-frontpage-template",level:3},{value:"Testing the Nginx State File",id:"testing-the-nginx-state-file",level:2}];function d(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.ah)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"TST, Hong Kong",src:r(56372).Z+"",width:"1500",height:"640"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"#nginx-state-file",children:"Nginx State File"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#nginx-package-and-service-states",children:"Nginx Package and Service States"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"#creating-the-master-files",children:"Creating the Master Files"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#nginx-config",children:"NGINX Config"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#nginx-default-server",children:"NGINX Default Server"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#nginx-default-frontpage-template",children:"NGINX Default Frontpage Template"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#testing-the-nginx-state-file",children:"Testing the Nginx State File"})}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"Configuration management with Salt State for an NGINX web proxy."}),"\n",(0,t.jsx)(e.h2,{id:"nginx-state-file",children:"Nginx State File"}),"\n",(0,t.jsxs)(e.p,{children:["To start off our Nginx configuration, we\u2019ll create a directory in this location specific to the software we are configuring. Then create an ",(0,t.jsx)(e.code,{children:"init.sls"})," file within this directory to get started::"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"mkdir /srv/salt/nginx\r\nnano /srv/salt/nginx/init.sls\n"})}),"\n",(0,t.jsx)(e.h3,{id:"nginx-package-and-service-states",children:"Nginx Package and Service States"}),"\n",(0,t.jsx)(e.p,{children:"First we want to make sure that NGINX is installed on our Minion and the service is running:"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"nginx/init.sls"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yml",children:"nginx:\r\n  pkg:\r\n    - installed\r\n  service.running:\r\n    - watch:\r\n        - pkg: nginx\r\n        - file: /etc/nginx/nginx.conf\r\n        - file: /etc/nginx/sites-available/default\n"})}),"\n",(0,t.jsxs)(e.p,{children:["Nginx should automatically reload when the package is updated, when the main configuration file has been changed, or when the default server block file is modified. We can tell Salt to restart the Nginx service when these conditions occur by using ",(0,t.jsx)(e.code,{children:"watch"}),"."]}),"\n",(0,t.jsx)(e.h3,{id:"nginx-configuration-file-states",children:"Nginx Configuration File States"}),"\n",(0,t.jsxs)(e.p,{children:["We now want to define the contents of the ",(0,t.jsx)(e.code,{children:"/etc/nginx/nginx.conf"})," file on the master server and upload it to each minion who needs it. ",(0,t.jsx)(e.a,{href:"#creating-the-master-files",children:"We will later create this default configuration file"})," in ",(0,t.jsx)(e.code,{children:"/srv/salt/nginx/files/etc/nginx"}),":"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"nginx/init.sls"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yml",children:"nginx:\r\n  pkg:\r\n    - installed\r\n  service.running:\r\n    - watch:\r\n        - pkg: nginx\r\n        - file: /etc/nginx/nginx.conf\r\n        - file: /etc/nginx/sites-available/default\r\n\r\n/etc/nginx/nginx.conf:\r\n  file.managed:\r\n    - source: salt://nginx/files/etc/nginx/nginx.conf\r\n    - user: root\r\n    - group: root\r\n    - mode: 640\n"})}),"\n",(0,t.jsxs)(e.p,{children:["Additionally we need to define the server block that controls how our content will be served with the ",(0,t.jsx)(e.code,{children:"/etc/nginx/sites-available/default"})," file. The difference here is that this file has to be a ",(0,t.jsx)(e.strong,{children:"Jinja"})," template. This means that we can pull information from each host and construct an appropriate, customized version of the file for each of our web servers:"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"nginx/init.sls"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yml",children:"nginx:\r\n  pkg:\r\n    - installed\r\n  service.running:\r\n    - watch:\r\n        - pkg: nginx\r\n        - file: /etc/nginx/nginx.conf\r\n        - file: /etc/nginx/sites-available/default\r\n\r\n/etc/nginx/nginx.conf:\r\n  file.managed:\r\n    - source: salt://nginx/files/etc/nginx/nginx.conf\r\n    - user: root\r\n    - group: root\r\n    - mode: 640\r\n\r\n/etc/nginx/sites-available/default:\r\n  file.managed:\r\n    - source: salt://nginx/files/etc/nginx/sites-available/default.jinja\r\n    - template: jinja\r\n    - user: root\r\n    - group: root\r\n    - mode: 640\n"})}),"\n",(0,t.jsxs)(e.p,{children:["Now, we just need to create a state for our ",(0,t.jsx)(e.code,{children:"index.html"})," file which will be the frontpage for our site:"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"nginx/init.sls"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yml",children:"nginx:\r\n  pkg:\r\n    - installed\r\n  service.running:\r\n    - watch:\r\n        - pkg: nginx\r\n        - file: /etc/nginx/nginx.conf\r\n        - file: /etc/nginx/sites-available/default\r\n\r\n/etc/nginx/nginx.conf:\r\n  file.managed:\r\n    - source: salt://nginx/files/etc/nginx/nginx.conf\r\n    - user: root\r\n    - group: root\r\n    - mode: 640\r\n\r\n/etc/nginx/sites-available/default:\r\n  file.managed:\r\n    - source: salt://nginx/files/etc/nginx/sites-available/default.jinja\r\n    - template: jinja\r\n    - user: root\r\n    - group: root\r\n    - mode: 640\r\n\r\n/usr/share/nginx/html/index.html:\r\n  file.managed:\r\n    - source: salt://nginx/files/usr/share/nginx/html/index.html.jinja\r\n    - template: jinja\r\n    - user: root\r\n    - group: root\r\n    - mode: 644\n"})}),"\n",(0,t.jsx)(e.h2,{id:"creating-the-master-files",children:"Creating the Master Files"}),"\n",(0,t.jsx)(e.p,{children:"To get the default NGINX configuration files we can install it manually on our Minion using Salt:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"salt ubuntuMaster pkg.install nginx\n"})}),"\n",(0,t.jsxs)(e.p,{children:["We can now configure our master to allow file transfers from Minions ",(0,t.jsx)(e.code,{children:"nano /etc/salt/master.d/local.conf"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yml",children:"# Allow minions to push files to the master. This is disabled by default, for\r\n# security purposes.\r\nfile_recv: True\n"})}),"\n",(0,t.jsxs)(e.p,{children:["Save and ",(0,t.jsx)(e.code,{children:"systemctl restart salt-master"})," your master. We can now grab the default versions of the files we\u2019ll be managing:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"salt ubuntuMaster cp.push /etc/nginx/nginx.conf\r\nsalt ubuntuMaster cp.push /etc/nginx/sites-available/default\r\nsalt ubuntuMaster cp.push /usr/share/nginx/html/index.html\n"})}),"\n",(0,t.jsxs)(e.p,{children:["These files should now be available on the master. The path to these files is recreated within the ",(0,t.jsx)(e.code,{children:"/var/cache/salt/master/minions/minion_id/files directory"}),". We can copy the directories beneath this location, which represents the file paths on the minion, to our Salt state directory:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'cp -r /var/cache/salt/master/minions/ubuntuMaster/files /srv/salt/nginx\r\n\r\nfind /srv/salt/nginx -printf "%P\\n"\r\n\r\n  init.sls\r\n  files\r\n  files/etc\r\n  files/etc/nginx\r\n  files/etc/nginx/sites-available\r\n  files/etc/nginx/sites-available/default\r\n  files/etc/nginx/nginx.conf\r\n  files/usr\r\n  files/usr/share\r\n  files/usr/share/nginx\r\n  files/usr/share/nginx/html\r\n  files/usr/share/nginx/html/index.html\n'})}),"\n",(0,t.jsx)(e.h3,{id:"nginx-config",children:"NGINX Config"}),"\n",(0,t.jsx)(e.p,{children:"Start by creating a backup of the original configuration and adjust the conf file according to your needs:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"cd /srv/salt/nginx/files/etc/nginx\r\ncp nginx.conf nginx.conf.ori\r\ndiff nginx.conf nginx.conf.ori\n"})}),"\n",(0,t.jsx)(e.h3,{id:"nginx-default-server",children:"NGINX Default Server"}),"\n",(0,t.jsxs)(e.p,{children:["Next, let\u2019s take a look at our default server block template. Start with making a copy of the original file and rename the file to ",(0,t.jsx)(e.code,{children:".jinja"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"cd /srv/salt/nginx/files/etc/nginx/sites-available\r\ncp default default.ori\r\nmv default default.jinja\n"})}),"\n",(0,t.jsxs)(e.p,{children:["Now, we can open the template file to make some changes ",(0,t.jsx)(e.code,{children:"nano default.jinja"}),". We\u2019ll then use the grains.get execution module function to grab the address associated with the selected interface and use that as the value for the ",(0,t.jsx)(e.code,{children:"addr"})," variable. We will add this to the very top of the file:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-cfg",children:"# Set interface to load balancer in production - change interface before using\r\n{%- set interface = 'enp3s0' if salt['grains.get']('env') == 'dev' else 'enp3s0' -%}\r\n{%- set addr = salt['network.interface_ip'](interface) -%}\r\n##\r\n# You should look at the following URL's in order to grasp a solid understanding\n"})}),"\n",(0,t.jsxs)(e.p,{children:["Next, we can edit the server block further down in the file. We can use the ",(0,t.jsx)(e.code,{children:"addr"})," variable we set at the top in the listen and ",(0,t.jsx)(e.code,{children:"server_name"})," directives. We\u2019ve removed the IPv6 and default server portions to restrict what this block serves:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-cfg",children:"server {\r\n    listen {{ addr }}:80;\r\n\r\n    root /usr/share/nginx/html;\r\n    index index.html index.htm;\r\n\r\n    server_name {{ addr }};\r\n\r\n    location / {\r\n        try_files $uri $uri/ =404;\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"Save and close the file when you are finished."}),"\n",(0,t.jsx)(e.h3,{id:"nginx-default-frontpage-template",children:"NGINX Default Frontpage Template"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"cd /srv/salt/nginx/files/usr/share/nginx/html\r\n\r\ncp index.html index.html.ori\r\nmv index.html index.html.jinja\r\n\r\nnano index.html.jinja\n"})}),"\n",(0,t.jsxs)(e.p,{children:["At the top, we\u2019ll set another variable using Jinja. We\u2019ll use the ",(0,t.jsx)(e.code,{children:"grains.get"})," execution module function to grab the minion\u2019s hostname. We\u2019ll store this in the host variable:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:"{% set host = salt['grains.get']('os-family') -%}\r\n{% set os = salt['grains.get']('os') -%}\r\n\r\n<!DOCTYPE html>\r\n<html>\r\n  <head>\r\n  <title>Welcome from {{ host }}</title>\r\n    <body>\r\n    <h1>This is NGINX!</h1>\r\n    <p>{{ os }} Rocks!</p>\r\n    </body>\r\n</html>\n"})}),"\n",(0,t.jsx)(e.h2,{id:"testing-the-nginx-state-file",children:"Testing the Nginx State File"}),"\n",(0,t.jsxs)(e.p,{children:["First, we can use the ",(0,t.jsx)(e.code,{children:"state.show_sls"})," execution module function to view how Salt will interpret our Nginx state file:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"salt ubuntuMaster state.show_sls nginx\r\n\r\nubuntuMaster:\r\n    ----------\r\n    /etc/nginx/nginx.conf:\r\n        ----------\r\n        __env__:\r\n            base\r\n        __sls__:\r\n            nginx\r\n        file:\r\n            |_\r\n              ----------\r\n              source:\r\n                  salt://nginx/files/etc/nginx/nginx.conf\r\n            |_\r\n              ----------\r\n              user:\r\n                  root\r\n            |_\r\n              ----------\r\n              group:\r\n                  root\r\n            |_\r\n              ----------\r\n              mode:\r\n                  640\r\n            - managed\r\n            |_\r\n              ----------\r\n              order:\r\n                  10002\r\n    /etc/nginx/sites-available/default:\r\n        ----------\r\n        __env__:\r\n            base\r\n        __sls__:\r\n            nginx\r\n        file:\r\n            |_\r\n              ----------\r\n              source:\r\n                  salt://nginx/files/etc/nginx/sites-available/default.jinja\r\n            |_\r\n              ----------\r\n              template:\r\n                  jinja\r\n            |_\r\n              ----------\r\n              user:\r\n                  root\r\n            |_\r\n              ----------\r\n              group:\r\n                  root\r\n            |_\r\n              ----------\r\n              mode:\r\n                  640\r\n            - managed\r\n            |_\r\n              ----------\r\n              order:\r\n                  10003\r\n    /usr/share/nginx/html/index.html:\r\n        ----------\r\n        __env__:\r\n            base\r\n        __sls__:\r\n            nginx\r\n        file:\r\n            |_\r\n              ----------\r\n              source:\r\n                  salt://nginx/files/usr/share/nginx/html/index.html.jinja\r\n            |_\r\n              ----------\r\n              template:\r\n                  jinja\r\n            |_\r\n              ----------\r\n              user:\r\n                  root\r\n            |_\r\n              ----------\r\n              group:\r\n                  root\r\n            |_\r\n              ----------\r\n              mode:\r\n                  644\r\n            - managed\r\n            |_\r\n              ----------\r\n              order:\r\n                  10004\r\n    nginx:\r\n        ----------\r\n        __env__:\r\n            base\r\n        __sls__:\r\n            nginx\r\n        pkg:\r\n            - installed\r\n            |_\r\n              ----------\r\n              order:\r\n                  10000\r\n        service:\r\n            |_\r\n              ----------\r\n              watch:\r\n                  |_\r\n                    ----------\r\n                    pkg:\r\n                        nginx\r\n                  |_\r\n                    ----------\r\n                    file:\r\n                        /etc/nginx/nginx.conf\r\n                  |_\r\n                    ----------\r\n                    file:\r\n                        /etc/nginx/sites-available/default\r\n            - running\r\n            |_\r\n              ----------\r\n              order:\r\n                  10001\n"})}),"\n",(0,t.jsxs)(e.p,{children:["Next, we can do a ",(0,t.jsx)(e.strong,{children:"dry-run"})," of applying our state file. We can do this with the ",(0,t.jsx)(e.code,{children:"state.apply"})," function with the ",(0,t.jsx)(e.code,{children:"test=True"})," option:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"salt ubuntuMaster state.apply nginx test=True\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'ubuntuMaster:\r\n----------\r\n          ID: nginx\r\n    Function: pkg.installed\r\n      Result: True\r\n     Comment: All specified packages are already installed\r\n     Started: 11:14:33.183423\r\n    Duration: 21.944 ms\r\n     Changes:\r\n----------\r\n          ID: /etc/nginx/nginx.conf\r\n    Function: file.managed\r\n      Result: None\r\n     Comment: The file /etc/nginx/nginx.conf is set to be changed\r\n              Note: No changes made, actual changes may\r\n              be different due to other states.\r\n     Started: 11:14:33.209030\r\n    Duration: 10.764 ms\r\n     Changes:\r\n              ----------\r\n              mode:\r\n                  0640\r\n----------\r\n          ID: /etc/nginx/sites-available/default\r\n    Function: file.managed\r\n      Result: None\r\n     Comment: The file /etc/nginx/sites-available/default is set to be changed\r\n              Note: No changes made, actual changes may\r\n              be different due to other states.\r\n     Started: 11:14:33.219892\r\n    Duration: 70.677 ms\r\n     Changes:\r\n              ----------\r\n              diff:\r\n                  ---\r\n                  +++\r\n                  @@ -1,4 +1,4 @@\r\n                  -##\r\n                  +# Set interface to load balancer in production - change interface before using##\r\n                   # You should look at the following URL\'s in order to grasp a solid understanding\r\n                   # of Nginx configuration files in order to fully unleash the power of Nginx.\r\n                   # https://www.nginx.com/resources/wiki/start/\r\n                  @@ -19,8 +19,7 @@\r\n                   # Default server configuration\r\n                   #\r\n                   server {\r\n                  -     listen 80 default_server;\r\n                  -     listen [::]:80 default_server;\r\n                  +     listen 192.168.2.110 80 default_server;\r\n\r\n                        # SSL configuration\r\n                        #\r\n                  @@ -38,12 +37,12 @@\r\n                        #\r\n                        # include snippets/snakeoil.conf;\r\n\r\n                  -     root /var/www/html;\r\n                  +     root /usr/share/nginx/html/;\r\n\r\n                        # Add index.php to the list if you are using PHP\r\n                        index index.html index.htm index.nginx-debian.html;\r\n\r\n                  -     server_name _;\r\n                  +     server_name 192.168.2.110;\r\n\r\n                        location / {\r\n                                # First attempt to serve request as file, then\r\n              mode:\r\n                  0640\r\n----------\r\n          ID: nginx\r\n    Function: service.running\r\n      Result: None\r\n     Comment: Service is set to be started\r\n     Started: 11:14:33.330309\r\n    Duration: 12.555 ms\r\n     Changes:\r\n----------\r\n          ID: /usr/share/nginx/html/index.html\r\n    Function: file.managed\r\n      Result: None\r\n     Comment: The file /usr/share/nginx/html/index.html is set to be changed\r\n              Note: No changes made, actual changes may\r\n              be different due to other states.\r\n     Started: 11:14:33.343135\r\n    Duration: 18.835 ms\r\n     Changes:\r\n              ----------\r\n              diff:\r\n                  ---\r\n                  +++\r\n                  @@ -1,25 +1,9 @@\r\n                   <!DOCTYPE html>\r\n                   <html>\r\n                  -<head>\r\n                  -<title>Welcome to nginx!</title>\r\n                  -<style>\r\n                  -    body {\r\n                  -        width: 35em;\r\n                  -        margin: 0 auto;\r\n                  -        font-family: Tahoma, Verdana, Arial, sans-serif;\r\n                  -    }\r\n                  -</style>\r\n                  -</head>\r\n                  -<body>\r\n                  -<h1>Welcome to nginx!</h1>\r\n                  -<p>If you see this page, the nginx web server is successfully installed and\r\n                  -working. Further configuration is required.</p>\r\n                  -\r\n                  -<p>For online documentation and support please refer to\r\n                  -<a href="http://nginx.org/">nginx.org</a>.<br/>\r\n                  -Commercial support is available at\r\n                  -<a href="http://nginx.com/">nginx.com</a>.</p>\r\n                  -\r\n                  -<p><em>Thank you for using nginx.</em></p>\r\n                  -</body>\r\n                  +  <head>\r\n                  +  <title>Welcome from </title>\r\n                  +    <body>\r\n                  +    <h1>This is NGINX!</h1>\r\n                  +    <p>Ubuntu Rocks!</p>\r\n                  +    </body>\r\n                   </html>\r\n\r\nSummary for ubuntuMaster\r\n------------\r\nSucceeded: 5 (unchanged=4, changed=3)\r\nFailed:    0\r\n------------\r\nTotal states run:     5\r\nTotal run time: 134.775 ms\n'})}),"\n",(0,t.jsx)(e.p,{children:"If the dry-run did not reveal any problems, you can try to apply the state to all of your available web servers by typing:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"salt ubuntuMaster state.apply nginx\n"})}),"\n",(0,t.jsx)(e.p,{children:"You can check that the Page is actually running on your Minions IP address:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"curl 192.168.2.110\r\n\r\n<!DOCTYPE html>\r\n<html>\r\n  <head>\r\n  <title>Welcome from </title>\r\n    <body>\r\n    <h1>This is NGINX!</h1>\r\n    <p>Ubuntu Rocks!</p>\r\n    </body>\r\n</html>\n"})})]})}function h(n={}){const{wrapper:e}={...(0,i.ah)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},603905:(n,e,r)=>{r.d(e,{ah:()=>c});var t=r(667294);function i(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function a(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.push.apply(r,t)}return r}function s(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){i(n,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}))}return n}function l(n,e){if(null==n)return{};var r,t,i=function(n,e){if(null==n)return{};var r,t,i={},a=Object.keys(n);for(t=0;t<a.length;t++)r=a[t],e.indexOf(r)>=0||(i[r]=n[r]);return i}(n,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(t=0;t<a.length;t++)r=a[t],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(n,r)&&(i[r]=n[r])}return i}var o=t.createContext({}),c=function(n){var e=t.useContext(o),r=e;return n&&(r="function"==typeof n?n(e):s(s({},e),n)),r},d={inlineCode:"code",wrapper:function(n){var e=n.children;return t.createElement(t.Fragment,{},e)}},h=t.forwardRef((function(n,e){var r=n.components,i=n.mdxType,a=n.originalType,o=n.parentName,h=l(n,["components","mdxType","originalType","parentName"]),g=c(r),u=i,x=g["".concat(o,".").concat(u)]||g[u]||d[u]||a;return r?t.createElement(x,s(s({ref:e},h),{},{components:r})):t.createElement(x,s({ref:e},h))}));h.displayName="MDXCreateElement"},56372:(n,e,r)=>{r.d(e,{Z:()=>t});const t=r.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-445649b262fc86c20c60ee46511b372b.jpg"}}]);