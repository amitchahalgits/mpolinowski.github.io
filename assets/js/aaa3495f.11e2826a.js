"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[40701],{601775:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var n=t(474848),s=t(28453);const a={sidebar_position:4960,slug:"2024-01-18",title:"Uptime Kuma",authors:"mpolinowski",tags:["LINUX","Docker"],description:"Uptime Kuma is an easy-to-use self-hosted monitoring tool."},o="Provision Uptime Kuma with Docker",r={id:"DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring/index",title:"Uptime Kuma",description:"Uptime Kuma is an easy-to-use self-hosted monitoring tool.",source:"@site/docs/DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring/index.md",sourceDirName:"DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring",slug:"/DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring/2024-01-18",permalink:"/docs/DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring/2024-01-18",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"},{label:"Docker",permalink:"/docs/tags/docker"}],version:"current",sidebarPosition:4960,frontMatter:{sidebar_position:4960,slug:"2024-01-18",title:"Uptime Kuma",authors:"mpolinowski",tags:["LINUX","Docker"],description:"Uptime Kuma is an easy-to-use self-hosted monitoring tool."},sidebar:"tutorialSidebar",previous:{title:"Server Provisioning",permalink:"/docs/category/server-provisioning"},next:{title:"ntfy Notification Service",permalink:"/docs/DevOps/Provisioning/2024-01-17--ntfy-notification-service/2024-01-17"}},c={},d=[{value:"Monitoring your INSTAR Camera",id:"monitoring-your-instar-camera",level:2},{value:"MQTT Heartbeat",id:"mqtt-heartbeat",level:3},{value:"HTTP Heartbeat",id:"http-heartbeat",level:2},{value:"Adding Notifications",id:"adding-notifications",level:2}];function m(e){const i={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Shenzhen, China",src:t(210621).A+"",width:"1500",height:"567"})}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"#provision-uptime-kuma-with-docker",children:"Provision Uptime Kuma with Docker"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"#monitoring-your-instar-camera",children:"Monitoring your INSTAR Camera"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsx)(i.li,{children:(0,n.jsx)(i.a,{href:"#mqtt-heartbeat",children:"MQTT Heartbeat"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(i.li,{children:(0,n.jsx)(i.a,{href:"#http-heartbeat",children:"HTTP Heartbeat"})}),"\n",(0,n.jsx)(i.li,{children:(0,n.jsx)(i.a,{href:"#adding-notifications",children:"Adding Notifications"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(i.h1,{id:"provision-uptime-kuma-with-docker",children:"Provision Uptime Kuma with Docker"}),"\n",(0,n.jsx)(i.p,{children:"Prepare a volume mount:"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-bash",children:"sudo mkdir /opt/uptime\r\nsudo chown $(whoami):$(whoami) /opt/uptime\r\nsudo chmod 777 /opt/uptime\n"})}),"\n",(0,n.jsxs)(i.p,{children:["Download the latest Docker image from ",(0,n.jsx)(i.a,{href:"https://hub.docker.com/r/louislam/uptime-kuma/tags",children:"Docker Hub"}),":"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-bash",children:"docker pull louislam/uptime-kuma:1-alpine\n"})}),"\n",(0,n.jsx)(i.p,{children:"Run the container in Docker:"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-bash",children:"docker run -d --restart=unless-stopped --net=host \\\r\n  # -p 3001:3001 \\\r\n  -v /opt/uptime:/app/data \\\r\n  --name monitor \\\r\n  louislam/uptime-kuma:1-alpine\n"})}),"\n",(0,n.jsxs)(i.p,{children:["Or with ",(0,n.jsx)(i.code,{children:"docker-compose up -d"}),":"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-yml",children:"version: '3'\r\nservices:\r\n  app:\r\n    image: louislam/uptime-kuma:1-alpine\r\n    container_name: monitor\r\n    restart: unless-stopped\r\n    network_mode: host\r\n    # ports:\r\n    #   - 3001:3001\r\n    volumes:\r\n      - /opt/uptime:/app/data\n"})}),"\n",(0,n.jsxs)(i.p,{children:["Visit the webUI on ",(0,n.jsx)(i.code,{children:"localhost:3001"})," and create an admin user and activate dark mode:"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(29422).A+"",width:"1045",height:"545"})}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(257253).A+"",width:"1051",height:"408"})}),"\n",(0,n.jsx)(i.h2,{id:"monitoring-your-instar-camera",children:"Monitoring your INSTAR Camera"}),"\n",(0,n.jsx)(i.h3,{id:"mqtt-heartbeat",children:"MQTT Heartbeat"}),"\n",(0,n.jsxs)(i.p,{children:["Start by clicking on ",(0,n.jsx)(i.strong,{children:"Add New Monitor"}),":"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(504988).A+"",width:"1256",height:"404"})}),"\n",(0,n.jsxs)(i.p,{children:["Select ",(0,n.jsx)(i.strong,{children:"MQTT"})," as ",(0,n.jsx)(i.strong,{children:"Monitor Type"})," and add the MQTT broker configuration from your INSTAR camera:"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(402387).A+"",width:"1253",height:"717"})}),"\n",(0,n.jsxs)(i.p,{children:["The ",(0,n.jsx)(i.strong,{children:"Hostname"})," is the local IP (or DDNS address) of your camera and ",(0,n.jsx)(i.strong,{children:"Port"})," is the regular MQTT server port that defaults to ",(0,n.jsx)(i.code,{children:"1883"}),":"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(186826).A+"",width:"1238",height:"820"})}),"\n",(0,n.jsxs)(i.p,{children:["You can use the ",(0,n.jsx)(i.em,{children:"Last-Will-and-Testament"})," (",(0,n.jsx)(i.a,{href:"https://wiki.instar.com/en/Advanced_User/INSTAR_MQTT_Broker/",children:"lwt-topic"}),") to monitor your camera - default ",(0,n.jsx)(i.code,{children:"mqtt prefix"}),"/",(0,n.jsx)(i.code,{children:"camera id"}),"/status/connection:"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(827905).A+"",width:"1025",height:"534"})}),"\n",(0,n.jsx)(i.p,{children:"Add the topic to your monitor:"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(606776).A+"",width:"1217",height:"808"})}),"\n",(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.strong,{children:"Note"}),': Use the "online" payload ',(0,n.jsx)(i.strong,{children:"without"})," any spaces or it will not match: ",(0,n.jsx)(i.code,{children:'{"val":"online"}'}),":"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(281583).A+"",width:"1195",height:"521"})}),"\n",(0,n.jsx)(i.p,{children:"Once corrected the camera will show up as online:"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(216390).A+"",width:"1246",height:"820"})}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(392652).A+"",width:"1241",height:"466"})}),"\n",(0,n.jsx)(i.h2,{id:"http-heartbeat",children:"HTTP Heartbeat"}),"\n",(0,n.jsxs)(i.p,{children:["For older INSTAR IP cameras that don't support the MQTT protocol we can use an HTTP endpoint (",(0,n.jsx)(i.a,{href:"https://wiki.instar.com/en/Advanced_User/CGI_Commands/",children:"random CGI command"}),") and sending GET requests to verify that the camera is connected and running. Start by clicking on ",(0,n.jsx)(i.strong,{children:"Add New Monitor"}),":"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(761749).A+"",width:"1247",height:"383"})}),"\n",(0,n.jsxs)(i.p,{children:["This time select ",(0,n.jsx)(i.strong,{children:"HTTP"})," as ",(0,n.jsx)(i.strong,{children:"Monitor Type"})," and add the IP address with a random CGI command as URL (e.g. ",(0,n.jsx)(i.code,{children:"getsysinfo"}),"):"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(594398).A+"",width:"1275",height:"847"})}),"\n",(0,n.jsxs)(i.p,{children:["As authentication choose ",(0,n.jsx)(i.strong,{children:"HTTP Basic Auth"})," and add your camera login:"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(312711).A+"",width:"1251",height:"607"})}),"\n",(0,n.jsx)(i.p,{children:"The monitor will now contact your camera once a minute to verify that it is still running:"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(521192).A+"",width:"1275",height:"814"})}),"\n",(0,n.jsx)(i.h2,{id:"adding-notifications",children:"Adding Notifications"}),"\n",(0,n.jsx)(i.p,{children:"Now to the interesting part - how do I receive notifications about events on my network on my Android phone?"}),"\n",(0,n.jsxs)(i.p,{children:["There are quite a few options to choose from. Let's take a look at a simple, self-hosted solution called ",(0,n.jsx)(i.a,{href:"/docs/DevOps/Provisioning/2024-01-17--ntfy-notification-service/2024-01-17",children:"ntfy"}),"."]}),"\n",(0,n.jsxs)(i.p,{children:["Start by selecting one of your monitors and click on ",(0,n.jsx)(i.strong,{children:"Setup Notification"}),":"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(935409).A+"",width:"1335",height:"369"})}),"\n",(0,n.jsxs)(i.p,{children:["And add the topic and URL of your ",(0,n.jsx)(i.a,{href:"/docs/DevOps/Provisioning/2024-01-17--ntfy-notification-service/2024-01-17",children:"nfty installation"}),":"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(5242).A+"",width:"1099",height:"473"})}),"\n",(0,n.jsx)(i.p,{children:"Click to test your configuration:"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(322819).A+"",width:"945",height:"298"})}),"\n",(0,n.jsx)(i.p,{children:"And you should see the test update on the nfty dashboard:"}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"Uptime Kuma",src:t(348804).A+"",width:"1261",height:"283"})})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(m,{...e})}):m(e)}},210621:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-983e9af3d84f5fb9ebad02646e63767d.jpg"},29422:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_01-fb82c0c29cf39d80a8e1a1228e82a352.png"},257253:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_02-24afbd5163a329a5a81a832c5ca9cdc2.png"},504988:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_03-107203f511a4f17856c28f1311c39ad4.png"},402387:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_04-10b17a92a3928707596a9c6bb9fca9c4.png"},186826:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_05-cc62c4247d5ae78150c280d438dc2916.png"},827905:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_06-de863c318015d5590bf1dd596fec1b8d.png"},606776:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_07-5116624f7a17ca5d2a042a3817055439.png"},281583:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_08-63a8e622bf076c8ceed1cc3ed8ae7115.png"},216390:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_09-8e0458331382a99159096d413285b6fd.png"},392652:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_10-47e0d780a7656a9314562209d32dcbb5.png"},761749:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_11-a20f7623e5a6913daefe6059ce60531a.png"},594398:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_12-548867c81c0178317a83ef377e8cd06b.png"},312711:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_13-6a736c74507dad09e35b42e1494a165c.png"},521192:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_14-98ae05722b15ccc42dc8c4cda6657b3b.png"},935409:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_15-a5dad1a9a9a052d39b10dc8f5f1043a6.png"},5242:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_16-e3c1385ec38710f047c7280cb4ab71a7.png"},322819:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_17-4326ff8c02e5ebfa353855c94ef627a9.png"},348804:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/uptime-kuma_18-5516f6d0d3a8566813788b8056190577.png"},28453:(e,i,t)=>{t.d(i,{R:()=>o,x:()=>r});var n=t(296540);const s={},a=n.createContext(s);function o(e){const i=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(a.Provider,{value:i},e.children)}}}]);