"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[84032],{28368:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var r=n(785893),i=n(603905);const s={sidebar_position:9080,slug:"2020-11-20",title:"Ansible Copy Cheat Sheet",authors:"mpolinowski",tags:["LINUX","Ansible"]},l=void 0,o={id:"DevOps/Ansible/2020-11-20--ansible-copy-cheat-sheet/index",title:"Ansible Copy Cheat Sheet",description:"Shenzhen, China",source:"@site/docs/DevOps/Ansible/2020-11-20--ansible-copy-cheat-sheet/index.md",sourceDirName:"DevOps/Ansible/2020-11-20--ansible-copy-cheat-sheet",slug:"/DevOps/Ansible/2020-11-20--ansible-copy-cheat-sheet/2020-11-20",permalink:"/docs/DevOps/Ansible/2020-11-20--ansible-copy-cheat-sheet/2020-11-20",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Ansible/2020-11-20--ansible-copy-cheat-sheet/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"},{label:"Ansible",permalink:"/docs/tags/ansible"}],version:"current",sidebarPosition:9080,frontMatter:{sidebar_position:9080,slug:"2020-11-20",title:"Ansible Copy Cheat Sheet",authors:"mpolinowski",tags:["LINUX","Ansible"]},sidebar:"tutorialSidebar",previous:{title:"Ansible Vault, Modules & Roles",permalink:"/docs/DevOps/Ansible/2020-11-21--ansible-modules-and-roles/2020-11-21"},next:{title:"Ansible Playbooks",permalink:"/docs/DevOps/Ansible/2020-11-19--ansible-playbooks/2020-11-19"}},a={},c=[{value:"Copying files from a local machine to the remote server",id:"copying-files-from-a-local-machine-to-the-remote-server",level:2},{value:"Copying a directory from a local machine to the remote server",id:"copying-a-directory-from-a-local-machine-to-the-remote-server",level:2},{value:"Copying multiple files/directories using with_items",id:"copying-multiple-filesdirectories-using-with_items",level:2},{value:"Copying multiple files with different permission/destination settings",id:"copying-multiple-files-with-different-permissiondestination-settings",level:2},{value:"Copying all the files inside a folder that matches a pattern",id:"copying-all-the-files-inside-a-folder-that-matches-a-pattern",level:2},{value:"Creating backup of a file in the remote servers before copy",id:"creating-backup-of-a-file-in-the-remote-servers-before-copy",level:2},{value:"Copying files from remote machine to the local machine",id:"copying-files-from-remote-machine-to-the-local-machine",level:2},{value:"Writing to a file using the copy module",id:"writing-to-a-file-using-the-copy-module",level:2}];function h(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.ah)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Shenzhen, China",src:n(112403).Z+"",width:"1500",height:"520"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"#copying-files-from-a-local-machine-to-the-remote-server",children:"Copying files from a local machine to the remote server"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"#copying-a-directory-from-a-local-machine-to-the-remote-server",children:"Copying a directory from a local machine to the remote server"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"#copying-multiple-filesdirectories-using-with_items",children:"Copying multiple files/directories using with_items"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"#copying-multiple-files-with-different-permissiondestination-settings",children:"Copying multiple files with different permission/destination settings"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"#copying-all-the-files-inside-a-folder-that-matches-a-pattern",children:"Copying all the files inside a folder that matches a pattern"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"#creating-backup-of-a-file-in-the-remote-servers-before-copy",children:"Creating backup of a file in the remote servers before copy"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"#copying-files-from-remote-machine-to-the-local-machine",children:"Copying files from remote machine to the local machine"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"#writing-to-a-file-using-the-copy-module",children:"Writing to a file using the copy module"})}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"copying-files-from-a-local-machine-to-the-remote-server",children:"Copying files from a local machine to the remote server"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:"---\r\n- hosts: test\r\n  tasks:\r\n  - name: Ansible copy file to remote server\r\n    copy:\r\n      src: ~/sample.txt\r\n      dest: /tmp \n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:"---\r\n- hosts: test\r\n  tasks:\r\n  - name: Ansible copy file force\r\n    copy:\r\n      src: ~/sample.txt\r\n      dest: /tmp \r\n      force: no\n"})}),"\n",(0,r.jsx)(t.h2,{id:"copying-a-directory-from-a-local-machine-to-the-remote-server",children:"Copying a directory from a local machine to the remote server"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:"---\r\n- hosts: test\r\n  tasks:\r\n  - name: Ansible copy directory to the remote server\r\n    copy:\r\n      src:/Users/mdtutorials2/Documents/Ansible/copy_dir_ex\r\n      dest:/Users/mdtutorials2/Documents/Ansible/tmp\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"output\r\n------\r\ntree tmp\r\n\r\ntmp\r\n\u2514\u2500\u2500 copy_dir_ex\r\n    \u251c\u2500\u2500 file1\r\n    \u251c\u2500\u2500 file2\r\n    \u251c\u2500\u2500 file3\r\n    \u2514\u2500\u2500 tmp2\r\n        \u251c\u2500\u2500 file4\r\n        \u2514\u2500\u2500 file5\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:"---\r\n- hosts: test\r\n  tasks:\r\n  - name: Ansible copy files from a directory to remote server\r\n    copy:\r\n      src:/Users/mdtutorials2/Documents/Ansible/copy_dir_ex/\r\n      dest:/Users/mdtutorials2/Documents/Ansible/tmp\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"output\r\n------\r\ntree tmp\r\n\r\ntmp/\r\n\u251c\u2500\u2500 file1\r\n\u251c\u2500\u2500 file2\r\n\u251c\u2500\u2500 file3\r\n\u2514\u2500\u2500 tmp2\r\n    \u251c\u2500\u2500 file4\r\n    \u2514\u2500\u2500 file5\n"})}),"\n",(0,r.jsx)(t.h2,{id:"copying-multiple-filesdirectories-using-with_items",children:"Copying multiple files/directories using with_items"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:"---\r\n- hosts: test\r\n  tasks:\r\n  - name: Ansible copy multiple files with_items\r\n    copy:\r\n      src: ~/{{item}}\r\n      dest: /tmp\r\n      mode: 0774\r\n    with_items:\r\n      ['hello1','hello2','hello3','sub_folder/hello4']\n"})}),"\n",(0,r.jsx)(t.h2,{id:"copying-multiple-files-with-different-permissiondestination-settings",children:"Copying multiple files with different permission/destination settings"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:"---\r\n- hosts: test\r\n  tasks:\r\n  - name: Copy multiple files in Ansible with different permissions\r\n    copy:\r\n      src: \"{{ item.src }}\"\r\n      dest: \"{{ item.dest }}\"\r\n      mode: \"{{item.mode}}\"\r\n    with_items:\r\n      - { src: '~/test1',dest: '/tmp/system1', mode: '0777'}\r\n      - { src: '~/test2',dest: '/tmp/system2', mode: '0707'}\r\n      - { src: '~/test3',dest: '/tmp2/system3', mode: '0575'}\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"ls -lrt /tmp\r\ndrwxrwxrwx 2 root root 4096 Oct  9 14:28 system1\r\ndrwx---rwx 2 root root 4096 Oct  9 14:28 system2\r\n\r\nls -lrt /tmp2\r\n-r-xrwxr-x 1 root root 0 Oct  9 14:33 system3\n"})}),"\n",(0,r.jsx)(t.h2,{id:"copying-all-the-files-inside-a-folder-that-matches-a-pattern",children:"Copying all the files inside a folder that matches a pattern"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:'- hosts: test\r\n  tasks:\r\n  - name: Ansible copy multiple files with wildcard matching.\r\n    copy:\r\n      src: "{{ item }}"\r\n      dest: /etc\r\n    with_fileglob:\r\n      - /tmp/hello*\n'})}),"\n",(0,r.jsx)(t.h2,{id:"creating-backup-of-a-file-in-the-remote-servers-before-copy",children:"Creating backup of a file in the remote servers before copy"}),"\n",(0,r.jsx)(t.p,{children:"For example, the following example will create a backup of the helloworld.txt in the /tmp directory of the remote server."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:"- hosts: test\r\n  tasks:\r\n  - name: ansible copy file backup example\r\n    copy:\r\n      src: ~/helloworld.txt\r\n      dest: /tmp\r\n      backup: yes\n"})}),"\n",(0,r.jsx)(t.h2,{id:"copying-files-from-remote-machine-to-the-local-machine",children:"Copying files from remote machine to the local machine"}),"\n",(0,r.jsxs)(t.p,{children:["By default, a directory named after each host you are connecting will be created in your destination directory (local machine). The fetched files will be copied there. If the file doesn\u2019t exist on the remote server, no error will be thrown by default.\r\nIn the following example, I am running the task on remote-server-1. The file will be copied into ",(0,r.jsx)(t.code,{children:"/etc/remote-server-1/tmp"})," directory of the local machine."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:"- hosts: test\r\n  tasks:\r\n  - name: Ansible fetch files from remote server to the local machine using Ansible fetch module\r\n    fetch:\r\n      src: /tmp/hello2\r\n      dest: /etc\r\n      mode: 0774\n"})}),"\n",(0,r.jsx)(t.p,{children:"If you don\u2019t want this behavior and you need the file to be copied directly to the destination directory, then you should use the \u2018flat\u2019 parameter."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:"- hosts: test\r\n  tasks:\r\n  - name: Ansible fetch directory example with flat parameter set\r\n    fetch:\r\n      src: /tmp/hello2\r\n      dest: /tmp/\r\n      mode: 0774\r\n      flat: yes\n"})}),"\n",(0,r.jsx)(t.p,{children:"The following example will throw an error if the remote file does not exist."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:"- hosts: test\r\n  tasks:\r\n  - name: Ansible fetch example with fail_on_missing set\r\n    fetch:\r\n      src: /tmp/fetch.txt\r\n      dest: /tmp/\r\n      mode: 0774\r\n      fail_on_missing: yes\n"})}),"\n",(0,r.jsx)(t.h2,{id:"writing-to-a-file-using-the-copy-module",children:"Writing to a file using the copy module"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yml",children:"- hosts: test\r\n  tasks:\r\n  - name: Ansible write to a file example\r\n  - copy:\r\n      content: |\r\n        Example Content.\r\n        echo.txt will be created after this task is executed.\r\n      dest: /tmp/echo.txt\r\n      backup: yes\n"})})]})}function m(e={}){const{wrapper:t}={...(0,i.ah)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},603905:(e,t,n)=>{n.d(t,{ah:()=>c});var r=n(667294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var a=r.createContext({}),c=function(e){var t=r.useContext(a),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,s=e.originalType,a=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),d=c(n),p=i,f=d["".concat(a,".").concat(p)]||d[p]||h[p]||s;return n?r.createElement(f,l(l({ref:t},m),{},{components:n})):r.createElement(f,l({ref:t},m))}));m.displayName="MDXCreateElement"},112403:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-2215e4912b7f3d1beed1d8b83bac94aa.jpg"}}]);