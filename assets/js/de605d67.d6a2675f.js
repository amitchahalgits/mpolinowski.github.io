"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[64088],{63814:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var a=r(785893),s=r(603905);const i={slug:"elasticsearch-cheat-sheet",title:"Elasticsearch Cheat Sheet",authors:"mpolinowski",tags:["LINUX","Elasticsearch"]},t=void 0,l={id:"DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/cheat-sheet",title:"Elasticsearch Cheat Sheet",description:"Source: JoliCode",source:"@site/docs/DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/cheat-sheet.md",sourceDirName:"DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries",slug:"/DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/elasticsearch-cheat-sheet",permalink:"/docs/DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/elasticsearch-cheat-sheet",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/cheat-sheet.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"},{label:"Elasticsearch",permalink:"/docs/tags/elasticsearch"}],version:"current",frontMatter:{slug:"elasticsearch-cheat-sheet",title:"Elasticsearch Cheat Sheet",authors:"mpolinowski",tags:["LINUX","Elasticsearch"]},sidebar:"tutorialSidebar",previous:{title:"Log all the searches going through Elasticsearch",permalink:"/docs/DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/2021-03-25"},next:{title:"Logstash 7 and Common Log Pattern",permalink:"/docs/DevOps/Elasticsearch/2021-03-24-logstash-common-grok-pattern/2021-03-24"}},c={},d=[{value:"Queries",id:"queries",level:2},{value:"Control total hit count",id:"control-total-hit-count",level:2},{value:"QueryString syntax",id:"querystring-syntax",level:2},{value:"Search After - Pagination cursor",id:"search-after---pagination-cursor",level:2},{value:"Indexes and mapping",id:"indexes-and-mapping",level:2},{value:"Get the mapping and the settings",id:"get-the-mapping-and-the-settings",level:2},{value:"Create a document (auto-generated ID)",id:"create-a-document-auto-generated-id",level:2},{value:"Create or update a document",id:"create-or-update-a-document",level:2},{value:"Delete a document",id:"delete-a-document",level:2},{value:"Open and close indexes to save memory and CPU",id:"open-and-close-indexes-to-save-memory-and-cpu",level:2},{value:"Remove and create aliases",id:"remove-and-create-aliases",level:2},{value:"List aliases",id:"list-aliases",level:2},{value:"Full custom analyzer declaration",id:"full-custom-analyzer-declaration",level:2},{value:"Indices monitoring and information",id:"indices-monitoring-and-information",level:2},{value:"Indices status and management",id:"indices-status-and-management",level:2},{value:"Reindex API",id:"reindex-api",level:2},{value:"Simple Reindex Operation",id:"simple-reindex-operation",level:3},{value:"Selective Reindex Operation",id:"selective-reindex-operation",level:3},{value:"Debug and development",id:"debug-and-development",level:2},{value:"Queries",id:"queries-1",level:3},{value:"Analysis",id:"analysis",level:3},{value:"Slowlog",id:"slowlog",level:2},{value:"Cluster and node information",id:"cluster-and-node-information",level:2},{value:"Updating settings",id:"updating-settings",level:2},{value:"Snapshots and Restore",id:"snapshots-and-restore",level:2}];function o(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.ah)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:(0,a.jsxs)(n.em,{children:["Source: ",(0,a.jsx)(n.a,{href:"https://github.com/jolicode/elasticsearch-cheatsheet",children:"JoliCode"})]})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#queries",children:"Queries"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#control-total-hit-count",children:"Control total hit count"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#querystring-syntax",children:"QueryString syntax"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#search-after---pagination-cursor",children:"Search After - Pagination cursor"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#indexes-and-mapping",children:"Indexes and mapping"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#get-the-mapping-and-the-settings",children:"Get the mapping and the settings"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#create-a-document-auto-generated-id",children:"Create a document (auto-generated ID)"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#create-or-update-a-document",children:"Create or update a document"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#delete-a-document",children:"Delete a document"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#open-and-close-indexes-to-save-memory-and-cpu",children:"Open and close indexes to save memory and CPU"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#remove-and-create-aliases",children:"Remove and create aliases"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-aliases",children:"List aliases"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#full-custom-analyzer-declaration",children:"Full custom analyzer declaration"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#indices-monitoring-and-information",children:"Indices monitoring and information"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#indices-status-and-management",children:"Indices status and management"})}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#reindex-api",children:"Reindex API"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#simple-reindex-operation",children:"Simple Reindex Operation"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#selective-reindex-operation",children:"Selective Reindex Operation"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#debug-and-development",children:"Debug and development"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#queries-1",children:"Queries"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#analysis",children:"Analysis"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#slowlog",children:"Slowlog"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#cluster-and-node-information",children:"Cluster and node information"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#updating-settings",children:"Updating settings"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#snapshots-and-restore",children:"Snapshots and Restore"})}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"queries",children:"Queries"}),"\n",(0,a.jsx)(n.p,{children:"There are two syntaxes for the basic queries: a simple one on the left, where you can't use any option, and an extended one on the right. Most of the beginner headache with the DSL come from this:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET _search\r\n{\r\n  "query": {\r\n    "match": {\r\n      "FIELD": "TEXT"\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET _search\r\n{\r\n  "query": {\r\n    "match": {\r\n      "FIELD": {\r\n        "query": "TEXT",\r\n        "OPTION": "VALUE"\r\n      }\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Full search example with aggregation, highlight, filter..."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET /_search\r\n{\r\n  "query": {\r\n    "bool": {\r\n      "must": [\r\n        {\r\n          "match": {\r\n            "title": "smith"\r\n          }\r\n        }\r\n      ],\r\n      "must_not": [\r\n        {\r\n          "match_phrase": {\r\n            "title": "granny smith"\r\n          }\r\n        }\r\n      ],\r\n      "filter": [\r\n        {\r\n          "exists": {\r\n            "field": "title"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "aggs": {\r\n    "my_agg": {\r\n      "terms": {\r\n        "field": "user",\r\n        "size": 10\r\n      }\r\n    }\r\n  },\r\n  "highlight": {\r\n    "pre_tags": [\r\n      "<em>"\r\n    ],\r\n    "post_tags": [\r\n      "</em>"\r\n    ],\r\n    "fields": {\r\n      "body": {\r\n        "number_of_fragments": 1,\r\n        "fragment_size": 20\r\n      },\r\n      "title": {}\r\n    }\r\n  },\r\n  "size": 20,\r\n  "from": 100,\r\n  "_source": [\r\n    "title",\r\n    "id"\r\n  ],\r\n  "sort": [\r\n    {\r\n      "_id": {\r\n        "order": "desc"\r\n      }\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"control-total-hit-count",children:"Control total hit count"}),"\n",(0,a.jsx)(n.p,{children:"Accept true, false or a fixed number, default to 10000."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET /_search\r\n{\r\n  "track_total_hits": true,\r\n  "query": {}\r\n}\r\nCommon queries\r\n"multi_match": {\r\n  "query": "Elastic",\r\n  "fields": ["user.*", "title^3"],\r\n  "type": "best_fields"\r\n}\r\n"bool": {\r\n  "must": [],\r\n  "must_not": [],\r\n  "filter": [],\r\n  "should": [],\r\n  "minimum_should_match" : 1\r\n}\r\n"range": {\r\n  "age": {\r\n    "gte": 10,\r\n    "lte": 20,\r\n    "boost": 2\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"querystring-syntax",children:"QueryString syntax"}),"\n",(0,a.jsxs)(n.p,{children:["Search in the default ",(0,a.jsx)(n.em,{children:"_all field"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:"GET /_search?q=pony\n"})}),"\n",(0,a.jsx)(n.p,{children:"Complex search with operator and exact phrase search with boost:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET /_search?q=title:(joli OR code) AND author:"Damien Alexandre"^2\n'})}),"\n",(0,a.jsx)(n.p,{children:"Search with wildcard and special queries:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:"GET /_search?q=_exists_:title OR title:singl? noneOrAnyChar*cter\n"})}),"\n",(0,a.jsx)(n.p,{children:"Search with fuzzyness and range:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:"GET /_search?q=title:elastichurch~3 AND date:[2016-01-01 TO 2018-12-31]\n"})}),"\n",(0,a.jsx)(n.p,{children:"Use in Query DSL (not recommended for user search):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET /_search\r\n{\r\n  "query": {\r\n    "query_string": {\r\n      "default_field": "content",\r\n      "query": "elastic AND (title:lucene OR title:solr)"\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"search-after---pagination-cursor",children:"Search After - Pagination cursor"}),"\n",(0,a.jsx)(n.p,{children:"Search with a custom sort:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET products/_search\r\n{\r\n    "size": 10,\r\n    "sort": [\r\n        {"date": "asc"},\r\n        {"_id": "desc"}\r\n    ]\r\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:'On the next "page", pass the sort values from the last result:'}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET product/_search\r\n{\r\n    "size": 10,\r\n    "search_after": [1463538857, "654323"],\r\n    "sort": [\r\n        {"date": "asc"},\r\n        {"_id": "desc"}\r\n    ]\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"indexes-and-mapping",children:"Indexes and mapping"}),"\n",(0,a.jsx)(n.p,{children:"Create an index with settings and mapping"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'PUT /my_index_name\r\n{\r\n  "settings": {\r\n    "number_of_replicas": 1,\r\n    "number_of_shards": 3,\r\n    "analysis": {},\r\n    "refresh_interval": "1s"\r\n  },\r\n  "mappings": {\r\n    "dynamic": false,\r\n    "properties": {\r\n      "title": {\r\n        "type": "text",\r\n        "analyzer": "english"\r\n      }\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"get-the-mapping-and-the-settings",children:"Get the mapping and the settings"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"GET /my_index_name\r\nGET /my_index_name/_mapping\r\nGET /my_index_name/_settings\n"})}),"\n",(0,a.jsx)(n.h2,{id:"create-a-document-auto-generated-id",children:"Create a document (auto-generated ID)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'POST /my_index_name/_doc\r\n{\r\n  "title": "Elastic is funny",\r\n  "tag": [\r\n    "lucene"\r\n  ]\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"create-or-update-a-document",children:"Create or update a document"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'PUT /my_index_name/_doc/12abc\r\n{\r\n  "title": "Elastic is funny",\r\n  "tag": [\r\n    "lucene"\r\n  ]\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"delete-a-document",children:"Delete a document"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"DELETE /my_index_name/_doc/12abc\n"})}),"\n",(0,a.jsx)(n.h2,{id:"open-and-close-indexes-to-save-memory-and-cpu",children:"Open and close indexes to save memory and CPU"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"POST /my_index_name/_close\r\nPOST /my_index_name/_open\n"})}),"\n",(0,a.jsx)(n.h2,{id:"remove-and-create-aliases",children:"Remove and create aliases"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'POST /_aliases\r\n{\r\n  "actions": [\r\n    {\r\n      "remove": {\r\n        "index": "my_index_name",\r\n        "alias": "foo"\r\n      }\r\n    },\r\n    {\r\n      "add": {\r\n        "index": "my_index_name",\r\n        "alias": "bar",\r\n        "filter" : { "term" : { "user" : "damien" } }\r\n      }\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"list-aliases",children:"List aliases"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"GET /_aliases\r\nGET /my_index_name/_alias/*\r\nGET /*/_alias/*\r\nGET /*/_alias/foo\n"})}),"\n",(0,a.jsx)(n.h2,{id:"full-custom-analyzer-declaration",children:"Full custom analyzer declaration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'PUT /english_example\r\n{\r\n  "settings": {\r\n    "analysis": {\r\n      "filter": {\r\n        "english_stop": {\r\n          "type":       "stop",\r\n          "stopwords":  "_english_"\r\n        },\r\n        "english_stemmer": {\r\n          "type":       "stemmer",\r\n          "language":   "english"\r\n        }\r\n      },\r\n      "analyzer": {\r\n        "my_english": {\r\n          "char_filter":  ["html_strip"],\r\n          "tokenizer":  "standard",\r\n          "filter": [\r\n            "lowercase",\r\n            "english_stop",\r\n            "english_stemmer"\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"indices-monitoring-and-information",children:"Indices monitoring and information"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"GET /my_index_name/_stats\r\nGET /my_index_name/_segments\r\nGET /my_index_name/_recovery?pretty&human\n"})}),"\n",(0,a.jsx)(n.h2,{id:"indices-status-and-management",children:"Indices status and management"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"POST /my_index_name/_cache/clear\r\nPOST /my_index_name/_refresh\r\nPOST /my_index_name/_flush\r\nPOST /my_index_name/_forcemerge\n"})}),"\n",(0,a.jsx)(n.h2,{id:"reindex-api",children:"Reindex API"}),"\n",(0,a.jsx)(n.h3,{id:"simple-reindex-operation",children:"Simple Reindex Operation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'POST /_reindex\r\n{\r\n  "source": {\r\n    "index": "test-index"\r\n  },\r\n  "dest": {\r\n    "index": "test-index-new"\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"selective-reindex-operation",children:"Selective Reindex Operation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'POST /_reindex\r\n{\r\n  "source": {\r\n    "index": "test-index",\r\n    "query": {\r\n      "match": {\r\n        "gender": "female"\r\n      }\r\n    }\r\n  },\r\n  "dest": {\r\n    "index": "test-index-new",\r\n    "type": "female"\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"debug-and-development",children:"Debug and development"}),"\n",(0,a.jsx)(n.h3,{id:"queries-1",children:"Queries"}),"\n",(0,a.jsx)(n.p,{children:"Get a detailed view of what a query do:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET /blog/_validate/query?explain=true\r\n{\r\n  "query": {\r\n    "match": {\r\n      "title": "Smith"\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Get an explanation about a document matching or not:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET /blog/_doc/1/_explain\r\n{\r\n  "query": {\r\n    "match": {\r\n      "title": "Smith"\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"analysis",children:"Analysis"}),"\n",(0,a.jsx)(n.p,{children:"Test how a content is tokenized in a field:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET /blog/_analyze\r\n{\r\n  "field": "title",\r\n  "text": "powerful"\r\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Test analyzer token output by analyzer:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'GET /blog/_analyze\r\n{\r\n  "analyzer": "english",\r\n  "text": "powerful"\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"slowlog",children:"Slowlog"}),"\n",(0,a.jsx)(n.p,{children:"Lower the slowlog threshold to see all the search queries in the logs:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'PUT /blog/_settings\r\n{\r\n  "index.search.slowlog.threshold.query.trace": "0s",\r\n  "index.search.slowlog.level": "trace"\r\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Go back to the default configuration:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'PUT /blog/_settings\r\n{\r\n  "index.search.slowlog.threshold.query.trace": "500ms",\r\n  "index.search.slowlog.level": "info"\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"cluster-and-node-information",children:"Cluster and node information"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"GET /_cluster/health?pretty\r\nGET /_cluster/health?wait_for_status=yellow&timeout=50s\r\nGET /_cluster/state\r\nGET /_cluster/stats?human&pretty\r\nGET /_cluster/pending_tasks\r\nGET /_nodes\r\nGET /_nodes/stats\r\nGET /_nodes/nodeId1,nodeId2/stats\n"})}),"\n",(0,a.jsx)(n.p,{children:"Get the full reference of all the settings:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"GET /_cluster/settings?include_defaults=true&flat_settings=true\n"})}),"\n",(0,a.jsx)(n.h2,{id:"updating-settings",children:"Updating settings"}),"\n",(0,a.jsx)(n.p,{children:"Disable shard allocation, useful before a rolling restart:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'PUT /_cluster/settings\r\n{\r\n    "transient" : {\r\n        "cluster.routing.allocation.enable" : "none"\r\n    }\r\n}\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'PUT /_cluster/settings\r\n{\r\n    "transient" : {\r\n        "cluster.routing.allocation.enable" : "all"\r\n    }\r\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"snapshots-and-restore",children:"Snapshots and Restore"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'PUT /_snapshot/my_backup\r\n{\r\n  "type": "fs",\r\n  "settings": {\r\n    "location": "my_backup_location"\r\n  }\r\n}\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'PUT /_snapshot/my_backup/snapshot_a\r\n{\r\n  "indices": "index_1,index_2",\r\n  "ignore_unavailable": "true",\r\n  "include_global_state": false\r\n}\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'POST /_snapshot/my_backup/snapshot_a/_restore\r\n{\r\n  "indices": "index_1,index_2",\r\n  "ignore_unavailable": "true",\r\n  "include_global_state": false,\r\n  "rename_pattern": "index_(.+)",\r\n  "rename_replacement": "restored_index_$1"\r\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.ah)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},603905:(e,n,r)=>{r.d(n,{ah:()=>d});var a=r(667294);function s(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function i(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,a)}return r}function t(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?i(Object(r),!0).forEach((function(n){s(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function l(e,n){if(null==e)return{};var r,a,s=function(e,n){if(null==e)return{};var r,a,s={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],n.indexOf(r)>=0||(s[r]=e[r]);return s}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var c=a.createContext({}),d=function(e){var n=a.useContext(c),r=n;return e&&(r="function"==typeof e?e(n):t(t({},n),e)),r},o={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},h=a.forwardRef((function(e,n){var r=e.components,s=e.mdxType,i=e.originalType,c=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),u=d(r),m=s,g=u["".concat(c,".").concat(m)]||u[m]||o[m]||i;return r?a.createElement(g,t(t({ref:n},h),{},{components:r})):a.createElement(g,t({ref:n},h))}));h.displayName="MDXCreateElement"}}]);