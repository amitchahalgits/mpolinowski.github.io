"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[75885],{540450:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>o});var r=t(785893),s=t(603905);const i={sidebar_position:9040,slug:"2017-07-22",title:"Food Caloric Table App",authors:"mpolinowski",tags:["Javascript","React"]},a="Server Setup",c={id:"Development/Javascript/2017-07-22--caloric-burn/index",title:"Food Caloric Table App",description:"Port Vila, Vanuatu",source:"@site/docs/Development/Javascript/2017-07-22--caloric-burn/index.mdx",sourceDirName:"Development/Javascript/2017-07-22--caloric-burn",slug:"/Development/Javascript/2017-07-22--caloric-burn/2017-07-22",permalink:"/docs/Development/Javascript/2017-07-22--caloric-burn/2017-07-22",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Development/Javascript/2017-07-22--caloric-burn/index.mdx",tags:[{label:"Javascript",permalink:"/docs/tags/javascript"},{label:"React",permalink:"/docs/tags/react"}],version:"current",sidebarPosition:9040,frontMatter:{sidebar_position:9040,slug:"2017-07-22",title:"Food Caloric Table App",authors:"mpolinowski",tags:["Javascript","React"]},sidebar:"tutorialSidebar",previous:{title:"React TODO List",permalink:"/docs/Development/Javascript/2017-07-24--obligatory-react-todo-list/2017-07-24"},next:{title:"Random Password Generator",permalink:"/docs/Development/Javascript/2017-07-04--random-password-generator/2017-07-04"}},l={},o=[{value:"Server Dependencies Installation",id:"server-dependencies-installation",level:2},{value:"Test the Server",id:"test-the-server",level:2},{value:"create-react-app",id:"create-react-app",level:2},{value:"react-scripts",id:"react-scripts",level:3},{value:"Concurrently",id:"concurrently",level:2},{value:"React Interface",id:"react-interface",level:2},{value:"Setting up the proxy",id:"setting-up-the-proxy",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.ah)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Port Vila, Vanuatu",src:t(753719).Z+"",width:"1500",height:"832"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["This app is based on the ",(0,r.jsx)(n.a,{href:"https://www.fullstackreact.com/articles/using-create-react-app-with-a-server/",children:"food-lookup-demo"})," from fullstackreact.com."]}),"\n",(0,r.jsxs)(n.p,{children:["Our sample app will be a simple food nutrition lookup table. The data driving the app is supplied by the USDA's ",(0,r.jsx)(n.a,{href:"https://www.ars.usda.gov/northeast-area/beltsville-md/beltsville-human-nutrition-research-center/nutrient-data-laboratory/docs/usda-national-nutrient-database-for-standard-reference/",children:"National Nutrient Database"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/mpolinowski/caloric-burn",children:"Github"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#server-setup",children:"Server Setup"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#server-dependencies-installation",children:"Server Dependencies Installation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#test-the-server",children:"Test the Server"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#frontend-client-setup",children:"Frontend Client Setup"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#create-react-app",children:"create-react-app"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#react-scripts",children:"react-scripts"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#concurrently",children:"Concurrently"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#react-interface",children:"React Interface"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#setting-up-the-proxy",children:"Setting up the proxy"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#test-your-app",children:"Test your App"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#deployment",children:"Deployment"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"First, git clone this repository and cd into that directory."}),"\n",(0,r.jsx)(n.p,{children:"This is where the server lives (server.js). Inside of the db folder is a sqlite database containing the nutrition data."}),"\n",(0,r.jsx)(n.h1,{id:"server-setup",children:"Server Setup"}),"\n",(0,r.jsxs)(n.p,{children:["We now use ",(0,r.jsx)(n.a,{href:"https://nodejs.org/en/",children:"Node.js"})," and the Node Package Manager to install all dependencies for our app. Make sure that you install the latest version of node first. Then use your Terminal, or ",(0,r.jsx)(n.a,{href:"https://git-scm.com",children:"Git Bash"})," under Windows, to run the following npm commands."]}),"\n",(0,r.jsx)(n.h2,{id:"server-dependencies-installation",children:"Server Dependencies Installation"}),"\n",(0,r.jsx)(n.p,{children:"Use"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm install\n"})}),"\n",(0,r.jsx)(n.p,{children:"to install all dependencies & dev-dependecies in a development environment (the default). Later you can use"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm install --production\n"})}),"\n",(0,r.jsx)(n.p,{children:"or set the NODE_ENV environment variable to production to avoid installing dev-dependencies."}),"\n",(0,r.jsx)(n.h2,{id:"test-the-server",children:"Test the Server"}),"\n",(0,r.jsx)(n.p,{children:"Let's boot the server:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm run server\n"})}),"\n",(0,r.jsx)(n.p,{children:"This server provides a single API endpoint, /api/food. It expects a single parameter, q, the food we are searching for. You can test it with your browser or use the CURL command inside your console:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl localhost:3001/api/food?q=mcflurry\n"})}),"\n",(0,r.jsx)(n.p,{children:"Now that we understand how this endpoint works, let's build the front-end application. Kill the server with CTRL+C."}),"\n",(0,r.jsx)(n.h1,{id:"frontend-client-setup",children:"Frontend Client Setup"}),"\n",(0,r.jsx)(n.p,{children:"Ensure that you have create-react-app installed globally:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm install -g create-react-app\n"})}),"\n",(0,r.jsx)(n.h2,{id:"create-react-app",children:"create-react-app"}),"\n",(0,r.jsx)(n.p,{children:"At the top-level directory of the project we'll create our client app. We want the React app to be in a folder called client, so we'll just use that name in the create-react-app command  (if you are working inside a clone of this repository, please make sure to remove the already existing /client folder first! Don't delete it completely - you will need some of the files later on):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"create-react-app client\n"})}),"\n",(0,r.jsx)(n.p,{children:"This creates a new directory with the following file structure:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ls client\r\nREADME.md\r\nnode_modules/\r\npackage.json\r\npublic/\r\nsrc/\n"})}),"\n",(0,r.jsx)(n.p,{children:"Taking a look at client/package.json, we can see that we just installed react, react-dom, and react-scripts to the /client directory:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:"{\r\n  'name': 'client',\r\n  'version': '0.1.0',\r\n  'private': true,\r\n  'dependencies': {\r\n    'react': '^15.6.1',\r\n    'react-dom': '^15.6.1',\r\n    'react-scripts': '1.0.12'\r\n  },\r\n  'scripts': {\r\n    'start': 'react-scripts start',\r\n    'build': 'react-scripts build',\r\n    'test': 'react-scripts test --env=jsdom',\r\n    'eject': 'react-scripts eject'\r\n  }\r\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Inside that directory, we can now run several commands:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["npm start","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Starts the development server."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["npm run build","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Bundles the app into static files for production."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["npm test","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Starts the test runner."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["npm run eject","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Removes this tool and copies build dependencies, configuration files and scripts into the app directory. If you do this, you can\u2019t go back!"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"react-scripts",children:"react-scripts"}),"\n",(0,r.jsx)(n.p,{children:"react-scripts is an NPM package specifically for use with create-react-app. It's the 'black box' which contains the essentials:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Dependencies","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Like Babel, ESLint, and Webpack."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Configuration","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Config files for Webpack, Babel and ESLint, both for development and production."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Scripts","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"For instance, the command react-scripts start runs a script shipped with this package. It's responsible for ultimately booting the > Webpack development server."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"To see it in action, we can run npm start from inside of this folder:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd client && npm start\n"})}),"\n",(0,r.jsx)(n.p,{children:"This will launch a Webpack dev server and should also open localhost:3000 in your browser:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Javascript Tutorial",src:t(146901).Z+"",width:"832",height:"915"})}),"\n",(0,r.jsx)(n.p,{children:"We have our API server in the top-level directory and we were able to boot that. And we have our client app down here in client and we're able to boot a server for this."}),"\n",(0,r.jsx)(n.p,{children:"So the user will direct their browser to localhost:3000, hitting the Webpack dev server. But then how will the React app communicate with our API server?"}),"\n",(0,r.jsx)(n.p,{children:"create-react-app provides a mechanism for working with an API server in development. We can have the Webpack development server proxy requests intended for our API server, like this:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Javascript Tutorial",src:t(935009).Z+"",width:"2827",height:"527"})}),"\n",(0,r.jsx)(n.p,{children:"In this flow, React makes an API request to localhost:3000, the Webpack development server. And then the development server simply proxies that request to the API server, negating any CORS issues."}),"\n",(0,r.jsx)(n.p,{children:"we need to:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"launch both the Webpack dev server and the API server in order to run the app locally."}),"\n",(0,r.jsx)(n.li,{children:"we need to get the Webpack dev server to proxy requests intended for our API server."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"concurrently",children:"Concurrently"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/kimmobrunfeldt/concurrently",children:"Concurrently"})," is a utility for running multiple processes. Taking a look at our package.json file inside the top-level directory will show you that we already installed Concurrently as a dev-dependency earlier."]}),"\n",(0,r.jsx)(n.p,{children:"We want concurrently to execute two commands, one to boot the API server and one to boot the Webpack development server. You boot multiple commands by passing them to concurrently in quotes like this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"concurrently 'npm run server' 'cd client && npm start'\n"})}),"\n",(0,r.jsx)(n.p,{children:"However, the && operator is not cross-platform (doesn't work on Windows). As such, we've included a start-client.js script with the project. This script will boot the client from the top-level directory in a manner that is cross-platform."}),"\n",(0,r.jsx)(n.p,{children:"Ultimately, we'll want to boot concurrently like this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"concurrently 'npm run server' 'npm run client'\n"})}),"\n",(0,r.jsx)(n.p,{children:"This will be our start command. Let's add the start and client commands to our package.json now:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:"'scripts': {\r\n    'start': 'concurrently \\'npm run server\\' \\'npm run client\\'',\r\n    'server': 'node server.js',\r\n    'client': 'node start-client.js'\r\n  },\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For start, we execute both commands, escaping the quotes because we're in a JSON file. For client, we execute the start-client.js script with node. Now we can boot both servers by running ",(0,r.jsx)(n.strong,{children:"npm start"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"react-interface",children:"React Interface"}),"\n",(0,r.jsxs)(n.p,{children:["Now we will add the food lookup React components which will make requests against our API server. The components are located in the ",(0,r.jsx)(n.strong,{children:"/client/src"})," folder. You can copy them over the auto-generated content by create-react-app, overwriting the original ",(0,r.jsx)(n.em,{children:"App.js"}),", ",(0,r.jsx)(n.em,{children:"index.js"})," and ",(0,r.jsx)(n.em,{children:"index.css"})," files."]}),"\n",(0,r.jsxs)(n.p,{children:["We use ",(0,r.jsx)(n.a,{href:"https://semantic-ui.com/introduction/getting-started.html",children:"Semantic UI"})," for styling the app - the files can be found in ",(0,r.jsx)(n.strong,{children:"/client/src/semantic"})," as well as ",(0,r.jsx)(n.strong,{children:"/client/semantic.json"})," inside this repository - just copy them into your client directory. It's loaded inside of ",(0,r.jsx)(n.strong,{children:"/client/src/index.js"}),". ",(0,r.jsx)(n.strong,{children:"/client/src/index.css"})," contains a few margins."]}),"\n",(0,r.jsxs)(n.p,{children:["Changing the value of the search bar (the FoodSearch component) ultimately calls search() on Client. ",(0,r.jsx)(n.strong,{children:"Client.js"})," contains a Fetch call to our API endpoint:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"function search(query, cb) {\r\n  return fetch(`api/food?q=${query}`, {\r\n    accept: 'application/json'\r\n  })\r\n    .then(checkStatus)\r\n    .then(parseJSON)\r\n    .then(cb);\r\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This is the one touch point between our React web app and the API server. Notice how the URL ",(0,r.jsx)(n.em,{children:"does not include"})," the base ",(0,r.jsx)(n.strong,{children:"localhost:3001"}),". That's because, as noted earlier, we want this request to be made to the Webpack development server. Thanks to the configuration established by create-react-app, the Webpack dev server will infer what traffic to proxy. It will proxy a request if the URL is not recognized or if the request is not loading static assets (like HTML/CSS/JS)."]}),"\n",(0,r.jsx)(n.p,{children:"We just need to instruct Webpack to use the proxy."}),"\n",(0,r.jsx)(n.h2,{id:"setting-up-the-proxy",children:"Setting up the proxy"}),"\n",(0,r.jsx)(n.p,{children:"To have the Webpack development server proxy our API requests to our API server, we just need to add the following line to client/package.json:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:"// Inside client/package.json\r\n'proxy': 'http://localhost:3001/',\n"})}),"\n",(0,r.jsx)(n.h1,{id:"test-your-app",children:"Test your App"}),"\n",(0,r.jsx)(n.p,{children:"Our React app is ready and in place in client/. We have concurrently setup to boot both our Webpack dev server and our API server together. And we've specified the route that Webpack should proxy API traffic to."}),"\n",(0,r.jsx)(n.p,{children:"Let's boot both servers:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm start\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Javascript Tutorial",src:t(594584).Z+"",width:"410",height:"411"})}),"\n",(0,r.jsx)(n.h1,{id:"deployment",children:"Deployment"}),"\n",(0,r.jsx)(n.p,{children:"create-react-app comes with a build command that you can use to create a static bundle of the React app:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd client\r\nnpm run build\n"})}),"\n",(0,r.jsx)(n.p,{children:"This produces a build/ folder which you can serve with any static asset host. It contains all your app's HTML, JavaScript, and CSS files. This command is intended for production use. It does all kinds of optimization, to create a fast loading static page."})]})}function h(e={}){const{wrapper:n}={...(0,s.ah)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},603905:(e,n,t)=>{t.d(n,{ah:()=>o});var r=t(667294);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var l=r.createContext({}),o=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},h=r.forwardRef((function(e,n){var t=e.components,s=e.mdxType,i=e.originalType,l=e.parentName,h=c(e,["components","mdxType","originalType","parentName"]),p=o(t),u=s,j=p["".concat(l,".").concat(u)]||p[u]||d[u]||i;return t?r.createElement(j,a(a({ref:n},h),{},{components:t})):r.createElement(j,a({ref:n},h))}));h.displayName="MDXCreateElement"},146901:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/boilerplate-page-dd1e44ef988c7acaaa70b4bd0a7d1e0e.png"},935009:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/flow-diagram-15694200098bb23c90965788307d2dc6.png"},753719:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/photo-34221441540_627d018c4b_o-dda001b186477924c04c5b18084923e1.png"},594584:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/usage-demo-feb22f0f6c2ebd7122a0ba01119df37a.gif"}}]);