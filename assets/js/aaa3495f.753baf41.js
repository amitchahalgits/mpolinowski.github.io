"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[29827],{909224:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var i=n(785893),s=n(603905);const r={sidebar_position:4960,slug:"2024-01-18",title:"Uptime Kuma",authors:"mpolinowski",tags:["LINUX","Docker"],description:"Uptime Kuma is an easy-to-use self-hosted monitoring tool."},a="Provision Uptime Kuma with Docker",o={id:"DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring/index",title:"Uptime Kuma",description:"Uptime Kuma is an easy-to-use self-hosted monitoring tool.",source:"@site/docs/DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring/index.md",sourceDirName:"DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring",slug:"/DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring/2024-01-18",permalink:"/docs/DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring/2024-01-18",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Provisioning/2024-01-18--uptime-kuma-monitoring/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"},{label:"Docker",permalink:"/docs/tags/docker"}],version:"current",sidebarPosition:4960,frontMatter:{sidebar_position:4960,slug:"2024-01-18",title:"Uptime Kuma",authors:"mpolinowski",tags:["LINUX","Docker"],description:"Uptime Kuma is an easy-to-use self-hosted monitoring tool."},sidebar:"tutorialSidebar",previous:{title:"Server Provisioning",permalink:"/docs/category/server-provisioning"},next:{title:"ntfy Notification Service",permalink:"/docs/DevOps/Provisioning/2024-01-17--ntfy-notification-service/2024-01-17"}},c={},d=[{value:"Monitoring your INSTAR Camera",id:"monitoring-your-instar-camera",level:2},{value:"MQTT Heartbeat",id:"mqtt-heartbeat",level:3},{value:"HTTP Heartbeat",id:"http-heartbeat",level:2},{value:"Adding Notifications",id:"adding-notifications",level:2}];function m(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.ah)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Shenzhen, China",src:n(970154).Z+"",width:"1500",height:"567"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"#provision-uptime-kuma-with-docker",children:"Provision Uptime Kuma with Docker"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"#monitoring-your-instar-camera",children:"Monitoring your INSTAR Camera"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"#mqtt-heartbeat",children:"MQTT Heartbeat"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"#http-heartbeat",children:"HTTP Heartbeat"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"#adding-notifications",children:"Adding Notifications"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h1,{id:"provision-uptime-kuma-with-docker",children:"Provision Uptime Kuma with Docker"}),"\n",(0,i.jsx)(t.p,{children:"Prepare a volume mount:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"sudo mkdir /opt/uptime\r\nsudo chown $(whoami):$(whoami) /opt/uptime\r\nsudo chmod 777 /opt/uptime\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Download the latest Docker image from ",(0,i.jsx)(t.a,{href:"https://hub.docker.com/r/louislam/uptime-kuma/tags",children:"Docker Hub"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"docker pull louislam/uptime-kuma:1-alpine\n"})}),"\n",(0,i.jsx)(t.p,{children:"Run the container in Docker:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"docker run -d --restart=unless-stopped --net=host \\\r\n  # -p 3001:3001 \\\r\n  -v /opt/uptime:/app/data \\\r\n  --name monitor \\\r\n  louislam/uptime-kuma:1-alpine\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Or with ",(0,i.jsx)(t.code,{children:"docker-compose up -d"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yml",children:"version: '3'\r\nservices:\r\n  app:\r\n    image: louislam/uptime-kuma:1-alpine\r\n    container_name: monitor\r\n    restart: unless-stopped\r\n    network_mode: host\r\n    # ports:\r\n    #   - 3001:3001\r\n    volumes:\r\n      - /opt/uptime:/app/data\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Visit the webUI on ",(0,i.jsx)(t.code,{children:"localhost:3001"})," and create an admin user and activate dark mode:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(154338).Z+"",width:"1045",height:"545"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(406225).Z+"",width:"1051",height:"408"})}),"\n",(0,i.jsx)(t.h2,{id:"monitoring-your-instar-camera",children:"Monitoring your INSTAR Camera"}),"\n",(0,i.jsx)(t.h3,{id:"mqtt-heartbeat",children:"MQTT Heartbeat"}),"\n",(0,i.jsxs)(t.p,{children:["Start by clicking on ",(0,i.jsx)(t.strong,{children:"Add New Monitor"}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(18786).Z+"",width:"1256",height:"404"})}),"\n",(0,i.jsxs)(t.p,{children:["Select ",(0,i.jsx)(t.strong,{children:"MQTT"})," as ",(0,i.jsx)(t.strong,{children:"Monitor Type"})," and add the MQTT broker configuration from your INSTAR camera:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(154704).Z+"",width:"1253",height:"717"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.strong,{children:"Hostname"})," is the local IP (or DDNS address) of your camera and ",(0,i.jsx)(t.strong,{children:"Port"})," is the regular MQTT server port that defaults to ",(0,i.jsx)(t.code,{children:"1883"}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(251529).Z+"",width:"1238",height:"820"})}),"\n",(0,i.jsxs)(t.p,{children:["You can use the ",(0,i.jsx)(t.em,{children:"Last-Will-and-Testament"})," (",(0,i.jsx)(t.a,{href:"https://wiki.instar.com/en/Advanced_User/INSTAR_MQTT_Broker/",children:"lwt-topic"}),") to monitor your camera - default ",(0,i.jsx)(t.code,{children:"mqtt prefix"}),"/",(0,i.jsx)(t.code,{children:"camera id"}),"/status/connection:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(178986).Z+"",width:"1025",height:"534"})}),"\n",(0,i.jsx)(t.p,{children:"Add the topic to your monitor:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(842587).Z+"",width:"1217",height:"808"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note"}),': Use the "online" payload ',(0,i.jsx)(t.strong,{children:"without"})," any spaces or it will not match: ",(0,i.jsx)(t.code,{children:'{"val":"online"}'}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(926454).Z+"",width:"1195",height:"521"})}),"\n",(0,i.jsx)(t.p,{children:"Once corrected the camera will show up as online:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(372710).Z+"",width:"1246",height:"820"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(981277).Z+"",width:"1241",height:"466"})}),"\n",(0,i.jsx)(t.h2,{id:"http-heartbeat",children:"HTTP Heartbeat"}),"\n",(0,i.jsxs)(t.p,{children:["For older INSTAR IP cameras that don't support the MQTT protocol we can use an HTTP endpoint (",(0,i.jsx)(t.a,{href:"https://wiki.instar.com/en/Advanced_User/CGI_Commands/",children:"random CGI command"}),") and sending GET requests to verify that the camera is connected and running. Start by clicking on ",(0,i.jsx)(t.strong,{children:"Add New Monitor"}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(104417).Z+"",width:"1247",height:"383"})}),"\n",(0,i.jsxs)(t.p,{children:["This time select ",(0,i.jsx)(t.strong,{children:"HTTP"})," as ",(0,i.jsx)(t.strong,{children:"Monitor Type"})," and add the IP address with a random CGI command as URL (e.g. ",(0,i.jsx)(t.code,{children:"getsysinfo"}),"):"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(465689).Z+"",width:"1275",height:"847"})}),"\n",(0,i.jsxs)(t.p,{children:["As authentication choose ",(0,i.jsx)(t.strong,{children:"HTTP Basic Auth"})," and add your camera login:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(631051).Z+"",width:"1251",height:"607"})}),"\n",(0,i.jsx)(t.p,{children:"The monitor will now contact your camera once a minute to verify that it is still running:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(339331).Z+"",width:"1275",height:"814"})}),"\n",(0,i.jsx)(t.h2,{id:"adding-notifications",children:"Adding Notifications"}),"\n",(0,i.jsx)(t.p,{children:"Now to the interesting part - how do I receive notifications about events on my network on my Android phone?"}),"\n",(0,i.jsxs)(t.p,{children:["There are quite a few options to choose from. Let's take a look at a simple, self-hosted solution called ",(0,i.jsx)(t.a,{href:"/docs/DevOps/Provisioning/2024-01-17--ntfy-notification-service/2024-01-17",children:"ntfy"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["Start by selecting one of your monitors and click on ",(0,i.jsx)(t.strong,{children:"Setup Notification"}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(894683).Z+"",width:"1335",height:"369"})}),"\n",(0,i.jsxs)(t.p,{children:["And add the topic and URL of your ",(0,i.jsx)(t.a,{href:"/docs/DevOps/Provisioning/2024-01-17--ntfy-notification-service/2024-01-17",children:"nfty installation"}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(478701).Z+"",width:"1099",height:"473"})}),"\n",(0,i.jsx)(t.p,{children:"Click to test your configuration:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(500527).Z+"",width:"945",height:"298"})}),"\n",(0,i.jsx)(t.p,{children:"And you should see the test update on the nfty dashboard:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Uptime Kuma",src:n(245282).Z+"",width:"1261",height:"283"})})]})}function l(e={}){const{wrapper:t}={...(0,s.ah)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}},603905:(e,t,n)=>{n.d(t,{ah:()=>d});var i=n(667294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,i,s=function(e,t){if(null==e)return{};var n,i,s={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var c=i.createContext({}),d=function(e){var t=i.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},l=i.forwardRef((function(e,t){var n=e.components,s=e.mdxType,r=e.originalType,c=e.parentName,l=o(e,["components","mdxType","originalType","parentName"]),p=d(n),h=s,u=p["".concat(c,".").concat(h)]||p[h]||m[h]||r;return n?i.createElement(u,a(a({ref:t},l),{},{components:n})):i.createElement(u,a({ref:t},l))}));l.displayName="MDXCreateElement"},970154:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-983e9af3d84f5fb9ebad02646e63767d.jpg"},154338:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_01-fb82c0c29cf39d80a8e1a1228e82a352.png"},406225:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_02-24afbd5163a329a5a81a832c5ca9cdc2.png"},18786:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_03-107203f511a4f17856c28f1311c39ad4.png"},154704:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_04-10b17a92a3928707596a9c6bb9fca9c4.png"},251529:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_05-cc62c4247d5ae78150c280d438dc2916.png"},178986:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_06-de863c318015d5590bf1dd596fec1b8d.png"},842587:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_07-5116624f7a17ca5d2a042a3817055439.png"},926454:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_08-63a8e622bf076c8ceed1cc3ed8ae7115.png"},372710:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_09-8e0458331382a99159096d413285b6fd.png"},981277:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_10-47e0d780a7656a9314562209d32dcbb5.png"},104417:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_11-a20f7623e5a6913daefe6059ce60531a.png"},465689:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_12-548867c81c0178317a83ef377e8cd06b.png"},631051:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_13-6a736c74507dad09e35b42e1494a165c.png"},339331:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_14-98ae05722b15ccc42dc8c4cda6657b3b.png"},894683:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_15-a5dad1a9a9a052d39b10dc8f5f1043a6.png"},478701:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_16-e3c1385ec38710f047c7280cb4ab71a7.png"},500527:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_17-4326ff8c02e5ebfa353855c94ef627a9.png"},245282:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/uptime-kuma_18-5516f6d0d3a8566813788b8056190577.png"}}]);