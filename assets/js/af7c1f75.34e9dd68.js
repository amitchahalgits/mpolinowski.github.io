"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[78899],{50450:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>l});var t=r(785893),a=r(603905);const o={sidebar_position:9e3,slug:"2021-11-08",title:"Tensorflow Crash Course - Part I",authors:"mpolinowski",tags:["Machine Learning","Python","Tensorflow"]},s=void 0,c={id:"IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/index",title:"Tensorflow Crash Course - Part I",description:"Mong Kok, Hongkong",source:"@site/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/index.md",sourceDirName:"IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i",slug:"/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/2021-11-08",permalink:"/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/2021-11-08",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/index.md",tags:[{label:"Machine Learning",permalink:"/docs/tags/machine-learning"},{label:"Python",permalink:"/docs/tags/python"},{label:"Tensorflow",permalink:"/docs/tags/tensorflow"}],version:"current",sidebarPosition:9e3,frontMatter:{sidebar_position:9e3,slug:"2021-11-08",title:"Tensorflow Crash Course - Part I",authors:"mpolinowski",tags:["Machine Learning","Python","Tensorflow"]},sidebar:"tutorialSidebar",previous:{title:"Tensorflow2 Crash Course - Part II",permalink:"/docs/IoT-and-Machine-Learning/ML/2021-11-09--tensorflow-crash-course-part-ii/2021-11-09"},next:{title:"activate_webcam",permalink:"/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/activate_webcam"}},i={},l=[{value:"Setting up Tensorflow",id:"setting-up-tensorflow",level:2},{value:"Arch Linux",id:"arch-linux",level:3},{value:"Installing Bazel",id:"installing-bazel",level:2},{value:"Arch Linux",id:"arch-linux-1",level:3},{value:"Project Setup",id:"project-setup",level:2},{value:"Data Collection",id:"data-collection",level:2},{value:"Training Preparation",id:"training-preparation",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.ah)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Mong Kok, Hongkong",src:r(388472).Z+"",width:"1500",height:"544"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#setting-up-tensorflow",children:"Setting up Tensorflow"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#arch-linux",children:"Arch Linux"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#installing-bazel",children:"Installing Bazel"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#arch-linux-1",children:"Arch Linux"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#project-setup",children:"Project Setup"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#data-collection",children:"Data Collection"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#training-preparation",children:"Training Preparation"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This set of Notebooks provides a complete set of code to be able to train and leverage your own custom object detection model using the Tensorflow Object Detection API."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["This article is based on a ",(0,t.jsx)(n.a,{href:"https://www.youtube.com/channel/UCHXa4OpASJEwrHrLeIzw7Yg",children:"Tutorial"})," by ",(0,t.jsx)(n.a,{href:"https://github.com/nicknochnack",children:"@nicknochnack"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Tensorflow Object Detection Walkthrough",src:r(880150).Z+"",width:"1453",height:"613"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/2021-11-08",children:"Tensorflow2 Crash Course Part I"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/IoT-and-Machine-Learning/ML/2021-11-09--tensorflow-crash-course-part-ii/2021-11-09",children:"Tensorflow2 Crash Course Part II"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/IoT-and-Machine-Learning/ML/2021-11-10--tensorflow-crash-course-part-iii/2021-11-10",children:"Tensorflow2 Crash Course Part III"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/IoT-and-Machine-Learning/ML/2021-11-11--tensorflow-crash-course-part-iv/2021-11-11",children:"Tensorflow2 Crash Course Part IV"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/IoT-and-Machine-Learning/ML/2021-11-12--tensorflow-crash-course-part-v/2021-11-12",children:"Tensorflow2 Crash Course Part V"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://github.com/mpolinowski/tensorflow2-starter",children:"Github Repository"})}),"\n",(0,t.jsx)(n.h2,{id:"setting-up-tensorflow",children:"Setting up Tensorflow"}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"https://www.tensorflow.org/install/source",children:"Installation Guide"})]}),"\n",(0,t.jsx)(n.h3,{id:"arch-linux",children:"Arch Linux"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"0 python-tensorflow\n"})}),"\n",(0,t.jsxs)(n.p,{children:["If you want to have ",(0,t.jsx)(n.strong,{children:"CUDA"})," acceleration with __nVidia ",(0,t.jsx)(n.strong,{children:"GPUs"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo pacman -Syu tensorflow-cuda python-tensorflow-cuda cuda cudnn\r\n\r\nPackages (51) abseil-cpp-20211102.0-1  absl-py-0.14.1-1  cblas-3.10.0-1  hdf5-1.12.1-1  intel-mkl-2020.4.304-1  libaec-1.0.6-1  liblzf-3.6-3 nccl-2.11.4-2  onednn-2.4.4-1  pybind11-2.8.1-1  python-astor-0.8.1-3  python-astunparse-1.6.3-3  python-bleach-4.1.0-1 python-cachetools-4.2.4-1  python-dateutil-2.8.2-2  python-decorator-5.1.0-1  python-flatbuffers-2.0.5-1  python-gast03-0.3.3-1 python-google-auth-1.34.0-1  python-google-auth-oauthlib-0.4.4-1  python-grpcio-1.42.0-1  python-h5py-3.6.0-1 python-keras-2.7.0-1  python-keras-applications-1.0.8-6  python-keras-preprocessing-1.1.2-4  python-numpy-1.21.3-1 python-oauthlib-3.1.1-1  python-opt_einsum-3.3.0-3  python-pandas-1.3.4-1  python-pasta-0.2.0-4  python-protobuf-3.17.3-1 python-pyasn1-0.4.8-5  python-pyasn1-modules-0.2.8-4  python-pycuda-2021.1-5  python-pydot-1.4.2-1  python-pytools-2021.2.9-1 python-pytz-2021.3-2  python-requests-oauthlib-1.3.0-4  python-rsa-4.8-1  python-scipy-1.7.3-1 python-tensorboard_plugin_wit-1.8.1-1 python-tensorflow-estimator-2.6.0-1  python-termcolor-1.1.0-10  python-werkzeug-2.0.2-1 python-wheel-0.37.0-2  python-wrapt-1.12.1-4  tensorboard-2.7.0-1  cuda-11.5.1-1  cudnn-8.3.0.98-1 python-tensorflow-cuda-2.7.0-3  tensorflow-cuda-2.7.0-3\r\n\r\nTotal Download Size:    3137.74 MiB\r\nTotal Installed Size:  10745.45 MiB\n"})}),"\n",(0,t.jsx)(n.h2,{id:"installing-bazel",children:"Installing Bazel"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://bazel.build",children:"Bazel"})," is a tool that builds and tests Java, C++, Android, iOS, Go and a wide variety of other language platforms. Bazel runs on ",(0,t.jsx)(n.a,{href:"https://docs.bazel.build/versions/main/install.html",children:"Windows, macOS, and Linux"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"arch-linux-1",children:"Arch Linux"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo pacman -Syu bazel\r\n\r\nPackages (7) java-environment-common-3-3  java-runtime-common-3-3  jdk11-openjdk-11.0.13.u8-1  jre11-openjdk-11.0.13.u8-1 jre11-openjdk-headless-11.0.13.u8-1  libnet-1:1.1.6-1  bazel-4.2.2-1\r\n\r\nTotal Download Size:   193.97 MiB\r\nTotal Installed Size:  362.47 MiB\r\n\n"})}),"\n",(0,t.jsx)(n.h2,{id:"project-setup",children:"Project Setup"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 1"}),": Clone this repository: ",(0,t.jsx)(n.a,{href:"https://github.com/mpolinowski/TFODCourse",children:"https://github.com/mpolinowski/TFODCourse"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Step 2"}),": Create a new virtual environment"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd workdir\r\nmkdir -p tf-course/Tensorflow/workspace/images/{train,test,collection}\r\ncd tf-course\r\npython -m venv tfod\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Step 3"}),": Activate your virtual environment"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"source tfod/bin/activate # Linux\r\n.\\tfod\\Scripts\\activate # Windows \n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Step 4"}),": Install dependencies and add virtual environment to the Python Kernel"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"pip install -r dependencies.txt\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"python -m pip install --upgrade pip\r\npip install ipykernel\r\npython -m ipykernel install --user --name=tfodj\n"})}),"\n",(0,t.jsx)(n.p,{children:"Verify that Jupyter Notebooks was installed:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"jupyter notebook\n"})}),"\n",(0,t.jsx)(n.p,{children:"Make sure that you have the option to choose your virtual environment as interpreter:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Tensorflow Object Detection Walkthrough",src:r(609877).Z+"",width:"1171",height:"372"})}),"\n",(0,t.jsx)(n.h2,{id:"data-collection",children:"Data Collection"}),"\n",(0,t.jsxs)(n.p,{children:["Collect images using the Notebook ",(0,t.jsx)(n.a,{href:"https://github.com/mpolinowski/TFODCourse/blob/main/collecting_training_data.ipynb",children:"collecting_training_data.ipynb"}),":"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Tensorflow Object Detection Walkthrough",src:r(690117).Z+"",width:"1187",height:"927"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:['For the image capturing I noticed that the timing seemed to be off. It got better by deactivating the preview. I am not sure what is going wrong there for now. Might be an issue with the RTSP stream - using a webcam instead seemed fine. Just run the capture step a couple of times and hold on to the "best" ',(0,t.jsx)(n.strong,{children:"5"})," images for all labels."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["To lable the images we are going to use ",(0,t.jsx)(n.a,{href:"https://github.com/tzutalin/labelImg",children:"labelImg"}),", which is a graphical image annotation tool."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"pip3 install labelImg\r\n\r\nSuccessfully installed PyQt5-Qt5-5.15.2 PyQt5-sip-12.9.0 labelImg-1.8.3 pyqt5-5.15.6\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Start the Software from your console with ",(0,t.jsx)(n.code,{children:"labelImg"}),":"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Tensorflow Object Detection Walkthrough",src:r(944043).Z+"",width:"800",height:"514"})}),"\n",(0,t.jsxs)(n.p,{children:["Open the directory where your captures were stored and press ",(0,t.jsx)(n.code,{children:"W"})," and draw a box around your hand and label it according to the gesture."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"Ctrl+s"})," to save the annotation XML file for your image and repeat for all images."]}),"\n",(0,t.jsx)(n.h2,{id:"training-preparation",children:"Training Preparation"}),"\n",(0,t.jsxs)(n.p,{children:["Manually divide collected images into two folders train and test. Copy 4 images (+ annotation file) of each label into the ",(0,t.jsx)(n.code,{children:"train"})," folder and the remaining one into the ",(0,t.jsx)(n.code,{children:"test"})," folder:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ls Tensorflow/workspace/images/test\r\n\r\nmetal.d31b4e19-6952-11ec-8d31-1c1b0dc5817f.jpg  thumbsdown.b74e6640-6953-11ec-b6d3-1c1b0dc5817f.jpg\r\nmetal.d31b4e19-6952-11ec-8d31-1c1b0dc5817f.xml  thumbsdown.b74e6640-6953-11ec-b6d3-1c1b0dc5817f.xml\r\nok.b9d7d438-6954-11ec-ae56-1c1b0dc5817f.jpg     thumbsup.f1535776-6951-11ec-856e-1c1b0dc5817f.jpg\r\nok.b9d7d438-6954-11ec-ae56-1c1b0dc5817f.xml     thumbsup.f1535776-6951-11ec-856e-1c1b0dc5817f.xml\r\n\r\nls Tensorflow/workspace/images/train\r\n\r\nmetal.25a3fdb5-6952-11ec-be18-1c1b0dc5817f.jpg  thumbsdown.939cd20d-6954-11ec-b0ac-1c1b0dc5817f.jpg\r\nmetal.25a3fdb5-6952-11ec-be18-1c1b0dc5817f.xml  thumbsdown.939cd20d-6954-11ec-b0ac-1c1b0dc5817f.xml\r\nmetal.c6fd71c4-6952-11ec-af7f-1c1b0dc5817f.jpg  thumbsdown.9a973d84-6954-11ec-89bf-1c1b0dc5817f.jpg\r\nmetal.c6fd71c4-6952-11ec-af7f-1c1b0dc5817f.xml  thumbsdown.9a973d84-6954-11ec-89bf-1c1b0dc5817f.xml\r\nmetal.cd667fbd-6953-11ec-a747-1c1b0dc5817f.jpg  thumbsdown.a3a55b8c-6954-11ec-baf0-1c1b0dc5817f.jpg\r\nmetal.cd667fbd-6953-11ec-a747-1c1b0dc5817f.xml  thumbsdown.a3a55b8c-6954-11ec-baf0-1c1b0dc5817f.xml\r\nmetal.d06a2256-6953-11ec-8d60-1c1b0dc5817f.jpg  thumbsdown.aa4aa114-6953-11ec-a97c-1c1b0dc5817f.jpg\r\nmetal.d06a2256-6953-11ec-8d60-1c1b0dc5817f.xml  thumbsdown.aa4aa114-6953-11ec-a97c-1c1b0dc5817f.xml\r\nok.adbee52a-6954-11ec-989c-1c1b0dc5817f.jpg     thumbsdown.b3df44fe-6952-11ec-bee8-1c1b0dc5817f.jpg\r\nok.adbee52a-6954-11ec-989c-1c1b0dc5817f.xml     thumbsdown.b3df44fe-6952-11ec-bee8-1c1b0dc5817f.xml\r\nok.b0c3a2e2-6954-11ec-8646-1c1b0dc5817f.jpg     thumbsup.8dc99774-6952-11ec-a0a3-1c1b0dc5817f.jpg\r\nok.b0c3a2e2-6954-11ec-8646-1c1b0dc5817f.xml     thumbsup.8dc99774-6952-11ec-a0a3-1c1b0dc5817f.xml\r\nok.b3c3f23a-6954-11ec-89b1-1c1b0dc5817f.jpg     thumbsup.90d4df65-6952-11ec-b7d0-1c1b0dc5817f.jpg\r\nok.b3c3f23a-6954-11ec-89b1-1c1b0dc5817f.xml     thumbsup.90d4df65-6952-11ec-b7d0-1c1b0dc5817f.xml\r\nok.b6ca07d3-6954-11ec-b156-1c1b0dc5817f.jpg     thumbsup.96d98a6b-6952-11ec-8039-1c1b0dc5817f.jpg\r\nok.b6ca07d3-6954-11ec-b156-1c1b0dc5817f.xml     thumbsup.96d98a6b-6952-11ec-8039-1c1b0dc5817f.xml\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Make sure you always have an even number of images in both folders"})})]})}function h(e={}){const{wrapper:n}={...(0,a.ah)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},603905:(e,n,r)=>{r.d(n,{ah:()=>l});var t=r(667294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function c(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=t.createContext({}),l=function(e){var n=t.useContext(i),r=n;return e&&(r="function"==typeof e?e(n):s(s({},n),e)),r},d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},h=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,h=c(e,["components","mdxType","originalType","parentName"]),p=l(r),u=a,b=p["".concat(i,".").concat(u)]||p[u]||d[u]||o;return r?t.createElement(b,s(s({ref:n},h),{},{components:r})):t.createElement(b,s({ref:n},h))}));h.displayName="MDXCreateElement"},388472:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-8629210580d5b66cf728356357923b9f.jpg"},880150:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/tensorflow-crash-course_00-3c45a7dda7c78e42a1266d64adc53e14.png"},609877:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/tensorflow-crash-course_01-b61e1ad20427a9679eba9ff1fe3049b3.png"},690117:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/tensorflow-crash-course_02-b02348de2fb25186a633ce75fd5fded0.png"},944043:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/tensorflow-crash-course_03-af6f93cdbfe477f7a40a1244573ea7dd.png"}}]);