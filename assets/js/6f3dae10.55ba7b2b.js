"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[78766],{3905:(t,n,e)=>{e.d(n,{Zo:()=>d,kt:()=>g});var a=e(67294);function r(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function l(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,a)}return e}function i(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?l(Object(e),!0).forEach((function(n){r(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function p(t,n){if(null==t)return{};var e,a,r=function(t,n){if(null==t)return{};var e,a,r={},l=Object.keys(t);for(a=0;a<l.length;a++)e=l[a],n.indexOf(e)>=0||(r[e]=t[e]);return r}(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)e=l[a],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(r[e]=t[e])}return r}var s=a.createContext({}),o=function(t){var n=a.useContext(s),e=n;return t&&(e="function"==typeof t?t(n):i(i({},n),t)),e},d=function(t){var n=o(t.components);return a.createElement(s.Provider,{value:n},t.children)},m={inlineCode:"code",wrapper:function(t){var n=t.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(t,n){var e=t.components,r=t.mdxType,l=t.originalType,s=t.parentName,d=p(t,["components","mdxType","originalType","parentName"]),u=o(e),g=r,c=u["".concat(s,".").concat(g)]||u[g]||m[g]||l;return e?a.createElement(c,i(i({ref:n},d),{},{components:e})):a.createElement(c,i({ref:n},d))}));function g(t,n){var e=arguments,r=n&&n.mdxType;if("string"==typeof t||r){var l=e.length,i=new Array(l);i[0]=u;var p={};for(var s in n)hasOwnProperty.call(n,s)&&(p[s]=n[s]);p.originalType=t,p.mdxType="string"==typeof t?t:r,i[1]=p;for(var o=2;o<l;o++)i[o]=e[o];return a.createElement.apply(null,i)}return a.createElement.apply(null,e)}u.displayName="MDXCreateElement"},50644:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>l,metadata:()=>p,toc:()=>o});var a=e(87462),r=(e(67294),e(3905));const l={sidebar_position:4360,slug:"2023-07-02",title:"SQL in Data Science - Machine Learning",authors:"mpolinowski",tags:["Python","Machine Learning","Cheating"],description:"Cheat Sheet using Psycopg2 to interact with PostgreSQL Databases"},i=void 0,p={unversionedId:"IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/index",id:"IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/index",title:"SQL in Data Science - Machine Learning",description:"Cheat Sheet using Psycopg2 to interact with PostgreSQL Databases",source:"@site/docs/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/index.md",sourceDirName:"IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml",slug:"/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/2023-07-02",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/2023-07-02",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/index.md",tags:[{label:"Python",permalink:"/docs/tags/python"},{label:"Machine Learning",permalink:"/docs/tags/machine-learning"},{label:"Cheating",permalink:"/docs/tags/cheating"}],version:"current",sidebarPosition:4360,frontMatter:{sidebar_position:4360,slug:"2023-07-02",title:"SQL in Data Science - Machine Learning",authors:"mpolinowski",tags:["Python","Machine Learning","Cheating"],description:"Cheat Sheet using Psycopg2 to interact with PostgreSQL Databases"},sidebar:"tutorialSidebar",previous:{title:"Machine Learning",permalink:"/docs/category/machine-learning"},next:{title:"SQL in Data Science - Slightly more Advanced Queries",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-06-30-sql-in-data-science-advanced/2023-06-30"}},s={},o=[{value:"Database Installation with Docker Compose",id:"database-installation-with-docker-compose",level:2},{value:"Dataset",id:"dataset",level:2},{value:"Linear Regression",id:"linear-regression",level:2},{value:"K-Nearest Neighbours",id:"k-nearest-neighbours",level:2},{value:"K-means Clustering",id:"k-means-clustering",level:2},{value:"Dataset II",id:"dataset-ii",level:2},{value:"Naive Bayes Classification",id:"naive-bayes-classification",level:2}],d={toc:o};function m(t){let{components:n,...l}=t;return(0,r.kt)("wrapper",(0,a.Z)({},d,l,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Guangzhou, China",src:e(69788).Z,width:"1500",height:"581"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#sql-in-data-science"},"SQL in Data Science"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#database-installation-with-docker-compose"},"Database Installation with Docker Compose")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#dataset"},"Dataset")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#linear-regression"},"Linear Regression")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#k-nearest-neighbours"},"K-Nearest Neighbours")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#k-means-clustering"},"K-means Clustering")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#dataset-ii"},"Dataset II")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#naive-bayes-classification"},"Naive Bayes Classification"))))),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/mpolinowski/sql-for-data-science/tree/master/02_machine_learning"},"Github Repository")),(0,r.kt)("h1",{id:"sql-in-data-science"},"SQL in Data Science"),(0,r.kt)("p",null,"PostgreSQL lets you build queries which run a variety of ",(0,r.kt)("a",{parentName:"p",href:"https://www.postgresql.org/docs/13/functions-aggregate.html"},"machine learning algorithms")," against your data."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/docs/IoT-and-Machine-Learning/ML/2023-06-27-sql-in-data-science-basics/2023-06-27"},"SQL in Data Science - The Basics using Python")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/docs/IoT-and-Machine-Learning/ML/2023-06-30-sql-in-data-science-advanced/2023-06-30"},"SQL in Data Science - Slightly more Advanced Queries")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/docs/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/2023-07-02"},"SQL in Data Science - Machine Learning"))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.freecodecamp.org/news/machine-learning-directly-in-sql/"},"Source: Machine Learning Directly in SQL \u2013 How to Use ML in Databases"))),(0,r.kt)("h2",{id:"database-installation-with-docker-compose"},"Database Installation with Docker Compose"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir /opt/pgdata\nsudo chown myuser:myuser /opt/pgdata\nsudo chmod 777 /opt/pgdata\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker pull postgres:alpine\n")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"docker-compose.yml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"# Use postgres/example user/password credentials\nversion: '3'\n\nservices:\n\n  db:\n    image: postgres:alpine\n    restart: unless-stopped\n    environment:\n      POSTGRES_USER: postgres\n      POSTGRES_PASSWORD: password\n      POSTGRES_DB: testing\n      PGDATA: /var/lib/postgresql/data/pgdata\n    volumes:\n      - /opt/pgdata:/var/lib/postgresql/data\n    ports:\n      - 5432:5432\n\n  adminer:\n    image: adminer\n    restart: unless-stopped\n    ports:\n      - 8080:8080 \n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose up\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"import psycopg2\nfrom config import config\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n")),(0,r.kt)("h2",{id:"dataset"},"Dataset"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"!wget https://gist.github.com/Thanatoz-1/9e7fdfb8189f0cdf5d73a494e4a6392a/raw/aaecbd14aeaa468cd749528f291aa8a30c2ea09e/iris_dataset.csv\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"data_iris = pd.read_csv ('iris_dataset.csv')   \ndf_iris = pd.DataFrame(data_iris)\ndf_iris.rename(columns={\n    'sepal length (cm)': 'sepal_length',\n    'sepal width (cm)': 'sepal_width',\n    'petal length (cm)': 'petal_length',\n    'petal width (cm)': 'petal_width',\n}, inplace=True)\ndf_iris.head(5)\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"sepal_length"),(0,r.kt)("th",{parentName:"tr",align:null},"sepal_width"),(0,r.kt)("th",{parentName:"tr",align:null},"petal_length"),(0,r.kt)("th",{parentName:"tr",align:null},"petal_width"),(0,r.kt)("th",{parentName:"tr",align:null},"target"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"0"),(0,r.kt)("td",{parentName:"tr",align:null},"5.1"),(0,r.kt)("td",{parentName:"tr",align:null},"3.5"),(0,r.kt)("td",{parentName:"tr",align:null},"1.4"),(0,r.kt)("td",{parentName:"tr",align:null},"0.2"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"4.9"),(0,r.kt)("td",{parentName:"tr",align:null},"3.0"),(0,r.kt)("td",{parentName:"tr",align:null},"1.4"),(0,r.kt)("td",{parentName:"tr",align:null},"0.2"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"4.7"),(0,r.kt)("td",{parentName:"tr",align:null},"3.2"),(0,r.kt)("td",{parentName:"tr",align:null},"1.3"),(0,r.kt)("td",{parentName:"tr",align:null},"0.2"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"3"),(0,r.kt)("td",{parentName:"tr",align:null},"4.6"),(0,r.kt)("td",{parentName:"tr",align:null},"3.1"),(0,r.kt)("td",{parentName:"tr",align:null},"1.5"),(0,r.kt)("td",{parentName:"tr",align:null},"0.2"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4"),(0,r.kt)("td",{parentName:"tr",align:null},"5.0"),(0,r.kt)("td",{parentName:"tr",align:null},"3.6"),(0,r.kt)("td",{parentName:"tr",align:null},"1.4"),(0,r.kt)("td",{parentName:"tr",align:null},"0.2"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"def create_table():\n    conn = None\n    try:\n        # read database configuration\n        params = config()\n        # connect to the PostgreSQL database\n        conn = psycopg2.connect(**params)\n        # create a new cursor\n        cursor = conn.cursor()\n        # create the table\n        cursor.execute('''\n        CREATE TABLE iris (\n            index SMALLINT primary key,\n            sepal_length FLOAT,\n            sepal_width FLOAT,\n            petal_length FLOAT,\n            petal_width FLOAT,\n            target VARCHAR\n            )\n               ''')\n        conn.commit()\n        # Close communication with the PostgreSQL database\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"def add_data():\n    conn = None\n    try:\n        # read database configuration\n        params = config()\n        # connect to the PostgreSQL database\n        conn = psycopg2.connect(**params)\n        # create a new cursor\n        cursor = conn.cursor()\n        # insert data\n        for row in df_iris.itertuples():\n            cursor.execute('''\n                INSERT INTO iris (\n                    index, sepal_length, sepal_width, petal_length, petal_width, target\n                ) VALUES (\n                    %s, %s, %s, %s, %s, %s\n                    )''',\n                (\n                    row.Index,\n                    row.sepal_length,\n                    row.sepal_width,\n                    row.petal_length,\n                    row.petal_width,\n                    row.target\n                )\n            )\n        # Commit the changes to the database\n        conn.commit()\n        # Close communication with the PostgreSQL database\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"create_table()\nadd_data()\n")),(0,r.kt)("h2",{id:"linear-regression"},"Linear Regression"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'query = f"""\nWITH regression AS\n  (SELECT \n      regr_slope(petal_width, petal_length) AS gradient,\n      regr_intercept(petal_width, petal_length) AS intercept\n   FROM\n      iris\n   WHERE\n      petal_width IS NOT NULL\n   )\n\nSELECT\n   petal_length,\n   (petal_length * gradient) + intercept AS prediction\nFROM\n   iris\nCROSS JOIN\n   regression\nWHERE\n   petal_width IS NOT NULL ;\n"""\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"def linear_regression(query):\n    conn = None\n    try:\n        params = config()\n        conn = psycopg2.connect(**params)\n        cursor = conn.cursor()\n        query = query\n        cursor.execute(query)\n        results = cursor.fetchall()\n\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n    finally:\n        if conn is not None:\n            return(results)\n            conn.close()\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"results = linear_regression(query=query)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"df_pred = pd.DataFrame(results, columns=['petal_length', 'petal_width_pred'])\ndf_pred.head()\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"petal_length"),(0,r.kt)("th",{parentName:"tr",align:null},"petal_width_pred"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"0"),(0,r.kt)("td",{parentName:"tr",align:null},"1.4"),(0,r.kt)("td",{parentName:"tr",align:null},"0.216473")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"1.4"),(0,r.kt)("td",{parentName:"tr",align:null},"0.216473")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"1.3"),(0,r.kt)("td",{parentName:"tr",align:null},"0.174831")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"3"),(0,r.kt)("td",{parentName:"tr",align:null},"1.5"),(0,r.kt)("td",{parentName:"tr",align:null},"0.258115")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4"),(0,r.kt)("td",{parentName:"tr",align:null},"1.4"),(0,r.kt)("td",{parentName:"tr",align:null},"0.216473")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"fig = plt.figure(figsize=(10,5))\nax1 = fig.add_subplot(111)\n\nax1.scatter(data=df_pred, x='petal_length', y='petal_width_pred', s=10, c='b', marker=\"s\", label='prediction')\nax1.scatter(data=df_iris, x='petal_length', y='petal_width', s=10, c='r', marker=\"o\", label='true')\nplt.legend(loc='upper left')\nplt.xlabel('Iris Petal Length')\nplt.ylabel('Iris Petal Width')\n\nplt.savefig('assets/sql-for-data-science_01.webp', bbox_inches='tight')\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"SQL in Data Science",src:e(3490).Z,width:"846",height:"448"})),(0,r.kt)("h2",{id:"k-nearest-neighbours"},"K-Nearest Neighbours"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"query = f'''\n-- CTE to get labelled training data\nWITH training AS\n  (SELECT\n      index,\n      POINT(sepal_length, petal_length) as xy,\n      target\n  FROM\n      iris\n  WHERE\n      target IS NOT NULL\n  ),\n\n-- CTE to get the unlabelled points\ntest AS\n  (SELECT\n      index,\n      POINT(sepal_length, petal_length) as xy,\n      target\n  FROM\n      iris\n  WHERE\n      target IS NOT NULL\n  ),\n\n-- calculate distances between unlabelled & labelled points\ndistances AS\n  (SELECT\n      test.index,\n      training.target,\n      test.xy <-> training.xy AS dist,\n      ROW_NUMBER() OVER (\n         PARTITION BY test.index\n         ORDER BY test.xy <-> training.xy \n         ) AS row_no\n  FROM\n      test\n  CROSS JOIN training\n  ORDER BY 1, 4 ASC\n  ),\n\n-- count the 'votes' per label for each unlabelled point\nvotes AS\n  (SELECT\n      index,\n      target,\n      count(*) AS votes\n  FROM distances\n  WHERE row_no <= 5\n  GROUP BY 1,2\n  ORDER BY 1)\n\n-- query for the label with the most votes\nSELECT\n  v.index,\n  v.target\nFROM\n  votes v\nJOIN\n  (SELECT\n      index,\n      max(votes) AS max_votes\n  FROM\n      votes\n  GROUP BY 1\n  ) mv \nON v.index = mv.index\nAND v.votes = mv.max_votes\nORDER BY 1 ASC ;\n'''\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"def k_nearest_neighbours(query):\n    conn = None\n    try:\n        params = config()\n        conn = psycopg2.connect(**params)\n        cursor = conn.cursor()\n        query = query\n        cursor.execute(query)\n        results = cursor.fetchall()\n\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n    finally:\n        if conn is not None:\n            return(results)\n            conn.close()\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"# run training with k=5\nresults = k_nearest_neighbours(query=query)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"df_pred = pd.DataFrame(results, columns=['index', 'target_pred'])\ndf_pred.head()\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"index"),(0,r.kt)("th",{parentName:"tr",align:null},"target_pred"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"0"),(0,r.kt)("td",{parentName:"tr",align:null},"0"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"3"),(0,r.kt)("td",{parentName:"tr",align:null},"3"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4"),(0,r.kt)("td",{parentName:"tr",align:null},"4"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"df_iris['target_pred'] = df_pred['target_pred']\ndf_iris.head()\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"sepal_length"),(0,r.kt)("th",{parentName:"tr",align:null},"sepal_width"),(0,r.kt)("th",{parentName:"tr",align:null},"petal_length"),(0,r.kt)("th",{parentName:"tr",align:null},"petal_width"),(0,r.kt)("th",{parentName:"tr",align:null},"target"),(0,r.kt)("th",{parentName:"tr",align:null},"target_pred"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"0"),(0,r.kt)("td",{parentName:"tr",align:null},"5.1"),(0,r.kt)("td",{parentName:"tr",align:null},"3.5"),(0,r.kt)("td",{parentName:"tr",align:null},"1.4"),(0,r.kt)("td",{parentName:"tr",align:null},"0.2"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"4.9"),(0,r.kt)("td",{parentName:"tr",align:null},"3.0"),(0,r.kt)("td",{parentName:"tr",align:null},"1.4"),(0,r.kt)("td",{parentName:"tr",align:null},"0.2"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"4.7"),(0,r.kt)("td",{parentName:"tr",align:null},"3.2"),(0,r.kt)("td",{parentName:"tr",align:null},"1.3"),(0,r.kt)("td",{parentName:"tr",align:null},"0.2"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"3"),(0,r.kt)("td",{parentName:"tr",align:null},"4.6"),(0,r.kt)("td",{parentName:"tr",align:null},"3.1"),(0,r.kt)("td",{parentName:"tr",align:null},"1.5"),(0,r.kt)("td",{parentName:"tr",align:null},"0.2"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4"),(0,r.kt)("td",{parentName:"tr",align:null},"5.0"),(0,r.kt)("td",{parentName:"tr",align:null},"3.6"),(0,r.kt)("td",{parentName:"tr",align:null},"1.4"),(0,r.kt)("td",{parentName:"tr",align:null},"0.2"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa"),(0,r.kt)("td",{parentName:"tr",align:null},"Iris-setosa")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"fig, axes = plt.subplots(1, 2, figsize=(12,5))\n\nsns.scatterplot(\n    x='sepal_length',\n    y='petal_length',\n    data=df_iris,\n    s=40,\n    alpha=0.6,\n    hue='target_pred',\n    palette='nipy_spectral',\n    ax=axes[0]\n)\n\nsns.scatterplot(\n    x='sepal_length',\n    y='petal_length',\n    data=df_iris,\n    s=40,\n    alpha=0.6,\n    hue='target',\n    palette='nipy_spectral',\n    ax=axes[1]\n)\n\nplt.savefig('assets/sql-for-data-science_02.webp', bbox_inches='tight')\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"SQL in Data Science",src:e(94057).Z,width:"1000",height:"457"})),(0,r.kt)("h2",{id:"k-means-clustering"},"K-means Clustering"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"query = f'''\nWITH points AS\n   (SELECT\n       index,\n       POINT(sepal_length, petal_length) AS xy\n    FROM\n       iris\n    ),\n\ninitial AS\n   (SELECT \n       RANK() OVER (\n          ORDER BY random() \n       ) AS cluster,\n       xy\n    FROM points\n    -- set k=3 since we know there are 3 classes\n    LIMIT 3\n    ),\n\niteration AS\n   (WITH RECURSIVE kmeans(iter, index, cluster, avg_point) AS (\n       SELECT\n          1,\n          NULL::INTEGER,\n          *\n        FROM \n           initial\n        UNION ALL\n        SELECT\n           iter + 1,\n           index,\n           cluster,\n           midpoint\n        FROM (\n           SELECT DISTINCT ON(iter, index)\n              *\n           FROM (\n              SELECT\n                 iter,\n                 cluster,\n                 p.index, \n                 p.xy <-> k.avg_point AS distance,\n                 @@ LSEG(p.xy, k.avg_point) AS midpoint,\n                 p.xy,\n                 k.avg_point\n               FROM points p\n               CROSS JOIN kmeans k\n               ) d\n            ORDER BY 1, 3, 4\n            ) r\n       WHERE iter < 1000\n   )\n   SELECT\n      *\n   FROM\n      kmeans\n   )\n\nSELECT\n   k.*,\n   cluster\nFROM\n   iteration i\nJOIN\n   iris k\nUSING(index)\nWHERE\n   iter = 1000\nORDER BY 4,1 ASC ;\n'''\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"def k_means(query):\n    conn = None\n    try:\n        params = config()\n        conn = psycopg2.connect(**params)\n        cursor = conn.cursor()\n        query = query\n        cursor.execute(query)\n        results = cursor.fetchall()\n\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n    finally:\n        if conn is not None:\n            return(results)\n            conn.close()\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"# run training with k=3 / max_iter=1000\nresults = k_nearest_neighbours(query=query)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"df_pred = pd.DataFrame(results, columns=['index', 'sepal_length', 'sepal_width', 'petal_length', 'petal_width', 'target', 'target_pred'])\ndf_pred.head()\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"fig, axes = plt.subplots(1, 2, figsize=(12,5))\n\nsns.scatterplot(\n    x='sepal_length',\n    y='petal_length',\n    data=df_pred,\n    s=40,\n    alpha=0.6,\n    hue='target_pred',\n    palette='nipy_spectral',\n    ax=axes[0]\n)\n\nsns.scatterplot(\n    x='sepal_length',\n    y='petal_length',\n    data=df_pred,\n    s=40,\n    alpha=0.6,\n    hue='target',\n    palette='nipy_spectral',\n    ax=axes[1]\n)\n\nplt.savefig('assets/sql-for-data-science_03.webp', bbox_inches='tight')\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"SQL in Data Science",src:e(94885).Z,width:"1000",height:"457"})),(0,r.kt)("h2",{id:"dataset-ii"},"Dataset II"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"!wget https://github.com/mohitgupta-omg/Kaggle-SMS-Spam-Collection-Dataset-/raw/master/spam.csv\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"data_spam = pd.read_csv ('spam_dataset.csv')   \ndf_spam = pd.DataFrame(data_spam)\ndf_spam = df_spam.reset_index()\ndf_spam.head(5)\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"index"),(0,r.kt)("th",{parentName:"tr",align:null},"cat"),(0,r.kt)("th",{parentName:"tr",align:null},"sms"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"0"),(0,r.kt)("td",{parentName:"tr",align:null},"ham"),(0,r.kt)("td",{parentName:"tr",align:null},"Go until jurong point crazy.. Available only i...")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"ham"),(0,r.kt)("td",{parentName:"tr",align:null},"Ok lar... Joking wif u oni...")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"spam"),(0,r.kt)("td",{parentName:"tr",align:null},"Free entry in 2 a wkly comp to win FA Cup fina...")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"3"),(0,r.kt)("td",{parentName:"tr",align:null},"ham"),(0,r.kt)("td",{parentName:"tr",align:null},"U dun say so early hor... U c already then say...")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4"),(0,r.kt)("td",{parentName:"tr",align:null},"ham"),(0,r.kt)("td",{parentName:"tr",align:null},"Nah I don't think he goes to usf he lives arou...")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"def create_table():\n    conn = None\n    try:\n        # read database configuration\n        params = config()\n        # connect to the PostgreSQL database\n        conn = psycopg2.connect(**params)\n        # create a new cursor\n        cursor = conn.cursor()\n        # create the table\n        cursor.execute('''\n        CREATE TABLE spam (\n            index SMALLINT primary key,\n            cat VARCHAR,\n            sms VARCHAR\n            )\n               ''')\n        conn.commit()\n        # Close communication with the PostgreSQL database\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"def add_data():\n    conn = None\n    try:\n        # read database configuration\n        params = config()\n        # connect to the PostgreSQL database\n        conn = psycopg2.connect(**params)\n        # create a new cursor\n        cursor = conn.cursor()\n        # insert data\n        for row in df_spam.itertuples():\n            cursor.execute('''\n                INSERT INTO spam (\n                    index, cat, sms\n                ) VALUES (\n                    %s, %s, %s\n                    )''',\n                (\n                    row.index,\n                    row.cat,\n                    row.sms\n                )\n            )\n        # Commit the changes to the database\n        conn.commit()\n        # Close communication with the PostgreSQL database\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"create_table()\nadd_data()\n")),(0,r.kt)("h2",{id:"naive-bayes-classification"},"Naive Bayes Classification"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"query = f'''\n-- CTE to create one row per word\nWITH staging AS\n  (SELECT \n      REGEXP_SPLIT_TO_TABLE(\n         LOWER(sms), '[^a-z]+') AS word,\n      cat\n   FROM\n      spam\n   WHERE\n      cat IS NOT NULL\n  ),\n\n-- testing data\ntest AS\n  (SELECT\n      index,\n      sms\n   FROM\n      spam\n   WHERE\n      cat is NOT NULL\n  ),\n          \n-- one row per word + cat\ncartesian AS\n  (SELECT\n      *\n   FROM\n     (SELECT\n         DISTINCT word\n      FROM\n         staging) w\n      CROSS JOIN\n     (SELECT\n         DISTINCT cat\n      FROM\n         staging) c\n      WHERE\n         length(word) > 0\n   ),\n\n-- CTE of smoothed frequencies of each word by cat\nfrequencies AS\n  (SELECT\n      c.word,\n      c.cat,\n      -- numerator plus one\n      (SELECT\n          count(*)+1\n       FROM\n          staging s\n       WHERE\n          s.word = c.word\n       AND\n          s.cat = c.cat) /\n      -- denominator plus two\n      (SELECT\n          count(*)+2\n       FROM\n          staging s1\n       WHERE\n          s1.cat = c.cat) ::DECIMAL AS freq\n   FROM\n      cartesian c\n   ),\n\n-- for each row in testing, get the probabilities   \nprobabilities AS\n  (SELECT\n      t.index,\n      f.cat,\n      SUM(LN(f.freq)) AS probability\n   FROM\n     (SELECT\n         index,\n         REGEXP_SPLIT_TO_TABLE(\n            LOWER(sms), '[^a-z]+') AS word\n      FROM\n         test) t\n   JOIN\n     (SELECT\n         word,\n         cat,\n         freq\n      FROM\n         frequencies) f \n   ON t.word = f.word\n   GROUP BY 1, 2\n  )\n\n-- keep only the highest estimate            \nSELECT\n   sms,\n   probabilities.cat\nFROM\n   probabilities\nJOIN\n  (SELECT\n      index,\n      max(probability) AS max_probability\n   FROM\n      probabilities\n   GROUP BY 1) p\nON probabilities.index = p.index\nAND probabilities.probability = p.max_probability\nJOIN\n   test\nON probabilities.index = test.index\nORDER BY 1 ;\n'''\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"def naive_bayes(query):\n    conn = None\n    try:\n        params = config()\n        conn = psycopg2.connect(**params)\n        cursor = conn.cursor()\n        query = query\n        cursor.execute(query)\n        results = cursor.fetchall()\n\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n    finally:\n        if conn is not None:\n            return(results)\n            conn.close()\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"# buckle up....this will take a while\nresults = naive_bayes(query=query)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"df_pred = pd.DataFrame(results, columns=['message', 'cat_pred'])\ndf_pred[df_pred['cat_pred'] == 'ham'].head(25)\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"message"),(0,r.kt)("th",{parentName:"tr",align:null},"cat_pred"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"0"),(0,r.kt)("td",{parentName:"tr",align:null},"all write or wat.."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"bot notes oredi... Cos i juz rem i got..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"called dad oredi..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"3"),(0,r.kt)("td",{parentName:"tr",align:null},"collecting ur laptop then going to configu..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4"),(0,r.kt)("td",{parentName:"tr",align:null},"come lt 25 n pass to me lar"),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"5"),(0,r.kt)("td",{parentName:"tr",align:null},"comin to fetch us oredi..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"6"),(0,r.kt)("td",{parentName:"tr",align:null},"dun need to pick ur gf?"),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"7"),(0,r.kt)("td",{parentName:"tr",align:null},"dun wan to watch infernal affair?"),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"8"),(0,r.kt)("td",{parentName:"tr",align:null},"eatin later but i'm eatin wif my frens now..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"9"),(0,r.kt)("td",{parentName:"tr",align:null},"give me some time to walk there."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"10"),(0,r.kt)("td",{parentName:"tr",align:null},"go home liao? Ask dad to pick me up at 6..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"11"),(0,r.kt)("td",{parentName:"tr",align:null},"got wat to buy tell us then _ no need to..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"12"),(0,r.kt)("td",{parentName:"tr",align:null},"log off 4 wat. It's sdryb8i"),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"13"),(0,r.kt)("td",{parentName:"tr",align:null},"mean it's confirmed... I tot they juz say ..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"14"),(0,r.kt)("td",{parentName:"tr",align:null},"neva tell me how i noe... I'm not at home ..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"15"),(0,r.kt)("td",{parentName:"tr",align:null},"no home work to do meh..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"16"),(0,r.kt)("td",{parentName:"tr",align:null},"only send me the contents page..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"17"),(0,r.kt)("td",{parentName:"tr",align:null},"predict wat time _'ll finish buying?"),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"18"),(0,r.kt)("td",{parentName:"tr",align:null},"ready then call me..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"19"),(0,r.kt)("td",{parentName:"tr",align:null},"say until like dat i dun buy ericsson oso ..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"20"),(0,r.kt)("td",{parentName:"tr",align:null},"still attending da talks?"),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"21"),(0,r.kt)("td",{parentName:"tr",align:null},"still got lessons? in sch?"),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"23"),(0,r.kt)("td",{parentName:"tr",align:null},"thk of wat to eat tonight."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"24"),(0,r.kt)("td",{parentName:"tr",align:null},"v ma fan..."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"25"),(0,r.kt)("td",{parentName:"tr",align:null},"wait 4 me in sch i finish ard 5.."),(0,r.kt)("td",{parentName:"tr",align:null},"ham")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"df_pred[df_pred['cat_pred'] == 'spam'].head(25)\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"message"),(0,r.kt)("th",{parentName:"tr",align:null},"cat_pred"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"22"),(0,r.kt)("td",{parentName:"tr",align:null},"takin linear algebra today?"),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"34"),(0,r.kt)("td",{parentName:"tr",align:null},"and picking them up from various points"),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"53"),(0,r.kt)("td",{parentName:"tr",align:null},"(Bank of Granite issues Strong-Buy) EXPLOSIVE ..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"60"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"td"}," FREE")," POLYPHONIC RINGTONE Text SUPER to 8713..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"68"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"FREE MESSAGE"),"Thanks for using the Auction S..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"70"),(0,r.kt)("td",{parentName:"tr",align:null},"+123 Congratulations - in this week's competit..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"71"),(0,r.kt)("td",{parentName:"tr",align:null},"+123 Congratulations - in this week's competit..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"72"),(0,r.kt)("td",{parentName:"tr",align:null},"+449071512431 URGENT! This is the 2nd attempt ..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"73"),(0,r.kt)("td",{parentName:"tr",align:null},"-PLS STOP bootydelious (32/F) is inviting you ..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"77"),(0,r.kt)("td",{parentName:"tr",align:null},"07732584351 - Rodger Burns - MSG = We tried to..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"78"),(0,r.kt)("td",{parentName:"tr",align:null},"08714712388 between 10am-7pm Cost 10p"),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"79"),(0,r.kt)("td",{parentName:"tr",align:null},"09066362231 URGENT! Your mobile No 07xxxxxxxxx..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"80"),(0,r.kt)("td",{parentName:"tr",align:null},"0A$NETWORKS allow companies to bill for SMS so..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"91"),(0,r.kt)("td",{parentName:"tr",align:null},"100 dating service cal;l 09064012103 box334sk38ch"),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"92"),(0,r.kt)("td",{parentName:"tr",align:null},"1000's flirting NOW! Txt GIRL or BLOKE & ur NA..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"93"),(0,r.kt)("td",{parentName:"tr",align:null},"1000's of girls many local 2 u who r virgins 2..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"94"),(0,r.kt)("td",{parentName:"tr",align:null},"18 days to Euro2004 kickoff! U will be kept in..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"95"),(0,r.kt)("td",{parentName:"tr",align:null},"18 days to Euro2004 kickoff! U will be kept in..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"96"),(0,r.kt)("td",{parentName:"tr",align:null},"1Apple/Day=No Doctor. 1Tulsi Leaf/Day=No Cance..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"97"),(0,r.kt)("td",{parentName:"tr",align:null},"1st wk FREE! Gr8 tones str8 2 u each wk. Txt N..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"101"),(0,r.kt)("td",{parentName:"tr",align:null},"2/2 146tf150p"),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"102"),(0,r.kt)("td",{parentName:"tr",align:null},"22 days to kick off! For Euro2004 U will be ke..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"103"),(0,r.kt)("td",{parentName:"tr",align:null},"25p 4 alfie Moon's Children in need song on ur..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"104"),(0,r.kt)("td",{parentName:"tr",align:null},"26th OF JULY"),(0,r.kt)("td",{parentName:"tr",align:null},"spam")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"107"),(0,r.kt)("td",{parentName:"tr",align:null},"2p per min to call Germany 08448350055 from yo..."),(0,r.kt)("td",{parentName:"tr",align:null},"spam")))))}m.isMDXComponent=!0},69788:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-5a33ed1aeac871d5b7a7594cc7d702c8.jpg"},3490:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"assets/images/sql-for-data-science_01-cf19056d8048510033c990eeaae5ce3d.webp"},94057:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"assets/images/sql-for-data-science_02-3a2f5c3ae89b96e49b2bbab32cfc95ae.webp"},94885:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"assets/images/sql-for-data-science_03-b1ecbf1733f45ff93a683ae766f57a0d.webp"}}]);