"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[27112],{211373:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var t=n(474848),i=n(28453);const r={sidebar_position:9e3,slug:"2021-04-29",title:"Setting up Ansible Tower (AWX)",authors:"mpolinowski",tags:["LINUX"]},o=void 0,a={id:"DevOps/Ansible/2021-04-29-ansible-tower-setup/index",title:"Setting up Ansible Tower (AWX)",description:"Guangzhou, China",source:"@site/docs/DevOps/Ansible/2021-04-29-ansible-tower-setup/index.md",sourceDirName:"DevOps/Ansible/2021-04-29-ansible-tower-setup",slug:"/DevOps/Ansible/2021-04-29-ansible-tower-setup/2021-04-29",permalink:"/docs/DevOps/Ansible/2021-04-29-ansible-tower-setup/2021-04-29",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Ansible/2021-04-29-ansible-tower-setup/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"}],version:"current",sidebarPosition:9e3,frontMatter:{sidebar_position:9e3,slug:"2021-04-29",title:"Setting up Ansible Tower (AWX)",authors:"mpolinowski",tags:["LINUX"]},sidebar:"tutorialSidebar",previous:{title:"Slack Notifications for Ansible Tower (AWX)",permalink:"/docs/DevOps/Ansible/2021-04-30-ansible-tower-slack-notifications/2021-04-30"},next:{title:"Installing Ansible Tower (AWX in Docker) on RHEL8",permalink:"/docs/DevOps/Ansible/2021-04-28-ansible-tower-rhel/2021-04-28"}},l={},d=[{value:"Creating a GitHub/GitLab SCM Project",id:"creating-a-githubgitlab-scm-project",level:2},{value:"Gitlab Credentials",id:"gitlab-credentials",level:3},{value:"Adding the Project",id:"adding-the-project",level:3},{value:"Adding Hosts",id:"adding-hosts",level:2},{value:"Running our Playbook",id:"running-our-playbook",level:2}];function c(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Guangzhou, China",src:n(694565).A+"",width:"1500",height:"653"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#creating-a-githubgitlab-scm-project",children:"Creating a GitHub/GitLab SCM Project"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#gitlab-credentials",children:"Gitlab Credentials"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#adding-the-project",children:"Adding the Project"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#adding-hosts",children:"Adding Hosts"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#running-our-playbook",children:"Running our Playbook"})}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"creating-a-githubgitlab-scm-project",children:"Creating a GitHub/GitLab SCM Project"}),"\n",(0,t.jsx)(s.h3,{id:"gitlab-credentials",children:"Gitlab Credentials"}),"\n",(0,t.jsx)(s.p,{children:"Ansible Tower allows us to use a Git repository as the source for our Ansible Playbooks. To be able to use this feature we need to add our Gitlab credentials (if you are using the hosted service by Gitlab or Github please refer to the Ansible docs - this is only for privately hosted Gitlab installations). Start by generating an SSH keypair:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"cd ~/.ssh\r\nssh-keygen -N '' -f awx_ssh_key\n"})}),"\n",(0,t.jsx)(s.p,{children:"Now add your private key to the AWX Source Control Credentials:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"cat awx_ssh_key\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Setting up Ansible Tower (AWX)",src:n(538686).A+"",width:"1338",height:"784"})}),"\n",(0,t.jsx)(s.p,{children:"And the public key has to be added to your Gitlab user account:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"cat awx_ssh_key.pub\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Setting up Ansible Tower (AWX)",src:n(624437).A+"",width:"1066",height:"762"})}),"\n",(0,t.jsx)(s.h3,{id:"adding-the-project",children:"Adding the Project"}),"\n",(0,t.jsx)(s.p,{children:"We can now use these credentials to add a new project - I added a new test repository on Gitlab and will use it as the Source Control URL here:"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Setting up Ansible Tower (AWX)",src:n(447997).A+"",width:"1346",height:"789"})}),"\n",(0,t.jsxs)(s.p,{children:["Save the Project and hit ",(0,t.jsx)(s.strong,{children:"Sync"})," - check under ",(0,t.jsx)(s.strong,{children:"Jobs"})," to see if the run was successful:"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Setting up Ansible Tower (AWX)",src:n(380582).A+"",width:"1365",height:"501"})}),"\n",(0,t.jsx)(s.p,{children:"Now that we know that Ansible Tower has access to our Gitlab repo, we can start by building our Ansible Playbook. Here is an Hello World example:"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Setting up Ansible Tower (AWX)",src:n(149327).A+"",width:"1075",height:"563"})}),"\n",(0,t.jsxs)(s.p,{children:["This will simply try to connect to our server, write a Hello World string into the terminal and return a ",(0,t.jsx)(s.code,{children:"successful"})," if everything worked."]}),"\n",(0,t.jsx)(s.h2,{id:"adding-hosts",children:"Adding Hosts"}),"\n",(0,t.jsxs)(s.p,{children:["To run our playbook we now have to add a host to Ansible Tower. To add a new host to our AWX frontend we need to create an inventory in the ",(0,t.jsx)(s.strong,{children:"Resources/Inventories"})," menu:"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Setting up Ansible Tower (AWX)",src:n(139279).A+"",width:"960",height:"369"})}),"\n",(0,t.jsxs)(s.p,{children:["After saving the inventory, we can add a host (minion server) from the ",(0,t.jsx)(s.strong,{children:"Host"})," tab:"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Setting up Ansible Tower (AWX)",src:n(404020).A+"",width:"1086",height:"546"})}),"\n",(0,t.jsxs)(s.p,{children:["Now we need to switch to the  ",(0,t.jsx)(s.strong,{children:"Resources/Credentials"})," menu and add our server login:"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Setting up Ansible Tower (AWX)",src:n(625149).A+"",width:"960",height:"373"})}),"\n",(0,t.jsx)(s.h2,{id:"running-our-playbook",children:"Running our Playbook"}),"\n",(0,t.jsxs)(s.p,{children:["Now we are finally at the point were we have all the information collected that Ansible Tower needs to work. So let's bring everything together in a ",(0,t.jsx)(s.strong,{children:"Job Template"})," and see if it runs:"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Setting up Ansible Tower (AWX)",src:n(695100).A+"",width:"1081",height:"693"})}),"\n",(0,t.jsxs)(s.p,{children:["Clicking on ",(0,t.jsx)(s.strong,{children:"Launch"})," will run our job template:"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Setting up Ansible Tower (AWX)",src:n(495735).A+"",width:"1064",height:"657"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Success!"})})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},538686:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/Ansible_Tower_Credentials_01-6233b8ef8830002b6f98f9f0ec69b0c4.png"},624437:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/Ansible_Tower_Credentials_02-8d17d488c7aa12daf19c59ca51b066e5.png"},139279:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/Ansible_Tower_Hosts_01-e269a0eba5f6337c671864a17b258bd2.png"},404020:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/Ansible_Tower_Hosts_02-9b0fa9adffafa4dddd9f6ebab97a58af.png"},625149:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/Ansible_Tower_Hosts_03-3e078171b58c32faf5960ca269bc9859.png"},447997:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/Ansible_Tower_Project_01-f66ffd7a56cd89443db896545d246d2a.png"},380582:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/Ansible_Tower_Project_02-d098e302ece3d9b2712abc879e964420.png"},149327:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/Ansible_Tower_Project_03-2d6965ce14f6b58f154e16c6650d0d6e.png"},695100:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/Ansible_Tower_Template_01-4de74e38574ec5907da5f47fcc056e96.png"},495735:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/Ansible_Tower_Template_02-34d56131e586411bc1324748404d1400.png"},694565:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/photo-456tdsfggd_67gfh6dgdf4_d-29089ffddd9803cd1b494634ad2a859c.jpg"},28453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>a});var t=n(296540);const i={},r=t.createContext(i);function o(e){const s=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);