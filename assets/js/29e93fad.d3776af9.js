"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[77131],{996407:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>l,frontMatter:()=>a,metadata:()=>s,toc:()=>h});var o=n(785893),r=n(603905);const a={sidebar_position:9080,slug:"2022-05-03",title:"React Native Context API",authors:"mpolinowski",tags:["Javascript","React","ReactNative"]},i=void 0,s={id:"Development/ReactNative/2022-05-03-react-native-contextapi/index",title:"React Native Context API",description:"Victoria Harbour, Hongkong",source:"@site/docs/Development/ReactNative/2022-05-03-react-native-contextapi/index.md",sourceDirName:"Development/ReactNative/2022-05-03-react-native-contextapi",slug:"/Development/ReactNative/2022-05-03-react-native-contextapi/2022-05-03",permalink:"/docs/Development/ReactNative/2022-05-03-react-native-contextapi/2022-05-03",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Development/ReactNative/2022-05-03-react-native-contextapi/index.md",tags:[{label:"Javascript",permalink:"/docs/tags/javascript"},{label:"React",permalink:"/docs/tags/react"},{label:"ReactNative",permalink:"/docs/tags/react-native"}],version:"current",sidebarPosition:9080,frontMatter:{sidebar_position:9080,slug:"2022-05-03",title:"React Native Context API",authors:"mpolinowski",tags:["Javascript","React","ReactNative"]},sidebar:"tutorialSidebar",previous:{title:"React Native Hooks",permalink:"/docs/Development/ReactNative/2022-05-04-react-native-hooks/2022-05-04"},next:{title:"React Native Navigation",permalink:"/docs/Development/ReactNative/2022-05-02-react-native-navigation/2022-05-02"}},c={},h=[{value:"Setup",id:"setup",level:2},{value:"Theming with Context",id:"theming-with-context",level:2},{value:"Accessing Context",id:"accessing-context",level:3},{value:"Static",id:"static",level:4},{value:"Context Consumer",id:"context-consumer",level:4},{value:"Toggling State",id:"toggling-state",level:2},{value:"Nesting Multiple Contexts",id:"nesting-multiple-contexts",level:2}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.ah)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Victoria Harbour, Hongkong",src:n(944882).Z+"",width:"1500",height:"565"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"#setup",children:"Setup"})}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.a,{href:"#theming-with-context",children:"Theming with Context"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.a,{href:"#accessing-context",children:"Accessing Context"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"#static",children:"Static"})}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"#context-consumer",children:"Context Consumer"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"#toggling-state",children:"Toggling State"})}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"#nesting-multiple-contexts",children:"Nesting Multiple Contexts"})}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{href:"https://github.com/mpolinowski/react-native-contextapi",children:"Github Repository"})}),"\n",(0,o.jsx)(t.h2,{id:"setup",children:"Setup"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",children:"npm install -g expo-cli\nexpo init react-native-contextapi\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Choose the ",(0,o.jsx)(t.strong,{children:"blank"})," template and run the client:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",children:"cd react-native-contextapi\nnpm install styled-components\nnpm start\n"})}),"\n",(0,o.jsxs)(t.p,{children:["I can test code by scanning the QR Code using the ",(0,o.jsx)(t.strong,{children:"Expo Go"})," app under Android or by pressing the ",(0,o.jsx)(t.code,{children:"w"})," key to activate a web preview."]}),"\n",(0,o.jsxs)(t.blockquote,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"error:0308010C:digital envelope routines::unsupported"}),": Newer versions of Node.js use OpenSSLv3 that brought some ",(0,o.jsx)(t.a,{href:"https://wiki.openssl.org/index.php/OpenSSL_3.0#Upgrading_to_OpenSSL_3.0_from_OpenSSL_1.0.2",children:"breaking changes"}),". Can be fixed (",(0,o.jsx)(t.strong,{children:">=Nodejs v17"}),") by adding the following option to the start script inside your ",(0,o.jsx)(t.code,{children:"package.json"})," -> ",(0,o.jsx)(t.code,{children:'"start": "export NODE_OPTIONS=--openssl-legacy-provider && expo start"'})]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"theming-with-context",children:"Theming with Context"}),"\n",(0,o.jsxs)(t.p,{children:["Creating a context to provide a ",(0,o.jsx)(t.strong,{children:"Dark"})," / ",(0,o.jsx)(t.strong,{children:"Light"})," theme to an ReactNative App. Add a folder ",(0,o.jsx)(t.code,{children:"context"})," to the ",(0,o.jsx)(t.code,{children:"src"})," directory of your app and create a file ",(0,o.jsx)(t.code,{children:"ThemeContext.jsx"}),":"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-jsx",children:"import React, {createContext, Component} from 'react'\n\nexport const ThemeContext = createContext()\n\nclass ThemeContextProvider extends Component {\n    state = {\n        isDarkTheme: true,\n        lightTheme: {\n            color: 'purple',\n            backgroundColor: 'snow'\n        },\n        darkTheme: {\n            color: 'plum',\n            backgroundColor: 'purple'\n        }\n    }\n\n    render() {\n        return (\n            <ThemeContext.Provider value={{ ...this.state }}>\n                {this.props.children}\n            </ThemeContext.Provider>\n        )\n    }\n }\n\n\nexport default ThemeContextProvider\n"})}),"\n",(0,o.jsxs)(t.p,{children:["And inside your apps entry point, e.g. ",(0,o.jsx)(t.code,{children:"App.jsx"})," wrap your code inside the theme provider:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-jsx",children:"import ThemeContextProvider from './src/context/ThemeContext'\n\nconst App = () => {\n  return (\n    <RootView>\n      <ThemeContextProvider>\n        <Navbar />\n        <TodoList />\n      </ThemeContextProvider>\n    </RootView>\n  );\n}\n\nexport default App\n"})}),"\n",(0,o.jsx)(t.h3,{id:"accessing-context",children:"Accessing Context"}),"\n",(0,o.jsx)(t.h4,{id:"static",children:"Static"}),"\n",(0,o.jsxs)(t.p,{children:["Now both the apps navigation bar and todo list are children of the context provider. Which means that we have access to the state it is providing by calling ",(0,o.jsx)(t.code,{children:"this.context"})," :"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-jsx",children:"import React from 'react'\n\nimport { TodoBackground, TodoItem } from './_styles'\nimport { ThemeContext } from '../context/ThemeContext'\n\nclass ToDoList extends React.Component {\n    static contextType = ThemeContext\n    render() {\n\n        const { isDarkTheme, darkTheme, lightTheme } = this.context\n        // if isDarkTheme is true return dark state / else light\n        const theme = isDarkTheme ? darkTheme : lightTheme\n\n        return (\n            <TodoBackground style={theme}>\n                <TodoItem>One thing to do</TodoItem>\n                <TodoItem>Another thing to do</TodoItem>\n                <TodoItem>And one more thing</TodoItem>\n            </TodoBackground>\n        )\n    }\n}\n\nexport default ToDoList\n"})}),"\n",(0,o.jsx)(t.h4,{id:"context-consumer",children:"Context Consumer"}),"\n",(0,o.jsx)(t.p,{children:"The disadvantage of the solution above is that you can only use it in class components. But there is another way that will also work in functional components using the context consumer:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-jsx",children:"import React from 'react'\n\nimport { NavBackground, NavHeader, NavTabs, NavTabsHeader } from './_styles'\nimport { ThemeContext } from '../context/ThemeContext'\n\nclass Navbar extends React.Component {\n    render() {\n        \n        return (\n            <ThemeContext.Consumer >\n                {(context) => {\n                    const { isDarkTheme, darkTheme, lightTheme } = context\n                    // if isDarkTheme is true return dark state / else light\n                    const theme = isDarkTheme ? darkTheme : lightTheme\n                    return (\n                        <NavBackground style={theme}>\n                            <NavHeader style={theme}>Company Inc.</NavHeader>\n                            <NavTabs>\n                                <NavTabsHeader>Overview</NavTabsHeader>\n                                <NavTabsHeader>Contact</NavTabsHeader>\n                            </NavTabs>\n                        </NavBackground>\n                    )\n                }}\n            </ThemeContext.Consumer>\n        )\n    }\n }\n\n export default Navbar\n"})}),"\n",(0,o.jsx)(t.h2,{id:"toggling-state",children:"Toggling State"}),"\n",(0,o.jsxs)(t.p,{children:["We now need to add a function that allows the user to toggle the used theme by creating a ",(0,o.jsx)(t.code,{children:"changeTheme"})," function inside our theme context provider and passing it through to all children:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-jsx",children:"import React, {createContext, Component} from 'react'\n\nexport const ThemeContext = createContext()\n\nclass ThemeContextProvider extends Component {\n    state = {\n        isDarkTheme: true,\n        lightTheme: {\n            color: 'purple',\n            backgroundColor: 'snow',\n            text: 'Dark'\n        },\n        darkTheme: {\n            color: 'plum',\n            backgroundColor: 'purple',\n            text: 'Light'\n        }\n    }\n\n    changeTheme = () => {\n        // toggle theme to opposite when called\n        this.setState({isDarkTheme: !this.state.isDarkTheme})\n    }\n\n    render() {\n        return (\n            <ThemeContext.Provider value={{ ...this.state, changeTheme: this.changeTheme }}>\n                {this.props.children}\n            </ThemeContext.Provider>\n        )\n    }\n }\n\n\nexport default ThemeContextProvider\n"})}),"\n",(0,o.jsxs)(t.p,{children:["I also added another variable to the state called ",(0,o.jsx)(t.code,{children:"text"})," that we can call on to add the button label to our theme toggle:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-jsx",children:"import React from 'react'\nimport {Text} from 'react-native'\nimport { NavBackground, NavHeader, NavTabs, NavTabsHeader, ThemeToggle } from './_styles'\nimport { ThemeContext } from '../context/ThemeContext'\n\nclass Navbar extends React.Component {\n    render() {\n        \n        return (\n            <ThemeContext.Consumer >\n                {(context) => {\n                    const { isDarkTheme, darkTheme, lightTheme, changeTheme } = context\n                    // if isDarkTheme is true return dark state / else light\n                    const theme = isDarkTheme ? darkTheme : lightTheme\n                    return (\n                        <NavBackground style={theme}>\n                            <NavHeader style={theme}>Company Inc.</NavHeader>\n                            <NavTabs>\n                                <NavTabsHeader>Overview</NavTabsHeader>\n                                <NavTabsHeader>Contact</NavTabsHeader>\n                                <ThemeToggle onPress={changeTheme}>\n                                    <Text>{theme.text}</Text>\n                                </ThemeToggle>\n                            </NavTabs>\n                        </NavBackground>\n                    )\n                }}\n            </ThemeContext.Consumer>\n        )\n    }\n }\n\n export default Navbar\n"})}),"\n",(0,o.jsx)(t.h2,{id:"nesting-multiple-contexts",children:"Nesting Multiple Contexts"}),"\n",(0,o.jsx)(t.p,{children:"Let's add another context that holds the logged-in state of the user:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-jsx",children:"import React, {createContext, Component} from 'react'\n\nexport const AuthContext = createContext()\n\nclass AuthContextProvider extends Component {\n    state = {\n        isLoggedIn: false\n    }\n\n    changeAuthStatus = () => {\n        this.setState({isLoggedIn: !this.state.isLoggedIn})\n    }\n\n    render() {\n        return (\n            <AuthContext.Provider value={{...this.state, changeAuthStatus: this.changeAuthStatus}}>\n                {this.props.children}\n            </AuthContext.Provider>\n        )\n    }\n}\n\nexport default AuthContextProvider\n"})}),"\n",(0,o.jsx)(t.p,{children:"We want the ToDo List hidden if the logged-in state is false so wrap the list inside the authentication context provider:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-jsx",children:"import React from 'react'\n\nimport { RootView } from './src/components/_styles'\nimport ThemeContextProvider from './src/context/ThemeContext'\nimport AuthContextProvider from './src/context/AuthContext'\nimport Navbar from './src/components/Navbar'\nimport TodoList from './src/components/ToDo'\n\nconst App = () => {\n  return (\n    <RootView>\n      <ThemeContextProvider>\n        <Navbar />\n        <AuthContextProvider>\n          <TodoList />\n        </AuthContextProvider>\n      </ThemeContextProvider>\n    </RootView>\n  );\n}\n\nexport default App\n"})}),"\n",(0,o.jsx)(t.p,{children:"And the ToDo itself now needs to be wrapped inside the consumer:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-jsx",children:"import React from 'react'\nimport {Text} from 'react-native'\n\nimport { TodoBackground, TodoItem, LoginView } from './_styles'\nimport { ThemeContext } from '../context/ThemeContext'\nimport { AuthContext } from '../context/AuthContext'\n\nclass ToDoList extends React.Component {\n    render() {\n        return (\n            <AuthContext.Consumer >\n                {(authContext) => {\n                    return (\n                        <ThemeContext.Consumer >\n                            {(themeContext) => {\n                                const { isLoggedIn, changeAuthStatus }  = authContext\n                                const { isDarkTheme, darkTheme, lightTheme } = themeContext\n                                // if isDarkTheme is true return dark state / else light\n                                const theme = isDarkTheme ? darkTheme : lightTheme\n                                if (isLoggedIn) {\n                                return (\n                                    <TodoBackground style={theme}>\n                                        <TodoItem>One thing to do</TodoItem>\n                                        <TodoItem>Another thing to do</TodoItem>\n                                        <TodoItem>And one more thing</TodoItem>\n                                        <TodoItem onPress={changeAuthStatus}>\n                                            <Text>Logout</Text>\n                                        </TodoItem>\n                                    </TodoBackground>\n                                )}\n                                return (\n                                    <LoginView>\n                                        <TodoItem onPress={changeAuthStatus}>\n                                            <Text>Login</Text>\n                                        </TodoItem>\n                                    </LoginView>\n                                )\n                            }}\n                        </ThemeContext.Consumer>   \n                    )\n                }}\n            </AuthContext.Consumer>\n        )\n    }\n}\n\nexport default ToDoList\n"})})]})}function l(e={}){const{wrapper:t}={...(0,r.ah)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},603905:(e,t,n)=>{n.d(t,{ah:()=>h});var o=n(667294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),h=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},l=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),m=h(n),p=r,x=m["".concat(c,".").concat(p)]||m[p]||d[p]||a;return n?o.createElement(x,i(i({ref:t},l),{},{components:n})):o.createElement(x,i({ref:t},l))}));l.displayName="MDXCreateElement"},944882:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-23d027067cc9016279f834178a642545.jpg"}}]);