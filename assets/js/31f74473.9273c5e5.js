"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[91886],{3905:(t,n,l)=>{l.d(n,{Zo:()=>p,kt:()=>s});var a=l(67294);function e(t,n,l){return n in t?Object.defineProperty(t,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[n]=l,t}function r(t,n){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),l.push.apply(l,a)}return l}function i(t){for(var n=1;n<arguments.length;n++){var l=null!=arguments[n]?arguments[n]:{};n%2?r(Object(l),!0).forEach((function(n){e(t,n,l[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):r(Object(l)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(l,n))}))}return t}function d(t,n){if(null==t)return{};var l,a,e=function(t,n){if(null==t)return{};var l,a,e={},r=Object.keys(t);for(a=0;a<r.length;a++)l=r[a],n.indexOf(l)>=0||(e[l]=t[l]);return e}(t,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)l=r[a],n.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(t,l)&&(e[l]=t[l])}return e}var k=a.createContext({}),m=function(t){var n=a.useContext(k),l=n;return t&&(l="function"==typeof t?t(n):i(i({},n),t)),l},p=function(t){var n=m(t.components);return a.createElement(k.Provider,{value:n},t.children)},u={inlineCode:"code",wrapper:function(t){var n=t.children;return a.createElement(a.Fragment,{},n)}},o=a.forwardRef((function(t,n){var l=t.components,e=t.mdxType,r=t.originalType,k=t.parentName,p=d(t,["components","mdxType","originalType","parentName"]),o=m(l),s=e,g=o["".concat(k,".").concat(s)]||o[s]||u[s]||r;return l?a.createElement(g,i(i({ref:n},p),{},{components:l})):a.createElement(g,i({ref:n},p))}));function s(t,n){var l=arguments,e=n&&n.mdxType;if("string"==typeof t||e){var r=l.length,i=new Array(r);i[0]=o;var d={};for(var k in n)hasOwnProperty.call(n,k)&&(d[k]=n[k]);d.originalType=t,d.mdxType="string"==typeof t?t:e,i[1]=d;for(var m=2;m<r;m++)i[m]=l[m];return a.createElement.apply(null,i)}return a.createElement.apply(null,l)}o.displayName="MDXCreateElement"},91083:(t,n,l)=>{l.r(n),l.d(n,{assets:()=>k,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>d,toc:()=>m});var a=l(87462),e=(l(67294),l(3905));const r={sidebar_position:4100,slug:"2023-09-17",title:"YOLOv8 Nightshift",authors:"mpolinowski",tags:["Python","Machine Learning","PyTorch"],description:"Training an YOLOv8 Object Tracker for Day/Night Cameras"},i=void 0,d={unversionedId:"IoT-and-Machine-Learning/ML/2023-09-17--yolo8-nightshift/index",id:"IoT-and-Machine-Learning/ML/2023-09-17--yolo8-nightshift/index",title:"YOLOv8 Nightshift",description:"Training an YOLOv8 Object Tracker for Day/Night Cameras",source:"@site/docs/IoT-and-Machine-Learning/ML/2023-09-17--yolo8-nightshift/index.md",sourceDirName:"IoT-and-Machine-Learning/ML/2023-09-17--yolo8-nightshift",slug:"/IoT-and-Machine-Learning/ML/2023-09-17--yolo8-nightshift/2023-09-17",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-09-17--yolo8-nightshift/2023-09-17",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2023-09-17--yolo8-nightshift/index.md",tags:[{label:"Python",permalink:"/docs/tags/python"},{label:"Machine Learning",permalink:"/docs/tags/machine-learning"},{label:"PyTorch",permalink:"/docs/tags/py-torch"}],version:"current",sidebarPosition:4100,frontMatter:{sidebar_position:4100,slug:"2023-09-17",title:"YOLOv8 Nightshift",authors:"mpolinowski",tags:["Python","Machine Learning","PyTorch"],description:"Training an YOLOv8 Object Tracker for Day/Night Cameras"},sidebar:"tutorialSidebar",previous:{title:"Computer Vision Annotation Tool (CVAT) Introduction",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-09-19--cvat-computer-vision-annotation-tool/2023-09-19"},next:{title:"YOLOv8 License Plate Detection",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-09-15--yolo8-tracking-and-ocr/2023-09-15"}},k={},m=[{value:"Dataset",id:"dataset",level:2},{value:"Dataset Exploration",id:"dataset-exploration",level:3},{value:"Label Conversion JSON2YOLO",id:"label-conversion-json2yolo",level:3},{value:"Video RGB Test Dataset",id:"video-rgb-test-dataset",level:4},{value:"Video Thermal Test Dataset",id:"video-thermal-test-dataset",level:4},{value:"Images RGB Train Dataset",id:"images-rgb-train-dataset",level:4},{value:"Images Thermal Train Dataset",id:"images-thermal-train-dataset",level:4},{value:"Images RGB Val Dataset",id:"images-rgb-val-dataset",level:4},{value:"Images Thermal Val Dataset",id:"images-thermal-val-dataset",level:4},{value:"Dataset Configuration",id:"dataset-configuration",level:3},{value:"Training the YOLOv8 Model (RGB / IR)",id:"training-the-yolov8-model-rgb--ir",level:2},{value:"YOLOv8 Nano (RGB)",id:"yolov8-nano-rgb",level:3},{value:"Model Training",id:"model-training",level:4},{value:"Model Evaluation",id:"model-evaluation",level:4},{value:"YOLOv8 Small (RGB)",id:"yolov8-small-rgb",level:3},{value:"Model Training",id:"model-training-1",level:4},{value:"Model Evaluation",id:"model-evaluation-1",level:4},{value:"YOLOv8 Nano (IR)",id:"yolov8-nano-ir",level:3},{value:"Model Training",id:"model-training-2",level:4},{value:"Model Evaluation",id:"model-evaluation-2",level:4},{value:"YOLOv8 Small (IR)",id:"yolov8-small-ir",level:3},{value:"Model Training",id:"model-training-3",level:3},{value:"Model Evaluation",id:"model-evaluation-3",level:4},{value:"Training the YOLOv8 Mixed Model (RGB + IR)",id:"training-the-yolov8-mixed-model-rgb--ir",level:2},{value:"YOLOv8 Nano (RGB+IR)",id:"yolov8-nano-rgbir",level:3},{value:"Model Training",id:"model-training-4",level:4},{value:"Model Evaluation",id:"model-evaluation-4",level:4},{value:"YOLOv8 Small (RGB + IR)",id:"yolov8-small-rgb--ir",level:3},{value:"Model Training",id:"model-training-5",level:4},{value:"Model Evaluation",id:"model-evaluation-5",level:4},{value:"Model Evaluation",id:"model-evaluation-6",level:2},{value:"YOLOv8n &amp; RGB Dataset",id:"yolov8n--rgb-dataset",level:3},{value:"YOLOv8s &amp; RGB Dataset",id:"yolov8s--rgb-dataset",level:3},{value:"YOLOv8n &amp; IR Dataset",id:"yolov8n--ir-dataset",level:3},{value:"YOLOv8s &amp; RGB Dataset",id:"yolov8s--rgb-dataset-1",level:3},{value:"YOLOv8n &amp; Combined Dataset",id:"yolov8n--combined-dataset",level:3},{value:"YOLOv8s &amp; Combined Dataset",id:"yolov8s--combined-dataset",level:3},{value:"Combining Results",id:"combining-results",level:3},{value:"Evaluate Bounding Boxes",id:"evaluate-bounding-boxes",level:2},{value:"Show Labels",id:"show-labels",level:3},{value:"Show Predictions",id:"show-predictions",level:3},{value:"Show Labels",id:"show-labels-1",level:3},{value:"Show Predictions",id:"show-predictions-1",level:3},{value:"Show Labels",id:"show-labels-2",level:3},{value:"Show Predictions",id:"show-predictions-2",level:3}],p={toc:m};function u(t){let{components:n,...r}=t;return(0,e.kt)("wrapper",(0,a.Z)({},p,r,{components:n,mdxType:"MDXLayout"}),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Guangzhou, China",src:l(16710).Z,width:"1500",height:"871"})),(0,e.kt)("ul",null,(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8-nightshift"},"YOLOv8 Nightshift"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#dataset"},"Dataset"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#dataset-exploration"},"Dataset Exploration")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#label-conversion-json2yolo"},"Label Conversion JSON2YOLO"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#video-rgb-test-dataset"},"Video RGB Test Dataset")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#video-thermal-test-dataset"},"Video Thermal Test Dataset")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#images-rgb-train-dataset"},"Images RGB Train Dataset")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#images-thermal-train-dataset"},"Images Thermal Train Dataset")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#images-rgb-val-dataset"},"Images RGB Val Dataset")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#images-thermal-val-dataset"},"Images Thermal Val Dataset")))),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#dataset-configuration"},"Dataset Configuration")))),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#training-the-yolov8-model-rgb--ir"},"Training the YOLOv8 Model (RGB / IR)"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8-nano-rgb"},"YOLOv8 Nano (RGB)"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-training"},"Model Training")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-evaluation"},"Model Evaluation")))),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8-small-rgb"},"YOLOv8 Small (RGB)"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-training-1"},"Model Training")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-evaluation-1"},"Model Evaluation")))),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8-nano-ir"},"YOLOv8 Nano (IR)"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-training-2"},"Model Training")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-evaluation-2"},"Model Evaluation")))),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8-small-ir"},"YOLOv8 Small (IR)")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-training-3"},"Model Training"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-evaluation-3"},"Model Evaluation")))))),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#training-the-yolov8-mixed-model-rgb--ir"},"Training the YOLOv8 Mixed Model (RGB + IR)"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8-nano-rgbir"},"YOLOv8 Nano (RGB+IR)"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-training-4"},"Model Training")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-evaluation-4"},"Model Evaluation")))),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8-small-rgb--ir"},"YOLOv8 Small (RGB + IR)"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-training-5"},"Model Training")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-evaluation-5"},"Model Evaluation")))))),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#model-evaluation-6"},"Model Evaluation"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8n--rgb-dataset"},"YOLOv8n \\& RGB Dataset")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8s--rgb-dataset"},"YOLOv8s \\& RGB Dataset")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8n--ir-dataset"},"YOLOv8n \\& IR Dataset")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8s--rgb-dataset-1"},"YOLOv8s \\& RGB Dataset")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8n--combined-dataset"},"YOLOv8n \\& Combined Dataset")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#yolov8s--combined-dataset"},"YOLOv8s \\& Combined Dataset")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#combining-results"},"Combining Results")))),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#evaluate-bounding-boxes"},"Evaluate Bounding Boxes"),(0,e.kt)("ul",{parentName:"li"},(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#show-labels"},"Show Labels")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#show-predictions"},"Show Predictions")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#show-labels-1"},"Show Labels")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#show-predictions-1"},"Show Predictions")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#show-labels-2"},"Show Labels")),(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("a",{parentName:"li",href:"#show-predictions-2"},"Show Predictions"))))))),(0,e.kt)("h1",{id:"yolov8-nightshift"},"YOLOv8 Nightshift"),(0,e.kt)("h2",{id:"dataset"},"Dataset"),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("a",{parentName:"p",href:"https://adas-dataset-v2.flirconservator.com/#multipartdownloadsection"},"Teledyne FLIR Free ADAS Thermal Dataset v2"),':\nThe Teledyne FLIR free starter thermal dataset provides fully annotated thermal and visible spectrum frames for development of object detection neural networks. This data was constructed to encourage research on visible + thermal spectrum sensor fusion algorithms ("RGBT") in order to advance the safety of autonomous vehicles. A total of 26,442 fully-annotated frames are included with 15 different object classes.')),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("strong",{parentName:"p"},"Baseline Model"),": Baseline accuracy for object detection was established using the YOLOX-m neural network designed for 640 X 640 images. Both the RGB and thermal detectors were pre-trained on MSCOCO data (",(0,e.kt)("a",{parentName:"p",href:"https://arxiv.org/abs/2107.08430"},"YOLOX: Exceeding YOLO Series in 2021")," and ",(0,e.kt)("a",{parentName:"p",href:"https://github.com/Megvii-BaseDetection/YOLOX"},"YOLOX"),"). The base neural networks were trained on the training set data provided in this dataset and tested on the video test data also provided in this dataset.")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"from glob import glob\nimport json\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport os\nimport shutil\nfrom tqdm import tqdm\n")),(0,e.kt)("h3",{id:"dataset-exploration"},"Dataset Exploration"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# read in dataset\nimages_themal = glob('./datasets/video_thermal_test/images/*.jpg')\nimages_rgb = glob('./datasets/video_rgb_test/images/*.jpg')\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"print(len(images_themal), len(images_rgb))\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"3749 3749\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# plot multiple random thermal images\nran_gen = np.random.default_rng()\n\nplt.figure(figsize=(16, 14))\nplt.suptitle('Thermal Images')\nfor i in range(12):\n    ax = plt.subplot(4, 4, i+1)\n    random_index = ran_gen.integers(low=0, high=3748, size=1)\n    i = random_index[0]\n    img_loc = images_themal[i]\n    img_title = 'video: ' + images_themal[i][-52:-35]+'\\n'+ 'frame: ' + images_themal[i][-28:-22]+'\\n'+ 'id: ' + images_themal[i][-21:-4]\n    image = plt.imread(img_loc)\n    plt.imshow(image, cmap=plt.cm.binary)\n    plt.title(img_title, fontsize='small')\n    plt.axis(False)\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(63161).Z,width:"1260",height:"947"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# plot multiple random rgb images\nran_gen = np.random.default_rng()\n\nplt.figure(figsize=(16, 14))\nplt.suptitle('RGB Images')\nfor i in range(12):\n    ax = plt.subplot(4, 4, i+1)\n    random_index = ran_gen.integers(low=0, high=3748, size=1)\n    i = random_index[0]\n    img_loc = images_rgb[i]\n    img_title = 'video: ' + images_rgb[i][-52:-35]+'\\n'+ 'frame: ' + images_rgb[i][-28:-22]+'\\n'+ 'id: ' + images_rgb[i][-21:-4]\n    image = plt.imread(img_loc)\n    plt.imshow(image, cmap=plt.cm.binary)\n    plt.title(img_title, fontsize='small')\n    plt.axis(False)\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(39396).Z,width:"1260",height:"952"})),(0,e.kt)("h3",{id:"label-conversion-json2yolo"},"Label Conversion JSON2YOLO"),(0,e.kt)("ul",null,(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("inlineCode",{parentName:"li"},'"file_name": "data/video-BzZspxAweF8AnKhWK-frame-000745-SSCRtAHcFjphNPczJ.jpg",')," -> ",(0,e.kt)("inlineCode",{parentName:"li"},'"file_name": "video-BzZspxAweF8AnKhWK-frame-000745-SSCRtAHcFjphNPczJ.jpg",'))),(0,e.kt)("p",null,"YOLOv8 expects all images to be located in an ",(0,e.kt)("inlineCode",{parentName:"p"},"images")," dir and the txt format annotation in a ",(0,e.kt)("inlineCode",{parentName:"p"},"labels")," folder next to it. The dataset was using a dirname of ",(0,e.kt)("inlineCode",{parentName:"p"},"data"),' for all images and had COCO JSON annotations. I renamed the folder, created the missing one and removed the "data/" from all the filenames in the JSON file. Now I am able to run a conversion:'),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},'def make_folders(output_path):\n    if os.path.exists(output_path):\n        shutil.rmtree(output_path)\n    os.makedirs(output_path)\n    return output_path\n\n\ndef convert_bbox_coco2yolo(img_width, img_height, bbox):\n    """\n    Convert bounding box from COCO  format to YOLO format\n\n    Parameters\n    ----------\n    img_width : int\n        width of image\n    img_height : int\n        height of image\n    bbox : list[int]\n        bounding box annotation in COCO format: \n        [top left x position, top left y position, width, height]\n\n    Returns\n    -------\n    list[float]\n        bounding box annotation in YOLO format: \n        [x_center_rel, y_center_rel, width_rel, height_rel]\n    """\n    \n    # YOLO bounding box format: [x_center, y_center, width, height]\n    # (float values relative to width and height of image)\n    x_tl, y_tl, w, h = bbox\n\n    dw = 1.0 / img_width\n    dh = 1.0 / img_height\n\n    x_center = x_tl + w / 2.0\n    y_center = y_tl + h / 2.0\n\n    x = x_center * dw\n    y = y_center * dh\n    w = w * dw\n    h = h * dh\n\n    return [x, y, w, h]\n')),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},'def convert_coco_json_to_yolo_txt(output_path, json_file):\n\n    path = make_folders(output_path)\n\n    with open(json_file) as f:\n        json_data = json.load(f)\n\n    # write _darknet.labels, which holds names of all classes (one class per line)\n    label_file = os.path.join(output_path, "_darknet.labels")\n    with open(label_file, "w") as f:\n        for category in tqdm(json_data["categories"], desc="Categories"):\n            category_name = category["name"]\n            f.write(f"{category_name}\\n")\n\n    for image in tqdm(json_data["images"], desc="Annotation txt for each iamge"):\n        img_id = image["id"]\n        img_name = image["file_name"]\n        img_width = image["width"]\n        img_height = image["height"]\n\n        anno_in_image = [anno for anno in json_data["annotations"] if anno["image_id"] == img_id]\n        anno_txt = os.path.join(output_path, img_name.split(".")[0] + ".txt")\n        with open(anno_txt, "w") as f:\n            for anno in anno_in_image:\n                category = anno["category_id"]\n                bbox_COCO = anno["bbox"]\n                x, y, w, h = convert_bbox_coco2yolo(img_width, img_height, bbox_COCO)\n                f.write(f"{category} {x:.6f} {y:.6f} {w:.6f} {h:.6f}\\n")\n\n    print("Converting COCO Json to YOLO txt finished!")\n')),(0,e.kt)("h4",{id:"video-rgb-test-dataset"},"Video RGB Test Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},'convert_coco_json_to_yolo_txt("./datasets/video_rgb_test/labels", "./datasets/video_rgb_test/coco.json")\n')),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"Categories: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 16/16 [00:00<00:00, 253241.00it/s]\nAnnotation txt for each iamge: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3749/3749 [00:38<00:00, 98.23it/s]\n\nConverting COCO Json to YOLO txt finished!\n")),(0,e.kt)("h4",{id:"video-thermal-test-dataset"},"Video Thermal Test Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},'convert_coco_json_to_yolo_txt("./datasets/video_thermal_test/labels", "./datasets/video_thermal_test/coco.json")\n')),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"Categories: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 16/16 [00:00<00:00, 430185.03it/s]\nAnnotation txt for each iamge: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3749/3749 [00:25<00:00, 145.99it/s]\n\nConverting COCO Json to YOLO txt finished!\n")),(0,e.kt)("h4",{id:"images-rgb-train-dataset"},"Images RGB Train Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},'convert_coco_json_to_yolo_txt("./datasets/images_rgb_train/labels", "./datasets/images_rgb_train/coco.json")\n')),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"Categories: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 16/16 [00:00<00:00, 175218.97it/s]1060\nAnnotation txt for each iamge: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 10318/10318 [03:18<00:00, 51.86it/s]\n\nConverting COCO Json to YOLO txt finished!\n")),(0,e.kt)("h4",{id:"images-thermal-train-dataset"},"Images Thermal Train Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},'convert_coco_json_to_yolo_txt("./datasets/images_thermal_train/labels", "./datasets/images_thermal_train/coco.json")\n')),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"Categories: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 16/16 [00:00<00:00, 394758.02it/s]\nAnnotation txt for each iamge: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 10742/10742 [03:07<00:00, 57.44it/s]\n\nConverting COCO Json to YOLO txt finished!\n")),(0,e.kt)("h4",{id:"images-rgb-val-dataset"},"Images RGB Val Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},'convert_coco_json_to_yolo_txt("./datasets/images_rgb_val/labels", "./datasets/images_rgb_val/coco.json")\n')),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"Categories: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 16/16 [00:00<00:00, 281970.02it/s]\nAnnotation txt for each iamge: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1085/1085 [00:02<00:00, 452.60it/s]\n\nConverting COCO Json to YOLO txt finished!\n")),(0,e.kt)("h4",{id:"images-thermal-val-dataset"},"Images Thermal Val Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},'convert_coco_json_to_yolo_txt("./datasets/images_thermal_val/labels", "./datasets/images_thermal_val/coco.json")\n')),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"Categories: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 16/16 [00:00<00:00, 377016.09it/s]\nAnnotation txt for each iamge: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1144/1144 [00:02<00:00, 472.82it/s]\n\nConverting COCO Json to YOLO txt finished!\n")),(0,e.kt)("h3",{id:"dataset-configuration"},"Dataset Configuration"),(0,e.kt)("p",null,"The ",(0,e.kt)("inlineCode",{parentName:"p"},"coco.yaml")," file that came with the dataset contained all 80 COCO classes - I removed all classes that were not part of the annotation and assigned new ",(0,e.kt)("inlineCode",{parentName:"p"},"category_id"),"'s from ",(0,e.kt)("inlineCode",{parentName:"p"},"0"),"-",(0,e.kt)("inlineCode",{parentName:"p"},"15")," for the 16 categories. If you want to use the configuration files below to train your YOLO model you need to replace the annotations accordingly - check the ",(0,e.kt)("inlineCode",{parentName:"p"},"./config")," folder."),(0,e.kt)("ul",null,(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("inlineCode",{parentName:"li"},"config/data_thermal.yaml"))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-yaml"},"train: ../images_thermal_train/images\nval: ../images_thermal_val/images\ntest: ../video_thermal_test/images\n\nnc: 16\nnames: [\n  'person',\n  'bike',\n  'car',\n  'motor',\n  'bus',\n  'train',\n  'truck',\n  'light',\n  'hydrant',\n  'sign',\n  'dog',\n  'deer',\n  'skateboard',\n  'stroller',\n  'scooter',\n  'other vehicle'\n  ]\n")),(0,e.kt)("ul",null,(0,e.kt)("li",{parentName:"ul"},(0,e.kt)("inlineCode",{parentName:"li"},"config/data_rgb.yaml"))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-yaml"},"train: /opt/app/datasets/images_rgb_train/images\nval: /opt/app/datasets/images_rgb_val/images\ntest: /opt/app/datasets/video_rgb_test/images\n\nnc: 16\nnames: [\n  'person',\n  'bike',\n  'car',\n  'motor',\n  'bus',\n  'train',\n  'truck',\n  'light',\n  'hydrant',\n  'sign',\n  'dog',\n  'deer',\n  'skateboard',\n  'stroller',\n  'scooter',\n  'other vehicle'\n  ]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"f_rgb = open('./config/images_rgb_val_coco.json') # =>'./datasets/images_rgb_val/coco.json'\nf_thermal = open('./config/images_thermal_val_coco.json') # => './datasets/images_thermal_val/coco.json'\n# returns JSON object as a dictionary\ndata_rgb_val = json.load(f_rgb)\ndata_thermal_val = json.load(f_thermal)\n# closing files\nf_rgb.close()\nf_thermal.close()\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"f_rgb = open('./config/images_rgb_train_coco.json') # => './datasets/images_rgb_train/coco.json'\nf_thermal = open('./config/images_thermal_train_coco.json') # => './datasets/images_thermal_train/coco.json'\n# returns JSON object as a dictionary\ndata_rgb_train = json.load(f_rgb)\ndata_thermal_train = json.load(f_thermal)\n# closing files\nf_rgb.close()\nf_thermal.close()\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"f_rgb = open('./config/video_rgb_test_coco.json') # => './datasets/video_rgb_test/coco.json'\nf_thermal = open('./config/video_thermal_test_coco.json') # => './datasets/video_thermal_test/coco.json'\n# returns JSON object as a dictionary\ndata_rgb_test = json.load(f_rgb)\ndata_thermal_test = json.load(f_thermal)\n# closing files\nf_rgb.close()\nf_thermal.close()\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Iterating through the json list - check that all annotations are between 0 and 15\n\ncategories = []\n\nfor detection in data_rgb_val['annotations']:\n    categories.append(detection['category_id'])\n\nprint(np.unique(categories))\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"[ 0  1  2  3  5  6  8  9 12 13 15]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"categories = []\n\nfor detection in data_thermal_val['annotations']:\n    categories.append(detection['category_id'])\n\nprint(np.unique(categories))\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"[ 0  1  2  3  5  6  8  9 12 13 15]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"categories = []\n\nfor detection in data_rgb_train['annotations']:\n    categories.append(detection['category_id'])\n\nprint(np.unique(categories))\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"[ 0  1  2  3  5  6  8  9 12 13 14 15]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"categories = []\n\nfor detection in data_thermal_train['annotations']:\n    categories.append(detection['category_id'])\n\nprint(np.unique(categories))\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"[ 0  1  2  3  5  6  8  9 10 11 12 13 14 15]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"categories = []\n\nfor detection in data_rgb_test['annotations']:\n    categories.append(detection['category_id'])\n\nprint(np.unique(categories))\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"[ 0  1  2  3  6  7  8  9 10 15]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"categories = []\n\nfor detection in data_thermal_test['annotations']:\n    categories.append(detection['category_id'])\n\nprint(np.unique(categories))\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"[ 0  1  2  3  6  8  9 10 15]\n")),(0,e.kt)("h2",{id:"training-the-yolov8-model-rgb--ir"},"Training the YOLOv8 Model (RGB / IR)"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# missing yolo dep\n!pip install lapx>=0.5.2\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"\x1b[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\x1b[0m\x1b[33m\n\x1b[0m\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"import cv2 as cv\nfrom glob import glob\nimport matplotlib.pyplot as plt\nimport os\nimport random\nfrom ultralytics import YOLO\n")),(0,e.kt)("h3",{id:"yolov8-nano-rgb"},"YOLOv8 Nano (RGB)"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# unzip downloaded dataset to `./datasets`\ndataset_rgb = 'datasets/data_rgb.yaml'\n\n# load a model\nbackbone_nano = YOLO(\"yolov8n.yaml\")  # build a new model from scratch\n")),(0,e.kt)("h4",{id:"model-training"},"Model Training"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"import json\n \n# Opening JSON file\nf = open('./datasets/images_rgb_train/coco.json')\n \n# returns JSON object as\n# a dictionary\ndata = json.load(f)\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Iterating through the json\nlist = []\nfor i in data['annotations']:\n    list.append(i['category_id'])\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"len(list)\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"169174\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"import numpy as np\n\nprint(np.unique(list))\n\n# Closing file\nf.close()\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"[ 0  1  2  3  5  6  8  9 12 13 14 15]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Train the model\nresults_n = backbone_nano.train(data=dataset_rgb, epochs=20)\n")),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"20 epochs completed in 1.521 hours.")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"Size"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"10/20"),(0,e.kt)("td",{parentName:"tr",align:null},"3.07G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.829"),(0,e.kt)("td",{parentName:"tr",align:null},"1.375"),(0,e.kt)("td",{parentName:"tr",align:null},"1.254"),(0,e.kt)("td",{parentName:"tr",align:null},"328"),(0,e.kt)("td",{parentName:"tr",align:null})),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50-95")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"16909"),(0,e.kt)("td",{parentName:"tr",align:null},"0.525"),(0,e.kt)("td",{parentName:"tr",align:null},"0.16"),(0,e.kt)("td",{parentName:"tr",align:null},"0.156"),(0,e.kt)("td",{parentName:"tr",align:null},"0.077")))),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"Size"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"20/20"),(0,e.kt)("td",{parentName:"tr",align:null},"2.63G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.595"),(0,e.kt)("td",{parentName:"tr",align:null},"1.117"),(0,e.kt)("td",{parentName:"tr",align:null},"1.146"),(0,e.kt)("td",{parentName:"tr",align:null},"223"),(0,e.kt)("td",{parentName:"tr",align:null})),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50-95")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"16909"),(0,e.kt)("td",{parentName:"tr",align:null},"0.579"),(0,e.kt)("td",{parentName:"tr",align:null},"0.185"),(0,e.kt)("td",{parentName:"tr",align:null},"0.196"),(0,e.kt)("td",{parentName:"tr",align:null},"0.102")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"YOLOv8n summary (fused): 168 layers, 3008768 parameters, 0 gradients")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"16909"),(0,e.kt)("td",{parentName:"tr",align:null},"0.578"),(0,e.kt)("td",{parentName:"tr",align:null},"0.186"),(0,e.kt)("td",{parentName:"tr",align:null},"0.196"),(0,e.kt)("td",{parentName:"tr",align:null},"0.102")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"3223"),(0,e.kt)("td",{parentName:"tr",align:null},"0.501"),(0,e.kt)("td",{parentName:"tr",align:null},"0.375"),(0,e.kt)("td",{parentName:"tr",align:null},"0.389"),(0,e.kt)("td",{parentName:"tr",align:null},"0.167")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"193"),(0,e.kt)("td",{parentName:"tr",align:null},"0.201"),(0,e.kt)("td",{parentName:"tr",align:null},"0.197"),(0,e.kt)("td",{parentName:"tr",align:null},"0.101"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0438")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"7285"),(0,e.kt)("td",{parentName:"tr",align:null},"0.662"),(0,e.kt)("td",{parentName:"tr",align:null},"0.575"),(0,e.kt)("td",{parentName:"tr",align:null},"0.621"),(0,e.kt)("td",{parentName:"tr",align:null},"0.397")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"77"),(0,e.kt)("td",{parentName:"tr",align:null},"0.418"),(0,e.kt)("td",{parentName:"tr",align:null},"0.26"),(0,e.kt)("td",{parentName:"tr",align:null},"0.298"),(0,e.kt)("td",{parentName:"tr",align:null},"0.164")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"183"),(0,e.kt)("td",{parentName:"tr",align:null},"0.458"),(0,e.kt)("td",{parentName:"tr",align:null},"0.246"),(0,e.kt)("td",{parentName:"tr",align:null},"0.253"),(0,e.kt)("td",{parentName:"tr",align:null},"0.153")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"2190"),(0,e.kt)("td",{parentName:"tr",align:null},"0.458"),(0,e.kt)("td",{parentName:"tr",align:null},"0.198"),(0,e.kt)("td",{parentName:"tr",align:null},"0.206"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0686")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"126"),(0,e.kt)("td",{parentName:"tr",align:null},"0.744"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0232"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0797"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0265")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"3581"),(0,e.kt)("td",{parentName:"tr",align:null},"0.564"),(0,e.kt)("td",{parentName:"tr",align:null},"0.143"),(0,e.kt)("td",{parentName:"tr",align:null},"0.171"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0824")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"4"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"7"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0.018"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0144")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"40"),(0,e.kt)("td",{parentName:"tr",align:null},"0.348"),(0,e.kt)("td",{parentName:"tr",align:null},"0.025"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0231"),(0,e.kt)("td",{parentName:"tr",align:null},"0.00793")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("em",{parentName:"p"},"Speed: 0.2ms preprocess, 4.2ms inference, 0.0ms loss, 0.6ms postprocess per image"))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(53721).Z,width:"2400",height:"1200"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(24, 14))\n\nim_batch0_labels = plt.imread('./assets/backbone_rgb_nano_val_batch0_labels.webp')\nim_batch0_pred = plt.imread('./assets/backbone_rgb_nano_val_batch0_pred.webp')\nim_batch1_labels = plt.imread('./assets/backbone_rgb_nano_val_batch1_labels.webp')\nim_batch1_pred = plt.imread('./assets/backbone_rgb_nano_val_batch1_pred.webp')\nim_batch2_labels = plt.imread('./assets/backbone_rgb_nano_val_batch2_labels.webp')\nim_batch2_pred = plt.imread('./assets/backbone_rgb_nano_val_batch2_pred.webp')\n\nax = plt.subplot(2, 3, 1)\nplt.title('batch0_labels')\nplt.imshow(im_batch0_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 2)\nplt.title('batch1_labels')\nplt.imshow(im_batch1_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 3)\nplt.title('batch2_labels')\nplt.imshow(im_batch2_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 4)\nplt.title('batch0_pred')\nplt.imshow(im_batch0_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 5)\nplt.title('batch1_pred')\nplt.imshow(im_batch1_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 6)\nplt.title('batch2_pred')\nplt.imshow(im_batch2_pred)\nplt.axis(\"off\")\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"(-0.5, 1919.5, 1647.5, -0.5)\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(57344).Z,width:"1880",height:"1099"})),(0,e.kt)("h4",{id:"model-evaluation"},"Model Evaluation"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Evaluate the model's performance on the validation set\nresults_n = backbone_nano.val()\n")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"16909"),(0,e.kt)("td",{parentName:"tr",align:null},"0.578"),(0,e.kt)("td",{parentName:"tr",align:null},"0.185"),(0,e.kt)("td",{parentName:"tr",align:null},"0.198"),(0,e.kt)("td",{parentName:"tr",align:null},"0.104")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"3223"),(0,e.kt)("td",{parentName:"tr",align:null},"0.505"),(0,e.kt)("td",{parentName:"tr",align:null},"0.375"),(0,e.kt)("td",{parentName:"tr",align:null},"0.391"),(0,e.kt)("td",{parentName:"tr",align:null},"0.167")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"193"),(0,e.kt)("td",{parentName:"tr",align:null},"0.2"),(0,e.kt)("td",{parentName:"tr",align:null},"0.197"),(0,e.kt)("td",{parentName:"tr",align:null},"0.102"),(0,e.kt)("td",{parentName:"tr",align:null},"0.044")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"7285"),(0,e.kt)("td",{parentName:"tr",align:null},"0.663"),(0,e.kt)("td",{parentName:"tr",align:null},"0.574"),(0,e.kt)("td",{parentName:"tr",align:null},"0.621"),(0,e.kt)("td",{parentName:"tr",align:null},"0.398")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"77"),(0,e.kt)("td",{parentName:"tr",align:null},"0.419"),(0,e.kt)("td",{parentName:"tr",align:null},"0.26"),(0,e.kt)("td",{parentName:"tr",align:null},"0.3"),(0,e.kt)("td",{parentName:"tr",align:null},"0.166")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"183"),(0,e.kt)("td",{parentName:"tr",align:null},"0.455"),(0,e.kt)("td",{parentName:"tr",align:null},"0.246"),(0,e.kt)("td",{parentName:"tr",align:null},"0.252"),(0,e.kt)("td",{parentName:"tr",align:null},"0.155")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"2190"),(0,e.kt)("td",{parentName:"tr",align:null},"0.458"),(0,e.kt)("td",{parentName:"tr",align:null},"0.197"),(0,e.kt)("td",{parentName:"tr",align:null},"0.205"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0686")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"126"),(0,e.kt)("td",{parentName:"tr",align:null},"0.741"),(0,e.kt)("td",{parentName:"tr",align:null},"0.023"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0801"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0274")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"3581"),(0,e.kt)("td",{parentName:"tr",align:null},"0.563"),(0,e.kt)("td",{parentName:"tr",align:null},"0.142"),(0,e.kt)("td",{parentName:"tr",align:null},"0.17"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0824")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"4"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"7"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0353"),(0,e.kt)("td",{parentName:"tr",align:null},"0.023")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"40"),(0,e.kt)("td",{parentName:"tr",align:null},"0.355"),(0,e.kt)("td",{parentName:"tr",align:null},"0.025"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0231"),(0,e.kt)("td",{parentName:"tr",align:null},"0.00793")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("em",{parentName:"p"},"Speed: 0.3ms preprocess, 5.0ms inference, 0.0ms loss, 0.7ms postprocess per image"))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(51657).Z,width:"3000",height:"2250"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Export the model to ONNX format\n# success = backbone_nano.export(imgsz=(640, 480), format='onnx', opset=12, optimize=False, half=False)\n# Export to PyTorch format\nsuccess = backbone_nano.export(imgsz=640, format='torchscript', optimize=False, half=False, int8=False)\n# TorchScript: export success \u2705 1.3s, saved as 'runs/detect/train4/weights/best.torchscript' (11.9 MB)\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# pick pre-trained model\nn_model = YOLO('runs/detect/train6/weights/best.torchscript')\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# read video by index\nvideo = cv.VideoCapture(videos[1])\nret, frame = video.read()\n\n# get video dims\nframe_width = int(video.get(3))\nframe_height = int(video.get(4))\nsize = (frame_width, frame_height)\n\n# Define the codec and create VideoWriter object\nfourcc = cv.VideoWriter_fourcc(*'DIVX')\nout = cv.VideoWriter('./outputs/backbone_nano_rgb.avi', fourcc, 20.0, size)\n\n# read frames\nret = True\n\nwhile ret:\n    ret, frame = video.read()\n\n    if ret:\n        # detect & track objects\n        results = np_model.track(frame, persist=True)\n\n        # plot results\n        composed = results[0].plot()\n\n        # save video\n        out.write(composed)\n\nout.release()\nvideo.release()\n")),(0,e.kt)("h3",{id:"yolov8-small-rgb"},"YOLOv8 Small (RGB)"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# unzip downloaded dataset to `./datasets`\ndataset_rgb = 'datasets/data_rgb.yaml'\n\n# load a model\nbackbone_small = YOLO(\"yolov8s.yaml\")  # build a new model from scratch\n")),(0,e.kt)("h4",{id:"model-training-1"},"Model Training"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Train the model\nresults_s = backbone_small.train(data=dataset_rgb, epochs=20)\n")),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"20 epochs completed in 2.438 hours.")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"Size"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"10/20"),(0,e.kt)("td",{parentName:"tr",align:null},"4.84G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.569"),(0,e.kt)("td",{parentName:"tr",align:null},"1.098"),(0,e.kt)("td",{parentName:"tr",align:null},"1.195"),(0,e.kt)("td",{parentName:"tr",align:null},"328"),(0,e.kt)("td",{parentName:"tr",align:null})),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50-95")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"16909"),(0,e.kt)("td",{parentName:"tr",align:null},"0.596"),(0,e.kt)("td",{parentName:"tr",align:null},"0.211"),(0,e.kt)("td",{parentName:"tr",align:null},"0.245"),(0,e.kt)("td",{parentName:"tr",align:null},"0.128")))),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"Size"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"20/20"),(0,e.kt)("td",{parentName:"tr",align:null},"4.67G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.367"),(0,e.kt)("td",{parentName:"tr",align:null},"0.8879"),(0,e.kt)("td",{parentName:"tr",align:null},"1.083"),(0,e.kt)("td",{parentName:"tr",align:null},"223"),(0,e.kt)("td",{parentName:"tr",align:null})),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50-95")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"16909"),(0,e.kt)("td",{parentName:"tr",align:null},"0.608"),(0,e.kt)("td",{parentName:"tr",align:null},"0.25"),(0,e.kt)("td",{parentName:"tr",align:null},"0.291"),(0,e.kt)("td",{parentName:"tr",align:null},"0.158")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"YOLOv8s summary (fused): 168 layers, 11131776 parameters, 0 gradients")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"16909"),(0,e.kt)("td",{parentName:"tr",align:null},"0.523"),(0,e.kt)("td",{parentName:"tr",align:null},"0.255"),(0,e.kt)("td",{parentName:"tr",align:null},"0.291"),(0,e.kt)("td",{parentName:"tr",align:null},"0.159")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"3223"),(0,e.kt)("td",{parentName:"tr",align:null},"0.618"),(0,e.kt)("td",{parentName:"tr",align:null},"0.428"),(0,e.kt)("td",{parentName:"tr",align:null},"0.481"),(0,e.kt)("td",{parentName:"tr",align:null},"0.225")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"193"),(0,e.kt)("td",{parentName:"tr",align:null},"0.248"),(0,e.kt)("td",{parentName:"tr",align:null},"0.326"),(0,e.kt)("td",{parentName:"tr",align:null},"0.239"),(0,e.kt)("td",{parentName:"tr",align:null},"0.121")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"7285"),(0,e.kt)("td",{parentName:"tr",align:null},"0.718"),(0,e.kt)("td",{parentName:"tr",align:null},"0.63"),(0,e.kt)("td",{parentName:"tr",align:null},"0.683"),(0,e.kt)("td",{parentName:"tr",align:null},"0.454")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"77"),(0,e.kt)("td",{parentName:"tr",align:null},"0.566"),(0,e.kt)("td",{parentName:"tr",align:null},"0.338"),(0,e.kt)("td",{parentName:"tr",align:null},"0.382"),(0,e.kt)("td",{parentName:"tr",align:null},"0.22")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"183"),(0,e.kt)("td",{parentName:"tr",align:null},"0.577"),(0,e.kt)("td",{parentName:"tr",align:null},"0.344"),(0,e.kt)("td",{parentName:"tr",align:null},"0.409"),(0,e.kt)("td",{parentName:"tr",align:null},"0.276")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"2190"),(0,e.kt)("td",{parentName:"tr",align:null},"0.593"),(0,e.kt)("td",{parentName:"tr",align:null},"0.318"),(0,e.kt)("td",{parentName:"tr",align:null},"0.336"),(0,e.kt)("td",{parentName:"tr",align:null},"0.119")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"126"),(0,e.kt)("td",{parentName:"tr",align:null},"0.8"),(0,e.kt)("td",{parentName:"tr",align:null},"0.175"),(0,e.kt)("td",{parentName:"tr",align:null},"0.293"),(0,e.kt)("td",{parentName:"tr",align:null},"0.129")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"3581"),(0,e.kt)("td",{parentName:"tr",align:null},"0.632"),(0,e.kt)("td",{parentName:"tr",align:null},"0.243"),(0,e.kt)("td",{parentName:"tr",align:null},"0.291"),(0,e.kt)("td",{parentName:"tr",align:null},"0.149")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"4"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"7"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0687"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0477")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"40"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0135"),(0,e.kt)("td",{parentName:"tr",align:null},"0.00526")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("em",{parentName:"p"},"Speed: 0.3ms preprocess, 9.6ms inference, 0.0ms loss, 0.5ms postprocess per image"))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(73262).Z,width:"2400",height:"1200"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(24, 14))\n\nim_batch0_labels = plt.imread('./assets/backbone_rgb_small_val_batch0_labels.webp')\nim_batch0_pred = plt.imread('./assets/backbone_rgb_small_val_batch0_pred.webp')\nim_batch1_labels = plt.imread('./assets/backbone_rgb_small_val_batch1_labels.webp')\nim_batch1_pred = plt.imread('./assets/backbone_rgb_small_val_batch1_pred.webp')\nim_batch2_labels = plt.imread('./assets/backbone_rgb_small_val_batch2_labels.webp')\nim_batch2_pred = plt.imread('./assets/backbone_rgb_small_val_batch2_pred.webp')\n\nax = plt.subplot(2, 3, 1)\nplt.title('batch0_labels')\nplt.imshow(im_batch0_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 2)\nplt.title('batch1_labels')\nplt.imshow(im_batch1_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 3)\nplt.title('batch2_labels')\nplt.imshow(im_batch2_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 4)\nplt.title('batch0_pred')\nplt.imshow(im_batch0_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 5)\nplt.title('batch1_pred')\nplt.imshow(im_batch1_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 6)\nplt.title('batch2_pred')\nplt.imshow(im_batch2_pred)\nplt.axis(\"off\")\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"(-0.5, 1919.5, 1647.5, -0.5)\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(85016).Z,width:"1880",height:"1099"})),(0,e.kt)("h4",{id:"model-evaluation-1"},"Model Evaluation"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Evaluate the model's performance on the validation set\nresults_s = backbone_small.val()\n")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"16909"),(0,e.kt)("td",{parentName:"tr",align:null},"0.524"),(0,e.kt)("td",{parentName:"tr",align:null},"0.253"),(0,e.kt)("td",{parentName:"tr",align:null},"0.29"),(0,e.kt)("td",{parentName:"tr",align:null},"0.159")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"3223"),(0,e.kt)("td",{parentName:"tr",align:null},"0.622"),(0,e.kt)("td",{parentName:"tr",align:null},"0.428"),(0,e.kt)("td",{parentName:"tr",align:null},"0.481"),(0,e.kt)("td",{parentName:"tr",align:null},"0.225")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"193"),(0,e.kt)("td",{parentName:"tr",align:null},"0.247"),(0,e.kt)("td",{parentName:"tr",align:null},"0.321"),(0,e.kt)("td",{parentName:"tr",align:null},"0.239"),(0,e.kt)("td",{parentName:"tr",align:null},"0.121")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"7285"),(0,e.kt)("td",{parentName:"tr",align:null},"0.722"),(0,e.kt)("td",{parentName:"tr",align:null},"0.629"),(0,e.kt)("td",{parentName:"tr",align:null},"0.683"),(0,e.kt)("td",{parentName:"tr",align:null},"0.454")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"77"),(0,e.kt)("td",{parentName:"tr",align:null},"0.563"),(0,e.kt)("td",{parentName:"tr",align:null},"0.338"),(0,e.kt)("td",{parentName:"tr",align:null},"0.382"),(0,e.kt)("td",{parentName:"tr",align:null},"0.219")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"183"),(0,e.kt)("td",{parentName:"tr",align:null},"0.575"),(0,e.kt)("td",{parentName:"tr",align:null},"0.339"),(0,e.kt)("td",{parentName:"tr",align:null},"0.41"),(0,e.kt)("td",{parentName:"tr",align:null},"0.276")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"2190"),(0,e.kt)("td",{parentName:"tr",align:null},"0.6"),(0,e.kt)("td",{parentName:"tr",align:null},"0.315"),(0,e.kt)("td",{parentName:"tr",align:null},"0.333"),(0,e.kt)("td",{parentName:"tr",align:null},"0.12")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"126"),(0,e.kt)("td",{parentName:"tr",align:null},"0.8"),(0,e.kt)("td",{parentName:"tr",align:null},"0.175"),(0,e.kt)("td",{parentName:"tr",align:null},"0.292"),(0,e.kt)("td",{parentName:"tr",align:null},"0.129")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"3581"),(0,e.kt)("td",{parentName:"tr",align:null},"0.635"),(0,e.kt)("td",{parentName:"tr",align:null},"0.243"),(0,e.kt)("td",{parentName:"tr",align:null},"0.292"),(0,e.kt)("td",{parentName:"tr",align:null},"0.149")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"4"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"7"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0.069"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0479")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"1085"),(0,e.kt)("td",{parentName:"tr",align:null},"40"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0136"),(0,e.kt)("td",{parentName:"tr",align:null},"0.00526")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("em",{parentName:"p"},"Speed: 0.4ms preprocess, 10.9ms inference, 0.0ms loss, 0.6ms postprocess per image"))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(84338).Z,width:"3000",height:"2250"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Export the model to ONNX format\n# success = backbone_nano.export(imgsz=(640, 480), format='onnx', opset=12, optimize=False, half=False)\n# Export to PyTorch format\nsuccess = backbone_small.export(imgsz=640, format='torchscript', optimize=False, half=False, int8=False)\nTorchScript: export success \u2705 2.1s, saved as 'runs/detect/train5/weights/best.torchscript' (42.9 MB)\n")),(0,e.kt)("h3",{id:"yolov8-nano-ir"},"YOLOv8 Nano (IR)"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# unzip downloaded dataset to `./datasets`\ndataset_ir = 'datasets/data_thermal.yaml'\n\n# load a model\nbackbone_ir_nano = YOLO(\"yolov8n.yaml\")  # build a new model from scratch\n")),(0,e.kt)("h4",{id:"model-training-2"},"Model Training"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Train the model\nresults_ir_n = backbone_ir_nano.train(data=dataset_ir, epochs=20)\n")),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"20 epochs completed in 1.337 hours.")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"Size"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"10/20"),(0,e.kt)("td",{parentName:"tr",align:null},"3.33G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.746"),(0,e.kt)("td",{parentName:"tr",align:null},"1.263"),(0,e.kt)("td",{parentName:"tr",align:null},"1.211"),(0,e.kt)("td",{parentName:"tr",align:null},"104"),(0,e.kt)("td",{parentName:"tr",align:null})),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50-95")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"16688"),(0,e.kt)("td",{parentName:"tr",align:null},"0.466"),(0,e.kt)("td",{parentName:"tr",align:null},"0.186"),(0,e.kt)("td",{parentName:"tr",align:null},"0.226"),(0,e.kt)("td",{parentName:"tr",align:null},"0.112")))),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"Size"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"20/20"),(0,e.kt)("td",{parentName:"tr",align:null},"2.5G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.518"),(0,e.kt)("td",{parentName:"tr",align:null},"1.016"),(0,e.kt)("td",{parentName:"tr",align:null},"1.111"),(0,e.kt)("td",{parentName:"tr",align:null},"102"),(0,e.kt)("td",{parentName:"tr",align:null})),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50-95")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"16688"),(0,e.kt)("td",{parentName:"tr",align:null},"0.513"),(0,e.kt)("td",{parentName:"tr",align:null},"0.249"),(0,e.kt)("td",{parentName:"tr",align:null},"0.276"),(0,e.kt)("td",{parentName:"tr",align:null},"0.146")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"YOLOv8n summary (fused): 168 layers, 3008768 parameters, 0 gradients")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"16688"),(0,e.kt)("td",{parentName:"tr",align:null},"0.514"),(0,e.kt)("td",{parentName:"tr",align:null},"0.249"),(0,e.kt)("td",{parentName:"tr",align:null},"0.276"),(0,e.kt)("td",{parentName:"tr",align:null},"0.146")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"4470"),(0,e.kt)("td",{parentName:"tr",align:null},"0.628"),(0,e.kt)("td",{parentName:"tr",align:null},"0.555"),(0,e.kt)("td",{parentName:"tr",align:null},"0.594"),(0,e.kt)("td",{parentName:"tr",align:null},"0.276")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"170"),(0,e.kt)("td",{parentName:"tr",align:null},"0.278"),(0,e.kt)("td",{parentName:"tr",align:null},"0.25"),(0,e.kt)("td",{parentName:"tr",align:null},"0.219"),(0,e.kt)("td",{parentName:"tr",align:null},"0.11")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"7128"),(0,e.kt)("td",{parentName:"tr",align:null},"0.691"),(0,e.kt)("td",{parentName:"tr",align:null},"0.65"),(0,e.kt)("td",{parentName:"tr",align:null},"0.71"),(0,e.kt)("td",{parentName:"tr",align:null},"0.449")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"55"),(0,e.kt)("td",{parentName:"tr",align:null},"0.569"),(0,e.kt)("td",{parentName:"tr",align:null},"0.364"),(0,e.kt)("td",{parentName:"tr",align:null},"0.39"),(0,e.kt)("td",{parentName:"tr",align:null},"0.19")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"179"),(0,e.kt)("td",{parentName:"tr",align:null},"0.741"),(0,e.kt)("td",{parentName:"tr",align:null},"0.383"),(0,e.kt)("td",{parentName:"tr",align:null},"0.455"),(0,e.kt)("td",{parentName:"tr",align:null},"0.284")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"2048"),(0,e.kt)("td",{parentName:"tr",align:null},"0.467"),(0,e.kt)("td",{parentName:"tr",align:null},"0.259"),(0,e.kt)("td",{parentName:"tr",align:null},"0.274"),(0,e.kt)("td",{parentName:"tr",align:null},"0.105")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"94"),(0,e.kt)("td",{parentName:"tr",align:null},"0.678"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0638"),(0,e.kt)("td",{parentName:"tr",align:null},"0.12"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0535")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"2472"),(0,e.kt)("td",{parentName:"tr",align:null},"0.557"),(0,e.kt)("td",{parentName:"tr",align:null},"0.2"),(0,e.kt)("td",{parentName:"tr",align:null},"0.255"),(0,e.kt)("td",{parentName:"tr",align:null},"0.132")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"3"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"6"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"63"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0423"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0159"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0194"),(0,e.kt)("td",{parentName:"tr",align:null},"0.00652")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("em",{parentName:"p"},"Speed: 0.3ms preprocess, 3.8ms inference, 0.0ms loss, 0.6ms postprocess per image"))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(97926).Z,width:"2400",height:"1200"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(24, 14))\n\nim_batch0_labels = plt.imread('./assets/backbone_ir_nano_val_batch0_labels.webp')\nim_batch0_pred = plt.imread('./assets/backbone_ir_nano_val_batch0_pred.webp')\nim_batch1_labels = plt.imread('./assets/backbone_ir_nano_val_batch1_labels.webp')\nim_batch1_pred = plt.imread('./assets/backbone_ir_nano_val_batch1_pred.webp')\nim_batch2_labels = plt.imread('./assets/backbone_ir_nano_val_batch2_labels.webp')\nim_batch2_pred = plt.imread('./assets/backbone_ir_nano_val_batch2_pred.webp')\n\nax = plt.subplot(2, 3, 1)\nplt.title('batch0_labels')\nplt.imshow(im_batch0_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 2)\nplt.title('batch1_labels')\nplt.imshow(im_batch1_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 3)\nplt.title('batch2_labels')\nplt.imshow(im_batch2_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 4)\nplt.title('batch0_pred')\nplt.imshow(im_batch0_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 5)\nplt.title('batch1_pred')\nplt.imshow(im_batch1_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 6)\nplt.title('batch2_pred')\nplt.imshow(im_batch2_pred)\nplt.axis(\"off\")\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(49562).Z,width:"1880",height:"1073"})),(0,e.kt)("h4",{id:"model-evaluation-2"},"Model Evaluation"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Evaluate the model's performance on the validation set\nresults_ir_n = backbone_ir_nano.val()\n")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"16688"),(0,e.kt)("td",{parentName:"tr",align:null},"0.516"),(0,e.kt)("td",{parentName:"tr",align:null},"0.249"),(0,e.kt)("td",{parentName:"tr",align:null},"0.276"),(0,e.kt)("td",{parentName:"tr",align:null},"0.146")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"4470"),(0,e.kt)("td",{parentName:"tr",align:null},"0.631"),(0,e.kt)("td",{parentName:"tr",align:null},"0.556"),(0,e.kt)("td",{parentName:"tr",align:null},"0.595"),(0,e.kt)("td",{parentName:"tr",align:null},"0.276")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"170"),(0,e.kt)("td",{parentName:"tr",align:null},"0.288"),(0,e.kt)("td",{parentName:"tr",align:null},"0.253"),(0,e.kt)("td",{parentName:"tr",align:null},"0.222"),(0,e.kt)("td",{parentName:"tr",align:null},"0.111")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"7128"),(0,e.kt)("td",{parentName:"tr",align:null},"0.696"),(0,e.kt)("td",{parentName:"tr",align:null},"0.65"),(0,e.kt)("td",{parentName:"tr",align:null},"0.711"),(0,e.kt)("td",{parentName:"tr",align:null},"0.449")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"55"),(0,e.kt)("td",{parentName:"tr",align:null},"0.57"),(0,e.kt)("td",{parentName:"tr",align:null},"0.364"),(0,e.kt)("td",{parentName:"tr",align:null},"0.39"),(0,e.kt)("td",{parentName:"tr",align:null},"0.189")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"179"),(0,e.kt)("td",{parentName:"tr",align:null},"0.746"),(0,e.kt)("td",{parentName:"tr",align:null},"0.378"),(0,e.kt)("td",{parentName:"tr",align:null},"0.455"),(0,e.kt)("td",{parentName:"tr",align:null},"0.283")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"2048"),(0,e.kt)("td",{parentName:"tr",align:null},"0.462"),(0,e.kt)("td",{parentName:"tr",align:null},"0.256"),(0,e.kt)("td",{parentName:"tr",align:null},"0.271"),(0,e.kt)("td",{parentName:"tr",align:null},"0.104")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"94"),(0,e.kt)("td",{parentName:"tr",align:null},"0.679"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0638"),(0,e.kt)("td",{parentName:"tr",align:null},"0.12"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0526")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"2472"),(0,e.kt)("td",{parentName:"tr",align:null},"0.557"),(0,e.kt)("td",{parentName:"tr",align:null},"0.199"),(0,e.kt)("td",{parentName:"tr",align:null},"0.256"),(0,e.kt)("td",{parentName:"tr",align:null},"0.132")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"3"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"6"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"63"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0425"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0159"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0193"),(0,e.kt)("td",{parentName:"tr",align:null},"0.00637")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("em",{parentName:"p"},"Speed: 0.3ms preprocess, 4.5ms inference, 0.0ms loss, 0.7ms postprocess per image"))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(11135).Z,width:"3000",height:"2250"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Export the model to ONNX format\n# success = backbone_nano.export(imgsz=(640, 480), format='onnx', opset=12, optimize=False, half=False)\n# Export to PyTorch format\nsuccess = backbone_ir_nano.export(imgsz=640, format='torchscript', optimize=False, half=False, int8=False)\n# TorchScript: export success \u2705 1.6s, saved as 'runs/detect/train6/weights/best.torchscript' (12.4 MB)\n")),(0,e.kt)("h3",{id:"yolov8-small-ir"},"YOLOv8 Small (IR)"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# unzip downloaded dataset to `./datasets`\ndataset_ir = 'datasets/data_thermal.yaml'\n\n# load a model\nbackbone_ir_small = YOLO(\"yolov8s.yaml\")  # build a new model from scratch\n")),(0,e.kt)("h3",{id:"model-training-3"},"Model Training"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Train the model\nresults_ir_s = backbone_ir_small.train(data=dataset_ir, epochs=20)\n")),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"20 epochs completed in 2.827 hours.")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"Size"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"10/20"),(0,e.kt)("td",{parentName:"tr",align:null},"4.83G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.508"),(0,e.kt)("td",{parentName:"tr",align:null},"1.018"),(0,e.kt)("td",{parentName:"tr",align:null},"1.16"),(0,e.kt)("td",{parentName:"tr",align:null},"104"),(0,e.kt)("td",{parentName:"tr",align:null})),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50-95")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"16688"),(0,e.kt)("td",{parentName:"tr",align:null},"0.489"),(0,e.kt)("td",{parentName:"tr",align:null},"0.286"),(0,e.kt)("td",{parentName:"tr",align:null},"0.313"),(0,e.kt)("td",{parentName:"tr",align:null},"0.168")))),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"Size"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"20/20"),(0,e.kt)("td",{parentName:"tr",align:null},"4.67G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.317"),(0,e.kt)("td",{parentName:"tr",align:null},"0.8207"),(0,e.kt)("td",{parentName:"tr",align:null},"1.064"),(0,e.kt)("td",{parentName:"tr",align:null},"102"),(0,e.kt)("td",{parentName:"tr",align:null})),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50-95")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"16688"),(0,e.kt)("td",{parentName:"tr",align:null},"0.554"),(0,e.kt)("td",{parentName:"tr",align:null},"0.322"),(0,e.kt)("td",{parentName:"tr",align:null},"0.358"),(0,e.kt)("td",{parentName:"tr",align:null},"0.2")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"YOLOv8s summary (fused): 168 layers, 11131776 parameters, 0 gradients")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"16688"),(0,e.kt)("td",{parentName:"tr",align:null},"0.554"),(0,e.kt)("td",{parentName:"tr",align:null},"0.322"),(0,e.kt)("td",{parentName:"tr",align:null},"0.358"),(0,e.kt)("td",{parentName:"tr",align:null},"0.2")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"4470"),(0,e.kt)("td",{parentName:"tr",align:null},"0.687"),(0,e.kt)("td",{parentName:"tr",align:null},"0.634"),(0,e.kt)("td",{parentName:"tr",align:null},"0.688"),(0,e.kt)("td",{parentName:"tr",align:null},"0.355")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"170"),(0,e.kt)("td",{parentName:"tr",align:null},"0.364"),(0,e.kt)("td",{parentName:"tr",align:null},"0.347"),(0,e.kt)("td",{parentName:"tr",align:null},"0.308"),(0,e.kt)("td",{parentName:"tr",align:null},"0.174")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"7128"),(0,e.kt)("td",{parentName:"tr",align:null},"0.74"),(0,e.kt)("td",{parentName:"tr",align:null},"0.725"),(0,e.kt)("td",{parentName:"tr",align:null},"0.781"),(0,e.kt)("td",{parentName:"tr",align:null},"0.527")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"55"),(0,e.kt)("td",{parentName:"tr",align:null},"0.608"),(0,e.kt)("td",{parentName:"tr",align:null},"0.509"),(0,e.kt)("td",{parentName:"tr",align:null},"0.552"),(0,e.kt)("td",{parentName:"tr",align:null},"0.25")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"179"),(0,e.kt)("td",{parentName:"tr",align:null},"0.683"),(0,e.kt)("td",{parentName:"tr",align:null},"0.419"),(0,e.kt)("td",{parentName:"tr",align:null},"0.526"),(0,e.kt)("td",{parentName:"tr",align:null},"0.358")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"2048"),(0,e.kt)("td",{parentName:"tr",align:null},"0.601"),(0,e.kt)("td",{parentName:"tr",align:null},"0.385"),(0,e.kt)("td",{parentName:"tr",align:null},"0.415"),(0,e.kt)("td",{parentName:"tr",align:null},"0.178")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"94"),(0,e.kt)("td",{parentName:"tr",align:null},"0.687"),(0,e.kt)("td",{parentName:"tr",align:null},"0.149"),(0,e.kt)("td",{parentName:"tr",align:null},"0.274"),(0,e.kt)("td",{parentName:"tr",align:null},"0.147")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"2472"),(0,e.kt)("td",{parentName:"tr",align:null},"0.608"),(0,e.kt)("td",{parentName:"tr",align:null},"0.313"),(0,e.kt)("td",{parentName:"tr",align:null},"0.362"),(0,e.kt)("td",{parentName:"tr",align:null},"0.195")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"3"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"6"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"63"),(0,e.kt)("td",{parentName:"tr",align:null},"0.112"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0635"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0254"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0151")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("em",{parentName:"p"},"Speed: 0.3ms preprocess, 9.6ms inference, 0.0ms loss, 0.6ms postprocess per image"))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(26133).Z,width:"2400",height:"1200"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(24, 14))\n\nim_batch0_labels = plt.imread('./assets/backbone_ir_small_val_batch0_labels.webp')\nim_batch0_pred = plt.imread('./assets/backbone_ir_small_val_batch0_pred.webp')\nim_batch1_labels = plt.imread('./assets/backbone_ir_small_val_batch1_labels.webp')\nim_batch1_pred = plt.imread('./assets/backbone_ir_small_val_batch1_pred.webp')\nim_batch2_labels = plt.imread('./assets/backbone_ir_small_val_batch2_labels.webp')\nim_batch2_pred = plt.imread('./assets/backbone_ir_small_val_batch2_pred.webp')\n\nax = plt.subplot(2, 3, 1)\nplt.title('batch0_labels')\nplt.imshow(im_batch0_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 2)\nplt.title('batch1_labels')\nplt.imshow(im_batch1_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 3)\nplt.title('batch2_labels')\nplt.imshow(im_batch2_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 4)\nplt.title('batch0_pred')\nplt.imshow(im_batch0_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 5)\nplt.title('batch1_pred')\nplt.imshow(im_batch1_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 6)\nplt.title('batch2_pred')\nplt.imshow(im_batch2_pred)\nplt.axis(\"off\")\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(63927).Z,width:"1880",height:"1073"})),(0,e.kt)("h4",{id:"model-evaluation-3"},"Model Evaluation"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Evaluate the model's performance on the validation set\nresults_ir_s = backbone_ir_small.val()\n")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"16688"),(0,e.kt)("td",{parentName:"tr",align:null},"0.555"),(0,e.kt)("td",{parentName:"tr",align:null},"0.322"),(0,e.kt)("td",{parentName:"tr",align:null},"0.358"),(0,e.kt)("td",{parentName:"tr",align:null},"0.2")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"4470"),(0,e.kt)("td",{parentName:"tr",align:null},"0.691"),(0,e.kt)("td",{parentName:"tr",align:null},"0.632"),(0,e.kt)("td",{parentName:"tr",align:null},"0.687"),(0,e.kt)("td",{parentName:"tr",align:null},"0.356")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"170"),(0,e.kt)("td",{parentName:"tr",align:null},"0.369"),(0,e.kt)("td",{parentName:"tr",align:null},"0.353"),(0,e.kt)("td",{parentName:"tr",align:null},"0.309"),(0,e.kt)("td",{parentName:"tr",align:null},"0.174")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"7128"),(0,e.kt)("td",{parentName:"tr",align:null},"0.743"),(0,e.kt)("td",{parentName:"tr",align:null},"0.725"),(0,e.kt)("td",{parentName:"tr",align:null},"0.781"),(0,e.kt)("td",{parentName:"tr",align:null},"0.527")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"55"),(0,e.kt)("td",{parentName:"tr",align:null},"0.593"),(0,e.kt)("td",{parentName:"tr",align:null},"0.504"),(0,e.kt)("td",{parentName:"tr",align:null},"0.551"),(0,e.kt)("td",{parentName:"tr",align:null},"0.251")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"179"),(0,e.kt)("td",{parentName:"tr",align:null},"0.683"),(0,e.kt)("td",{parentName:"tr",align:null},"0.419"),(0,e.kt)("td",{parentName:"tr",align:null},"0.527"),(0,e.kt)("td",{parentName:"tr",align:null},"0.361")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"2048"),(0,e.kt)("td",{parentName:"tr",align:null},"0.608"),(0,e.kt)("td",{parentName:"tr",align:null},"0.386"),(0,e.kt)("td",{parentName:"tr",align:null},"0.418"),(0,e.kt)("td",{parentName:"tr",align:null},"0.178")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"94"),(0,e.kt)("td",{parentName:"tr",align:null},"0.695"),(0,e.kt)("td",{parentName:"tr",align:null},"0.149"),(0,e.kt)("td",{parentName:"tr",align:null},"0.274"),(0,e.kt)("td",{parentName:"tr",align:null},"0.148")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"2472"),(0,e.kt)("td",{parentName:"tr",align:null},"0.614"),(0,e.kt)("td",{parentName:"tr",align:null},"0.313"),(0,e.kt)("td",{parentName:"tr",align:null},"0.362"),(0,e.kt)("td",{parentName:"tr",align:null},"0.195")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"3"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"6"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"1144"),(0,e.kt)("td",{parentName:"tr",align:null},"63"),(0,e.kt)("td",{parentName:"tr",align:null},"0.112"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0635"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0254"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0151")))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(99515).Z,width:"3000",height:"2250"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Export the model to ONNX format\n# success = backbone_nano.export(imgsz=(640, 480), format='onnx', opset=12, optimize=False, half=False)\n# Export to PyTorch format\nsuccess = backbone_ir_small.export(imgsz=640, format='torchscript', optimize=False, half=False, int8=False)\n# TorchScript: export success \u2705 1.6s, saved as 'runs/detect/train6/weights/best.torchscript' (12.4 MB)\n")),(0,e.kt)("h2",{id:"training-the-yolov8-mixed-model-rgb--ir"},"Training the YOLOv8 Mixed Model (RGB + IR)"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# missing yolo dep\n!pip install lapx>=0.5.2\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"import cv2 as cv\nfrom glob import glob\nimport matplotlib.pyplot as plt\nimport os\nimport random\nfrom ultralytics import YOLO\n")),(0,e.kt)("h3",{id:"yolov8-nano-rgbir"},"YOLOv8 Nano (RGB+IR)"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# unzip downloaded dataset to `./datasets`\ndataset_combined = 'datasets/data_combined.yaml'\n\n# load a model\nbackbone_nano = YOLO(\"yolov8n.yaml\")  # build a new model from scratch\n")),(0,e.kt)("h4",{id:"model-training-4"},"Model Training"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Train the model\nresults_n = backbone_nano.train(data=dataset_combined, epochs=20)\n")),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"20 epochs completed in 2.531 hours.")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"10/20"),(0,e.kt)("td",{parentName:"tr",align:null},"3.18G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.655"),(0,e.kt)("td",{parentName:"tr",align:null},"1.208"),(0,e.kt)("td",{parentName:"tr",align:null},"1.154"),(0,e.kt)("td",{parentName:"tr",align:null},"179")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"33597"),(0,e.kt)("td",{parentName:"tr",align:null},"0.545"),(0,e.kt)("td",{parentName:"tr",align:null},"0.208"),(0,e.kt)("td",{parentName:"tr",align:null},"0.226")))),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"20/20"),(0,e.kt)("td",{parentName:"tr",align:null},"2.6G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.458"),(0,e.kt)("td",{parentName:"tr",align:null},"0.9884"),(0,e.kt)("td",{parentName:"tr",align:null},"1.073"),(0,e.kt)("td",{parentName:"tr",align:null},"52")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"33597"),(0,e.kt)("td",{parentName:"tr",align:null},"0.52"),(0,e.kt)("td",{parentName:"tr",align:null},"0.242"),(0,e.kt)("td",{parentName:"tr",align:null},"0.272")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"YOLOv8n summary (fused): 168 layers, 3008768 parameters, 0 gradients")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"33597"),(0,e.kt)("td",{parentName:"tr",align:null},"0.522"),(0,e.kt)("td",{parentName:"tr",align:null},"0.241"),(0,e.kt)("td",{parentName:"tr",align:null},"0.272"),(0,e.kt)("td",{parentName:"tr",align:null},"0.147")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"7693"),(0,e.kt)("td",{parentName:"tr",align:null},"0.624"),(0,e.kt)("td",{parentName:"tr",align:null},"0.48"),(0,e.kt)("td",{parentName:"tr",align:null},"0.526"),(0,e.kt)("td",{parentName:"tr",align:null},"0.253")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"363"),(0,e.kt)("td",{parentName:"tr",align:null},"0.288"),(0,e.kt)("td",{parentName:"tr",align:null},"0.27"),(0,e.kt)("td",{parentName:"tr",align:null},"0.239"),(0,e.kt)("td",{parentName:"tr",align:null},"0.128")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"14413"),(0,e.kt)("td",{parentName:"tr",align:null},"0.689"),(0,e.kt)("td",{parentName:"tr",align:null},"0.644"),(0,e.kt)("td",{parentName:"tr",align:null},"0.696"),(0,e.kt)("td",{parentName:"tr",align:null},"0.46")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"132"),(0,e.kt)("td",{parentName:"tr",align:null},"0.611"),(0,e.kt)("td",{parentName:"tr",align:null},"0.364"),(0,e.kt)("td",{parentName:"tr",align:null},"0.419"),(0,e.kt)("td",{parentName:"tr",align:null},"0.193")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"362"),(0,e.kt)("td",{parentName:"tr",align:null},"0.675"),(0,e.kt)("td",{parentName:"tr",align:null},"0.344"),(0,e.kt)("td",{parentName:"tr",align:null},"0.425"),(0,e.kt)("td",{parentName:"tr",align:null},"0.281")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"4238"),(0,e.kt)("td",{parentName:"tr",align:null},"0.492"),(0,e.kt)("td",{parentName:"tr",align:null},"0.235"),(0,e.kt)("td",{parentName:"tr",align:null},"0.255"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0951")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"220"),(0,e.kt)("td",{parentName:"tr",align:null},"0.688"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0955"),(0,e.kt)("td",{parentName:"tr",align:null},"0.162"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0659")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"6053"),(0,e.kt)("td",{parentName:"tr",align:null},"0.592"),(0,e.kt)("td",{parentName:"tr",align:null},"0.205"),(0,e.kt)("td",{parentName:"tr",align:null},"0.252"),(0,e.kt)("td",{parentName:"tr",align:null},"0.13")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"7"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"13"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"103"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0798"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0194"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0232"),(0,e.kt)("td",{parentName:"tr",align:null},"0.00977")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("em",{parentName:"p"},"Speed: 0.2ms preprocess, 4.0ms inference, 0.0ms loss, 0.6ms postprocess per image"))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(48535).Z,width:"2400",height:"1200"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(24, 14))\n\nim_batch0_labels = plt.imread('./assets/backbone_combined_nano_val_batch0_labels.webp')\nim_batch0_pred = plt.imread('./assets/backbone_combined_nano_val_batch0_pred.webp')\nim_batch1_labels = plt.imread('./assets/backbone_combined_nano_val_batch1_labels.webp')\nim_batch1_pred = plt.imread('./assets/backbone_combined_nano_val_batch1_pred.webp')\nim_batch2_labels = plt.imread('./assets/backbone_combined_nano_val_batch2_labels.webp')\nim_batch2_pred = plt.imread('./assets/backbone_combined_nano_val_batch2_pred.webp')\n\nax = plt.subplot(2, 3, 1)\nplt.title('batch0_labels')\nplt.imshow(im_batch0_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 2)\nplt.title('batch1_labels')\nplt.imshow(im_batch1_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 3)\nplt.title('batch2_labels')\nplt.imshow(im_batch2_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 4)\nplt.title('batch0_pred')\nplt.imshow(im_batch0_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 5)\nplt.title('batch1_pred')\nplt.imshow(im_batch1_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 6)\nplt.title('batch2_pred')\nplt.imshow(im_batch2_pred)\nplt.axis(\"off\")\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(94173).Z,width:"1880",height:"1073"})),(0,e.kt)("h4",{id:"model-evaluation-4"},"Model Evaluation"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Evaluate the model's performance on the validation set\nresults_n = backbone_nano.val()\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"Ultralytics YOLOv8.0.173 \ud83d\ude80 Python-3.10.11 torch-2.0.1 CUDA:0 (NVIDIA GeForce GTX 1060 6GB, 6070MiB)\nYOLOv8n summary (fused): 168 layers, 3008768 parameters, 0 gradients\n\x1b[34m\x1b[1mval: \x1b[0mScanning /opt/app/datasets/images_combined_val/labels.cache... 2229 images, 32 backgrounds, 0 corrupt: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2229/2229 [00:00<?, ?it/s]\x1b[0m\n                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 140/140 [00:31<00:00,  4.47it/s]\n                   all       2229      33597      0.519      0.242      0.272      0.147\n                person       2229       7693      0.623      0.482      0.527      0.253\n                  bike       2229        363      0.281      0.267      0.239       0.13\n                   car       2229      14413      0.686      0.646      0.697      0.461\n                 motor       2229        132      0.607      0.364      0.417      0.193\n                 train       2229        362      0.666      0.348      0.424      0.279\n                 truck       2229       4238      0.493      0.237      0.256      0.096\n               hydrant       2229        220      0.685     0.0955      0.162     0.0676\n                  sign       2229       6053      0.588      0.205      0.251      0.131\n            skateboard       2229          7          0          0          0          0\n              stroller       2229         13          1          0          0          0\n         other vehicle       2229        103     0.0795     0.0194      0.023    0.00967\nSpeed: 0.3ms preprocess, 4.5ms inference, 0.0ms loss, 0.6ms postprocess per image\nResults saved to \x1b[1mruns/detect/val5\x1b[0m\n")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"33597"),(0,e.kt)("td",{parentName:"tr",align:null},"0.519"),(0,e.kt)("td",{parentName:"tr",align:null},"0.242"),(0,e.kt)("td",{parentName:"tr",align:null},"0.272"),(0,e.kt)("td",{parentName:"tr",align:null},"0.147")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"7693"),(0,e.kt)("td",{parentName:"tr",align:null},"0.623"),(0,e.kt)("td",{parentName:"tr",align:null},"0.482"),(0,e.kt)("td",{parentName:"tr",align:null},"0.527"),(0,e.kt)("td",{parentName:"tr",align:null},"0.253")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"363"),(0,e.kt)("td",{parentName:"tr",align:null},"0.281"),(0,e.kt)("td",{parentName:"tr",align:null},"0.267"),(0,e.kt)("td",{parentName:"tr",align:null},"0.239"),(0,e.kt)("td",{parentName:"tr",align:null},"0.13")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"14413"),(0,e.kt)("td",{parentName:"tr",align:null},"0.686"),(0,e.kt)("td",{parentName:"tr",align:null},"0.646"),(0,e.kt)("td",{parentName:"tr",align:null},"0.697"),(0,e.kt)("td",{parentName:"tr",align:null},"0.461")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"132"),(0,e.kt)("td",{parentName:"tr",align:null},"0.607"),(0,e.kt)("td",{parentName:"tr",align:null},"0.364"),(0,e.kt)("td",{parentName:"tr",align:null},"0.417"),(0,e.kt)("td",{parentName:"tr",align:null},"0.193")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"362"),(0,e.kt)("td",{parentName:"tr",align:null},"0.666"),(0,e.kt)("td",{parentName:"tr",align:null},"0.348"),(0,e.kt)("td",{parentName:"tr",align:null},"0.424"),(0,e.kt)("td",{parentName:"tr",align:null},"0.279")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"4238"),(0,e.kt)("td",{parentName:"tr",align:null},"0.493"),(0,e.kt)("td",{parentName:"tr",align:null},"0.237"),(0,e.kt)("td",{parentName:"tr",align:null},"0.256"),(0,e.kt)("td",{parentName:"tr",align:null},"0.096")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"220"),(0,e.kt)("td",{parentName:"tr",align:null},"0.685"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0955"),(0,e.kt)("td",{parentName:"tr",align:null},"0.162"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0676")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"6053"),(0,e.kt)("td",{parentName:"tr",align:null},"0.588"),(0,e.kt)("td",{parentName:"tr",align:null},"0.205"),(0,e.kt)("td",{parentName:"tr",align:null},"0.251"),(0,e.kt)("td",{parentName:"tr",align:null},"0.131")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"7"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"13"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"103"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0795"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0194"),(0,e.kt)("td",{parentName:"tr",align:null},"0.023"),(0,e.kt)("td",{parentName:"tr",align:null},"0.00967")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("em",{parentName:"p"},"Speed: 0.3ms preprocess, 4.5ms inference, 0.0ms loss, 0.6ms postprocess per image"))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(42724).Z,width:"3000",height:"2250"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Export the model to ONNX format\n# success = backbone_nano.export(imgsz=(640, 480), format='onnx', opset=12, optimize=False, half=False)\n# Export to PyTorch format\nsuccess = backbone_nano.export(imgsz=640, format='torchscript', optimize=False, half=False, int8=False)\n# TorchScript: export success \u2705 1.2s, saved as 'runs/detect/train10/weights/best.torchscript' (11.9 MB)\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"Ultralytics YOLOv8.0.173 \ud83d\ude80 Python-3.10.11 torch-2.0.1 CPU (Intel Core(TM) i7-7700 3.60GHz)\n\n\x1b[34m\x1b[1mPyTorch:\x1b[0m starting from 'runs/detect/train10/weights/best.pt' with input shape (1, 3, 640, 640) BCHW and output shape(s) (1, 20, 8400) (6.0 MB)\n\n\x1b[34m\x1b[1mTorchScript:\x1b[0m starting export with torch 2.0.1...\n\x1b[34m\x1b[1mTorchScript:\x1b[0m export success \u2705 1.2s, saved as 'runs/detect/train10/weights/best.torchscript' (11.9 MB)\n\nExport complete (2.5s)\nResults saved to \x1b[1m/opt/app/runs/detect/train10/weights\x1b[0m\nPredict:         yolo predict task=detect model=runs/detect/train10/weights/best.torchscript imgsz=640  \nValidate:        yolo val task=detect model=runs/detect/train10/weights/best.torchscript imgsz=640 data=datasets/data_combined.yaml  \nVisualize:       https://netron.app\n")),(0,e.kt)("h3",{id:"yolov8-small-rgb--ir"},"YOLOv8 Small (RGB + IR)"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# unzip downloaded dataset to `./datasets`\ndataset_combined = 'datasets/data_combined.yaml'\n\n# load a model\nbackbone_small = YOLO(\"yolov8s.yaml\")  # build a new model from scratch\n")),(0,e.kt)("h4",{id:"model-training-5"},"Model Training"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Train the model\nresults_s = backbone_small.train(data=dataset_combined, epochs=20)\n")),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"20 epochs completed in 4.965 hours.")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"10/20"),(0,e.kt)("td",{parentName:"tr",align:null},"4.88G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.445"),(0,e.kt)("td",{parentName:"tr",align:null},"0.9915"),(0,e.kt)("td",{parentName:"tr",align:null},"1.085"),(0,e.kt)("td",{parentName:"tr",align:null},"179")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"33597"),(0,e.kt)("td",{parentName:"tr",align:null},"0.548"),(0,e.kt)("td",{parentName:"tr",align:null},"0.277"),(0,e.kt)("td",{parentName:"tr",align:null},"0.314")))),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Epoch"),(0,e.kt)("th",{parentName:"tr",align:null},"GPU_mem"),(0,e.kt)("th",{parentName:"tr",align:null},"box_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"cls_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"dfl_loss"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"20/20"),(0,e.kt)("td",{parentName:"tr",align:null},"4.86G"),(0,e.kt)("td",{parentName:"tr",align:null},"1.265"),(0,e.kt)("td",{parentName:"tr",align:null},"0.7992"),(0,e.kt)("td",{parentName:"tr",align:null},"1.011"),(0,e.kt)("td",{parentName:"tr",align:null},"52")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"Class"),(0,e.kt)("td",{parentName:"tr",align:null},"Images"),(0,e.kt)("td",{parentName:"tr",align:null},"Instances"),(0,e.kt)("td",{parentName:"tr",align:null},"P"),(0,e.kt)("td",{parentName:"tr",align:null},"R"),(0,e.kt)("td",{parentName:"tr",align:null},"mAP50")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"33597"),(0,e.kt)("td",{parentName:"tr",align:null},"0.651"),(0,e.kt)("td",{parentName:"tr",align:null},"0.324"),(0,e.kt)("td",{parentName:"tr",align:null},"0.36")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},"YOLOv8s summary (fused): 168 layers, 11131776 parameters, 0 gradients")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"33597"),(0,e.kt)("td",{parentName:"tr",align:null},"0.652"),(0,e.kt)("td",{parentName:"tr",align:null},"0.323"),(0,e.kt)("td",{parentName:"tr",align:null},"0.36"),(0,e.kt)("td",{parentName:"tr",align:null},"0.204")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"7693"),(0,e.kt)("td",{parentName:"tr",align:null},"0.687"),(0,e.kt)("td",{parentName:"tr",align:null},"0.566"),(0,e.kt)("td",{parentName:"tr",align:null},"0.628"),(0,e.kt)("td",{parentName:"tr",align:null},"0.325")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"363"),(0,e.kt)("td",{parentName:"tr",align:null},"0.35"),(0,e.kt)("td",{parentName:"tr",align:null},"0.383"),(0,e.kt)("td",{parentName:"tr",align:null},"0.353"),(0,e.kt)("td",{parentName:"tr",align:null},"0.199")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"14413"),(0,e.kt)("td",{parentName:"tr",align:null},"0.735"),(0,e.kt)("td",{parentName:"tr",align:null},"0.712"),(0,e.kt)("td",{parentName:"tr",align:null},"0.764"),(0,e.kt)("td",{parentName:"tr",align:null},"0.528")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"132"),(0,e.kt)("td",{parentName:"tr",align:null},"0.645"),(0,e.kt)("td",{parentName:"tr",align:null},"0.439"),(0,e.kt)("td",{parentName:"tr",align:null},"0.513"),(0,e.kt)("td",{parentName:"tr",align:null},"0.268")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"362"),(0,e.kt)("td",{parentName:"tr",align:null},"0.703"),(0,e.kt)("td",{parentName:"tr",align:null},"0.478"),(0,e.kt)("td",{parentName:"tr",align:null},"0.555"),(0,e.kt)("td",{parentName:"tr",align:null},"0.383")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"4238"),(0,e.kt)("td",{parentName:"tr",align:null},"0.589"),(0,e.kt)("td",{parentName:"tr",align:null},"0.389"),(0,e.kt)("td",{parentName:"tr",align:null},"0.404"),(0,e.kt)("td",{parentName:"tr",align:null},"0.167")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"220"),(0,e.kt)("td",{parentName:"tr",align:null},"0.696"),(0,e.kt)("td",{parentName:"tr",align:null},"0.177"),(0,e.kt)("td",{parentName:"tr",align:null},"0.266"),(0,e.kt)("td",{parentName:"tr",align:null},"0.121")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"6053"),(0,e.kt)("td",{parentName:"tr",align:null},"0.62"),(0,e.kt)("td",{parentName:"tr",align:null},"0.329"),(0,e.kt)("td",{parentName:"tr",align:null},"0.372"),(0,e.kt)("td",{parentName:"tr",align:null},"0.205")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"7"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"13"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0386"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0297")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"103"),(0,e.kt)("td",{parentName:"tr",align:null},"0.15"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0777"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0616"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0202")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("em",{parentName:"p"},"Speed: 0.2ms preprocess, 9.1ms inference, 0.0ms loss, 0.5ms postprocess per image"))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(72753).Z,width:"2400",height:"1200"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(24, 14))\n\nim_batch0_labels = plt.imread('./assets/backbone_combined_small_val_batch0_labels.webp')\nim_batch0_pred = plt.imread('./assets/backbone_combined_small_val_batch0_pred.webp')\nim_batch1_labels = plt.imread('./assets/backbone_combined_small_val_batch1_labels.webp')\nim_batch1_pred = plt.imread('./assets/backbone_combined_small_val_batch1_pred.webp')\nim_batch2_labels = plt.imread('./assets/backbone_combined_small_val_batch2_labels.webp')\nim_batch2_pred = plt.imread('./assets/backbone_combined_small_val_batch2_pred.webp')\n\nax = plt.subplot(2, 3, 1)\nplt.title('batch0_labels')\nplt.imshow(im_batch0_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 2)\nplt.title('batch1_labels')\nplt.imshow(im_batch1_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 3)\nplt.title('batch2_labels')\nplt.imshow(im_batch2_labels)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 4)\nplt.title('batch0_pred')\nplt.imshow(im_batch0_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 5)\nplt.title('batch1_pred')\nplt.imshow(im_batch1_pred)\nplt.axis(\"off\")\n\nax = plt.subplot(2, 3, 6)\nplt.title('batch2_pred')\nplt.imshow(im_batch2_pred)\nplt.axis(\"off\")\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(800).Z,width:"1880",height:"1073"})),(0,e.kt)("h4",{id:"model-evaluation-5"},"Model Evaluation"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Evaluate the model's performance on the validation set\nresults_s = backbone_small.val()\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"Ultralytics YOLOv8.0.173 \ud83d\ude80 Python-3.10.11 torch-2.0.1 CUDA:0 (NVIDIA GeForce GTX 1060 6GB, 6070MiB)\nYOLOv8s summary (fused): 168 layers, 11131776 parameters, 0 gradients\n\x1b[34m\x1b[1mval: \x1b[0mScanning /opt/app/datasets/images_combined_val/labels.cache... 2229 images, 32 backgrounds, 0 corrupt: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2229/2229 [00:00<?, ?it/s]\x1b[0m\n                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 140/140 [00:42<00:00,  3.28it/s]\n                   all       2229      33597      0.651      0.324      0.359      0.204\n                person       2229       7693      0.687      0.569       0.63      0.326\n                  bike       2229        363      0.346      0.383      0.351      0.198\n                   car       2229      14413      0.734      0.713      0.764      0.529\n                 motor       2229        132      0.633      0.439      0.514      0.267\n                 train       2229        362      0.707      0.481      0.556      0.384\n                 truck       2229       4238       0.59      0.391      0.407      0.167\n               hydrant       2229        220      0.697      0.178      0.266      0.122\n                  sign       2229       6053      0.617      0.329      0.371      0.205\n            skateboard       2229          7          1          0          0          0\n              stroller       2229         13          1          0     0.0323      0.024\n         other vehicle       2229        103      0.148     0.0777     0.0618     0.0193\nSpeed: 0.3ms preprocess, 10.3ms inference, 0.0ms loss, 0.7ms postprocess per image\nResults saved to \x1b[1mruns/detect/val6\x1b[0m\n")),(0,e.kt)("table",null,(0,e.kt)("thead",{parentName:"table"},(0,e.kt)("tr",{parentName:"thead"},(0,e.kt)("th",{parentName:"tr",align:null},"Class"),(0,e.kt)("th",{parentName:"tr",align:null},"Images"),(0,e.kt)("th",{parentName:"tr",align:null},"Instances"),(0,e.kt)("th",{parentName:"tr",align:null},"P"),(0,e.kt)("th",{parentName:"tr",align:null},"R"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50"),(0,e.kt)("th",{parentName:"tr",align:null},"mAP50-95"))),(0,e.kt)("tbody",{parentName:"table"},(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"all"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"33597"),(0,e.kt)("td",{parentName:"tr",align:null},"0.651"),(0,e.kt)("td",{parentName:"tr",align:null},"0.324"),(0,e.kt)("td",{parentName:"tr",align:null},"0.359"),(0,e.kt)("td",{parentName:"tr",align:null},"0.204")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"person"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"7693"),(0,e.kt)("td",{parentName:"tr",align:null},"0.687"),(0,e.kt)("td",{parentName:"tr",align:null},"0.569"),(0,e.kt)("td",{parentName:"tr",align:null},"0.63"),(0,e.kt)("td",{parentName:"tr",align:null},"0.326")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"bike"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"363"),(0,e.kt)("td",{parentName:"tr",align:null},"0.346"),(0,e.kt)("td",{parentName:"tr",align:null},"0.383"),(0,e.kt)("td",{parentName:"tr",align:null},"0.351"),(0,e.kt)("td",{parentName:"tr",align:null},"0.198")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"car"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"14413"),(0,e.kt)("td",{parentName:"tr",align:null},"0.734"),(0,e.kt)("td",{parentName:"tr",align:null},"0.713"),(0,e.kt)("td",{parentName:"tr",align:null},"0.764"),(0,e.kt)("td",{parentName:"tr",align:null},"0.529")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"motor"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"132"),(0,e.kt)("td",{parentName:"tr",align:null},"0.633"),(0,e.kt)("td",{parentName:"tr",align:null},"0.439"),(0,e.kt)("td",{parentName:"tr",align:null},"0.514"),(0,e.kt)("td",{parentName:"tr",align:null},"0.267")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"train"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"362"),(0,e.kt)("td",{parentName:"tr",align:null},"0.707"),(0,e.kt)("td",{parentName:"tr",align:null},"0.481"),(0,e.kt)("td",{parentName:"tr",align:null},"0.556"),(0,e.kt)("td",{parentName:"tr",align:null},"0.384")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"truck"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"4238"),(0,e.kt)("td",{parentName:"tr",align:null},"0.59"),(0,e.kt)("td",{parentName:"tr",align:null},"0.391"),(0,e.kt)("td",{parentName:"tr",align:null},"0.407"),(0,e.kt)("td",{parentName:"tr",align:null},"0.167")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"hydrant"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"220"),(0,e.kt)("td",{parentName:"tr",align:null},"0.697"),(0,e.kt)("td",{parentName:"tr",align:null},"0.178"),(0,e.kt)("td",{parentName:"tr",align:null},"0.266"),(0,e.kt)("td",{parentName:"tr",align:null},"0.122")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"sign"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"6053"),(0,e.kt)("td",{parentName:"tr",align:null},"0.617"),(0,e.kt)("td",{parentName:"tr",align:null},"0.329"),(0,e.kt)("td",{parentName:"tr",align:null},"0.371"),(0,e.kt)("td",{parentName:"tr",align:null},"0.205")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"skateboard"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"7"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"stroller"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"13"),(0,e.kt)("td",{parentName:"tr",align:null},"1"),(0,e.kt)("td",{parentName:"tr",align:null},"0"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0323"),(0,e.kt)("td",{parentName:"tr",align:null},"0.024")),(0,e.kt)("tr",{parentName:"tbody"},(0,e.kt)("td",{parentName:"tr",align:null},"other vehicle"),(0,e.kt)("td",{parentName:"tr",align:null},"2229"),(0,e.kt)("td",{parentName:"tr",align:null},"103"),(0,e.kt)("td",{parentName:"tr",align:null},"0.148"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0777"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0618"),(0,e.kt)("td",{parentName:"tr",align:null},"0.0193")))),(0,e.kt)("blockquote",null,(0,e.kt)("p",{parentName:"blockquote"},(0,e.kt)("em",{parentName:"p"},"Speed: 0.3ms preprocess, 10.3ms inference, 0.0ms loss, 0.7ms postprocess per image"))),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(39228).Z,width:"3000",height:"2250"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Export the model to ONNX format\n# success = backbone_nano.export(imgsz=(640, 480), format='onnx', opset=12, optimize=False, half=False)\n# Export to PyTorch format\nsuccess = backbone_small.export(imgsz=640, format='torchscript', optimize=False, half=False, int8=False)\n# TorchScript: export success \u2705 1.7s, saved as 'runs/detect/train11/weights/best.torchscript' (42.9 MB)\n")),(0,e.kt)("h2",{id:"model-evaluation-6"},"Model Evaluation"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"import matplotlib.pyplot as plt\nimport pandas as pd\nimport seaborn as sns\n")),(0,e.kt)("h3",{id:"yolov8n--rgb-dataset"},"YOLOv8n & RGB Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"data_index = ['all', 'person', 'bike', 'car', 'motor', 'train', 'truck', 'hydrant', 'sign', 'skateboard', 'stroller', 'other vehicle']\ndata_columns = ['Model', 'Images', 'Instances', 'P', 'R', 'mAP50', 'mAP50-95']\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"rgb_nano = [\n    ['rgb_nano', 1085, 16909, 0.578, 0.185, 0.198, 0.104],\n    ['rgb_nano', 1085, 3223, 0.505, 0.375, 0.391, 0.167],\n    ['rgb_nano', 1085, 193, 0.2, 0.197, 0.102, 0.044],\n    ['rgb_nano', 1085, 7285, 0.663, 0.574, 0.621, 0.398],\n    ['rgb_nano', 1085, 77, 0.419, 0.26, 0.3, 0.166],\n    ['rgb_nano', 1085, 183, 0.455, 0.246, 0.252, 0.155],\n    ['rgb_nano', 1085, 2190, 0.458, 0.197, 0.205, 0.0686],\n    ['rgb_nano', 1085, 126, 0.741, 0.023, 0.0801, 0.0274],\n    ['rgb_nano', 1085, 3581, 0.563, 0.142, 0.17, 0.0824],\n    ['rgb_nano', 1085, 4, 1, 0, 0, 0],\n    ['rgb_nano', 1085, 7, 1, 0, 0.0353, 0.023],\n    ['rgb_nano', 1085, 40, 0.355, 0.025, 0.0231, 0.00793]\n]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"rgb_nano_df = pd.DataFrame(rgb_nano, data_index, data_columns)\nrgb_nano_df\n")),(0,e.kt)("table",null,(0,e.kt)("thead",null,(0,e.kt)("tr",null,(0,e.kt)("th",null),(0,e.kt)("th",null,"Model"),(0,e.kt)("th",null,"Images"),(0,e.kt)("th",null,"Instances"),(0,e.kt)("th",null,"P"),(0,e.kt)("th",null,"R"),(0,e.kt)("th",null,"mAP50"),(0,e.kt)("th",null,"mAP50-95"))),(0,e.kt)("tbody",null,(0,e.kt)("tr",null,(0,e.kt)("th",null,"all"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"16909"),(0,e.kt)("td",null,"0.578"),(0,e.kt)("td",null,"0.185"),(0,e.kt)("td",null,"0.1980"),(0,e.kt)("td",null,"0.10400")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"person"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"3223"),(0,e.kt)("td",null,"0.505"),(0,e.kt)("td",null,"0.375"),(0,e.kt)("td",null,"0.3910"),(0,e.kt)("td",null,"0.16700")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"bike"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"193"),(0,e.kt)("td",null,"0.200"),(0,e.kt)("td",null,"0.197"),(0,e.kt)("td",null,"0.1020"),(0,e.kt)("td",null,"0.04400")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"car"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"7285"),(0,e.kt)("td",null,"0.663"),(0,e.kt)("td",null,"0.574"),(0,e.kt)("td",null,"0.6210"),(0,e.kt)("td",null,"0.39800")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"motor"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"77"),(0,e.kt)("td",null,"0.419"),(0,e.kt)("td",null,"0.260"),(0,e.kt)("td",null,"0.3000"),(0,e.kt)("td",null,"0.16600")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"train"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"183"),(0,e.kt)("td",null,"0.455"),(0,e.kt)("td",null,"0.246"),(0,e.kt)("td",null,"0.2520"),(0,e.kt)("td",null,"0.15500")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"truck"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"2190"),(0,e.kt)("td",null,"0.458"),(0,e.kt)("td",null,"0.197"),(0,e.kt)("td",null,"0.2050"),(0,e.kt)("td",null,"0.06860")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"hydrant"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"126"),(0,e.kt)("td",null,"0.741"),(0,e.kt)("td",null,"0.023"),(0,e.kt)("td",null,"0.0801"),(0,e.kt)("td",null,"0.02740")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"sign"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"3581"),(0,e.kt)("td",null,"0.563"),(0,e.kt)("td",null,"0.142"),(0,e.kt)("td",null,"0.1700"),(0,e.kt)("td",null,"0.08240")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"skateboard"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"4"),(0,e.kt)("td",null,"1.000"),(0,e.kt)("td",null,"0.000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.00000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"stroller"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"7"),(0,e.kt)("td",null,"1.000"),(0,e.kt)("td",null,"0.000"),(0,e.kt)("td",null,"0.0353"),(0,e.kt)("td",null,"0.02300")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"other vehicle"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"40"),(0,e.kt)("td",null,"0.355"),(0,e.kt)("td",null,"0.025"),(0,e.kt)("td",null,"0.0231"),(0,e.kt)("td",null,"0.00793")))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(16, 5))\nplt.title('Average Precision by Class & Instances')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=rgb_nano_df.reset_index(),\n    x='Instances',\n    y='mAP50',\n    errorbar='sd',\n    hue='index',\n    palette='nipy_spectral'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(3111).Z,width:"1486",height:"470"})),(0,e.kt)("h3",{id:"yolov8s--rgb-dataset"},"YOLOv8s & RGB Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"rgb_small = [\n    ['rgb_small', 1085, 16909, 0.524, 0.253, 0.29, 0.159],\n    ['rgb_small', 1085, 3223, 0.622, 0.428, 0.481, 0.225],\n    ['rgb_small', 1085, 193, 0.247, 0.321, 0.239, 0.121],\n    ['rgb_small', 1085, 7285, 0.722, 0.629, 0.683, 0.454],\n    ['rgb_small', 1085, 77, 0.563, 0.338, 0.382, 0.219],\n    ['rgb_small', 1085, 183, 0.575, 0.339, 0.41, 0.276],\n    ['rgb_small', 1085, 2190, 0.6, 0.315, 0.333, 0.12],\n    ['rgb_small', 1085, 126, 0.8, 0.175, 0.292, 0.129],\n    ['rgb_small', 1085, 3581, 0.635, 0.243, 0.292, 0.149],\n    ['rgb_small', 1085, 4, 0, 0, 0, 0],\n    ['rgb_small', 1085, 7, 1, 0, 0.069, 0.0479],\n    ['rgb_small', 1085, 40, 0, 0, 0.0136, 0.00526]\n]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"rgb_small_df = pd.DataFrame(rgb_small, data_index, data_columns)\nrgb_small_df\n")),(0,e.kt)("table",null,(0,e.kt)("thead",null,(0,e.kt)("tr",null,(0,e.kt)("th",null),(0,e.kt)("th",null,"Model"),(0,e.kt)("th",null,"Images"),(0,e.kt)("th",null,"Instances"),(0,e.kt)("th",null,"P"),(0,e.kt)("th",null,"R"),(0,e.kt)("th",null,"mAP50"),(0,e.kt)("th",null,"mAP50-95"))),(0,e.kt)("tbody",null,(0,e.kt)("tr",null,(0,e.kt)("th",null,"all"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"16909"),(0,e.kt)("td",null,"0.524"),(0,e.kt)("td",null,"0.253"),(0,e.kt)("td",null,"0.2900"),(0,e.kt)("td",null,"0.15900")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"person"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"3223"),(0,e.kt)("td",null,"0.622"),(0,e.kt)("td",null,"0.428"),(0,e.kt)("td",null,"0.4810"),(0,e.kt)("td",null,"0.22500")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"bike"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"193"),(0,e.kt)("td",null,"0.247"),(0,e.kt)("td",null,"0.321"),(0,e.kt)("td",null,"0.2390"),(0,e.kt)("td",null,"0.12100")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"car"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"7285"),(0,e.kt)("td",null,"0.722"),(0,e.kt)("td",null,"0.629"),(0,e.kt)("td",null,"0.6830"),(0,e.kt)("td",null,"0.45400")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"motor"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"77"),(0,e.kt)("td",null,"0.563"),(0,e.kt)("td",null,"0.338"),(0,e.kt)("td",null,"0.3820"),(0,e.kt)("td",null,"0.21900")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"train"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"183"),(0,e.kt)("td",null,"0.575"),(0,e.kt)("td",null,"0.339"),(0,e.kt)("td",null,"0.4100"),(0,e.kt)("td",null,"0.27600")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"truck"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"2190"),(0,e.kt)("td",null,"0.600"),(0,e.kt)("td",null,"0.315"),(0,e.kt)("td",null,"0.3330"),(0,e.kt)("td",null,"0.12000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"hydrant"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"126"),(0,e.kt)("td",null,"0.800"),(0,e.kt)("td",null,"0.175"),(0,e.kt)("td",null,"0.2920"),(0,e.kt)("td",null,"0.12900")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"sign"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"3581"),(0,e.kt)("td",null,"0.635"),(0,e.kt)("td",null,"0.243"),(0,e.kt)("td",null,"0.2920"),(0,e.kt)("td",null,"0.14900")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"skateboard"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"4"),(0,e.kt)("td",null,"0.000"),(0,e.kt)("td",null,"0.000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.00000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"stroller"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"7"),(0,e.kt)("td",null,"1.000"),(0,e.kt)("td",null,"0.000"),(0,e.kt)("td",null,"0.0690"),(0,e.kt)("td",null,"0.04790")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"other vehicle"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"40"),(0,e.kt)("td",null,"0.000"),(0,e.kt)("td",null,"0.000"),(0,e.kt)("td",null,"0.0136"),(0,e.kt)("td",null,"0.00526")))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(16, 5))\nplt.title('Average Precision by Class & Instances')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=rgb_small_df.reset_index(),\n    x='Instances',\n    y='mAP50',\n    errorbar='sd',\n    hue='index',\n    palette='nipy_spectral'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(95703).Z,width:"1496",height:"479"})),(0,e.kt)("h3",{id:"yolov8n--ir-dataset"},"YOLOv8n & IR Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"ir_nano = [\n    ['ir_nano', 1144, 16688, 0.516, 0.249, 0.276, 0.146],\n    ['ir_nano', 1144, 4470, 0.631, 0.556, 0.595, 0.276],\n    ['ir_nano', 1144, 170, 0.288, 0.253, 0.222, 0.111],\n    ['ir_nano', 1144, 7128, 0.696, 0.65, 0.711, 0.449],\n    ['ir_nano', 1144, 55, 0.57, 0.364, 0.39, 0.189],\n    ['ir_nano', 1144, 179, 0.746, 0.378, 0.455, 0.283],\n    ['ir_nano', 1144, 2048, 0.462, 0.256, 0.271, 0.104],\n    ['ir_nano', 1144, 94, 0.679, 0.0638, 0.12, 0.0526],\n    ['ir_nano', 1144, 2472, 0.557, 0.199, 0.256, 0.132],\n    ['ir_nano', 1144, 3, 0, 0, 0, 0],\n    ['ir_nano', 1144, 6, 1, 0, 0, 0],\n    ['ir_nano', 1144, 63, 0.0425, 0.0159, 0.0193, 0.00637]\n]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"ir_nano_df = pd.DataFrame(ir_nano, data_index, data_columns)\nir_nano_df\n")),(0,e.kt)("table",null,(0,e.kt)("thead",null,(0,e.kt)("tr",null,(0,e.kt)("th",null),(0,e.kt)("th",null,"Model"),(0,e.kt)("th",null,"Images"),(0,e.kt)("th",null,"Instances"),(0,e.kt)("th",null,"P"),(0,e.kt)("th",null,"R"),(0,e.kt)("th",null,"mAP50"),(0,e.kt)("th",null,"mAP50-95"))),(0,e.kt)("tbody",null,(0,e.kt)("tr",null,(0,e.kt)("th",null,"all"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"16688"),(0,e.kt)("td",null,"0.5160"),(0,e.kt)("td",null,"0.2490"),(0,e.kt)("td",null,"0.2760"),(0,e.kt)("td",null,"0.14600")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"person"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"4470"),(0,e.kt)("td",null,"0.6310"),(0,e.kt)("td",null,"0.5560"),(0,e.kt)("td",null,"0.5950"),(0,e.kt)("td",null,"0.27600")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"bike"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"170"),(0,e.kt)("td",null,"0.2880"),(0,e.kt)("td",null,"0.2530"),(0,e.kt)("td",null,"0.2220"),(0,e.kt)("td",null,"0.11100")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"car"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"7128"),(0,e.kt)("td",null,"0.6960"),(0,e.kt)("td",null,"0.6500"),(0,e.kt)("td",null,"0.7110"),(0,e.kt)("td",null,"0.44900")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"motor"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"55"),(0,e.kt)("td",null,"0.5700"),(0,e.kt)("td",null,"0.3640"),(0,e.kt)("td",null,"0.3900"),(0,e.kt)("td",null,"0.18900")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"train"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"179"),(0,e.kt)("td",null,"0.7460"),(0,e.kt)("td",null,"0.3780"),(0,e.kt)("td",null,"0.4550"),(0,e.kt)("td",null,"0.28300")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"truck"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"2048"),(0,e.kt)("td",null,"0.4620"),(0,e.kt)("td",null,"0.2560"),(0,e.kt)("td",null,"0.2710"),(0,e.kt)("td",null,"0.10400")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"hydrant"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"94"),(0,e.kt)("td",null,"0.6790"),(0,e.kt)("td",null,"0.0638"),(0,e.kt)("td",null,"0.1200"),(0,e.kt)("td",null,"0.05260")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"sign"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"2472"),(0,e.kt)("td",null,"0.5570"),(0,e.kt)("td",null,"0.1990"),(0,e.kt)("td",null,"0.2560"),(0,e.kt)("td",null,"0.13200")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"skateboard"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"3"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.00000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"stroller"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"6"),(0,e.kt)("td",null,"1.0000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.00000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"other vehicle"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"63"),(0,e.kt)("td",null,"0.0425"),(0,e.kt)("td",null,"0.0159"),(0,e.kt)("td",null,"0.0193"),(0,e.kt)("td",null,"0.00637")))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(16, 5))\nplt.title('Average Precision by Class & Instances')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=ir_nano_df.reset_index(),\n    x='Instances',\n    y='mAP50',\n    errorbar='sd',\n    hue='index',\n    palette='nipy_spectral'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(13e3).Z,width:"1496",height:"479"})),(0,e.kt)("h3",{id:"yolov8s--rgb-dataset-1"},"YOLOv8s & RGB Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"ir_small = [\n    ['ir_small', 1144, 16688, 0.555, 0.322, 0.358, 0.2],\n    ['ir_small', 1144, 4470, 0.691, 0.632, 0.687, 0.356],\n    ['ir_small', 1144, 170, 0.369, 0.353, 0.309, 0.174],\n    ['ir_small', 1144, 7128, 0.743, 0.725, 0.781, 0.527],\n    ['ir_small', 1144, 55, 0.593, 0.504, 0.551, 0.251],\n    ['ir_small', 1144, 179, 0.683, 0.419, 0.527, 0.361],\n    ['ir_small', 1144, 2048, 0.608, 0.386, 0.418, 0.178],\n    ['ir_small', 1144, 94, 0.695, 0.149, 0.274, 0.148],\n    ['ir_small', 1144, 2472, 0.614, 0.313, 0.362, 0.195],\n    ['ir_small', 1144, 3, 0, 0, 0, 0],\n    ['ir_small', 1144, 6, 1, 0, 0, 0],\n    ['ir_small', 1144, 63, 0.112, 0.0635, 0.0254, 0.0151]\n]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"ir_small_df = pd.DataFrame(ir_small, data_index, data_columns)\nir_small_df\n")),(0,e.kt)("table",null,(0,e.kt)("thead",null,(0,e.kt)("tr",null,(0,e.kt)("th",null),(0,e.kt)("th",null,"Model"),(0,e.kt)("th",null,"Images"),(0,e.kt)("th",null,"Instances"),(0,e.kt)("th",null,"P"),(0,e.kt)("th",null,"R"),(0,e.kt)("th",null,"mAP50"),(0,e.kt)("th",null,"mAP50-95"))),(0,e.kt)("tbody",null,(0,e.kt)("tr",null,(0,e.kt)("th",null,"all"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"16688"),(0,e.kt)("td",null,"0.555"),(0,e.kt)("td",null,"0.3220"),(0,e.kt)("td",null,"0.3580"),(0,e.kt)("td",null,"0.2000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"person"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"4470"),(0,e.kt)("td",null,"0.691"),(0,e.kt)("td",null,"0.6320"),(0,e.kt)("td",null,"0.6870"),(0,e.kt)("td",null,"0.3560")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"bike"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"170"),(0,e.kt)("td",null,"0.369"),(0,e.kt)("td",null,"0.3530"),(0,e.kt)("td",null,"0.3090"),(0,e.kt)("td",null,"0.1740")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"car"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"7128"),(0,e.kt)("td",null,"0.743"),(0,e.kt)("td",null,"0.7250"),(0,e.kt)("td",null,"0.7810"),(0,e.kt)("td",null,"0.5270")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"motor"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"55"),(0,e.kt)("td",null,"0.593"),(0,e.kt)("td",null,"0.5040"),(0,e.kt)("td",null,"0.5510"),(0,e.kt)("td",null,"0.2510")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"train"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"179"),(0,e.kt)("td",null,"0.683"),(0,e.kt)("td",null,"0.4190"),(0,e.kt)("td",null,"0.5270"),(0,e.kt)("td",null,"0.3610")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"truck"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"2048"),(0,e.kt)("td",null,"0.608"),(0,e.kt)("td",null,"0.3860"),(0,e.kt)("td",null,"0.4180"),(0,e.kt)("td",null,"0.1780")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"hydrant"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"94"),(0,e.kt)("td",null,"0.695"),(0,e.kt)("td",null,"0.1490"),(0,e.kt)("td",null,"0.2740"),(0,e.kt)("td",null,"0.1480")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"sign"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"2472"),(0,e.kt)("td",null,"0.614"),(0,e.kt)("td",null,"0.3130"),(0,e.kt)("td",null,"0.3620"),(0,e.kt)("td",null,"0.1950")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"skateboard"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"3"),(0,e.kt)("td",null,"0.000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.0000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"stroller"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"6"),(0,e.kt)("td",null,"1.000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.0000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"other vehicle"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"63"),(0,e.kt)("td",null,"0.112"),(0,e.kt)("td",null,"0.0635"),(0,e.kt)("td",null,"0.0254"),(0,e.kt)("td",null,"0.0151")))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(16, 5))\nplt.title('Average Precision by Class & Instances')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=ir_small_df.reset_index(),\n    x='Instances',\n    y='mAP50',\n    errorbar='sd',\n    hue='index',\n    palette='nipy_spectral'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(35294).Z,width:"1496",height:"479"})),(0,e.kt)("h3",{id:"yolov8n--combined-dataset"},"YOLOv8n & Combined Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"combined_nano = [\n    ['combined_nano', 2229, 33597, 0.519, 0.242, 0.272, 0.147],\n    ['combined_nano', 2229, 7693, 0.623, 0.482, 0.527, 0.253],\n    ['combined_nano', 2229, 363, 0.281, 0.267, 0.239, 0.13],\n    ['combined_nano', 2229, 14413, 0.686, 0.646, 0.697, 0.461],\n    ['combined_nano', 2229, 132, 0.607, 0.364, 0.417, 0.193],\n    ['combined_nano', 2229, 362, 0.666, 0.348, 0.424, 0.279],\n    ['combined_nano', 2229, 4238, 0.493, 0.237, 0.256, 0.096],\n    ['combined_nano', 2229, 220, 0.685, 0.0955, 0.162, 0.0676],\n    ['combined_nano', 2229, 6053, 0.588, 0.205, 0.251, 0.131],\n    ['combined_nano', 2229, 7, 0, 0, 0, 0],\n    ['combined_nano', 2229, 13, 1, 0, 0, 0],\n    ['combined_nano', 2229, 103, 0.0795, 0.0194, 0.023, 0.00967]\n]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"combined_nano_df = pd.DataFrame(combined_nano, data_index, data_columns)\ncombined_nano_df\n")),(0,e.kt)("table",null,(0,e.kt)("thead",null,(0,e.kt)("tr",null,(0,e.kt)("th",null),(0,e.kt)("th",null,"Model"),(0,e.kt)("th",null,"Images"),(0,e.kt)("th",null,"Instances"),(0,e.kt)("th",null,"P"),(0,e.kt)("th",null,"R"),(0,e.kt)("th",null,"mAP50"),(0,e.kt)("th",null,"mAP50-95"))),(0,e.kt)("tbody",null,(0,e.kt)("tr",null,(0,e.kt)("th",null,"all"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"33597"),(0,e.kt)("td",null,"0.5190"),(0,e.kt)("td",null,"0.2420"),(0,e.kt)("td",null,"0.272"),(0,e.kt)("td",null,"0.14700")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"person"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"7693"),(0,e.kt)("td",null,"0.6230"),(0,e.kt)("td",null,"0.4820"),(0,e.kt)("td",null,"0.527"),(0,e.kt)("td",null,"0.25300")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"bike"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"363"),(0,e.kt)("td",null,"0.2810"),(0,e.kt)("td",null,"0.2670"),(0,e.kt)("td",null,"0.239"),(0,e.kt)("td",null,"0.13000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"car"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"14413"),(0,e.kt)("td",null,"0.6860"),(0,e.kt)("td",null,"0.6460"),(0,e.kt)("td",null,"0.697"),(0,e.kt)("td",null,"0.46100")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"motor"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"132"),(0,e.kt)("td",null,"0.6070"),(0,e.kt)("td",null,"0.3640"),(0,e.kt)("td",null,"0.417"),(0,e.kt)("td",null,"0.19300")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"train"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"362"),(0,e.kt)("td",null,"0.6660"),(0,e.kt)("td",null,"0.3480"),(0,e.kt)("td",null,"0.424"),(0,e.kt)("td",null,"0.27900")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"truck"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"4238"),(0,e.kt)("td",null,"0.4930"),(0,e.kt)("td",null,"0.2370"),(0,e.kt)("td",null,"0.256"),(0,e.kt)("td",null,"0.09600")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"hydrant"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"220"),(0,e.kt)("td",null,"0.6850"),(0,e.kt)("td",null,"0.0955"),(0,e.kt)("td",null,"0.162"),(0,e.kt)("td",null,"0.06760")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"sign"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"6053"),(0,e.kt)("td",null,"0.5880"),(0,e.kt)("td",null,"0.2050"),(0,e.kt)("td",null,"0.251"),(0,e.kt)("td",null,"0.13100")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"skateboard"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"7"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.000"),(0,e.kt)("td",null,"0.00000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"stroller"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"13"),(0,e.kt)("td",null,"1.0000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.000"),(0,e.kt)("td",null,"0.00000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"other vehicle"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"103"),(0,e.kt)("td",null,"0.0795"),(0,e.kt)("td",null,"0.0194"),(0,e.kt)("td",null,"0.023"),(0,e.kt)("td",null,"0.00967")))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(16, 5))\nplt.title('Average Precision by Class & Instances')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=combined_nano_df.reset_index(),\n    x='Instances',\n    y='mAP50',\n    errorbar='sd',\n    hue='index',\n    palette='nipy_spectral'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(91719).Z,width:"1496",height:"479"})),(0,e.kt)("h3",{id:"yolov8s--combined-dataset"},"YOLOv8s & Combined Dataset"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"combined_small = [\n    ['combined_small', 2229, 33597, 0.651, 0.324, 0.359, 0.204],\n    ['combined_small', 2229, 7693, 0.687, 0.569, 0.63, 0.326],\n    ['combined_small', 2229, 363, 0.346, 0.383, 0.351, 0.198],\n    ['combined_small', 2229, 14413, 0.734, 0.713, 0.764, 0.529],\n    ['combined_small', 2229, 132, 0.633, 0.439, 0.514, 0.267],\n    ['combined_small', 2229, 362, 0.707, 0.481, 0.556, 0.384],\n    ['combined_small', 2229, 4238, 0.59, 0.391, 0.407, 0.167],\n    ['combined_small', 2229, 220, 0.697, 0.178, 0.266, 0.122],\n    ['combined_small', 2229, 6053, 0.617, 0.329, 0.371, 0.205],\n    ['combined_small', 2229, 7, 1, 0, 0, 0],\n    ['combined_small', 2229, 13, 1, 0, 0.0323, 0.024],\n    ['combined_small', 2229, 103, 0.148, 0.0777, 0.0618, 0.0193]\n]\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"combined_small_df = pd.DataFrame(combined_small, data_index, data_columns)\ncombined_small_df\n")),(0,e.kt)("table",null,(0,e.kt)("thead",null,(0,e.kt)("tr",null,(0,e.kt)("th",null),(0,e.kt)("th",null,"Model"),(0,e.kt)("th",null,"Images"),(0,e.kt)("th",null,"Instances"),(0,e.kt)("th",null,"P"),(0,e.kt)("th",null,"R"),(0,e.kt)("th",null,"mAP50"),(0,e.kt)("th",null,"mAP50-95"))),(0,e.kt)("tbody",null,(0,e.kt)("tr",null,(0,e.kt)("th",null,"all"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"33597"),(0,e.kt)("td",null,"0.651"),(0,e.kt)("td",null,"0.3240"),(0,e.kt)("td",null,"0.3590"),(0,e.kt)("td",null,"0.2040")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"person"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"7693"),(0,e.kt)("td",null,"0.687"),(0,e.kt)("td",null,"0.5690"),(0,e.kt)("td",null,"0.6300"),(0,e.kt)("td",null,"0.3260")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"bike"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"363"),(0,e.kt)("td",null,"0.346"),(0,e.kt)("td",null,"0.3830"),(0,e.kt)("td",null,"0.3510"),(0,e.kt)("td",null,"0.1980")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"car"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"14413"),(0,e.kt)("td",null,"0.734"),(0,e.kt)("td",null,"0.7130"),(0,e.kt)("td",null,"0.7640"),(0,e.kt)("td",null,"0.5290")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"motor"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"132"),(0,e.kt)("td",null,"0.633"),(0,e.kt)("td",null,"0.4390"),(0,e.kt)("td",null,"0.5140"),(0,e.kt)("td",null,"0.2670")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"train"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"362"),(0,e.kt)("td",null,"0.707"),(0,e.kt)("td",null,"0.4810"),(0,e.kt)("td",null,"0.5560"),(0,e.kt)("td",null,"0.3840")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"truck"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"4238"),(0,e.kt)("td",null,"0.590"),(0,e.kt)("td",null,"0.3910"),(0,e.kt)("td",null,"0.4070"),(0,e.kt)("td",null,"0.1670")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"hydrant"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"220"),(0,e.kt)("td",null,"0.697"),(0,e.kt)("td",null,"0.1780"),(0,e.kt)("td",null,"0.2660"),(0,e.kt)("td",null,"0.1220")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"sign"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"6053"),(0,e.kt)("td",null,"0.617"),(0,e.kt)("td",null,"0.3290"),(0,e.kt)("td",null,"0.3710"),(0,e.kt)("td",null,"0.2050")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"skateboard"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"7"),(0,e.kt)("td",null,"1.000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.0000")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"stroller"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"13"),(0,e.kt)("td",null,"1.000"),(0,e.kt)("td",null,"0.0000"),(0,e.kt)("td",null,"0.0323"),(0,e.kt)("td",null,"0.0240")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"other vehicle"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"103"),(0,e.kt)("td",null,"0.148"),(0,e.kt)("td",null,"0.0777"),(0,e.kt)("td",null,"0.0618"),(0,e.kt)("td",null,"0.0193")))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(16, 5))\nplt.title('Average Precision by Class & Instances')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=combined_small_df.reset_index(),\n    x='Instances',\n    y='mAP50',\n    errorbar='sd',\n    hue='index',\n    palette='nipy_spectral'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(53386).Z,width:"1496",height:"479"})),(0,e.kt)("h3",{id:"combining-results"},"Combining Results"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"combined_df = pd.concat([rgb_nano_df, rgb_small_df, ir_nano_df, ir_small_df, combined_nano_df, combined_small_df], axis=0)\ncombined_df = combined_df.reset_index()\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(16, 5))\nplt.title('Average Precision by Class')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=combined_df.reset_index(),\n    x='index',\n    y='mAP50',\n    errorbar='sd',\n    hue='Model',\n    palette='seismic'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(77286).Z,width:"1325",height:"479"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(24, 10))\n\nsns.set(style='darkgrid')\n\nsns.scatterplot(\n    data=combined_df.reset_index(),\n    x='R',\n    y='P',\n    s=300,\n    alpha=0.8,\n    hue='Model',\n    palette='nipy_spectral',\n    style='index'\n).set_title('Precision Recall')\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(10448).Z,width:"1941",height:"864"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"combined_df[combined_df['index'] == 'car']\n")),(0,e.kt)("table",null,(0,e.kt)("thead",null,(0,e.kt)("tr",null,(0,e.kt)("th",null),(0,e.kt)("th",null,"index"),(0,e.kt)("th",null,"Model"),(0,e.kt)("th",null,"Images"),(0,e.kt)("th",null,"Instances"),(0,e.kt)("th",null,"P"),(0,e.kt)("th",null,"R"),(0,e.kt)("th",null,"mAP50"),(0,e.kt)("th",null,"mAP50-95"))),(0,e.kt)("tbody",null,(0,e.kt)("tr",null,(0,e.kt)("th",null,"3"),(0,e.kt)("td",null,"car"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"7285"),(0,e.kt)("td",null,"0.663"),(0,e.kt)("td",null,"0.574"),(0,e.kt)("td",null,"0.621"),(0,e.kt)("td",null,"0.398")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"15"),(0,e.kt)("td",null,"car"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"7285"),(0,e.kt)("td",null,"0.722"),(0,e.kt)("td",null,"0.629"),(0,e.kt)("td",null,"0.683"),(0,e.kt)("td",null,"0.454")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"27"),(0,e.kt)("td",null,"car"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"7128"),(0,e.kt)("td",null,"0.696"),(0,e.kt)("td",null,"0.650"),(0,e.kt)("td",null,"0.711"),(0,e.kt)("td",null,"0.449")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"39"),(0,e.kt)("td",null,"car"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"7128"),(0,e.kt)("td",null,"0.743"),(0,e.kt)("td",null,"0.725"),(0,e.kt)("td",null,"0.781"),(0,e.kt)("td",null,"0.527")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"51"),(0,e.kt)("td",null,"car"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"14413"),(0,e.kt)("td",null,"0.686"),(0,e.kt)("td",null,"0.646"),(0,e.kt)("td",null,"0.697"),(0,e.kt)("td",null,"0.461")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"63"),(0,e.kt)("td",null,"car"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"14413"),(0,e.kt)("td",null,"0.734"),(0,e.kt)("td",null,"0.713"),(0,e.kt)("td",null,"0.764"),(0,e.kt)("td",null,"0.529")))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(8, 5))\nplt.title('Average Precision by Class')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=combined_df[combined_df['index'] == 'car'],\n    x='index',\n    y='mAP50',\n    errorbar='sd',\n    hue='Model',\n    palette='seismic'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(24630).Z,width:"893",height:"479"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"combined_df[combined_df['index'] == 'person']\n")),(0,e.kt)("table",null,(0,e.kt)("thead",null,(0,e.kt)("tr",null,(0,e.kt)("th",null),(0,e.kt)("th",null,"index"),(0,e.kt)("th",null,"Model"),(0,e.kt)("th",null,"Images"),(0,e.kt)("th",null,"Instances"),(0,e.kt)("th",null,"P"),(0,e.kt)("th",null,"R"),(0,e.kt)("th",null,"mAP50"),(0,e.kt)("th",null,"mAP50-95"))),(0,e.kt)("tbody",null,(0,e.kt)("tr",null,(0,e.kt)("th",null,"1"),(0,e.kt)("td",null,"person"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"3223"),(0,e.kt)("td",null,"0.505"),(0,e.kt)("td",null,"0.375"),(0,e.kt)("td",null,"0.391"),(0,e.kt)("td",null,"0.167")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"13"),(0,e.kt)("td",null,"person"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"3223"),(0,e.kt)("td",null,"0.622"),(0,e.kt)("td",null,"0.428"),(0,e.kt)("td",null,"0.481"),(0,e.kt)("td",null,"0.225")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"25"),(0,e.kt)("td",null,"person"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"4470"),(0,e.kt)("td",null,"0.631"),(0,e.kt)("td",null,"0.556"),(0,e.kt)("td",null,"0.595"),(0,e.kt)("td",null,"0.276")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"37"),(0,e.kt)("td",null,"person"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"4470"),(0,e.kt)("td",null,"0.691"),(0,e.kt)("td",null,"0.632"),(0,e.kt)("td",null,"0.687"),(0,e.kt)("td",null,"0.356")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"49"),(0,e.kt)("td",null,"person"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"7693"),(0,e.kt)("td",null,"0.623"),(0,e.kt)("td",null,"0.482"),(0,e.kt)("td",null,"0.527"),(0,e.kt)("td",null,"0.253")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"61"),(0,e.kt)("td",null,"person"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"7693"),(0,e.kt)("td",null,"0.687"),(0,e.kt)("td",null,"0.569"),(0,e.kt)("td",null,"0.630"),(0,e.kt)("td",null,"0.326")))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(8, 5))\nplt.title('Average Precision by Class')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=combined_df[combined_df['index'] == 'person'],\n    x='index',\n    y='mAP50',\n    errorbar='sd',\n    hue='Model',\n    palette='seismic'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(38028).Z,width:"893",height:"479"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"combined_df[combined_df['index'] == 'motor']\n")),(0,e.kt)("table",null,(0,e.kt)("thead",null,(0,e.kt)("tr",null,(0,e.kt)("th",null),(0,e.kt)("th",null,"index"),(0,e.kt)("th",null,"Model"),(0,e.kt)("th",null,"Images"),(0,e.kt)("th",null,"Instances"),(0,e.kt)("th",null,"P"),(0,e.kt)("th",null,"R"),(0,e.kt)("th",null,"mAP50"),(0,e.kt)("th",null,"mAP50-95"))),(0,e.kt)("tbody",null,(0,e.kt)("tr",null,(0,e.kt)("th",null,"4"),(0,e.kt)("td",null,"motor"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"77"),(0,e.kt)("td",null,"0.419"),(0,e.kt)("td",null,"0.260"),(0,e.kt)("td",null,"0.300"),(0,e.kt)("td",null,"0.166")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"16"),(0,e.kt)("td",null,"motor"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"77"),(0,e.kt)("td",null,"0.563"),(0,e.kt)("td",null,"0.338"),(0,e.kt)("td",null,"0.382"),(0,e.kt)("td",null,"0.219")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"28"),(0,e.kt)("td",null,"motor"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"55"),(0,e.kt)("td",null,"0.570"),(0,e.kt)("td",null,"0.364"),(0,e.kt)("td",null,"0.390"),(0,e.kt)("td",null,"0.189")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"40"),(0,e.kt)("td",null,"motor"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"55"),(0,e.kt)("td",null,"0.593"),(0,e.kt)("td",null,"0.504"),(0,e.kt)("td",null,"0.551"),(0,e.kt)("td",null,"0.251")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"52"),(0,e.kt)("td",null,"motor"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"132"),(0,e.kt)("td",null,"0.607"),(0,e.kt)("td",null,"0.364"),(0,e.kt)("td",null,"0.417"),(0,e.kt)("td",null,"0.193")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"64"),(0,e.kt)("td",null,"motor"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"132"),(0,e.kt)("td",null,"0.633"),(0,e.kt)("td",null,"0.439"),(0,e.kt)("td",null,"0.514"),(0,e.kt)("td",null,"0.267")))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(8, 5))\nplt.title('Average Precision by Class')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=combined_df[combined_df['index'] == 'motor'],\n    x='index',\n    y='mAP50',\n    errorbar='sd',\n    hue='Model',\n    palette='seismic'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(94473).Z,width:"893",height:"479"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"combined_df[combined_df['index'] == 'bike']\n")),(0,e.kt)("table",null,(0,e.kt)("thead",null,(0,e.kt)("tr",null,(0,e.kt)("th",null),(0,e.kt)("th",null,"index"),(0,e.kt)("th",null,"Model"),(0,e.kt)("th",null,"Images"),(0,e.kt)("th",null,"Instances"),(0,e.kt)("th",null,"P"),(0,e.kt)("th",null,"R"),(0,e.kt)("th",null,"mAP50"),(0,e.kt)("th",null,"mAP50-95"))),(0,e.kt)("tbody",null,(0,e.kt)("tr",null,(0,e.kt)("th",null,"2"),(0,e.kt)("td",null,"bike"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"193"),(0,e.kt)("td",null,"0.200"),(0,e.kt)("td",null,"0.197"),(0,e.kt)("td",null,"0.102"),(0,e.kt)("td",null,"0.044")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"14"),(0,e.kt)("td",null,"bike"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"193"),(0,e.kt)("td",null,"0.247"),(0,e.kt)("td",null,"0.321"),(0,e.kt)("td",null,"0.239"),(0,e.kt)("td",null,"0.121")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"26"),(0,e.kt)("td",null,"bike"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"170"),(0,e.kt)("td",null,"0.288"),(0,e.kt)("td",null,"0.253"),(0,e.kt)("td",null,"0.222"),(0,e.kt)("td",null,"0.111")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"38"),(0,e.kt)("td",null,"bike"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"170"),(0,e.kt)("td",null,"0.369"),(0,e.kt)("td",null,"0.353"),(0,e.kt)("td",null,"0.309"),(0,e.kt)("td",null,"0.174")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"50"),(0,e.kt)("td",null,"bike"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"363"),(0,e.kt)("td",null,"0.281"),(0,e.kt)("td",null,"0.267"),(0,e.kt)("td",null,"0.239"),(0,e.kt)("td",null,"0.130")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"62"),(0,e.kt)("td",null,"bike"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"363"),(0,e.kt)("td",null,"0.346"),(0,e.kt)("td",null,"0.383"),(0,e.kt)("td",null,"0.351"),(0,e.kt)("td",null,"0.198")))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(8, 5))\nplt.title('Average Precision by Class')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=combined_df[combined_df['index'] == 'bike'],\n    x='index',\n    y='mAP50',\n    errorbar='sd',\n    hue='Model',\n    palette='seismic'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(44011).Z,width:"903",height:"479"})),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"combined_df[combined_df['index'] == 'truck']\n")),(0,e.kt)("table",null,(0,e.kt)("thead",null,(0,e.kt)("tr",null,(0,e.kt)("th",null),(0,e.kt)("th",null,"index"),(0,e.kt)("th",null,"Model"),(0,e.kt)("th",null,"Images"),(0,e.kt)("th",null,"Instances"),(0,e.kt)("th",null,"P"),(0,e.kt)("th",null,"R"),(0,e.kt)("th",null,"mAP50"),(0,e.kt)("th",null,"mAP50-95"))),(0,e.kt)("tbody",null,(0,e.kt)("tr",null,(0,e.kt)("th",null,"6"),(0,e.kt)("td",null,"truck"),(0,e.kt)("td",null,"rgb_nano"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"2190"),(0,e.kt)("td",null,"0.458"),(0,e.kt)("td",null,"0.197"),(0,e.kt)("td",null,"0.205"),(0,e.kt)("td",null,"0.0686")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"18"),(0,e.kt)("td",null,"truck"),(0,e.kt)("td",null,"rgb_small"),(0,e.kt)("td",null,"1085"),(0,e.kt)("td",null,"2190"),(0,e.kt)("td",null,"0.600"),(0,e.kt)("td",null,"0.315"),(0,e.kt)("td",null,"0.333"),(0,e.kt)("td",null,"0.1200")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"30"),(0,e.kt)("td",null,"truck"),(0,e.kt)("td",null,"ir_nano"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"2048"),(0,e.kt)("td",null,"0.462"),(0,e.kt)("td",null,"0.256"),(0,e.kt)("td",null,"0.271"),(0,e.kt)("td",null,"0.1040")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"42"),(0,e.kt)("td",null,"truck"),(0,e.kt)("td",null,"ir_small"),(0,e.kt)("td",null,"1144"),(0,e.kt)("td",null,"2048"),(0,e.kt)("td",null,"0.608"),(0,e.kt)("td",null,"0.386"),(0,e.kt)("td",null,"0.418"),(0,e.kt)("td",null,"0.1780")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"54"),(0,e.kt)("td",null,"truck"),(0,e.kt)("td",null,"combined_nano"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"4238"),(0,e.kt)("td",null,"0.493"),(0,e.kt)("td",null,"0.237"),(0,e.kt)("td",null,"0.256"),(0,e.kt)("td",null,"0.0960")),(0,e.kt)("tr",null,(0,e.kt)("th",null,"66"),(0,e.kt)("td",null,"truck"),(0,e.kt)("td",null,"combined_small"),(0,e.kt)("td",null,"2229"),(0,e.kt)("td",null,"4238"),(0,e.kt)("td",null,"0.590"),(0,e.kt)("td",null,"0.391"),(0,e.kt)("td",null,"0.407"),(0,e.kt)("td",null,"0.1670")))),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"plt.figure(figsize=(8, 5))\nplt.title('Average Precision by Class')\nsns.set(style='darkgrid')\nsns.barplot(\n    data=combined_df[combined_df['index'] == 'truck'],\n    x='index',\n    y='mAP50',\n    errorbar='sd',\n    hue='Model',\n    palette='seismic'\n)\nplt.legend(bbox_to_anchor=(1.01,1.01))\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(57101).Z,width:"903",height:"479"})),(0,e.kt)("h2",{id:"evaluate-bounding-boxes"},"Evaluate Bounding Boxes"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# read images\nimages = glob('./datasets/images_combined_val/images/\\*.jpg')\nprint(len(images))\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"2229\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# select image\nimg = cv.imread(images[0])\nheight, width, _ = img.shape\n\nprint(images[0][38:-4], height, width)\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"video-57kWWRyeqqHs3Byei-frame-000816-b6tuLjNco8MfoBs3d 512 640\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# select label file\npath = './datasets/images_combined_val/labels/' + images[0][38:-4] + '.txt'\nlabels = open(path, 'r')\n\ndata = labels.readlines()\nlabels.close()\n\nprint(data)\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"['9 0.696875 0.375000 0.025000 0.039062\\n', '9 0.696094 0.314453 0.032813 0.082031\\n', '9 0.168750 0.395508 0.040625 0.013672\\n', '0 0.464063 0.457031 0.009375 0.027344\\n', '0 0.004688 0.491211 0.009375 0.041016\\n', '0 0.165625 0.489258 0.009375 0.033203\\n', '1 0.316406 0.500000 0.014063 0.035156\\n', '2 0.600781 0.511719 0.117188 0.113281\\n', '2 0.524219 0.481445 0.060938 0.064453\\n', '2 0.481250 0.469727 0.037500 0.033203\\n', '2 0.426563 0.454102 0.015625 0.017578\\n', '2 0.412500 0.463867 0.015625 0.025391\\n', '2 0.376563 0.474609 0.018750 0.023438\\n', '2 0.364063 0.477539 0.021875 0.033203\\n', '2 0.342188 0.477539 0.034375 0.041016\\n', '0 0.315625 0.483398 0.021875 0.044922\\n', '8 0.105469 0.500977 0.007812 0.021484\\n']\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# create one colour for every COCO class\ncolours = []\nnumber_colours=80\n\nfor j in range(number_colours):\n    colour = np.random.randint(0,255),np.random.randint(0,255),np.random.randint(0,255)\n    colours.append(colour)\n\nprint(len(colours),colours)\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"80 [(129, 83, 161), (220, 116, 220), (47, 113, 141), (185, 137, 77), (212, 208, 251), (36, 83, 204), (4, 40, 112), (61, 18, 39), (25, 132, 21), (239, 67, 234), (140, 253, 52), (207, 196, 72), (144, 32, 112), (138, 29, 227), (101, 17, 45), (102, 118, 7), (210, 51, 160), (59, 158, 131), (37, 145, 69), (68, 56, 71), (28, 96, 25), (72, 189, 118), (190, 67, 118), (152, 48, 33), (153, 138, 248), (218, 94, 242), (236, 229, 215), (133, 186, 102), (33, 198, 167), (223, 32, 103), (16, 209, 160), (83, 89, 91), (194, 46, 110), (243, 47, 47), (187, 11, 41), (193, 188, 6), (107, 119, 230), (116, 118, 109), (65, 155, 110), (12, 151, 145), (135, 138, 197), (43, 19, 174), (52, 203, 214), (72, 178, 172), (10, 247, 17), (108, 90, 185), (134, 29, 207), (217, 96, 179), (2, 38, 161), (245, 175, 254), (254, 57, 175), (84, 184, 46), (249, 195, 60), (246, 67, 127), (51, 89, 138), (12, 162, 182), (176, 89, 187), (165, 40, 110), (141, 76, 226), (245, 187, 119), (47, 237, 138), (173, 176, 50), (49, 101, 36), (171, 235, 78), (125, 105, 250), (123, 83, 13), (18, 47, 133), (196, 102, 109), (234, 204, 106), (55, 110, 131), (116, 209, 240), (147, 203, 253), (115, 246, 60), (17, 245, 112), (50, 250, 19), (254, 233, 18), (122, 211, 221), (229, 12, 236), (86, 169, 186), (13, 189, 38)]\n")),(0,e.kt)("h3",{id:"show-labels"},"Show Labels"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"index = 0\n\nfor line in data:\n\n    # Split string to float\n    _, x, y, w, h = map(float, line.split(' '))\n    \n    l = int((x - w / 2) * width)\n    r = int((x + w / 2) * width)\n    t = int((y - h / 2) * height)\n    b = int((y + h / 2) * height)\n    \n    if l < 0:\n        l = 0\n    if r > width - 1:\n        r = width - 1\n    if t < 0:\n        t = 0\n    if b > height - 1:\n        b = height - 1\n\n    image = cv.rectangle(img, (l, t), (r, b), colours[index], thickness=2)\n    index += 1\n\nplt.title('Image with original Labels')\nplt.axis('off')\nplt.imshow(image)\nplt.show()\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(37192).Z,width:"481",height:"411"})),(0,e.kt)("h3",{id:"show-predictions"},"Show Predictions"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Load the best model\nbackbone_combined_small = YOLO('./runs/detect/backbone_combined_small.torchscript')\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Run batched inference on a list of images\nresults = backbone_combined_small(img)  # return a list of Results objects\n\nfor r in results:\n    im_array = r.plot()  # plot a BGR numpy array of predictions\n    im = Image.fromarray(im_array[..., ::-1])  # RGB PIL image\n    im.show()  # show image\n    im.save('results.jpg')  # save image\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"0: 640x640 5 persons, 1 bike, 11 cars, 3 signs, 16.8ms\nSpeed: 8.9ms preprocess, 16.8ms inference, 1.1ms postprocess per image at shape (1, 3, 640, 640)\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(47417).Z,width:"640",height:"512"})),(0,e.kt)("h3",{id:"show-labels-1"},"Show Labels"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# get another image\nimg = cv.imread(images[1337])\nheight, width, _ = img.shape\n\n# get labels\npath = './datasets/images_combined_val/labels/' + images[1337][38:-4] + '.txt'\nlabels = open(path, 'r')\n\ndata = labels.readlines()\nlabels.close()\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"index = 0\n\nfor line in data:\n\n    # Split string to float\n    _, x, y, w, h = map(float, line.split(' '))\n    \n    l = int((x - w / 2) * width)\n    r = int((x + w / 2) * width)\n    t = int((y - h / 2) * height)\n    b = int((y + h / 2) * height)\n    \n    if l < 0:\n        l = 0\n    if r > width - 1:\n        r = width - 1\n    if t < 0:\n        t = 0\n    if b > height - 1:\n        b = height - 1\n\n    image = cv.rectangle(img, (l, t), (r, b), colours[index], thickness=2)\n    index += 1\n\nplt.title('Image with original Labels')\nplt.axis('off')\nplt.imshow(image)\nplt.show()\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(60493).Z,width:"435",height:"411"})),(0,e.kt)("h3",{id:"show-predictions-1"},"Show Predictions"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Run batched inference on a list of images\nresults = backbone_combined_small(img)  # return a list of Results objects\n\nfor r in results:\n    im_array = r.plot()  # plot a BGR numpy array of predictions\n    im = Image.fromarray(im_array[..., ::-1])  # RGB PIL image\n    im.show()  # show image\n    im.save('results.jpg')  # save image\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"0: 640x640 2 persons, 1 car, 7 trucks, 2 signs, 17.7ms\nSpeed: 12.7ms preprocess, 17.7ms inference, 1.4ms postprocess per image at shape (1, 3, 640, 640)\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(11734).Z,width:"1800",height:"1600"})),(0,e.kt)("h3",{id:"show-labels-2"},"Show Labels"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# get another image\nimg = cv.imread(images[666])\nheight, width, _ = img.shape\n\n# get labels\npath = './datasets/images_combined_val/labels/' + images[666][38:-4] + '.txt'\nlabels = open(path, 'r')\n\ndata = labels.readlines()\nlabels.close()\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"index = 0\n\nfor line in data:\n\n    # Split string to float\n    _, x, y, w, h = map(float, line.split(' '))\n    \n    l = int((x - w / 2) * width)\n    r = int((x + w / 2) * width)\n    t = int((y - h / 2) * height)\n    b = int((y + h / 2) * height)\n    \n    if l < 0:\n        l = 0\n    if r > width - 1:\n        r = width - 1\n    if t < 0:\n        t = 0\n    if b > height - 1:\n        b = height - 1\n\n    image = cv.rectangle(img, (l, t), (r, b), colours[index], thickness=2)\n    index += 1\n\nplt.title('Image with original Labels')\nplt.axis('off')\nplt.imshow(image)\nplt.show()\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(16778).Z,width:"435",height:"411"})),(0,e.kt)("h3",{id:"show-predictions-2"},"Show Predictions"),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre",className:"language-python"},"# Run batched inference on a list of images\nresults = backbone_combined_small(img)  # return a list of Results objects\n\nfor r in results:\n    im_array = r.plot()  # plot a BGR numpy array of predictions\n    im = Image.fromarray(im_array[..., ::-1])  # RGB PIL image\n    im.show()  # show image\n    im.save('results.jpg')  # save image\n")),(0,e.kt)("pre",null,(0,e.kt)("code",{parentName:"pre"},"0: 640x640 2 persons, 3 bikes, 7 cars, 1 sign, 16.9ms\nSpeed: 13.9ms preprocess, 16.9ms inference, 2.0ms postprocess per image at shape (1, 3, 640, 640)\n")),(0,e.kt)("p",null,(0,e.kt)("img",{alt:"Training the YOLOv8 Model (RGB)",src:l(29468).Z,width:"1800",height:"1600"})))}u.isMDXComponent=!0},42724:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_combined_nano_confusion_matrix_normalized-862d07c8f16e8239a12003d8042c7ffb.webp"},48535:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_combined_nano_results-0dbf1b3bbf1ada0f2465babc80ee476c.webp"},39228:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_combined_small_confusion_matrix_normalized-8ff40073ea9895f907c2c149dd816aaf.webp"},72753:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_combined_small_results-d72b565cfcbd4a09f9bd034957fe98e5.webp"},11135:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_ir_nano_confusion_matrix_normalized-5cc4000782c524957dc7d362ed4c8dd1.webp"},97926:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_ir_nano_results-d3d699d2e623e64eee71d0e86cf8ff6e.webp"},99515:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_ir_small_confusion_matrix_normalized-251435cb3ccf708191c5e23799d205aa.webp"},26133:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_ir_small_results-141a8c53c4cbf26545b5e4a8549b1b79.webp"},51657:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_rgb_nano_confusion_matrix_normalized-66158e0304362dc36a3144b4f7181871.webp"},53721:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_rgb_nano_results-5a600015b86f5eff87e279b83fef0a57.webp"},84338:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_rgb_small_confusion_matrix_normalized-c670483f5fd5c4d59bef626befe426b4.webp"},73262:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/backbone_rgb_small_results-0e8772ea24bb3db6367d29dce44d586e.webp"},95703:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_10_2-286c1cae4daaff250e32b136ea305b8a.png"},57344:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_13_1-b41dc7141bbde3c5a528a32b5859383d.png"},13e3:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_14_2-28221bf851c599903186f00281bb9df1.png"},35294:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_18_2-ecdcc39cee71e1d5e0dd396f6c16b86d.png"},800:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_21_1-085e50c2b12dccd7d72d2b781d75311b.png"},91719:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_22_2-f6232706f61634b580200645afd51bb2.png"},53386:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_26_2-2053b766a5d9dae785d58237ba40216e.png"},85016:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_27_1-fae7eb8b7c2230cd414effc8d546bf6f.png"},77286:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_29_2-3a65b249d1b903a3750bb28b996eec20.png"},10448:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_30_2-63612818c43f62f6fb22db9d6572696c.png"},24630:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_32_2-d0bcdc2a1caf347772c0ef83671fefe3.png"},38028:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_34_2-12faf5d89984aa436eea1d530626a719.png"},94473:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_36_2-2c642b8ef818c5d36896dd237b567d8d.png"},44011:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_38_2-e676685e058d3dd23571d5b0289d1112.png"},49562:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_39_1-0e53db06a791206dcb886c9108d00645.png"},57101:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_40_2-5388475efa60719c9ca27031043762ba.png"},37192:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_47_0-c0a83047cb90928efb8dc283e804a5e6.png"},47417:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_50_1-9cce9463bb811c8453377702306e0fd7.png"},63927:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_51_1-721f0f3f3ed8da31951fac7b88c3af15.png"},60493:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_53_0-79b8a8889221f283c30381b798ae4c5a.png"},11734:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_55_1-1069c6045570d2e9a9b0415dd4f08f43.png"},16778:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_58_0-198e50df39cd289729136a12ec07e51f.png"},63161:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_5_0-81cd34f42a0d8751d1dc52567fab774e.png"},29468:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_60_1-c8b7f1f7075ac8f7f254ea2c858006e6.png"},39396:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_6_0-5ff5758fd447e6cf2087b8830ac02bd9.png"},3111:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_6_2-bac58363175530630108cd09187807ea.png"},94173:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/output_9_1-2acdb1047c3c0dc07ae51a341d34c4f8.png"},16710:(t,n,l)=>{l.d(n,{Z:()=>a});const a=l.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-864be48f76a28ed6a3e155f7ab51bc74.jpg"}}]);