"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[36255],{952970:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>l,frontMatter:()=>s,metadata:()=>i,toc:()=>h});var a=r(474848),t=r(28453);const s={sidebar_position:8060,slug:"2022-01-14",title:"Zabbix v6 Apache 2 Monitor",authors:"mpolinowski",tags:["Zabbix","Linux","Apache"]},o=void 0,i={id:"DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/index",title:"Zabbix v6 Apache 2 Monitor",description:"Guangzhou, China",source:"@site/docs/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/index.md",sourceDirName:"DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor",slug:"/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/2022-01-14",permalink:"/docs/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/2022-01-14",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/index.md",tags:[{label:"Zabbix",permalink:"/docs/tags/zabbix"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"Apache",permalink:"/docs/tags/apache"}],version:"current",sidebarPosition:8060,frontMatter:{sidebar_position:8060,slug:"2022-01-14",title:"Zabbix v6 Apache 2 Monitor",authors:"mpolinowski",tags:["Zabbix","Linux","Apache"]},sidebar:"tutorialSidebar",previous:{title:"Zabbix v6 Docker Monitor",permalink:"/docs/DevOps/Zabbix/2022-01-14--zabbix-docker-monitor/2022-01-14"},next:{title:"Zabbix v6 Docker-Compose Setup",permalink:"/docs/DevOps/Zabbix/2022-01-13--zabbix-server-v6/2022-01-13"}},c={},h=[{value:"Apache Module mod_status",id:"apache-module-mod_status",level:2},{value:"Configure Zabbix Agent",id:"configure-zabbix-agent",level:2},{value:"ERROR :: Apache Process is not running",id:"error--apache-process-is-not-running",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Guangzhou, China",src:r(229432).A+"",width:"1500",height:"467"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#apache-module-mod_status",children:"Apache Module mod_status"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#configure-zabbix-agent",children:"Configure Zabbix Agent"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#error--apache-process-is-not-running",children:"ERROR :: Apache Process is not running"})}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"apache-module-mod_status",children:"Apache Module mod_status"}),"\n",(0,a.jsxs)(n.p,{children:["Activate the ",(0,a.jsx)(n.strong,{children:"Server Status"})," module:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo a2enmod status\n"})}),"\n",(0,a.jsx)(n.p,{children:"And add the configuration to:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cp /etc/apache2/mods-available/status.conf /etc/apache2/mods-available/status.conf.bak\r\nnano /etc/apache2/mods-available/status.conf\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"https://httpd.apache.org/docs/2.4/mod/mod_status.html",children:"Enabling Status Support"})," for the host you want to monitor:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-html",children:'<IfModule mod_status.c>\r\n        # Allow server status reports generated by mod_status,\r\n        # with the URL of http://servername/server-status\r\n        # Uncomment and change the "192.0.2.0/24" to allow access from other hosts.\r\n\r\n        <Location /server-status>\r\n                SetHandler server-status\r\n\r\n                ##Allow all IPs to access for testing\r\n                #Allow from all\r\n\r\n                ##Allow only localhost and local server IP\r\n                Order deny,allow\r\n                Deny from all\r\n                Allow from 127.0.0.1 ::1\r\n                #Allow from Your.Server.IP.Address.Here\r\n\r\n                ##Limit access from other hosts\r\n                #Require local\r\n                #Require ip 192.0.2.0/24\r\n                #Require host example.com\r\n        </Location>\r\n\r\n        # Keep track of extended status information for each request\r\n        ExtendedStatus On\r\n\r\n        # Determine if mod_status displays the first 63 characters of a request or\r\n        # the last 63, assuming the request itself is greater than 63 chars.\r\n        # Default: Off\r\n        #SeeRequestTail On\r\n        <IfModule mod_proxy.c>\r\n                # Show Proxy LoadBalancer status in mod_status\r\n                ProxyStatus On\r\n        </IfModule>\r\n</IfModule>\n'})}),"\n",(0,a.jsx)(n.p,{children:"Check config integrity and restart:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"apachectl configtest\r\napache2 -t # or httpd -t\r\nsystemctl restart apache2 # or httpd\n"})}),"\n",(0,a.jsx)(n.p,{children:"Or all in one line:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"apache2ctl -t && apache2ctl graceful\n"})}),"\n",(0,a.jsx)(n.p,{children:"Test the status output by:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"curl http://127.0.0.1/server-status?auto\r\n127.0.0.1\r\nServerVersion: Apache/2.4.25 (Debian) OpenSSL/1.0.2q\r\nServerMPM: prefork\r\nServer Built: 2018-11-03T18:46:19\r\nCurrentTime: Tuesday, 09-Nov-2021 07:24:39 CET\r\nRestartTime: Tuesday, 09-Nov-2021 06:44:31 CET\r\nParentServerConfigGeneration: 1\r\nParentServerMPMGeneration: 0\r\nServerUptimeSeconds: 2408\r\nServerUptime: 40 minutes 8 seconds\r\nLoad1: 0.07\r\nLoad5: 0.24\r\nLoad15: 0.53\r\nTotal Accesses: 319\r\nTotal kBytes: 1554\r\nCPUUser: 5.52\r\nCPUSystem: 2.06\r\nCPUChildrenUser: 0\r\nCPUChildrenSystem: 0\r\nCPULoad: .314784\r\nUptime: 2408\r\nReqPerSec: .132475\r\nBytesPerSec: 660.837\r\nBytesPerReq: 4988.39\r\nBusyWorkers: 2\r\nIdleWorkers: 8\r\nScoreboard: _W____W___............................................................................................................................................\r\nTLSSessionCacheStatus\r\nCacheType: SHMCB\r\nCacheSharedMemory: 512000\r\nCacheCurrentEntries: 35\r\nCacheSubcaches: 32\r\nCacheIndexesPerSubcaches: 88\r\nCacheTimeLeftOldestAvg: 123\r\nCacheTimeLeftOldestMin: 0\r\nCacheTimeLeftOldestMax: 262\r\nCacheIndexUsage: 1%\r\nCacheUsage: 1%\r\nCacheStoreCount: 279\r\nCacheReplaceCount: 0\r\nCacheExpireCount: 244\r\nCacheDiscardCount: 0\r\nCacheRetrieveHitCount: 0\r\nCacheRetrieveMissCount: 38\r\nCacheRemoveHitCount: 0\r\nCacheRemoveMissCount: 0\n"})}),"\n",(0,a.jsx)(n.h2,{id:"configure-zabbix-agent",children:"Configure Zabbix Agent"}),"\n",(0,a.jsxs)(n.p,{children:["Stat by adding the ",(0,a.jsx)(n.strong,{children:"Apache by Zabbix Agent"})," template:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Zabbix Apache Monitor",src:r(168493).A+"",width:"1040",height:"397"})}),"\n",(0,a.jsxs)(n.p,{children:["Make sure that the server is set to ",(0,a.jsx)(n.code,{children:"127.0.0.1"})," and save the configuration:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Zabbix Apache Monitor",src:r(555903).A+"",width:"1033",height:"607"})}),"\n",(0,a.jsx)(n.p,{children:"Check latest data to see if your agent is working:"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Zabbix Apache Monitor",src:r(777814).A+"",width:"1242",height:"393"})}),"\n",(0,a.jsx)(n.h2,{id:"error--apache-process-is-not-running",children:"ERROR :: Apache Process is not running"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Zabbix Apache Monitor",src:r(697248).A+"",width:"1058",height:"90"})}),"\n",(0,a.jsxs)(n.p,{children:["The process name is set to ",(0,a.jsx)(n.code,{children:"httpd"})," by default - which is correct for Apache on CentOS. But has to be changed to ",(0,a.jsx)(n.code,{children:"apache2"})," for Debian:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Zabbix Apache Monitor",src:r(152073).A+"",width:"1203",height:"224"})})]})}function l(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},168493:(e,n,r)=>{r.d(n,{A:()=>a});const a=r.p+"assets/images/Zabbix_v6_Apache_Monitor_01-5015944f27e6f83af010faa1a1863199.png"},777814:(e,n,r)=>{r.d(n,{A:()=>a});const a=r.p+"assets/images/Zabbix_v6_Apache_Monitor_02-2bc1023ccecdfa7f5dfde76bc42fc034.png"},555903:(e,n,r)=>{r.d(n,{A:()=>a});const a=r.p+"assets/images/Zabbix_v6_Apache_Monitor_03-fdf020942fd10ce902106488c37004cd.png"},697248:(e,n,r)=>{r.d(n,{A:()=>a});const a=r.p+"assets/images/Zabbix_v6_Apache_Monitor_04-4eb8f75b8869aaf3d660f3b18916b6bf.png"},152073:(e,n,r)=>{r.d(n,{A:()=>a});const a=r.p+"assets/images/Zabbix_v6_Apache_Monitor_05-321aad164b1c13b21462a29890d9b9f7.png"},229432:(e,n,r)=>{r.d(n,{A:()=>a});const a=r.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-539dc0d90c8fd4caf3d5cd5162b8ded5.jpg"},28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>i});var a=r(296540);const t={},s=a.createContext(t);function o(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);