"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[95875],{788393:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var s=n(474848),r=n(28453);const o={sidebar_position:6990,slug:"2022-12-15",title:"Convert RTSP to HLS using FFmpeg",authors:"mpolinowski",tags:["LINUX"],description:"INSTAR IP Camera RTSP Stream to HLS with FFMPEG"},a=void 0,i={id:"Automation_and_Robotics/Home_Automation/2022-12-15--rtsp-to-hls-ffmpeg/index",title:"Convert RTSP to HLS using FFmpeg",description:"INSTAR IP Camera RTSP Stream to HLS with FFMPEG",source:"@site/docs/Automation_and_Robotics/Home_Automation/2022-12-15--rtsp-to-hls-ffmpeg/index.md",sourceDirName:"Automation_and_Robotics/Home_Automation/2022-12-15--rtsp-to-hls-ffmpeg",slug:"/Automation_and_Robotics/Home_Automation/2022-12-15--rtsp-to-hls-ffmpeg/2022-12-15",permalink:"/docs/Automation_and_Robotics/Home_Automation/2022-12-15--rtsp-to-hls-ffmpeg/2022-12-15",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Automation_and_Robotics/Home_Automation/2022-12-15--rtsp-to-hls-ffmpeg/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"}],version:"current",sidebarPosition:6990,frontMatter:{sidebar_position:6990,slug:"2022-12-15",title:"Convert RTSP to HLS using FFmpeg",authors:"mpolinowski",tags:["LINUX"],description:"INSTAR IP Camera RTSP Stream to HLS with FFMPEG"},sidebar:"tutorialSidebar",previous:{title:"Run Camera.UI with Docker-Compose",permalink:"/docs/Automation_and_Robotics/Home_Automation/2022-10-18-camera-ui-docker/2022-10-18"},next:{title:"Grafana IoT Dashboard",permalink:"/docs/Automation_and_Robotics/Home_Automation/2022-12-22--grafana-for-iot/2022-12-22"}},l={},d=[{value:"Convert RTSP to HLS using FFmpeg",id:"convert-rtsp-to-hls-using-ffmpeg",level:2}];function m(e){const t={a:"a",code:"code",em:"em",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"TST, Hong Kong",src:n(342847).A+"",width:"1500",height:"517"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"#convert-rtsp-to-hls-using-ffmpeg",children:"Convert RTSP to HLS using FFmpeg"})}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"convert-rtsp-to-hls-using-ffmpeg",children:"Convert RTSP to HLS using FFmpeg"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://www.ffmpeg.org/ffmpeg-formats.html#hls-1",children:"FFmpeg supports"})," convert the RTSP streaming to HLS ",(0,s.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/HTTP_Live_Streaming",children:"HTTP Live Streaming"}),". Based on standard HTTP transactions, HTTP Live Streaming can traverse any firewall or proxy server that lets through standard HTTP traffic, unlike UDP-based protocols such as RTP. This also allows content to be offered from conventional HTTP servers."]}),"\n",(0,s.jsxs)(t.p,{children:["Start by creating a file ",(0,s.jsx)(t.code,{children:"index.html"})," and embed the soon to be created stream:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-html",children:'<!DOCTYPE html>\r\n<html lang="en">\r\n  <head>\r\n    <meta charset="utf-8">\r\n    <title>HLS Stream</title>\r\n  </head>\r\n  <body>\r\n    <video id="video" autoplay="true" controls="controls">\r\n      <source src="/stream/index.m3u8" type="application/x-mpegURL" />\r\n      Your browser does not support HTML5 streaming!\r\n    </video>\r\n  </body>\r\n</html>\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Create the ",(0,s.jsx)(t.code,{children:"stream"})," folder ",(0,s.jsx)(t.code,{children:"mkdir stream"}),", install FFMPEG, e.g. ",(0,s.jsx)(t.code,{children:"apt install ffmpeg"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"ffmpeg -version\r\nffmpeg version n5.1.2 Copyright (c) 2000-2022 the FFmpeg developers\n"})}),"\n",(0,s.jsxs)(t.p,{children:["and for an ",(0,s.jsx)(t.a,{href:"https://wiki.instar.com/en/Outdoor_Cameras/IN-9408_WQHD/Video_Streaming/",children:"IP camera stream"}),":"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"INSTAR 2k+ WQHD Cameras"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"rtsp://admin:instar@192.168.2.120:554/livestream/12\n"})}),"\n",(0,s.jsx)(t.p,{children:"run the following command:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"ffmpeg -fflags nobuffer \\\r\n -loglevel debug \\\r\n -rtsp_transport tcp \\\r\n -i rtsp://admin:instar@192.168.2.120:554/livestream/11 \\\r\n -vsync 0 \\\r\n -copyts \\\r\n -vcodec copy \\\r\n -movflags frag_keyframe+empty_moov \\\r\n -an \\\r\n -hls_flags delete_segments+append_list \\\r\n -f hls \\\r\n -hls_time 1 \\\r\n -hls_list_size 3 \\\r\n -hls_segment_type mpegts \\\r\n -hls_segment_filename './stream/%d.ts' \\\r\n./stream/index.m3u8\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"INSTAR Full HD Cameras"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"ffmpeg -fflags nobuffer \\\r\n -loglevel debug \\\r\n -rtsp_transport tcp \\\r\n -i rtsp://admin:instar@192.168.2.31:554/11 \\\r\n -vsync 0 \\\r\n -copyts \\\r\n -vcodec copy \\\r\n -movflags frag_keyframe+empty_moov \\\r\n -an \\\r\n -hls_flags delete_segments+append_list \\\r\n -f hls \\\r\n -hls_time 1 \\\r\n -hls_list_size 3 \\\r\n -hls_segment_type mpegts \\\r\n -hls_segment_filename './stream/%d.ts' \\\r\n./stream/index.m3u8\n"})}),"\n",(0,s.jsxs)(t.p,{children:["By starting a web server on port ",(0,s.jsx)(t.code,{children:"3000"})," on a PC with the local IP ",(0,s.jsx)(t.code,{children:"192.168.2.112"})," the stream will now be served on the path ",(0,s.jsx)(t.code,{children:"http://192.168.2.112:3000/stream/index.m3u8"}),". You can test the stream using ",(0,s.jsx)(t.code,{children:"ffplay"}),":"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"RTSP to HLS with FFMPEG",src:n(22276).A+"",width:"1566",height:"554"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"})," that the Content-Type: ",(0,s.jsx)(t.code,{children:"audio/x-mpegurl"})," is not supported on desktop systems - I had to use Google Chrome on Android to display the video embedded in the HTML file:"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"RTSP to HLS with FFMPEG",src:n(983503).A+"",width:"1536",height:"985"})})]})}function c(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},342847:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-ec671595d585b88a85b017a7908fb619.jpg"},22276:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/rtsp-to-hls-ffmpeg_01-6c63935fc3f9b8c602aa484e1800c502.png"},983503:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/rtsp-to-hls-ffmpeg_02-b96c70ca1111183745af53a5eed4de28.jpg"},28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>i});var s=n(296540);const r={},o=s.createContext(r);function a(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);