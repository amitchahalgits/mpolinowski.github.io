"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[30878],{358648:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>c});var r=n(785893),i=n(603905);const t={sidebar_position:4290,slug:"2023-08-02",title:"Tensorflow Image Classifier - Data Pre-processing",authors:"mpolinowski",tags:["Python","Machine Learning"],description:"Blue print image classifier using Tensorflow and Keras Applications pre-trained models"},o="Tf Image Classifier",s={id:"IoT-and-Machine-Learning/ML/2023-08-02-tensorflow-i-know-flowers-preprocessing/index",title:"Tensorflow Image Classifier - Data Pre-processing",description:"Blue print image classifier using Tensorflow and Keras Applications pre-trained models",source:"@site/docs/IoT-and-Machine-Learning/ML/2023-08-02-tensorflow-i-know-flowers-preprocessing/index.md",sourceDirName:"IoT-and-Machine-Learning/ML/2023-08-02-tensorflow-i-know-flowers-preprocessing",slug:"/IoT-and-Machine-Learning/ML/2023-08-02-tensorflow-i-know-flowers-preprocessing/2023-08-02",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-08-02-tensorflow-i-know-flowers-preprocessing/2023-08-02",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2023-08-02-tensorflow-i-know-flowers-preprocessing/index.md",tags:[{label:"Python",permalink:"/docs/tags/python"},{label:"Machine Learning",permalink:"/docs/tags/machine-learning"}],version:"current",sidebarPosition:4290,frontMatter:{sidebar_position:4290,slug:"2023-08-02",title:"Tensorflow Image Classifier - Data Pre-processing",authors:"mpolinowski",tags:["Python","Machine Learning"],description:"Blue print image classifier using Tensorflow and Keras Applications pre-trained models"},sidebar:"tutorialSidebar",previous:{title:"Tensorflow Image Classifier - Data-efficient Image Transformers",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-08-03-tensorflow-i-know-flowers-deit/2023-08-03"},next:{title:"Tensorflow Image Classifier - Introduction",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-08-01-tensorflow-i-know-flowers-intro/2023-08-01"}},l={},c=[{value:"Image Dataset Preparation",id:"image-dataset-preparation",level:2},{value:"Get Image Dataset from Local Directory",id:"get-image-dataset-from-local-directory",level:2},{value:"Resize to 224,224,3",id:"resize-to-2242243",level:3},{value:"Train Test Split",id:"train-test-split",level:3}];function d(e){const a={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.ah)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"Angkor Wat, Cambodia",src:n(940309).Z+"",width:"1500",height:"706"})}),"\n",(0,r.jsx)(a.h1,{id:"tf-image-classifier",children:"Tf Image Classifier"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:(0,r.jsx)(a.a,{href:"https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2023-08-01-tensorflow-i-know-flowers-intro/2023-08-01",children:"Overview - Model Evaluation & Deployment"})}),"\n"]}),"\n",(0,r.jsx)(a.h2,{id:"image-dataset-preparation",children:"Image Dataset Preparation"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"from glob import glob\nimport matplotlib.pyplot as plt\nimport os\nfrom skimage import (\n    io,\n    color,\n    exposure,\n    transform,\n    feature\n)\nfrom sklearn.model_selection import train_test_split\nimport splitfolders # pip install split-folders\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"SEED = 42\n"})}),"\n",(0,r.jsx)(a.h2,{id:"get-image-dataset-from-local-directory",children:"Get Image Dataset from Local Directory"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"data_dir = os.listdir('../dataset/Flower_Dataset/complete')\nprint(data_dir)\n# ['Gladiolus', 'Adenium', 'Alpinia_Purpurata', 'Alstroemeria', 'Amaryllis', 'Anthurium_Andraeanum', 'Antirrhinum', 'Aquilegia', 'Billbergia_Pyramidalis', 'Cattleya', 'Cirsium', 'Coccinia_Grandis', 'Crocus', 'Cyclamen', 'Dahlia', 'Datura_Metel', 'Dianthus_Barbatus', 'Digitalis', 'Echinacea_Purpurea', 'Echinops_Bannaticus', 'Fritillaria_Meleagris', 'Gaura', 'Gazania', 'Gerbera', 'Guzmania', 'Helianthus_Annuus', 'Iris_Pseudacorus', 'Leucanthemum', 'Malvaceae', 'Narcissus_Pseudonarcissus', 'Nerine', 'Nymphaea_Tetragona', 'Paphiopedilum', 'Passiflora', 'Pelargonium', 'Petunia', 'Platycodon_Grandiflorus', 'Plumeria', 'Poinsettia', 'Primula', 'Protea_Cynaroides', 'Rose', 'Rudbeckia', 'Strelitzia_Reginae', 'Tropaeolum_Majus', 'Tussilago', 'Viola', 'Zantedeschia_Aethiopica']\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"glob('../dataset/Flower_Dataset/complete/{}/*.jpg'.format('Viola'))\n\n# ['../dataset/Flower_Dataset/complete/Viola/Viola_185.jpg',\n#  '../dataset/Flower_Dataset/complete/Viola/Viola_186.jpg',\n#  '../dataset/Flower_Dataset/complete/Viola/Viola_187.jpg',\n#  ...\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"all_files = []\nfor subfolder in data_dir:\n    all_files += glob('../dataset/Flower_Dataset/complete/{}/*.jpg'.format(subfolder))\n    \nlen(all_files)\n# 12278\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"data_collection = io.ImageCollection(all_files)\ndata_collection.files\n"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"len(data_collection)\n"})}),"\n",(0,r.jsx)(a.h3,{id:"resize-to-2242243",children:"Resize to 224,224,3"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"c = 0\n\nfor image in data_collection:\n    # print(data_collection.files[c]) # debug file read errors\n    img_ori = io.imread(data_collection.files[c], as_gray=False)\n    img_thumb = transform.resize(img_ori, output_shape=(224, 224, 3), anti_aliasing=True)\n    plt.imsave(data_collection.files[c], img_thumb)\n    c = c + 1\n"})}),"\n",(0,r.jsx)(a.h3,{id:"train-test-split",children:"Train Test Split"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:'input_folder = "../dataset/Flower_Dataset/complete"\noutput_folder = "../dataset/Flower_Dataset/split"\n\nsplitfolders.ratio(input_folder, output=output_folder, seed=SEED, ratio=(.75, .25))\n'})})]})}function p(e={}){const{wrapper:a}={...(0,i.ah)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},603905:(e,a,n)=>{n.d(a,{ah:()=>c});var r=n(667294);function i(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function t(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?t(Object(n),!0).forEach((function(a){i(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function s(e,a){if(null==e)return{};var n,r,i=function(e,a){if(null==e)return{};var n,r,i={},t=Object.keys(e);for(r=0;r<t.length;r++)n=t[r],a.indexOf(n)>=0||(i[n]=e[n]);return i}(e,a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(r=0;r<t.length;r++)n=t[r],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),c=function(e){var a=r.useContext(l),n=a;return e&&(n="function"==typeof e?e(a):o(o({},a),e)),n},d={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},p=r.forwardRef((function(e,a){var n=e.components,i=e.mdxType,t=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=i,g=u["".concat(l,".").concat(m)]||u[m]||d[m]||t;return n?r.createElement(g,o(o({ref:a},p),{},{components:n})):r.createElement(g,o({ref:a},p))}));p.displayName="MDXCreateElement"},940309:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-4b4c922f390788acb724c3c274da1ef9.jpg"}}]);