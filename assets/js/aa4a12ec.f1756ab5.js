"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[66864],{657752:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var r=t(785893),s=t(603905);const i={sidebar_position:4730,slug:"2023-02-15",title:"YOLOv8 with AS-One",authors:"mpolinowski",tags:["Python","Machine Learning","YOLO","Torch"],description:"A Modular Libary for YOLO Object Detection and Object Tracking."},c=void 0,a={id:"IoT-and-Machine-Learning/ML/2023-02-15-as-one-yolo-object-tracking/index",title:"YOLOv8 with AS-One",description:"A Modular Libary for YOLO Object Detection and Object Tracking.",source:"@site/docs/IoT-and-Machine-Learning/ML/2023-02-15-as-one-yolo-object-tracking/index.md",sourceDirName:"IoT-and-Machine-Learning/ML/2023-02-15-as-one-yolo-object-tracking",slug:"/IoT-and-Machine-Learning/ML/2023-02-15-as-one-yolo-object-tracking/2023-02-15",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-02-15-as-one-yolo-object-tracking/2023-02-15",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2023-02-15-as-one-yolo-object-tracking/index.md",tags:[{label:"Python",permalink:"/docs/tags/python"},{label:"Machine Learning",permalink:"/docs/tags/machine-learning"},{label:"YOLO",permalink:"/docs/tags/yolo"},{label:"Torch",permalink:"/docs/tags/torch"}],version:"current",sidebarPosition:4730,frontMatter:{sidebar_position:4730,slug:"2023-02-15",title:"YOLOv8 with AS-One",authors:"mpolinowski",tags:["Python","Machine Learning","YOLO","Torch"],description:"A Modular Libary for YOLO Object Detection and Object Tracking."},sidebar:"tutorialSidebar",previous:{title:"Keras for Tensorflow - Artificial Neural Networks",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-02-16-keras-introduction-ann/2023-02-16"},next:{title:"Keras for Tensorflow - An (Re)Introduction 2023",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-02-14-keras-introduction/2023-02-14"}},l={},d=[{value:"AS-One and YOLOv8",id:"as-one-and-yolov8",level:2},{value:"Installation",id:"installation",level:3},{value:"Running AS-One",id:"running-as-one",level:2},{value:"Trackers",id:"trackers",level:3},{value:"DeepSort",id:"deepsort",level:4},{value:"ByteTrack",id:"bytetrack",level:4},{value:"NorFair",id:"norfair",level:4},{value:"Detectors (Excerpt)",id:"detectors-excerpt",level:3},{value:"YOLOv8",id:"yolov8",level:4}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.ah)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Mongkok, HongKong",src:t(554200).Z+"",width:"2385",height:"1164"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#as-one-and-yolov8",children:"AS-One and YOLOv8"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#installation",children:"Installation"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#running-as-one",children:"Running AS-One"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#trackers",children:"Trackers"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#deepsort",children:"DeepSort"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#bytetrack",children:"ByteTrack"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#norfair",children:"NorFair"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#detectors-excerpt",children:"Detectors (Excerpt)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#yolov8",children:"YOLOv8"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/augmentedstartups/AS-One",children:"AS-One"})," is a python wrapper for multiple detection and tracking algorithms all at one place. Different trackers such as ByteTrack, DeepSort or NorFair can be integrated with different versions of YOLO with minimum lines of code. This python wrapper provides YOLO models in both ONNX and PyTorch versions."]}),"\n",(0,r.jsx)(n.h2,{id:"as-one-and-yolov8",children:"AS-One and YOLOv8"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/augmentedstartups/AS-One.git /run/media/xiaodie/dev/as-one-yolov8/\ncd as-one-yolov8\n"})}),"\n",(0,r.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.p,{children:"You can install the dependencies in a virtual environment - if you wish:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"python3 -m venv .env\nsource .env/bin/activate\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip install numpy Cython\npip install cython-bbox\npip install asone\n"})}),"\n",(0,r.jsx)(n.p,{children:"YOLO is build on PyTorch that needs to be installed with our without GPU support:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# for CPU\npip install torch torchvision\n# for GPU\npip install torch torchvision --extra-index-url https://download.pytorch.org/whl/cu113\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip show numpy Cython cython-bbox asone torch torchvision\nName: numpy\nVersion: 1.23.3\n---\nName: Cython\nVersion: 0.29.33\n---\nName: cython-bbox\nVersion: 0.1.3\n---\nName: asone\nVersion: 0.1.2.dev17\n---\nName: torch\nVersion: 1.13.1\n---\nName: torchvision\nVersion: 0.14.1\n"})}),"\n",(0,r.jsx)(n.h2,{id:"running-as-one",children:"Running AS-One"}),"\n",(0,r.jsxs)(n.p,{children:["If you run ",(0,r.jsx)(n.code,{children:"main.py"})," to test tracker on the ",(0,r.jsx)(n.code,{children:"data/sample_videos/test.mp4"})," video:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"python main.py data/sample_videos/test.mp4\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The test code uses ",(0,r.jsx)(n.strong,{children:"YOLOv7"})," and ",(0,r.jsx)(n.strong,{children:"Bytetrack"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:"dt_obj = ASOne(\n      tracker=asone.BYTETRACK,\n      detector=asone.YOLOV7_PYTORCH,\n      weights=args.weights,\n      use_cuda=args.use_cuda\n    )\n"})}),"\n",(0,r.jsx)(n.p,{children:"and starts tracking and counting cars in the test video:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"AS-One with YOLOv8 Introduction",src:t(786386).Z+"",width:"1280",height:"798"})}),"\n",(0,r.jsxs)(n.p,{children:["We can change the detector and tracker that is being used with anyone from ",(0,r.jsx)(n.a,{href:"https://github.com/augmentedstartups/AS-One/blob/main/asone/linux/Instructions/Benchmarking.md",children:"this list"}),":"]}),"\n",(0,r.jsx)(n.h3,{id:"trackers",children:"Trackers"}),"\n",(0,r.jsx)(n.h4,{id:"deepsort",children:"DeepSort"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Model"}),(0,r.jsx)(n.th,{children:"Model Flag"}),(0,r.jsx)(n.th,{children:"FPS-GPU"}),(0,r.jsx)(n.th,{children:"FPS-CPU"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"DeepSort-ONNX-Yolov5s"}),(0,r.jsx)(n.td,{children:"DEEPSORT"}),(0,r.jsx)(n.td,{children:"13"}),(0,r.jsx)(n.td,{children:"3.2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"DeepSort-Pytorch-Yolov5s"}),(0,r.jsx)(n.td,{children:"DEEPSORT"}),(0,r.jsx)(n.td,{children:"13"}),(0,r.jsx)(n.td,{children:"3.2"})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"bytetrack",children:"ByteTrack"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Model"}),(0,r.jsx)(n.th,{children:"Model Flag"}),(0,r.jsx)(n.th,{children:"FPS-GPU"}),(0,r.jsx)(n.th,{children:"FPS-CPU"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ByteTrack-ONNX-YOLOv5s"}),(0,r.jsx)(n.td,{children:"BYTETRACK"}),(0,r.jsx)(n.td,{children:"33.7"}),(0,r.jsx)(n.td,{children:"17.4"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ByteTrack-Pytorch-Sample-YOLOv5s"}),(0,r.jsx)(n.td,{children:"BYTETRACK"}),(0,r.jsx)(n.td,{children:"33.7"}),(0,r.jsx)(n.td,{children:"17.4"})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"norfair",children:"NorFair"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Model"}),(0,r.jsx)(n.th,{children:"Model Flag"}),(0,r.jsx)(n.th,{children:"FPS-GPU"}),(0,r.jsx)(n.th,{children:"FPS-CPU"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"tryolab-ONNX-YOLOv5s"}),(0,r.jsx)(n.td,{children:"NORFAIR"}),(0,r.jsx)(n.td,{children:"25.8"}),(0,r.jsx)(n.td,{children:"12"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"tryolab-Pytorch-YOLOv5s"}),(0,r.jsx)(n.td,{children:"NORFAIR"}),(0,r.jsx)(n.td,{children:"25.8"}),(0,r.jsx)(n.td,{children:"12"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"detectors-excerpt",children:"Detectors (Excerpt)"}),"\n",(0,r.jsx)(n.h4,{id:"yolov8",children:"YOLOv8"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Pytorch"}),(0,r.jsx)(n.th,{style:{textAlign:"center"}}),(0,r.jsx)(n.th,{style:{textAlign:"center"}})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"Model Name / Model Flag"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"FPS-GPU"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"FPS-CPU"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"YOLOV8N_PYTORCH"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"26.7"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"17.0"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"YOLOV8S_PYTORCH"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"26.4"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"12.3"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"YOLOV8M_PYTORCH"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"25.1"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"6.8"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"YOLOV8L_PYTORCH"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"23.6"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"4.0"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"YOLOV8X_PYTORCH"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"20.7"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"2.8"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["So to change to ",(0,r.jsx)(n.strong,{children:"YOLOv8"})," we just have to replace it here ",(0,r.jsx)(n.code,{children:"main.py"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:"dt_obj = ASOne(\n      tracker=asone.BYTETRACK,\n      detector=asone.YOLOV8M_PYTORCH,\n      weights=args.weights,\n      use_cuda=args.use_cuda\n    )\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"python main.py data/sample_videos/video2.mp4\n"})}),"\n",(0,r.jsx)(n.p,{children:"And this time we are running YOLOv8:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"AS-One with YOLOv8 Introduction",src:t(458149).Z+"",width:"1277",height:"801"})}),"\n",(0,r.jsxs)(n.p,{children:["The tracking function in ",(0,r.jsx)(n.code,{children:"main.py"})," also gives us a few more options - for example to draw trails on tracked moving objects:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:"track_fn = dt_obj.track_video(args.video_path,\n        output_dir=args.output_dir,\n        conf_thres=args.conf_thres,\n        iou_thres=args.iou_thres,\n        display=args.display,\n        draw_trails=args.draw_trails,\n        filter_classes=filter_classes,\n        class_names=None) # class_names=['License Plate'] for custom weights\n"})}),"\n",(0,r.jsx)(n.p,{children:"Which we can set to true by adding the argument:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"python main.py data/sample_videos/video2.mp4 --draw_trails\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"AS-One with YOLOv8 Introduction",src:t(40262).Z+"",width:"1275",height:"799"})})]})}function h(e={}){const{wrapper:n}={...(0,s.ah)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},603905:(e,n,t)=>{t.d(n,{ah:()=>d});var r=t(667294);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var l=r.createContext({}),d=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},o={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},h=r.forwardRef((function(e,n){var t=e.components,s=e.mdxType,i=e.originalType,l=e.parentName,h=a(e,["components","mdxType","originalType","parentName"]),x=d(t),j=s,p=x["".concat(l,".").concat(j)]||x[j]||o[j]||i;return t?r.createElement(p,c(c({ref:n},h),{},{components:t})):r.createElement(p,c({ref:n},h))}));h.displayName="MDXCreateElement"},786386:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/AS-ONE-YOLOv8_01-750d6ef83c3ea058ae58c61438edd0a2.png"},458149:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/AS-ONE-YOLOv8_02-abac9c621e659c7d337f689fe43d040e.png"},40262:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/AS-ONE-YOLOv8_03-196f5482b3d2df82aaca5038729fed18.png"},554200:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-0236af0e3799917b597bf7448ef0042c.jpg"}}]);