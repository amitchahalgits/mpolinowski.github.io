"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[78677],{467487:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>s,default:()=>h,frontMatter:()=>d,metadata:()=>o,toc:()=>l});var i=n(474848),a=n(28453);const d={sidebar_position:9070,slug:"2018-11-12",title:"Using SQLite with Node-RED on Windows",authors:"mpolinowski",tags:["Windows","Node-RED","IoT","Databases","SQLite"]},s=void 0,o={id:"Automation_and_Robotics/Home_Automation/2018-11-12--nodered-sqlite/index",title:"Using SQLite with Node-RED on Windows",description:"Pokhara, Nepal",source:"@site/docs/Automation_and_Robotics/Home_Automation/2018-11-12--nodered-sqlite/index.mdx",sourceDirName:"Automation_and_Robotics/Home_Automation/2018-11-12--nodered-sqlite",slug:"/Automation_and_Robotics/Home_Automation/2018-11-12--nodered-sqlite/2018-11-12",permalink:"/docs/Automation_and_Robotics/Home_Automation/2018-11-12--nodered-sqlite/2018-11-12",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Automation_and_Robotics/Home_Automation/2018-11-12--nodered-sqlite/index.mdx",tags:[{label:"Windows",permalink:"/docs/tags/windows"},{label:"Node-RED",permalink:"/docs/tags/node-red"},{label:"IoT",permalink:"/docs/tags/io-t"},{label:"Databases",permalink:"/docs/tags/databases"},{label:"SQLite",permalink:"/docs/tags/sq-lite"}],version:"current",sidebarPosition:9070,frontMatter:{sidebar_position:9070,slug:"2018-11-12",title:"Using SQLite with Node-RED on Windows",authors:"mpolinowski",tags:["Windows","Node-RED","IoT","Databases","SQLite"]},sidebar:"tutorialSidebar",previous:{title:"Node-RED with IFTTT",permalink:"/docs/Automation_and_Robotics/Home_Automation/2018-11-13--nodered-ifttt/2018-11-13"},next:{title:"Creating a Dashboard displaying Cryptocurrency Data using Node-RED",permalink:"/docs/Automation_and_Robotics/Home_Automation/2018-11-05--nodered-cryptocurrency-dashboard/2018-11-05"}},r={},l=[{value:"Installing SQLite",id:"installing-sqlite",level:2},{value:"Creating your first Database",id:"creating-your-first-database",level:3},{value:"Installing SQLite in Node-RED",id:"installing-sqlite-in-node-red",level:2},{value:"INSERT inject node",id:"insert-inject-node",level:3},{value:"SELECT inject node with",id:"select-inject-node-with",level:3},{value:"DELETE inject node as follows",id:"delete-inject-node-as-follows",level:3},{value:"DROP inject node",id:"drop-inject-node",level:3},{value:"Visualizing Data from SQLite in Node-RED Dashboard",id:"visualizing-data-from-sqlite-in-node-red-dashboard",level:2},{value:"Database Administration",id:"database-administration",level:2},{value:"Flow Export",id:"flow-export",level:2}];function c(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Pokhara, Nepal",src:n(679055).A+"",width:"1500",height:"514"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"#installing-sqlite",children:"Installing SQLite"}),", ",(0,i.jsx)(t.a,{href:"#creating-your-first-database",children:"Creating your first Database"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"#installing-sqlite-in-node-red",children:"Installing SQLite in Node-RED"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"#insert-inject-node",children:"INSERT inject node"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"#select-inject-node-with",children:"SELECT inject node with"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"#delete-inject-node-as-follows",children:"DELETE inject node as follows"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"#drop-inject-node",children:"DROP inject node"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"#visualizing-data-from-sqlite-in-node-red-dashboard",children:"Visualizing Data from SQLite in Node-RED Dashboard"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"#database-administration",children:"Database Administration"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"#flow-export",children:"Flow Export"})}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"installing-sqlite",children:"Installing SQLite"}),"\n",(0,i.jsxs)(t.p,{children:["First scroll down to the newest pre-compiled version for your Operating System ",(0,i.jsx)(t.a,{href:"https://www.sqlite.org/download.html",children:"here"})," and choose the bundle of command-line tools for managing SQLite database files, including the command-line shell program, the sqldiff.exe program, and the sqlite3_analyzer.exe program."]}),"\n",(0,i.jsxs)(t.p,{children:["Unzip the folder, rename it something short - e.g. sqlite3 - and copy it to your C:\\ partition. Now add the installation path to your system variables and run the ",(0,i.jsx)(t.strong,{children:"sqlite3"})," command to see that it is working:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(817758).A+"",width:"950",height:"604"})}),"\n",(0,i.jsxs)(t.p,{children:["To exit the SQLite Shell again, type ",(0,i.jsx)(t.code,{children:".quit"})]}),"\n",(0,i.jsx)(t.h3,{id:"creating-your-first-database",children:"Creating your first Database"}),"\n",(0,i.jsxs)(t.p,{children:["Navigate to the directory you want to store your data and type ",(0,i.jsx)(t.code,{children:"sqlite3 mydb.db"})," and ",(0,i.jsx)(t.code,{children:".databases"}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(985109).A+"",width:"950",height:"329"})}),"\n",(0,i.jsxs)(t.p,{children:["To add a table, type in the following ",(0,i.jsx)(t.code,{children:"create table cameras (id INT primary key);"}),". This will create a table named ",(0,i.jsx)(t.strong,{children:"cameras"})," with a single (primary) column with the name of ",(0,i.jsx)(t.strong,{children:"id"})," that expects an integer value."]}),"\n",(0,i.jsx)(t.h2,{id:"installing-sqlite-in-node-red",children:"Installing SQLite in Node-RED"}),"\n",(0,i.jsxs)(t.p,{children:["Open the ",(0,i.jsx)(t.strong,{children:"Manage Palette"})," menu inside Node-RED, switch to the ",(0,i.jsx)(t.strong,{children:"Install"})," tab and search for ",(0,i.jsx)(t.strong,{children:"node-red-node-sqlite"}),". More information can be found ",(0,i.jsx)(t.a,{href:"https://flows.nodered.org/node/node-red-node-sqlite",children:"here"}),". A new node called sqlite should appear on the left under the storage tab. In this flow, you\u2019re going to send 5 SQL queries (CREATE, INSERT, SELECT, DELETE and DROP) to your SQLite database:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(99660).A+"",width:"950",height:"478"})}),"\n",(0,i.jsxs)(t.p,{children:["Double-click the ",(0,i.jsx)(t.strong,{children:"SQLite Node"})," press the Add new sqlitedb button and type in the absolute path to the SQLite Database we created earlier"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(29827).A+"",width:"950",height:"453"})}),"\n",(0,i.jsxs)(t.p,{children:["Configure your CREATE ",(0,i.jsx)(t.strong,{children:"Inject Node"})," as follows:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sql",children:"CREATE TABLE dhtreadings(id INTEGER PRIMARY KEY AUTOINCREMENT, temperature NUMERIC, humidity NUMERIC, currentdate DATE, currenttime TIME, device TEXT)\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(228602).A+"",width:"950",height:"579"})}),"\n",(0,i.jsx)(t.p,{children:"Repeat this step to create the following :"}),"\n",(0,i.jsx)(t.h3,{id:"insert-inject-node",children:"INSERT inject node"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sql",children:"INSERT INTO dhtreadings(temperature, humidity, currentdate, currenttime, device) values(22.4, 48, date('now'), time('now'), 'manual')\n"})}),"\n",(0,i.jsx)(t.h3,{id:"select-inject-node-with",children:"SELECT inject node with"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sql",children:"SELECT * FROM dhtreadings\n"})}),"\n",(0,i.jsx)(t.h3,{id:"delete-inject-node-as-follows",children:"DELETE inject node as follows"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sql",children:"DELETE from dhtreadings\n"})}),"\n",(0,i.jsx)(t.h3,{id:"drop-inject-node",children:"DROP inject node"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sql",children:"DROP TABLE dhtreadings\n"})}),"\n",(0,i.jsxs)(t.p,{children:["To save your application, you need to click the ",(0,i.jsx)(t.strong,{children:"Deploy"})," button on the top right corner (",(0,i.jsx)(t.code,{children:"You might have to restart Node-RED"}),") and your application is saved and ready. Open the debug window and press the first inject node to trigger the CREATE SQL query:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(158769).A+"",width:"947",height:"500"})}),"\n",(0,i.jsx)(t.h2,{id:"visualizing-data-from-sqlite-in-node-red-dashboard",children:"Visualizing Data from SQLite in Node-RED Dashboard"}),"\n",(0,i.jsxs)(t.p,{children:["We are able to visualize the data by using the ",(0,i.jsx)(t.a,{href:"https://github.com/mpolinowski/nodered-dashboard-getting-started",children:"dashboard nodes"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["Injecting ",(0,i.jsx)(t.code,{children:"SELECT * FROM dhtreadings"})," into our SQLite node gives us an array of records in the response, we can simply use the ui template node to parse the information we want."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(744552).A+"",width:"943",height:"427"})}),"\n",(0,i.jsx)(t.p,{children:"For example, we would like to have a table showing the first 2 records, just simply connect the template UI node to the SQLite node:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(526815).A+"",width:"947",height:"497"})}),"\n",(0,i.jsx)(t.p,{children:"In the template node, enter the following code:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-html",children:"<table style='width:100%'>\r\n  <tr>\r\n    <th>Time</th> \r\n    <th>Temp</th> \r\n    <th>Hum</th>\r\n  </tr>\r\n  <tr ng-repeat='x in msg.payload | limitTo:2'>\r\n    <td>{{msg.payload[$index].currenttime}}</td>\r\n    <td>{{msg.payload[$index].temperature}}</td> \r\n    <td>{{msg.payload[$index].humidity}}</td>\r\n  </tr>\r\n</table>\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(930486).A+"",width:"952",height:"594"})}),"\n",(0,i.jsxs)(t.p,{children:["This code simply a table in HTML, and places the index, currenttime, temperature and humidity fields from  msg.payload into the appropriate cells of the table using ",(0,i.jsx)(t.strong,{children:"ng-repeat"})," & ",(0,i.jsx)(t.strong,{children:"limitTo"}),". Once you deploy the nodes, the UI template node will update the table whenever SELECT * is sent to the SQLite node, and an array of records are returned from the SQLite node to the UI template node. The resulting table would look like this when you hit the URL ",(0,i.jsx)(t.a,{href:"http://192.168.1.112:1880/ui/",children:"http://192.168.1.112:1880/ui/"}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(270460).A+"",width:"950",height:"550"})}),"\n",(0,i.jsx)(t.h2,{id:"database-administration",children:"Database Administration"}),"\n",(0,i.jsxs)(t.p,{children:["For the basic database administrative activities you can use web (php) based tools like ",(0,i.jsx)(t.strong,{children:"phpLiteAdmin"})," or go with an installable tool like ",(0,i.jsx)(t.a,{href:"https://github.com/sqlitebrowser/sqlitebrowser",children:"SQLiteBrowser"}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(799877).A+"",width:"957",height:"660"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SQLite",src:n(928078).A+"",width:"958",height:"659"})}),"\n",(0,i.jsx)(t.h2,{id:"flow-export",children:"Flow Export"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-json",children:"[{'id':'af8b3131.1b188','type':'tab','label':'sqlite','disabled':false,'info':''},{'id':'d7f0c96f.0d0588','type':'inject','z':'af8b3131.1b188','name':'CREATE','topic':'CREATE TABLE dhtreadings(id INTEGER PRIMARY KEY AUTOINCREMENT, temperature NUMERIC, humidity NUMERIC, currentdate DATE, currenttime TIME, device TEXT)','payload':'','payloadType':'date','repeat':'','crontab':'','once':false,'onceDelay':0.1,'x':90,'y':40,'wires':[['7f9d303d.adb45']]},{'id':'522e8f98.ac3de','type':'inject','z':'af8b3131.1b188','name':'INSERT','topic':'INSERT INTO dhtreadings(temperature, humidity, currentdate, currenttime, device) values(22.4, 48, date('now'), time('now'), \\'manual\\')','payload':'','payloadType':'date','repeat':'','crontab':'','once':false,'onceDelay':0.1,'x':90,'y':100,'wires':[['7f9d303d.adb45']]},{'id':'40fe756f.d7cd5c','type':'inject','z':'af8b3131.1b188','name':'SELECT','topic':'SELECT * FROM dhtreadings','payload':'','payloadType':'date','repeat':'','crontab':'','once':false,'onceDelay':0.1,'x':90,'y':160,'wires':[['7f9d303d.adb45']]},{'id':'3b1c34a.1639acc','type':'inject','z':'af8b3131.1b188','name':'DELETE','topic':'DELETE from dhtreadings','payload':'','payloadType':'date','repeat':'','crontab':'','once':false,'onceDelay':0.1,'x':90,'y':220,'wires':[['7f9d303d.adb45']]},{'id':'57370135.7daa1','type':'inject','z':'af8b3131.1b188','name':'DROP TABLE','topic':'DROP TABLE dhtreadings','payload':'','payloadType':'date','repeat':'','crontab':'','once':false,'onceDelay':0.1,'x':100,'y':280,'wires':[['7f9d303d.adb45']]},{'id':'7f9d303d.adb45','type':'sqlite','z':'af8b3131.1b188','mydb':'4e71ffcc.32ba8','sqlquery':'msg.topic','sql':'','name':'SQLite','x':270,'y':160,'wires':[['593ed62b.495198']]},{'id':'593ed62b.495198','type':'debug','z':'af8b3131.1b188','name':'','active':true,'tosidebar':true,'console':false,'tostatus':false,'complete':'false','x':430,'y':160,'wires':[]},{'id':'3735b0c8.22ff','type':'sqlite','z':'af8b3131.1b188','mydb':'4e71ffcc.32ba8','sqlquery':'msg.topic','sql':'','name':'SQLite','x':370,'y':300,'wires':[['2f6afcf0.58e874']]},{'id':'c8e55090.582db','type':'inject','z':'af8b3131.1b188','name':'View Records','topic':'SELECT * FROM dhtreadings','payload':'','payloadType':'date','repeat':'','crontab':'','once':false,'onceDelay':0.1,'x':300,'y':240,'wires':[['3735b0c8.22ff']]},{'id':'2f6afcf0.58e874','type':'ui_template','z':'af8b3131.1b188','group':'5be80bfc.629394','name':'UI Table','order':2,'width':'6','height':'3','format':'<table style=\\'width:100%\\'>\\n  <tr>\\n    <th>Time</th> \\n    <th>Temp</th> \\n    <th>Hum</th>\\n  </tr>\\n  <tr ng-repeat=\\'x in msg.payload | limitTo:2\\'>\\n    <td>{{msg.payload[$index].currenttime}}</td>\\n    <td>{{msg.payload[$index].temperature}}</td> \\n    <td>{{msg.payload[$index].humidity}}</td>\\n  </tr>\\n</table>','storeOutMessages':true,'fwdInMessages':true,'templateScope':'local','x':430,'y':360,'wires':[[]]},{'id':'4e71ffcc.32ba8','type':'sqlitedb','z':'','db':'C:\\\\Users\\\\INSTAR\\\\.node-red\\\\db\\\\mydb.db'},{'id':'5be80bfc.629394','type':'ui_group','z':'','name':'Data','tab':'da0180c5.64fa9','order':3,'disp':true,'width':'6','collapse':false},{'id':'da0180c5.64fa9','type':'ui_tab','z':'','name':'IP Camera','icon':'photo_camera'}]\n"})})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},817758:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_01-e6ec713c7acfcf4a7b59231951cc602e.png"},985109:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_02-1fc85db6b7a696a9f287b2830b01d086.png"},99660:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_03-7be43d9109ab1bad895622e2d4c19836.png"},29827:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_04-cc19e041ea14658ef13ac39c9ad436f2.png"},228602:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_05-b38b044da9009822b57ca6d9fb93644c.png"},158769:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_06-a41df18e50663c867e84fe4ec3226a45.png"},744552:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_07-aed9a31dbca7da6634b0df766172eb73.png"},526815:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_08-0ccae94a6061f952083d27bf24ce4017.png"},930486:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_09-71cae835fa72017fd87f3d57e8cf0a2e.png"},270460:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_10-7fe4aa2953f51ef09063c152af9d9fdb.png"},799877:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_11-91f6ab85aab2cb67ba93b31646be93ef.png"},928078:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/nodered_12-7158d9feeaaea7a8594ebd605e8aa5a7.png"},679055:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/photo-15491736416_6abd8de751_o-dfcbeddf4c825e6e7265891d8bb856bd.png"},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>o});var i=n(296540);const a={},d=i.createContext(a);function s(e){const t=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(d.Provider,{value:t},e.children)}}}]);