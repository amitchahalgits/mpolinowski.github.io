"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[96274],{593163:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>i});var n=a(785893),r=a(603905);const s={sidebar_position:1e4,slug:"2020-12-22",title:"Install Tomcat 9 on Ubuntu 20.04",authors:"mpolinowski",tags:["LINUX","Tomcat"]},o=void 0,c={id:"DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation/index",title:"Install Tomcat 9 on Ubuntu 20.04",description:"Siem Reap, Cambodia",source:"@site/docs/DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation/index.md",sourceDirName:"DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation",slug:"/DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation/2020-12-22",permalink:"/docs/DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation/2020-12-22",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Tomcat/2020-12-22-tomcat9-ubuntu-20-10-installation/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"},{label:"Tomcat",permalink:"/docs/tags/tomcat"}],version:"current",sidebarPosition:1e4,frontMatter:{sidebar_position:1e4,slug:"2020-12-22",title:"Install Tomcat 9 on Ubuntu 20.04",authors:"mpolinowski",tags:["LINUX","Tomcat"]},sidebar:"tutorialSidebar",previous:{title:"Tomcat 9 Configuration",permalink:"/docs/DevOps/Tomcat/2020-12-23-tomcat9-configuration/2020-12-23"},next:{title:"Salt",permalink:"/docs/category/salt"}},l={},i=[{value:"Install Java",id:"install-java",level:2},{value:"Creating a System User",id:"creating-a-system-user",level:2},{value:"Install Tomcat 9",id:"install-tomcat-9",level:2},{value:"Download the latest Tomcat",id:"download-the-latest-tomcat",level:3},{value:"Extract the Files",id:"extract-the-files",level:3},{value:"Create a SystemD Service",id:"create-a-systemd-service",level:3},{value:"Access the Tomcat Webfrontend",id:"access-the-tomcat-webfrontend",level:2},{value:"Deploying a Demo Application",id:"deploying-a-demo-application",level:2},{value:"Manger App",id:"manger-app",level:3}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.ah)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Siem Reap, Cambodia",src:a(401012).Z+"",width:"1500",height:"706"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#install-java",children:"Install Java"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#creating-a-system-user",children:"Creating a System User"})}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"#install-tomcat-9",children:"Install Tomcat 9"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#download-the-latest-tomcat",children:"Download the latest Tomcat"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#extract-the-files",children:"Extract the Files"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#create-a-systemd-service",children:"Create a SystemD Service"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#access-the-tomcat-webfrontend",children:"Access the Tomcat Webfrontend"})}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"#deploying-a-demo-application",children:"Deploying a Demo Application"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#manger-app",children:"Manger App"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Apache Tomcat is an open-source web server and Java servlet container. It is one of the most popular choices for building Java-based websites and applications. Tomcat is lightweight, easy to use, and has a robust ecosystem of add-ons."}),"\n",(0,n.jsx)(t.h2,{id:"install-java",children:"Install Java"}),"\n",(0,n.jsx)(t.p,{children:"Tomcat 9 requires Java SE 8 or later to be installed on the system. \xcc\u2019ll install OpenJDK 11 , the open-source implementation of the Java Platform."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"apt update\r\napt install openjdk-11-jdk\n"})}),"\n",(0,n.jsx)(t.p,{children:"Verify the installation by checking the Java version:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"java -version\n"})}),"\n",(0,n.jsx)(t.h2,{id:"creating-a-system-user",children:"Creating a System User"}),"\n",(0,n.jsxs)(t.p,{children:["I\u2019ll create a new system user and group with home directory ",(0,n.jsx)(t.code,{children:"/opt/tomcat"})," that will run the Tomcat service:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"useradd -m -U -d /opt/tomcat -s /bin/false tomcat\n"})}),"\n",(0,n.jsx)(t.h2,{id:"install-tomcat-9",children:"Install Tomcat 9"}),"\n",(0,n.jsx)(t.h3,{id:"download-the-latest-tomcat",children:"Download the latest Tomcat"}),"\n",(0,n.jsxs)(t.p,{children:["Tomcat binary distribution is available for download from the ",(0,n.jsx)(t.a,{href:"https://tomcat.apache.org/download-90.cgi",children:"Tomcat downloads page"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"wget https://mirrors.tuna.tsinghua.edu.cn/apache/tomcat/tomcat-9/v9.0.41/bin/apache-tomcat-9.0.41.tar.gz -P /tmp\n"})}),"\n",(0,n.jsx)(t.h3,{id:"extract-the-files",children:"Extract the Files"}),"\n",(0,n.jsxs)(t.p,{children:["Extract the tar file to the Tomcat user home directory ",(0,n.jsx)(t.code,{children:"/opt/tomcat"})," directory:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"tar -xf /tmp/apache-tomcat-9.0.41.tar.gz -C /opt/tomcat/\r\nln -s /opt/tomcat/apache-tomcat-9.0.41 /opt/tomcat/latest\n"})}),"\n",(0,n.jsx)(t.p,{children:"Change the directory ownership to user and group tomcat:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"chown -R tomcat: /opt/tomcat\n"})}),"\n",(0,n.jsx)(t.p,{children:"The shell scripts inside the Tomcat\u2019s bin directory must be executable:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"sudo sh -c 'chmod +x /opt/tomcat/latest/bin/*.sh'\n"})}),"\n",(0,n.jsx)(t.h3,{id:"create-a-systemd-service",children:"Create a SystemD Service"}),"\n",(0,n.jsxs)(t.p,{children:["Open your text editor and create a tomcat.service unit file in the ",(0,n.jsx)(t.code,{children:"/etc/systemd/system/"})," directory:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"nano /etc/systemd/system/tomcat.service\n"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'[Unit]\r\nDescription=Tomcat 9 servlet container\r\nAfter=network.target\r\n\r\n[Service]\r\nType=forking\r\n\r\nUser=tomcat\r\nGroup=tomcat\r\n\r\nEnvironment="JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64"\r\nEnvironment="JAVA_OPTS=-Djava.security.egd=file:///dev/urandom -Djava.awt.headless=true"\r\n\r\nEnvironment="CATALINA_BASE=/opt/tomcat/latest"\r\nEnvironment="CATALINA_HOME=/opt/tomcat/latest"\r\nEnvironment="CATALINA_PID=/opt/tomcat/latest/temp/tomcat.pid"\r\nEnvironment="CATALINA_OPTS=-Xms512M -Xmx1024M -server -XX:+UseParallelGC"\r\n\r\nExecStart=/opt/tomcat/latest/bin/startup.sh\r\nExecStop=/opt/tomcat/latest/bin/shutdown.sh\r\n\r\n[Install]\r\nWantedBy=multi-user.target\n'})}),"\n",(0,n.jsx)(t.p,{children:"Find the Java home directory:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"find / -name java-11-openjdk-amd64\r\n\r\n/usr/lib/jvm/java-11-openjdk-amd64\n"})}),"\n",(0,n.jsx)(t.p,{children:"Save and close the file and notify systemd that a new unit file exists:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"systemctl daemon-reload\r\nsudo systemctl enable --now tomcat\r\nsudo systemctl status tomcat\n"})}),"\n",(0,n.jsx)(t.p,{children:"You can start, stop and restart Tomcat same as any other systemd service:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"service tomcat start\r\nservice tomcat stop\r\nservice tomcat restart\n"})}),"\n",(0,n.jsx)(t.h2,{id:"access-the-tomcat-webfrontend",children:"Access the Tomcat Webfrontend"}),"\n",(0,n.jsx)(t.p,{children:"Open the port 8080 in your firewall:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"ufw allow 8080/tcp\n"})}),"\n",(0,n.jsx)(t.p,{children:"And access the IP address of your server with your web browser:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Install Tomcat 9 on Ubuntu 20.04",src:a(790139).Z+"",width:"1146",height:"437"})}),"\n",(0,n.jsx)(t.h2,{id:"deploying-a-demo-application",children:"Deploying a Demo Application"}),"\n",(0,n.jsxs)(t.p,{children:["To deploy an application, simply drag the application folder into the ",(0,n.jsx)(t.strong,{children:"webapps"})," folder in the Tomcat installation directory - in my case ",(0,n.jsx)(t.code,{children:"/opt/tomcat/apache-tomcat-9.0.41/webapps"}),". I do not have an application so I will just create an empty folder ",(0,n.jsx)(t.code,{children:"boilerplate"})," and add an ",(0,n.jsx)(t.code,{children:"index.jsp"})," file with the following content:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-html",children:'\x3c!-- nano /opt/tomcat/apache-tomcat-9.0.41/webapps/boilerplate/index.jsp --\x3e\r\n\r\n<%@ page language="java" contentType="text/html; charset=ISO-8859-1"\r\npageEncoding="ISO-8859-1"%>\r\n\r\n<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\r\n<html>\r\n  <head>\r\n    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />\r\n    <title>Tomcat Boilerplate</title>\r\n  </head>\r\n  <body>\r\n    <h1>This is just a test..</h1>\r\n    <h3>Tomcats!</h3>\r\n  </body>\r\n</html>\n'})}),"\n",(0,n.jsxs)(t.p,{children:["The application will automatically be deployed and be reachable under ",(0,n.jsx)(t.code,{children:"/boilerplate/"})," - e.g.:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"http://192.168.2.111:8080/boilerplate/\n"})}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsxs)(t.p,{children:["The compiled work file for the servlet can be found in ",(0,n.jsx)(t.code,{children:"/opt/tomcat/apache-tomcat-9.0.41/work/Catalina/localhost/boilerplate"}),"."]}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"manger-app",children:"Manger App"}),"\n",(0,n.jsxs)(t.p,{children:["To use the manager app we first have to create a user login. This can be done in the ",(0,n.jsx)(t.code,{children:"tomcat-users.xml"})," in the ",(0,n.jsx)(t.code,{children:"conf"})," directory. Add the ",(0,n.jsx)(t.code,{children:"manager-gui"})," role as follows:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-xml",children:'\x3c!-- nano /opt/tomcat/apache-tomcat-9.0.41/conf/tomcat-users.xml --\x3e\r\n\r\n<tomcat-users xmlns="http://tomcat.apache.org/xml"\r\n              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\r\n              xsi:schemaLocation="http://tomcat.apache.org/xml tomcat-users.xsd"\r\n              version="1.0">\r\n\r\n  <role rolename="manager-gui"/>\r\n  <user username="admin" password="instar" roles="manager-gui"/>\r\n\r\n</tomcat-users>\n'})}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsxs)(t.p,{children:["Access to the Manager App is only allowed on ",(0,n.jsx)(t.code,{children:"localhost"}),". Since I am accessing remotely I will have to ",(0,n.jsx)(t.a,{href:"https://stackoverflow.com/questions/36703856/access-tomcat-manager-app-from-different-host",children:"add my IP address to the allowed"})," ",(0,n.jsx)(t.code,{children:"org.apache.catalina.valves.RemoteAddrValve"})," inside the ",(0,n.jsx)(t.code,{children:"context.xml"})," of the manager app:"]}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-xml",children:'\x3c!-- nano /opt/tomcat/apache-tomcat-9.0.41/webapps/manager/META-INF/context.xml --\x3e\r\n\r\n<Valve className="org.apache.catalina.valves.RemoteAddrValve"\r\n         allow="127\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1|192.168.2.112" />\n'})}),"\n",(0,n.jsx)(t.p,{children:"or allow all address with an regular expression:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-xml",children:'<Valve className="org.apache.catalina.valves.RemoteAddrValve"\r\n         allow=".*" />\n'})}),"\n",(0,n.jsx)(t.p,{children:"Restart your server:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"service tomcat restart\n"})}),"\n",(0,n.jsxs)(t.p,{children:["I can now access the ",(0,n.jsx)(t.strong,{children:"Manager App"})," ",(0,n.jsx)(t.code,{children:"http://192.168.2.111:8080/manager/html"})," with the login ",(0,n.jsx)(t.strong,{children:"admin/instar"}),"."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Install Tomcat 9 on Ubuntu 20.04",src:a(80603).Z+"",width:"1186",height:"711"})})]})}function h(e={}){const{wrapper:t}={...(0,r.ah)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},603905:(e,t,a)=>{a.d(t,{ah:()=>i});var n=a(667294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),i=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,h=c(e,["components","mdxType","originalType","parentName"]),m=i(a),p=r,u=m["".concat(l,".").concat(p)]||m[p]||d[p]||s;return a?n.createElement(u,o(o({ref:t},h),{},{components:a})):n.createElement(u,o({ref:t},h))}));h.displayName="MDXCreateElement"},401012:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-dbec03b1535301c8b293ac3087af0dd4.jpg"},790139:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/tomcat9-ubuntu-20-10-installation_01-720e9b8d20be446399f06b32a85fbecb.png"},80603:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/tomcat9-ubuntu-20-10-installation_02-55050835e3b0ff8bd44251d5bf676a65.png"}}]);