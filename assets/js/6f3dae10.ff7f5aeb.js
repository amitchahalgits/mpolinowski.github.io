"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[78766],{242616:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>o,frontMatter:()=>i,metadata:()=>d,toc:()=>l});var t=s(785893),r=s(603905);const i={sidebar_position:4360,slug:"2023-07-02",title:"SQL in Data Science - Machine Learning",authors:"mpolinowski",tags:["Python","Machine Learning","Cheating"],description:"Cheat Sheet using Psycopg2 to interact with PostgreSQL Databases"},a="SQL in Data Science",d={id:"IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/index",title:"SQL in Data Science - Machine Learning",description:"Cheat Sheet using Psycopg2 to interact with PostgreSQL Databases",source:"@site/docs/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/index.md",sourceDirName:"IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml",slug:"/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/2023-07-02",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/2023-07-02",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/index.md",tags:[{label:"Python",permalink:"/docs/tags/python"},{label:"Machine Learning",permalink:"/docs/tags/machine-learning"},{label:"Cheating",permalink:"/docs/tags/cheating"}],version:"current",sidebarPosition:4360,frontMatter:{sidebar_position:4360,slug:"2023-07-02",title:"SQL in Data Science - Machine Learning",authors:"mpolinowski",tags:["Python","Machine Learning","Cheating"],description:"Cheat Sheet using Psycopg2 to interact with PostgreSQL Databases"},sidebar:"tutorialSidebar",previous:{title:"Introduction to Caffe2",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-07-21-introduction-to-pytorch-caffe2/2023-07-21"},next:{title:"SQL in Data Science - Slightly more Advanced Queries",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-06-30-sql-in-data-science-advanced/2023-06-30"}},c={},l=[{value:"Database Installation with Docker Compose",id:"database-installation-with-docker-compose",level:2},{value:"Dataset",id:"dataset",level:2},{value:"Linear Regression",id:"linear-regression",level:2},{value:"K-Nearest Neighbours",id:"k-nearest-neighbours",level:2},{value:"K-means Clustering",id:"k-means-clustering",level:2},{value:"Dataset II",id:"dataset-ii",level:2},{value:"Naive Bayes Classification",id:"naive-bayes-classification",level:2}];function h(n){const e={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.ah)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"Guangzhou, China",src:s(969788).Z+"",width:"1500",height:"581"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"#sql-in-data-science",children:"SQL in Data Science"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#database-installation-with-docker-compose",children:"Database Installation with Docker Compose"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#dataset",children:"Dataset"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#linear-regression",children:"Linear Regression"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#k-nearest-neighbours",children:"K-Nearest Neighbours"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#k-means-clustering",children:"K-means Clustering"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#dataset-ii",children:"Dataset II"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"#naive-bayes-classification",children:"Naive Bayes Classification"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://github.com/mpolinowski/sql-for-data-science/tree/master/02_machine_learning",children:"Github Repository"})}),"\n",(0,t.jsx)(e.h1,{id:"sql-in-data-science",children:"SQL in Data Science"}),"\n",(0,t.jsxs)(e.p,{children:["PostgreSQL lets you build queries which run a variety of ",(0,t.jsx)(e.a,{href:"https://www.postgresql.org/docs/13/functions-aggregate.html",children:"machine learning algorithms"})," against your data."]}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"/docs/IoT-and-Machine-Learning/ML/2023-06-27-sql-in-data-science-basics/2023-06-27",children:"SQL in Data Science - The Basics using Python"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"/docs/IoT-and-Machine-Learning/ML/2023-06-30-sql-in-data-science-advanced/2023-06-30",children:"SQL in Data Science - Slightly more Advanced Queries"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"/docs/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/2023-07-02",children:"SQL in Data Science - Machine Learning"})}),"\n"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://www.freecodecamp.org/news/machine-learning-directly-in-sql/",children:"Source: Machine Learning Directly in SQL \u2013 How to Use ML in Databases"})}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"database-installation-with-docker-compose",children:"Database Installation with Docker Compose"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"mkdir /opt/pgdata\nsudo chown myuser:myuser /opt/pgdata\nsudo chmod 777 /opt/pgdata\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"docker pull postgres:alpine\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.em,{children:"docker-compose.yml"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yml",children:"# Use postgres/example user/password credentials\nversion: '3'\n\nservices:\n\n  db:\n    image: postgres:alpine\n    restart: unless-stopped\n    environment:\n      POSTGRES_USER: postgres\n      POSTGRES_PASSWORD: password\n      POSTGRES_DB: testing\n      PGDATA: /var/lib/postgresql/data/pgdata\n    volumes:\n      - /opt/pgdata:/var/lib/postgresql/data\n    ports:\n      - 5432:5432\n\n  adminer:\n    image: adminer\n    restart: unless-stopped\n    ports:\n      - 8080:8080 \n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"docker-compose up\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import psycopg2\nfrom config import config\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n"})}),"\n",(0,t.jsx)(e.h2,{id:"dataset",children:"Dataset"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"!wget https://gist.github.com/Thanatoz-1/9e7fdfb8189f0cdf5d73a494e4a6392a/raw/aaecbd14aeaa468cd749528f291aa8a30c2ea09e/iris_dataset.csv\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"data_iris = pd.read_csv ('iris_dataset.csv')   \ndf_iris = pd.DataFrame(data_iris)\ndf_iris.rename(columns={\n    'sepal length (cm)': 'sepal_length',\n    'sepal width (cm)': 'sepal_width',\n    'petal length (cm)': 'petal_length',\n    'petal width (cm)': 'petal_width',\n}, inplace=True)\ndf_iris.head(5)\n"})}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{}),(0,t.jsx)(e.th,{children:"sepal_length"}),(0,t.jsx)(e.th,{children:"sepal_width"}),(0,t.jsx)(e.th,{children:"petal_length"}),(0,t.jsx)(e.th,{children:"petal_width"}),(0,t.jsx)(e.th,{children:"target"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"0"}),(0,t.jsx)(e.td,{children:"5.1"}),(0,t.jsx)(e.td,{children:"3.5"}),(0,t.jsx)(e.td,{children:"1.4"}),(0,t.jsx)(e.td,{children:"0.2"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"1"}),(0,t.jsx)(e.td,{children:"4.9"}),(0,t.jsx)(e.td,{children:"3.0"}),(0,t.jsx)(e.td,{children:"1.4"}),(0,t.jsx)(e.td,{children:"0.2"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"2"}),(0,t.jsx)(e.td,{children:"4.7"}),(0,t.jsx)(e.td,{children:"3.2"}),(0,t.jsx)(e.td,{children:"1.3"}),(0,t.jsx)(e.td,{children:"0.2"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"3"}),(0,t.jsx)(e.td,{children:"4.6"}),(0,t.jsx)(e.td,{children:"3.1"}),(0,t.jsx)(e.td,{children:"1.5"}),(0,t.jsx)(e.td,{children:"0.2"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"4"}),(0,t.jsx)(e.td,{children:"5.0"}),(0,t.jsx)(e.td,{children:"3.6"}),(0,t.jsx)(e.td,{children:"1.4"}),(0,t.jsx)(e.td,{children:"0.2"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]})]})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"def create_table():\n    conn = None\n    try:\n        # read database configuration\n        params = config()\n        # connect to the PostgreSQL database\n        conn = psycopg2.connect(**params)\n        # create a new cursor\n        cursor = conn.cursor()\n        # create the table\n        cursor.execute('''\n        CREATE TABLE iris (\n            index SMALLINT primary key,\n            sepal_length FLOAT,\n            sepal_width FLOAT,\n            petal_length FLOAT,\n            petal_width FLOAT,\n            target VARCHAR\n            )\n               ''')\n        conn.commit()\n        # Close communication with the PostgreSQL database\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"def add_data():\n    conn = None\n    try:\n        # read database configuration\n        params = config()\n        # connect to the PostgreSQL database\n        conn = psycopg2.connect(**params)\n        # create a new cursor\n        cursor = conn.cursor()\n        # insert data\n        for row in df_iris.itertuples():\n            cursor.execute('''\n                INSERT INTO iris (\n                    index, sepal_length, sepal_width, petal_length, petal_width, target\n                ) VALUES (\n                    %s, %s, %s, %s, %s, %s\n                    )''',\n                (\n                    row.Index,\n                    row.sepal_length,\n                    row.sepal_width,\n                    row.petal_length,\n                    row.petal_width,\n                    row.target\n                )\n            )\n        # Commit the changes to the database\n        conn.commit()\n        # Close communication with the PostgreSQL database\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"create_table()\nadd_data()\n"})}),"\n",(0,t.jsx)(e.h2,{id:"linear-regression",children:"Linear Regression"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'query = f"""\nWITH regression AS\n  (SELECT \n      regr_slope(petal_width, petal_length) AS gradient,\n      regr_intercept(petal_width, petal_length) AS intercept\n   FROM\n      iris\n   WHERE\n      petal_width IS NOT NULL\n   )\n\nSELECT\n   petal_length,\n   (petal_length * gradient) + intercept AS prediction\nFROM\n   iris\nCROSS JOIN\n   regression\nWHERE\n   petal_width IS NOT NULL ;\n"""\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"def linear_regression(query):\n    conn = None\n    try:\n        params = config()\n        conn = psycopg2.connect(**params)\n        cursor = conn.cursor()\n        query = query\n        cursor.execute(query)\n        results = cursor.fetchall()\n\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n    finally:\n        if conn is not None:\n            return(results)\n            conn.close()\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"results = linear_regression(query=query)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"df_pred = pd.DataFrame(results, columns=['petal_length', 'petal_width_pred'])\ndf_pred.head()\n"})}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{}),(0,t.jsx)(e.th,{children:"petal_length"}),(0,t.jsx)(e.th,{children:"petal_width_pred"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"0"}),(0,t.jsx)(e.td,{children:"1.4"}),(0,t.jsx)(e.td,{children:"0.216473"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"1"}),(0,t.jsx)(e.td,{children:"1.4"}),(0,t.jsx)(e.td,{children:"0.216473"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"2"}),(0,t.jsx)(e.td,{children:"1.3"}),(0,t.jsx)(e.td,{children:"0.174831"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"3"}),(0,t.jsx)(e.td,{children:"1.5"}),(0,t.jsx)(e.td,{children:"0.258115"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"4"}),(0,t.jsx)(e.td,{children:"1.4"}),(0,t.jsx)(e.td,{children:"0.216473"})]})]})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"fig = plt.figure(figsize=(10,5))\nax1 = fig.add_subplot(111)\n\nax1.scatter(data=df_pred, x='petal_length', y='petal_width_pred', s=10, c='b', marker=\"s\", label='prediction')\nax1.scatter(data=df_iris, x='petal_length', y='petal_width', s=10, c='r', marker=\"o\", label='true')\nplt.legend(loc='upper left')\nplt.xlabel('Iris Petal Length')\nplt.ylabel('Iris Petal Width')\n\nplt.savefig('assets/sql-for-data-science_01.webp', bbox_inches='tight')\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"SQL in Data Science",src:s(803490).Z+"",width:"846",height:"448"})}),"\n",(0,t.jsx)(e.h2,{id:"k-nearest-neighbours",children:"K-Nearest Neighbours"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"query = f'''\n-- CTE to get labelled training data\nWITH training AS\n  (SELECT\n      index,\n      POINT(sepal_length, petal_length) as xy,\n      target\n  FROM\n      iris\n  WHERE\n      target IS NOT NULL\n  ),\n\n-- CTE to get the unlabelled points\ntest AS\n  (SELECT\n      index,\n      POINT(sepal_length, petal_length) as xy,\n      target\n  FROM\n      iris\n  WHERE\n      target IS NOT NULL\n  ),\n\n-- calculate distances between unlabelled & labelled points\ndistances AS\n  (SELECT\n      test.index,\n      training.target,\n      test.xy <-> training.xy AS dist,\n      ROW_NUMBER() OVER (\n         PARTITION BY test.index\n         ORDER BY test.xy <-> training.xy \n         ) AS row_no\n  FROM\n      test\n  CROSS JOIN training\n  ORDER BY 1, 4 ASC\n  ),\n\n-- count the 'votes' per label for each unlabelled point\nvotes AS\n  (SELECT\n      index,\n      target,\n      count(*) AS votes\n  FROM distances\n  WHERE row_no <= 5\n  GROUP BY 1,2\n  ORDER BY 1)\n\n-- query for the label with the most votes\nSELECT\n  v.index,\n  v.target\nFROM\n  votes v\nJOIN\n  (SELECT\n      index,\n      max(votes) AS max_votes\n  FROM\n      votes\n  GROUP BY 1\n  ) mv \nON v.index = mv.index\nAND v.votes = mv.max_votes\nORDER BY 1 ASC ;\n'''\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"def k_nearest_neighbours(query):\n    conn = None\n    try:\n        params = config()\n        conn = psycopg2.connect(**params)\n        cursor = conn.cursor()\n        query = query\n        cursor.execute(query)\n        results = cursor.fetchall()\n\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n    finally:\n        if conn is not None:\n            return(results)\n            conn.close()\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"# run training with k=5\nresults = k_nearest_neighbours(query=query)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"df_pred = pd.DataFrame(results, columns=['index', 'target_pred'])\ndf_pred.head()\n"})}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{}),(0,t.jsx)(e.th,{children:"index"}),(0,t.jsx)(e.th,{children:"target_pred"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"0"}),(0,t.jsx)(e.td,{children:"0"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"1"}),(0,t.jsx)(e.td,{children:"1"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"2"}),(0,t.jsx)(e.td,{children:"2"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"3"}),(0,t.jsx)(e.td,{children:"3"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"4"}),(0,t.jsx)(e.td,{children:"4"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]})]})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"df_iris['target_pred'] = df_pred['target_pred']\ndf_iris.head()\n"})}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{}),(0,t.jsx)(e.th,{children:"sepal_length"}),(0,t.jsx)(e.th,{children:"sepal_width"}),(0,t.jsx)(e.th,{children:"petal_length"}),(0,t.jsx)(e.th,{children:"petal_width"}),(0,t.jsx)(e.th,{children:"target"}),(0,t.jsx)(e.th,{children:"target_pred"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"0"}),(0,t.jsx)(e.td,{children:"5.1"}),(0,t.jsx)(e.td,{children:"3.5"}),(0,t.jsx)(e.td,{children:"1.4"}),(0,t.jsx)(e.td,{children:"0.2"}),(0,t.jsx)(e.td,{children:"Iris-setosa"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"1"}),(0,t.jsx)(e.td,{children:"4.9"}),(0,t.jsx)(e.td,{children:"3.0"}),(0,t.jsx)(e.td,{children:"1.4"}),(0,t.jsx)(e.td,{children:"0.2"}),(0,t.jsx)(e.td,{children:"Iris-setosa"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"2"}),(0,t.jsx)(e.td,{children:"4.7"}),(0,t.jsx)(e.td,{children:"3.2"}),(0,t.jsx)(e.td,{children:"1.3"}),(0,t.jsx)(e.td,{children:"0.2"}),(0,t.jsx)(e.td,{children:"Iris-setosa"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"3"}),(0,t.jsx)(e.td,{children:"4.6"}),(0,t.jsx)(e.td,{children:"3.1"}),(0,t.jsx)(e.td,{children:"1.5"}),(0,t.jsx)(e.td,{children:"0.2"}),(0,t.jsx)(e.td,{children:"Iris-setosa"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"4"}),(0,t.jsx)(e.td,{children:"5.0"}),(0,t.jsx)(e.td,{children:"3.6"}),(0,t.jsx)(e.td,{children:"1.4"}),(0,t.jsx)(e.td,{children:"0.2"}),(0,t.jsx)(e.td,{children:"Iris-setosa"}),(0,t.jsx)(e.td,{children:"Iris-setosa"})]})]})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"fig, axes = plt.subplots(1, 2, figsize=(12,5))\n\nsns.scatterplot(\n    x='sepal_length',\n    y='petal_length',\n    data=df_iris,\n    s=40,\n    alpha=0.6,\n    hue='target_pred',\n    palette='nipy_spectral',\n    ax=axes[0]\n)\n\nsns.scatterplot(\n    x='sepal_length',\n    y='petal_length',\n    data=df_iris,\n    s=40,\n    alpha=0.6,\n    hue='target',\n    palette='nipy_spectral',\n    ax=axes[1]\n)\n\nplt.savefig('assets/sql-for-data-science_02.webp', bbox_inches='tight')\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"SQL in Data Science",src:s(694057).Z+"",width:"1000",height:"457"})}),"\n",(0,t.jsx)(e.h2,{id:"k-means-clustering",children:"K-means Clustering"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"query = f'''\nWITH points AS\n   (SELECT\n       index,\n       POINT(sepal_length, petal_length) AS xy\n    FROM\n       iris\n    ),\n\ninitial AS\n   (SELECT \n       RANK() OVER (\n          ORDER BY random() \n       ) AS cluster,\n       xy\n    FROM points\n    -- set k=3 since we know there are 3 classes\n    LIMIT 3\n    ),\n\niteration AS\n   (WITH RECURSIVE kmeans(iter, index, cluster, avg_point) AS (\n       SELECT\n          1,\n          NULL::INTEGER,\n          *\n        FROM \n           initial\n        UNION ALL\n        SELECT\n           iter + 1,\n           index,\n           cluster,\n           midpoint\n        FROM (\n           SELECT DISTINCT ON(iter, index)\n              *\n           FROM (\n              SELECT\n                 iter,\n                 cluster,\n                 p.index, \n                 p.xy <-> k.avg_point AS distance,\n                 @@ LSEG(p.xy, k.avg_point) AS midpoint,\n                 p.xy,\n                 k.avg_point\n               FROM points p\n               CROSS JOIN kmeans k\n               ) d\n            ORDER BY 1, 3, 4\n            ) r\n       WHERE iter < 1000\n   )\n   SELECT\n      *\n   FROM\n      kmeans\n   )\n\nSELECT\n   k.*,\n   cluster\nFROM\n   iteration i\nJOIN\n   iris k\nUSING(index)\nWHERE\n   iter = 1000\nORDER BY 4,1 ASC ;\n'''\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"def k_means(query):\n    conn = None\n    try:\n        params = config()\n        conn = psycopg2.connect(**params)\n        cursor = conn.cursor()\n        query = query\n        cursor.execute(query)\n        results = cursor.fetchall()\n\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n    finally:\n        if conn is not None:\n            return(results)\n            conn.close()\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"# run training with k=3 / max_iter=1000\nresults = k_nearest_neighbours(query=query)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"df_pred = pd.DataFrame(results, columns=['index', 'sepal_length', 'sepal_width', 'petal_length', 'petal_width', 'target', 'target_pred'])\ndf_pred.head()\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"fig, axes = plt.subplots(1, 2, figsize=(12,5))\n\nsns.scatterplot(\n    x='sepal_length',\n    y='petal_length',\n    data=df_pred,\n    s=40,\n    alpha=0.6,\n    hue='target_pred',\n    palette='nipy_spectral',\n    ax=axes[0]\n)\n\nsns.scatterplot(\n    x='sepal_length',\n    y='petal_length',\n    data=df_pred,\n    s=40,\n    alpha=0.6,\n    hue='target',\n    palette='nipy_spectral',\n    ax=axes[1]\n)\n\nplt.savefig('assets/sql-for-data-science_03.webp', bbox_inches='tight')\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"SQL in Data Science",src:s(494885).Z+"",width:"1000",height:"457"})}),"\n",(0,t.jsx)(e.h2,{id:"dataset-ii",children:"Dataset II"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"!wget https://github.com/mohitgupta-omg/Kaggle-SMS-Spam-Collection-Dataset-/raw/master/spam.csv\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"data_spam = pd.read_csv ('spam_dataset.csv')   \ndf_spam = pd.DataFrame(data_spam)\ndf_spam = df_spam.reset_index()\ndf_spam.head(5)\n"})}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"index"}),(0,t.jsx)(e.th,{children:"cat"}),(0,t.jsx)(e.th,{children:"sms"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"0"}),(0,t.jsx)(e.td,{children:"ham"}),(0,t.jsx)(e.td,{children:"Go until jurong point crazy.. Available only i..."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"1"}),(0,t.jsx)(e.td,{children:"ham"}),(0,t.jsx)(e.td,{children:"Ok lar... Joking wif u oni..."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"2"}),(0,t.jsx)(e.td,{children:"spam"}),(0,t.jsx)(e.td,{children:"Free entry in 2 a wkly comp to win FA Cup fina..."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"3"}),(0,t.jsx)(e.td,{children:"ham"}),(0,t.jsx)(e.td,{children:"U dun say so early hor... U c already then say..."})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"4"}),(0,t.jsx)(e.td,{children:"ham"}),(0,t.jsx)(e.td,{children:"Nah I don't think he goes to usf he lives arou..."})]})]})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"def create_table():\n    conn = None\n    try:\n        # read database configuration\n        params = config()\n        # connect to the PostgreSQL database\n        conn = psycopg2.connect(**params)\n        # create a new cursor\n        cursor = conn.cursor()\n        # create the table\n        cursor.execute('''\n        CREATE TABLE spam (\n            index SMALLINT primary key,\n            cat VARCHAR,\n            sms VARCHAR\n            )\n               ''')\n        conn.commit()\n        # Close communication with the PostgreSQL database\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"def add_data():\n    conn = None\n    try:\n        # read database configuration\n        params = config()\n        # connect to the PostgreSQL database\n        conn = psycopg2.connect(**params)\n        # create a new cursor\n        cursor = conn.cursor()\n        # insert data\n        for row in df_spam.itertuples():\n            cursor.execute('''\n                INSERT INTO spam (\n                    index, cat, sms\n                ) VALUES (\n                    %s, %s, %s\n                    )''',\n                (\n                    row.index,\n                    row.cat,\n                    row.sms\n                )\n            )\n        # Commit the changes to the database\n        conn.commit()\n        # Close communication with the PostgreSQL database\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"create_table()\nadd_data()\n"})}),"\n",(0,t.jsx)(e.h2,{id:"naive-bayes-classification",children:"Naive Bayes Classification"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"query = f'''\n-- CTE to create one row per word\nWITH staging AS\n  (SELECT \n      REGEXP_SPLIT_TO_TABLE(\n         LOWER(sms), '[^a-z]+') AS word,\n      cat\n   FROM\n      spam\n   WHERE\n      cat IS NOT NULL\n  ),\n\n-- testing data\ntest AS\n  (SELECT\n      index,\n      sms\n   FROM\n      spam\n   WHERE\n      cat is NOT NULL\n  ),\n          \n-- one row per word + cat\ncartesian AS\n  (SELECT\n      *\n   FROM\n     (SELECT\n         DISTINCT word\n      FROM\n         staging) w\n      CROSS JOIN\n     (SELECT\n         DISTINCT cat\n      FROM\n         staging) c\n      WHERE\n         length(word) > 0\n   ),\n\n-- CTE of smoothed frequencies of each word by cat\nfrequencies AS\n  (SELECT\n      c.word,\n      c.cat,\n      -- numerator plus one\n      (SELECT\n          count(*)+1\n       FROM\n          staging s\n       WHERE\n          s.word = c.word\n       AND\n          s.cat = c.cat) /\n      -- denominator plus two\n      (SELECT\n          count(*)+2\n       FROM\n          staging s1\n       WHERE\n          s1.cat = c.cat) ::DECIMAL AS freq\n   FROM\n      cartesian c\n   ),\n\n-- for each row in testing, get the probabilities   \nprobabilities AS\n  (SELECT\n      t.index,\n      f.cat,\n      SUM(LN(f.freq)) AS probability\n   FROM\n     (SELECT\n         index,\n         REGEXP_SPLIT_TO_TABLE(\n            LOWER(sms), '[^a-z]+') AS word\n      FROM\n         test) t\n   JOIN\n     (SELECT\n         word,\n         cat,\n         freq\n      FROM\n         frequencies) f \n   ON t.word = f.word\n   GROUP BY 1, 2\n  )\n\n-- keep only the highest estimate            \nSELECT\n   sms,\n   probabilities.cat\nFROM\n   probabilities\nJOIN\n  (SELECT\n      index,\n      max(probability) AS max_probability\n   FROM\n      probabilities\n   GROUP BY 1) p\nON probabilities.index = p.index\nAND probabilities.probability = p.max_probability\nJOIN\n   test\nON probabilities.index = test.index\nORDER BY 1 ;\n'''\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"def naive_bayes(query):\n    conn = None\n    try:\n        params = config()\n        conn = psycopg2.connect(**params)\n        cursor = conn.cursor()\n        query = query\n        cursor.execute(query)\n        results = cursor.fetchall()\n\n        cursor.close()\n    except (Exception, psycopg2.DatabaseError) as error:\n        print(error)\n    finally:\n        if conn is not None:\n            return(results)\n            conn.close()\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"# buckle up....this will take a while\nresults = naive_bayes(query=query)\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"df_pred = pd.DataFrame(results, columns=['message', 'cat_pred'])\ndf_pred[df_pred['cat_pred'] == 'ham'].head(25)\n"})}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{}),(0,t.jsx)(e.th,{children:"message"}),(0,t.jsx)(e.th,{children:"cat_pred"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"0"}),(0,t.jsx)(e.td,{children:"all write or wat.."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"1"}),(0,t.jsx)(e.td,{children:"bot notes oredi... Cos i juz rem i got..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"2"}),(0,t.jsx)(e.td,{children:"called dad oredi..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"3"}),(0,t.jsx)(e.td,{children:"collecting ur laptop then going to configu..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"4"}),(0,t.jsx)(e.td,{children:"come lt 25 n pass to me lar"}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"5"}),(0,t.jsx)(e.td,{children:"comin to fetch us oredi..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"6"}),(0,t.jsx)(e.td,{children:"dun need to pick ur gf?"}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"7"}),(0,t.jsx)(e.td,{children:"dun wan to watch infernal affair?"}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"8"}),(0,t.jsx)(e.td,{children:"eatin later but i'm eatin wif my frens now..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"9"}),(0,t.jsx)(e.td,{children:"give me some time to walk there."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"10"}),(0,t.jsx)(e.td,{children:"go home liao? Ask dad to pick me up at 6..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"11"}),(0,t.jsx)(e.td,{children:"got wat to buy tell us then _ no need to..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"12"}),(0,t.jsx)(e.td,{children:"log off 4 wat. It's sdryb8i"}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"13"}),(0,t.jsx)(e.td,{children:"mean it's confirmed... I tot they juz say ..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"14"}),(0,t.jsx)(e.td,{children:"neva tell me how i noe... I'm not at home ..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"15"}),(0,t.jsx)(e.td,{children:"no home work to do meh..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"16"}),(0,t.jsx)(e.td,{children:"only send me the contents page..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"17"}),(0,t.jsx)(e.td,{children:"predict wat time _'ll finish buying?"}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"18"}),(0,t.jsx)(e.td,{children:"ready then call me..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"19"}),(0,t.jsx)(e.td,{children:"say until like dat i dun buy ericsson oso ..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"20"}),(0,t.jsx)(e.td,{children:"still attending da talks?"}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"21"}),(0,t.jsx)(e.td,{children:"still got lessons? in sch?"}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"23"}),(0,t.jsx)(e.td,{children:"thk of wat to eat tonight."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"24"}),(0,t.jsx)(e.td,{children:"v ma fan..."}),(0,t.jsx)(e.td,{children:"ham"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"25"}),(0,t.jsx)(e.td,{children:"wait 4 me in sch i finish ard 5.."}),(0,t.jsx)(e.td,{children:"ham"})]})]})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"df_pred[df_pred['cat_pred'] == 'spam'].head(25)\n"})}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{}),(0,t.jsx)(e.th,{children:"message"}),(0,t.jsx)(e.th,{children:"cat_pred"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"22"}),(0,t.jsx)(e.td,{children:"takin linear algebra today?"}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"34"}),(0,t.jsx)(e.td,{children:"and picking them up from various points"}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"53"}),(0,t.jsx)(e.td,{children:"(Bank of Granite issues Strong-Buy) EXPLOSIVE ..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"60"}),(0,t.jsx)(e.td,{children:"* FREE* POLYPHONIC RINGTONE Text SUPER to 8713..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"68"}),(0,t.jsxs)(e.td,{children:[(0,t.jsx)(e.strong,{children:"FREE MESSAGE"}),"Thanks for using the Auction S..."]}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"70"}),(0,t.jsx)(e.td,{children:"+123 Congratulations - in this week's competit..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"71"}),(0,t.jsx)(e.td,{children:"+123 Congratulations - in this week's competit..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"72"}),(0,t.jsx)(e.td,{children:"+449071512431 URGENT! This is the 2nd attempt ..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"73"}),(0,t.jsx)(e.td,{children:"-PLS STOP bootydelious (32/F) is inviting you ..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"77"}),(0,t.jsx)(e.td,{children:"07732584351 - Rodger Burns - MSG = We tried to..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"78"}),(0,t.jsx)(e.td,{children:"08714712388 between 10am-7pm Cost 10p"}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"79"}),(0,t.jsx)(e.td,{children:"09066362231 URGENT! Your mobile No 07xxxxxxxxx..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"80"}),(0,t.jsx)(e.td,{children:"0A$NETWORKS allow companies to bill for SMS so..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"91"}),(0,t.jsx)(e.td,{children:"100 dating service cal;l 09064012103 box334sk38ch"}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"92"}),(0,t.jsx)(e.td,{children:"1000's flirting NOW! Txt GIRL or BLOKE & ur NA..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"93"}),(0,t.jsx)(e.td,{children:"1000's of girls many local 2 u who r virgins 2..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"94"}),(0,t.jsx)(e.td,{children:"18 days to Euro2004 kickoff! U will be kept in..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"95"}),(0,t.jsx)(e.td,{children:"18 days to Euro2004 kickoff! U will be kept in..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"96"}),(0,t.jsx)(e.td,{children:"1Apple/Day=No Doctor. 1Tulsi Leaf/Day=No Cance..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"97"}),(0,t.jsx)(e.td,{children:"1st wk FREE! Gr8 tones str8 2 u each wk. Txt N..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"101"}),(0,t.jsx)(e.td,{children:"2/2 146tf150p"}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"102"}),(0,t.jsx)(e.td,{children:"22 days to kick off! For Euro2004 U will be ke..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"103"}),(0,t.jsx)(e.td,{children:"25p 4 alfie Moon's Children in need song on ur..."}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"104"}),(0,t.jsx)(e.td,{children:"26th OF JULY"}),(0,t.jsx)(e.td,{children:"spam"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"107"}),(0,t.jsx)(e.td,{children:"2p per min to call Germany 08448350055 from yo..."}),(0,t.jsx)(e.td,{children:"spam"})]})]})]})]})}function o(n={}){const{wrapper:e}={...(0,r.ah)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(h,{...n})}):h(n)}},603905:(n,e,s)=>{s.d(e,{ah:()=>l});var t=s(667294);function r(n,e,s){return e in n?Object.defineProperty(n,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[e]=s,n}function i(n,e){var s=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),s.push.apply(s,t)}return s}function a(n){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?i(Object(s),!0).forEach((function(e){r(n,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(s,e))}))}return n}function d(n,e){if(null==n)return{};var s,t,r=function(n,e){if(null==n)return{};var s,t,r={},i=Object.keys(n);for(t=0;t<i.length;t++)s=i[t],e.indexOf(s)>=0||(r[s]=n[s]);return r}(n,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(t=0;t<i.length;t++)s=i[t],e.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(n,s)&&(r[s]=n[s])}return r}var c=t.createContext({}),l=function(n){var e=t.useContext(c),s=e;return n&&(s="function"==typeof n?n(e):a(a({},e),n)),s},h={inlineCode:"code",wrapper:function(n){var e=n.children;return t.createElement(t.Fragment,{},e)}},o=t.forwardRef((function(n,e){var s=n.components,r=n.mdxType,i=n.originalType,c=n.parentName,o=d(n,["components","mdxType","originalType","parentName"]),x=l(s),p=r,j=x["".concat(c,".").concat(p)]||x[p]||h[p]||i;return s?t.createElement(j,a(a({ref:e},o),{},{components:s})):t.createElement(j,a({ref:e},o))}));o.displayName="MDXCreateElement"},969788:(n,e,s)=>{s.d(e,{Z:()=>t});const t=s.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-5a33ed1aeac871d5b7a7594cc7d702c8.jpg"},803490:(n,e,s)=>{s.d(e,{Z:()=>t});const t=s.p+"assets/images/sql-for-data-science_01-cf19056d8048510033c990eeaae5ce3d.webp"},694057:(n,e,s)=>{s.d(e,{Z:()=>t});const t=s.p+"assets/images/sql-for-data-science_02-3a2f5c3ae89b96e49b2bbab32cfc95ae.webp"},494885:(n,e,s)=>{s.d(e,{Z:()=>t});const t=s.p+"assets/images/sql-for-data-science_03-b1ecbf1733f45ff93a683ae766f57a0d.webp"}}]);