"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[25960],{718774:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});var i=r(785893),a=r(603905);const s={sidebar_position:4740,slug:"2023-02-14",title:"Keras for Tensorflow - An (Re)Introduction 2023",authors:"mpolinowski",tags:["Python","Machine Learning","Keras","Tensorflow"],description:"Keras is built on top of TensorFlow 2 and provides an API designed for human beings."},o=void 0,t={id:"IoT-and-Machine-Learning/ML/2023-02-14-keras-introduction/index",title:"Keras for Tensorflow - An (Re)Introduction 2023",description:"Keras is built on top of TensorFlow 2 and provides an API designed for human beings.",source:"@site/docs/IoT-and-Machine-Learning/ML/2023-02-14-keras-introduction/index.md",sourceDirName:"IoT-and-Machine-Learning/ML/2023-02-14-keras-introduction",slug:"/IoT-and-Machine-Learning/ML/2023-02-14-keras-introduction/2023-02-14",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-02-14-keras-introduction/2023-02-14",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2023-02-14-keras-introduction/index.md",tags:[{label:"Python",permalink:"/docs/tags/python"},{label:"Machine Learning",permalink:"/docs/tags/machine-learning"},{label:"Keras",permalink:"/docs/tags/keras"},{label:"Tensorflow",permalink:"/docs/tags/tensorflow"}],version:"current",sidebarPosition:4740,frontMatter:{sidebar_position:4740,slug:"2023-02-14",title:"Keras for Tensorflow - An (Re)Introduction 2023",authors:"mpolinowski",tags:["Python","Machine Learning","Keras","Tensorflow"],description:"Keras is built on top of TensorFlow 2 and provides an API designed for human beings."},sidebar:"tutorialSidebar",previous:{title:"YOLOv8 with AS-One",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-02-15-as-one-yolo-object-tracking/2023-02-15"},next:{title:"SciKit Wine Quality",permalink:"/docs/IoT-and-Machine-Learning/ML/2023-01-30-predicting-wine-quality/2023-01-30"}},l={},d=[{value:"Building a Keras Model",id:"building-a-keras-model",level:2},{value:"Compiling the Keras Model",id:"compiling-the-keras-model",level:2},{value:"Optimizer",id:"optimizer",level:3},{value:"Losses",id:"losses",level:3},{value:"Metrics",id:"metrics",level:3},{value:"Training the Keras Model",id:"training-the-keras-model",level:2},{value:"Evaluating the Model Performance",id:"evaluating-the-model-performance",level:2}];function c(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.ah)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Guangzhou, China",src:r(158973).Z+"",width:"2830",height:"1272"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#building-a-keras-model",children:"Building a Keras Model"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#compiling-the-keras-model",children:"Compiling the Keras Model"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#optimizer",children:"Optimizer"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#losses",children:"Losses"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#metrics",children:"Metrics"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#training-the-keras-model",children:"Training the Keras Model"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#evaluating-the-model-performance",children:"Evaluating the Model Performance"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/mpolinowski/tf-keras-2023",children:"Github Repository"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://keras.io/getting_started/",children:"Keras"})," is built on top of TensorFlow 2 and provides an API designed for human beings. Keras follows best practices for reducing cognitive load: it offers consistent & simple APIs, it minimizes the number of user actions required for common use cases, and it provides clear & actionable error messages."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"See also:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/IoT-and-Machine-Learning/ML/2023-02-14-keras-introduction/2023-02-14",children:"Keras for Tensorflow - An (Re)Introduction 2023"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/IoT-and-Machine-Learning/ML/2023-02-16-keras-introduction-ann/2023-02-16",children:"Keras for Tensorflow - Artificial Neural Networks"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/IoT-and-Machine-Learning/ML/2023-02-17-keras-introduction-cnn/2023-02-17",children:"Keras for Tensorflow - Convolutional Neural Networks"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/IoT-and-Machine-Learning/ML/2023-02-18-keras-introduction-vgg16/2023-02-18",children:"Keras for Tensorflow - VGG16 Network Architecture"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/IoT-and-Machine-Learning/ML/2023-02-18-keras-introduction-rnn/2023-02-18",children:"Keras for Tensorflow - Recurrent Neural Networks"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"You can export Keras models to JavaScript to run directly in the browser, to TF Lite to run on iOS, Android, and embedded devices. It's also easy to serve Keras models as via a web API."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pip show tensorflow-gpu\n\nName: tensorflow-gpu\nVersion: 2.11.0\nSummary: TensorFlow is an open source machine learning framework for everyone.\nHome-page: https://www.tensorflow.org/\nAuthor: Google Inc.\nAuthor-email: packages@tensorflow.org\nLicense: Apache 2.0\nLocation: /usr/lib/python3.10/site-packages\nRequires: absl-py, astunparse, flatbuffers, gast, google-pasta, grpcio, h5py, keras, libclang, numpy, opt-einsum, packaging, protobuf, setuptools, six, tensorboard, tensorflow-estimator, tensorflow-io-gcs-filesystem, termcolor, typing-extensions, wrapt\nRequired-by:\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pip show keras\n\nName: keras\nVersion: 2.11.0\nSummary: Deep learning for humans.\nHome-page: https://keras.io/\nAuthor: Keras team\nAuthor-email: keras-users@googlegroups.com\nLicense: Apache 2.0\nLocation: /usr/lib/python3.10/site-packages\nRequires: \nRequired-by: tensorflow-gpu\n"})}),"\n",(0,i.jsx)(n.h2,{id:"building-a-keras-model",children:"Building a Keras Model"}),"\n",(0,i.jsxs)(n.p,{children:["We can use Keras to quickly define a Tensorflow neural network with an input and output layer and the dense layers in between. Here is an example for a ",(0,i.jsx)(n.a,{href:"https://keras.io/guides/sequential_model/",children:"Sequential Model"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"from keras.models import Model, Sequential\nfrom keras.layers import Input, Dense\n\n# Define Sequential model with 3 layers\ninput_layer = Input(shape=(3,))\ndense_layer1 = Dense(4)(input_layer)\ndense_layer2 = Dense(4)(dense_layer1)\noutput = Dense(4)(dense_layer2)\n\nmodel = Model(inputs = input_layer, outputs=output)\nmodel = Sequential()\n\nmodel.add(Dense(4, name='dense_layer1', input_shape=(3,)))\nmodel.add(Dense(4, name='dense_layer2'))\nmodel.add(Dense(1, name='output'))\n\nmodel.summary()\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'Model: "sequential"\n_________________________________________________________________\n Layer (type)                Output Shape              Param #   \n=================================================================\n dense_layer1 (Dense)        (None, 4)                 16        \n                                                                 \n dense_layer2 (Dense)        (None, 4)                 20        \n                                                                 \n output (Dense)              (None, 1)                 5         \n                                                                 \n=================================================================\nTotal params: 41\nTrainable params: 41\nNon-trainable params: 0\n_________________________________________________________________\n'})}),"\n",(0,i.jsx)(n.h2,{id:"compiling-the-keras-model",children:"Compiling the Keras Model"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.a,{href:"https://keras.io/api/models/model_training_apis/",children:"compile method"})," configures the model for training. There are three parameter that are mandatory:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"model.compile(optimizer='adam', loss='mean_squared_error', metrics=('accuracy'))\n"})}),"\n",(0,i.jsx)(n.h3,{id:"optimizer",children:"Optimizer"}),"\n",(0,i.jsxs)(n.p,{children:["An ",(0,i.jsx)(n.a,{href:"https://keras.io/api/optimizers/",children:"optimizer"})," is one of the two arguments required for compiling a Keras model. The most often used optimizer is ",(0,i.jsx)(n.a,{href:"https://keras.io/api/optimizers/adam/",children:"Adam"}),". The optimization used is a stochastic gradient descent method that is based on adaptive estimation of first-order and second-order moments. The method is computationally efficient, has little memory requirement, invariant to diagonal rescaling of gradients, and is well suited for problems that are large in terms of data/parameters."]}),"\n",(0,i.jsx)(n.h3,{id:"losses",children:"Losses"}),"\n",(0,i.jsxs)(n.p,{children:["The purpose of ",(0,i.jsx)(n.a,{href:"https://keras.io/api/losses/",children:"loss functions"})," is to compute the quantity that a model should seek to minimize during training."]}),"\n",(0,i.jsx)(n.h3,{id:"metrics",children:"Metrics"}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.a,{href:"https://keras.io/api/metrics/",children:"metric"})," is a function that is used to judge the performance of your model. Metric functions are similar to loss functions, except that the results from evaluating a metric are not used when training the model. Note that you may use any loss function as a metric."]}),"\n",(0,i.jsx)(n.h2,{id:"training-the-keras-model",children:"Training the Keras Model"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.a,{href:"https://keras.io/api/models/model_training_apis/",children:"Fit Method"})," trains the model for a fixed number of epochs (iterations on a dataset):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"# training the model\nmodel.fir(X, y, batch_size=32, epochs=12)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"evaluating-the-model-performance",children:"Evaluating the Model Performance"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.a,{href:"https://keras.io/api/models/model_training_apis/",children:"Evaluate Method"})," returns the loss value & metrics values for the model in test mode. And the ",(0,i.jsx)(n.a,{href:"https://keras.io/api/models/model_training_apis/",children:"Predict Method"})," generates output predictions for the input samples. Computation is done in batches. This method is designed for batch processing of large numbers of inputs. It is not intended for use inside of loops that iterate over your data and process small numbers of inputs at a time:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"# evaluate model performance\nmodel.evaluate(Xval, yval)\nmodel.predict(Xtest)\n"})}),"\n",(0,i.jsx)(n.p,{children:"We take the validation part of our dataset and run predictions on it after training our model with the testing part of the dataset."})]})}function h(e={}){const{wrapper:n}={...(0,a.ah)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},603905:(e,n,r)=>{r.d(n,{ah:()=>d});var i=r(667294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,i)}return r}function o(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function t(e,n){if(null==e)return{};var r,i,a=function(e,n){if(null==e)return{};var r,i,a={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=i.createContext({}),d=function(e){var n=i.useContext(l),r=n;return e&&(r="function"==typeof e?e(n):o(o({},n),e)),r},c={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},h=i.forwardRef((function(e,n){var r=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,h=t(e,["components","mdxType","originalType","parentName"]),p=d(r),u=a,m=p["".concat(l,".").concat(u)]||p[u]||c[u]||s;return r?i.createElement(m,o(o({ref:n},h),{},{components:r})):i.createElement(m,o({ref:n},h))}));h.displayName="MDXCreateElement"},158973:(e,n,r)=>{r.d(n,{Z:()=>i});const i=r.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-f80e63ee872dae25129198058ac93b4e.jpg"}}]);