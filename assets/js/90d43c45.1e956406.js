"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[10392],{907805:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var t=n(785893),a=n(603905);const s={sidebar_position:8060,slug:"2022-01-14",title:"Zabbix v6 Apache 2 Monitor",authors:"mpolinowski",tags:["Zabbix","Linux","Apache"]},o=void 0,i={id:"DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/index",title:"Zabbix v6 Apache 2 Monitor",description:"Guangzhou, China",source:"@site/docs/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/index.md",sourceDirName:"DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor",slug:"/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/2022-01-14",permalink:"/docs/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/2022-01-14",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/index.md",tags:[{label:"Zabbix",permalink:"/docs/tags/zabbix"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"Apache",permalink:"/docs/tags/apache"}],version:"current",sidebarPosition:8060,frontMatter:{sidebar_position:8060,slug:"2022-01-14",title:"Zabbix v6 Apache 2 Monitor",authors:"mpolinowski",tags:["Zabbix","Linux","Apache"]},sidebar:"tutorialSidebar",previous:{title:"Zabbix v6 Docker Monitor",permalink:"/docs/DevOps/Zabbix/2022-01-14--zabbix-docker-monitor/2022-01-14"},next:{title:"Zabbix v6 Docker-Compose Setup",permalink:"/docs/DevOps/Zabbix/2022-01-13--zabbix-server-v6/2022-01-13"}},c={},l=[{value:"Apache Module mod_status",id:"apache-module-mod_status",level:2},{value:"Configure Zabbix Agent",id:"configure-zabbix-agent",level:2},{value:"ERROR :: Apache Process is not running",id:"error--apache-process-is-not-running",level:2}];function h(e){const r={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.ah)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Guangzhou, China",src:n(792058).Z+"",width:"1500",height:"467"})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.a,{href:"#apache-module-mod_status",children:"Apache Module mod_status"})}),"\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.a,{href:"#configure-zabbix-agent",children:"Configure Zabbix Agent"})}),"\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.a,{href:"#error--apache-process-is-not-running",children:"ERROR :: Apache Process is not running"})}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"apache-module-mod_status",children:"Apache Module mod_status"}),"\n",(0,t.jsxs)(r.p,{children:["Activate the ",(0,t.jsx)(r.strong,{children:"Server Status"})," module:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"sudo a2enmod status\n"})}),"\n",(0,t.jsx)(r.p,{children:"And add the configuration to:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"cp /etc/apache2/mods-available/status.conf /etc/apache2/mods-available/status.conf.bak\r\nnano /etc/apache2/mods-available/status.conf\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.a,{href:"https://httpd.apache.org/docs/2.4/mod/mod_status.html",children:"Enabling Status Support"})," for the host you want to monitor:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-html",children:'<IfModule mod_status.c>\r\n        # Allow server status reports generated by mod_status,\r\n        # with the URL of http://servername/server-status\r\n        # Uncomment and change the "192.0.2.0/24" to allow access from other hosts.\r\n\r\n        <Location /server-status>\r\n                SetHandler server-status\r\n\r\n                ##Allow all IPs to access for testing\r\n                #Allow from all\r\n\r\n                ##Allow only localhost and local server IP\r\n                Order deny,allow\r\n                Deny from all\r\n                Allow from 127.0.0.1 ::1\r\n                #Allow from Your.Server.IP.Address.Here\r\n\r\n                ##Limit access from other hosts\r\n                #Require local\r\n                #Require ip 192.0.2.0/24\r\n                #Require host example.com\r\n        </Location>\r\n\r\n        # Keep track of extended status information for each request\r\n        ExtendedStatus On\r\n\r\n        # Determine if mod_status displays the first 63 characters of a request or\r\n        # the last 63, assuming the request itself is greater than 63 chars.\r\n        # Default: Off\r\n        #SeeRequestTail On\r\n        <IfModule mod_proxy.c>\r\n                # Show Proxy LoadBalancer status in mod_status\r\n                ProxyStatus On\r\n        </IfModule>\r\n</IfModule>\n'})}),"\n",(0,t.jsx)(r.p,{children:"Check config integrity and restart:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"apachectl configtest\r\napache2 -t # or httpd -t\r\nsystemctl restart apache2 # or httpd\n"})}),"\n",(0,t.jsx)(r.p,{children:"Or all in one line:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"apache2ctl -t && apache2ctl graceful\n"})}),"\n",(0,t.jsx)(r.p,{children:"Test the status output by:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"curl http://127.0.0.1/server-status?auto\r\n127.0.0.1\r\nServerVersion: Apache/2.4.25 (Debian) OpenSSL/1.0.2q\r\nServerMPM: prefork\r\nServer Built: 2018-11-03T18:46:19\r\nCurrentTime: Tuesday, 09-Nov-2021 07:24:39 CET\r\nRestartTime: Tuesday, 09-Nov-2021 06:44:31 CET\r\nParentServerConfigGeneration: 1\r\nParentServerMPMGeneration: 0\r\nServerUptimeSeconds: 2408\r\nServerUptime: 40 minutes 8 seconds\r\nLoad1: 0.07\r\nLoad5: 0.24\r\nLoad15: 0.53\r\nTotal Accesses: 319\r\nTotal kBytes: 1554\r\nCPUUser: 5.52\r\nCPUSystem: 2.06\r\nCPUChildrenUser: 0\r\nCPUChildrenSystem: 0\r\nCPULoad: .314784\r\nUptime: 2408\r\nReqPerSec: .132475\r\nBytesPerSec: 660.837\r\nBytesPerReq: 4988.39\r\nBusyWorkers: 2\r\nIdleWorkers: 8\r\nScoreboard: _W____W___............................................................................................................................................\r\nTLSSessionCacheStatus\r\nCacheType: SHMCB\r\nCacheSharedMemory: 512000\r\nCacheCurrentEntries: 35\r\nCacheSubcaches: 32\r\nCacheIndexesPerSubcaches: 88\r\nCacheTimeLeftOldestAvg: 123\r\nCacheTimeLeftOldestMin: 0\r\nCacheTimeLeftOldestMax: 262\r\nCacheIndexUsage: 1%\r\nCacheUsage: 1%\r\nCacheStoreCount: 279\r\nCacheReplaceCount: 0\r\nCacheExpireCount: 244\r\nCacheDiscardCount: 0\r\nCacheRetrieveHitCount: 0\r\nCacheRetrieveMissCount: 38\r\nCacheRemoveHitCount: 0\r\nCacheRemoveMissCount: 0\n"})}),"\n",(0,t.jsx)(r.h2,{id:"configure-zabbix-agent",children:"Configure Zabbix Agent"}),"\n",(0,t.jsxs)(r.p,{children:["Stat by adding the ",(0,t.jsx)(r.strong,{children:"Apache by Zabbix Agent"})," template:"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Zabbix Apache Monitor",src:n(321323).Z+"",width:"1040",height:"397"})}),"\n",(0,t.jsxs)(r.p,{children:["Make sure that the server is set to ",(0,t.jsx)(r.code,{children:"127.0.0.1"})," and save the configuration:"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Zabbix Apache Monitor",src:n(551779).Z+"",width:"1033",height:"607"})}),"\n",(0,t.jsx)(r.p,{children:"Check latest data to see if your agent is working:"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Zabbix Apache Monitor",src:n(556803).Z+"",width:"1242",height:"393"})}),"\n",(0,t.jsx)(r.h2,{id:"error--apache-process-is-not-running",children:"ERROR :: Apache Process is not running"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Zabbix Apache Monitor",src:n(933473).Z+"",width:"1058",height:"90"})}),"\n",(0,t.jsxs)(r.p,{children:["The process name is set to ",(0,t.jsx)(r.code,{children:"httpd"})," by default - which is correct for Apache on CentOS. But has to be changed to ",(0,t.jsx)(r.code,{children:"apache2"})," for Debian:"]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Zabbix Apache Monitor",src:n(339490).Z+"",width:"1203",height:"224"})})]})}function d(e={}){const{wrapper:r}={...(0,a.ah)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},603905:(e,r,n)=>{n.d(r,{ah:()=>l});var t=n(667294);function a(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function s(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function o(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?s(Object(n),!0).forEach((function(r){a(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function i(e,r){if(null==e)return{};var n,t,a=function(e,r){if(null==e)return{};var n,t,a={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],r.indexOf(n)>=0||(a[n]=e[n]);return a}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=t.createContext({}),l=function(e){var r=t.useContext(c),n=r;return e&&(n="function"==typeof e?e(r):o(o({},r),e)),n},h={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},d=t.forwardRef((function(e,r){var n=e.components,a=e.mdxType,s=e.originalType,c=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),p=l(n),u=a,b=p["".concat(c,".").concat(u)]||p[u]||h[u]||s;return n?t.createElement(b,o(o({ref:r},d),{},{components:n})):t.createElement(b,o({ref:r},d))}));d.displayName="MDXCreateElement"},321323:(e,r,n)=>{n.d(r,{Z:()=>t});const t=n.p+"assets/images/Zabbix_v6_Apache_Monitor_01-5015944f27e6f83af010faa1a1863199.png"},556803:(e,r,n)=>{n.d(r,{Z:()=>t});const t=n.p+"assets/images/Zabbix_v6_Apache_Monitor_02-2bc1023ccecdfa7f5dfde76bc42fc034.png"},551779:(e,r,n)=>{n.d(r,{Z:()=>t});const t=n.p+"assets/images/Zabbix_v6_Apache_Monitor_03-fdf020942fd10ce902106488c37004cd.png"},933473:(e,r,n)=>{n.d(r,{Z:()=>t});const t=n.p+"assets/images/Zabbix_v6_Apache_Monitor_04-4eb8f75b8869aaf3d660f3b18916b6bf.png"},339490:(e,r,n)=>{n.d(r,{Z:()=>t});const t=n.p+"assets/images/Zabbix_v6_Apache_Monitor_05-321aad164b1c13b21462a29890d9b9f7.png"},792058:(e,r,n)=>{n.d(r,{Z:()=>t});const t=n.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-539dc0d90c8fd4caf3d5cd5162b8ded5.jpg"}}]);