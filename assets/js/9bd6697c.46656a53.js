"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[43197],{933385:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>t,metadata:()=>o,toc:()=>l});var s=n(474848),i=n(28453);const t={sidebar_position:5960,slug:"2023-02-03",title:"ARM Docker",authors:"mpolinowski",tags:["LINUX","Docker"],description:"Installing Docker on a Raspberry Pi"},a=void 0,o={id:"DevOps/Linux/2023-02-03--installing-docker-raspberry-pi/index",title:"ARM Docker",description:"Installing Docker on a Raspberry Pi",source:"@site/docs/DevOps/Linux/2023-02-03--installing-docker-raspberry-pi/index.md",sourceDirName:"DevOps/Linux/2023-02-03--installing-docker-raspberry-pi",slug:"/DevOps/Linux/2023-02-03--installing-docker-raspberry-pi/2023-02-03",permalink:"/docs/DevOps/Linux/2023-02-03--installing-docker-raspberry-pi/2023-02-03",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Linux/2023-02-03--installing-docker-raspberry-pi/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"},{label:"Docker",permalink:"/docs/tags/docker"}],version:"current",sidebarPosition:5960,frontMatter:{sidebar_position:5960,slug:"2023-02-03",title:"ARM Docker",authors:"mpolinowski",tags:["LINUX","Docker"],description:"Installing Docker on a Raspberry Pi"},sidebar:"tutorialSidebar",previous:{title:"Music Player Daemon",permalink:"/docs/DevOps/Linux/2023-03-12--installing-music-player-daemon/2023-03-12"},next:{title:"Resistance is futile - Borg with Docker",permalink:"/docs/DevOps/Linux/2022-11-09--docker-borg-backupserver/2022-11-09"}},c={},l=[{value:"Preparing the RaspberryPI",id:"preparing-the-raspberrypi",level:2},{value:"Installing Docker",id:"installing-docker",level:2}];function d(e){const r={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{alt:"TST, Hong Kong",src:n(975703).A+"",width:"1500",height:"517"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#preparing-the-raspberrypi",children:"Preparing the RaspberryPI"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"#installing-docker",children:"Installing Docker"})}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://www.docker.com/blog/happy-pi-day-docker-raspberry-pi/",children:"Happy Pi Day with Docker and Raspberry Pi"})}),"\n",(0,s.jsx)(r.h2,{id:"preparing-the-raspberrypi",children:"Preparing the RaspberryPI"}),"\n",(0,s.jsxs)(r.p,{children:["I am downloading a ",(0,s.jsx)(r.strong,{children:"Raspberry Pi 3B+"})," compatible ",(0,s.jsx)(r.a,{href:"https://raspi.debian.net/tested-images/",children:"Debian Bullseye Image"})," and bring it ",(0,s.jsx)(r.a,{href:"https://etcher.io",children:"onto an SD card"}),". To activate the SSH service you are have to add an empty file ",(0,s.jsx)(r.code,{children:"ssh"})," to the ",(0,s.jsx)(r.code,{children:"boot"})," directory - though remote logins are deactivated by default and need to be configured by attaching a keyboard and monitor. There should be a way to do this by a post-install script, but I could not find it on a quick skim:"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"cd /run/media/myuser/RASPIROOT/boot/\r\ntouch ssh\n"})}),"\n",(0,s.jsx)(r.p,{children:"To activate the login first generate a password for the root account by running:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"passwd\n"})}),"\n",(0,s.jsxs)(r.p,{children:["And edit the following line in ",(0,s.jsx)(r.code,{children:"/etc/ssh/sshd_config"}),":"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"# FROM:\r\n# PermitRootLogin without-password\r\n# TO:\r\nPermitRootLogin yes\n"})}),"\n",(0,s.jsx)(r.p,{children:"Now restart the SSH daemon with:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"systemctl sshd restart\r\nsystemctl sshd status\n"})}),"\n",(0,s.jsx)(r.h2,{id:"installing-docker",children:"Installing Docker"}),"\n",(0,s.jsx)(r.p,{children:"Install the following prerequisites:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"apt update && apt upgrade -y\r\napt install curl apt-transport-https ca-certificates software-properties-common -y\n"})}),"\n",(0,s.jsx)(r.p,{children:"Import Docker CPG key (I think this isautomatically done by the install script below):"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"curl -fsSL https://download.docker.com/linux/raspbian/gpg | gpg --dearmor -o /etc/apt/keyrings/docker.gpg\n"})}),"\n",(0,s.jsx)(r.p,{children:"Use the following command to set up the repository:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:'echo \\\r\n  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/raspbian/ \\\r\n  $(lsb_release -cs) stable" | tee /etc/apt/sources.list.d/docker.list > /dev/null\n'})}),"\n",(0,s.jsx)(r.p,{children:"Download and install Docker:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"curl -fsSL get.docker.com -o get-docker.sh && sh get-docker.sh\n"})}),"\n",(0,s.jsx)(r.p,{children:"Become root-less:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"sudo usermod -aG docker $USER\r\nnewgrp docker\n"})}),"\n",(0,s.jsx)(r.p,{children:"Make sure the service is enabled and started (should already have happened by the install script):"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"systemctl enable docker.service\r\nsystemctl start docker.service\r\nservice docker status\n"})}),"\n",(0,s.jsx)(r.p,{children:"Verify everything is in order:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"docker info\r\n\r\nClient:\r\n Context:    default\r\n Debug Mode: false\r\n Plugins:\r\n  buildx: Docker Buildx (Docker Inc.)\r\n    Version:  v0.10.2\r\n    Path:     /usr/libexec/docker/cli-plugins/docker-buildx\r\n  compose: Docker Compose (Docker Inc.)\r\n    Version:  v2.15.1\r\n    Path:     /usr/libexec/docker/cli-plugins/docker-compose\r\n\r\n    ...\r\n\r\n Kernel Version: 5.10.0-21-arm64\r\n Operating System: Debian GNU/Linux 11 (bullseye)\r\n OSType: linux\r\n Architecture: aarch64\r\n CPUs: 4\r\n Total Memory: 906.6MiB\r\n Name: rpi3-20230102\n"})}),"\n",(0,s.jsx)(r.p,{children:"\ud83d\udc4d"}),"\n",(0,s.jsxs)(r.p,{children:["If you need it run modprobe to load the kernel modules for iptables - e.g. for the ",(0,s.jsx)(r.a,{href:"/docs/Automation_and_Robotics/Home_Automation/2023-01-23-thread-edge-router-docker/2023-01-23",children:"Open Thread Edge Router"}),":"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"sudo modprobe ip_tables\r\nsudo modprobe ip6table_filter\n"})})]})}function p(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},975703:(e,r,n)=>{n.d(r,{A:()=>s});const s=n.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-ec671595d585b88a85b017a7908fb619.jpg"},28453:(e,r,n)=>{n.d(r,{R:()=>a,x:()=>o});var s=n(296540);const i={},t=s.createContext(i);function a(e){const r=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);