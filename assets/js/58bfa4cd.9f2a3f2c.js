"use strict";(self.webpackChunkmikes_dev_notebook=self.webpackChunkmikes_dev_notebook||[]).push([[55294],{95103:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>t,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var i=n(474848),r=n(28453);const o={sidebar_position:5080,slug:"2022-01-23",title:"Installing a Discourse Forum on Debian Bullseye with Docker",authors:"mpolinowski",tags:["LINUX"]},t=void 0,a={id:"DevOps/Provisioning/2022-01-23--installing-discourse-docker/index",title:"Installing a Discourse Forum on Debian Bullseye with Docker",description:"Shenzhen, China",source:"@site/docs/DevOps/Provisioning/2022-01-23--installing-discourse-docker/index.md",sourceDirName:"DevOps/Provisioning/2022-01-23--installing-discourse-docker",slug:"/DevOps/Provisioning/2022-01-23--installing-discourse-docker/2022-01-23",permalink:"/docs/DevOps/Provisioning/2022-01-23--installing-discourse-docker/2022-01-23",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Provisioning/2022-01-23--installing-discourse-docker/index.md",tags:[{label:"LINUX",permalink:"/docs/tags/linux"}],version:"current",sidebarPosition:5080,frontMatter:{sidebar_position:5080,slug:"2022-01-23",title:"Installing a Discourse Forum on Debian Bullseye with Docker",authors:"mpolinowski",tags:["LINUX"]},sidebar:"tutorialSidebar",previous:{title:"Getting to know the BIND9 DNS Server with Docker",permalink:"/docs/DevOps/Provisioning/2022-01-24--getting-to-know-bind9-docker/2022-01-24"},next:{title:"Matrix Secure Messaging",permalink:"/docs/DevOps/Provisioning/2021-10-25--matrix-secure-messaging/2021-10-25"}},c={},l=[{value:"Install Discourse",id:"install-discourse",level:2},{value:"Setting Up an SMTP EMail Server",id:"setting-up-an-smtp-email-server",level:2},{value:"Edit Discourse Configuration",id:"edit-discourse-configuration",level:2},{value:"Start Discourse",id:"start-discourse",level:2},{value:"Register New Account and Become Admin",id:"register-new-account-and-become-admin",level:3},{value:"Manual Update (Discourse CLI)",id:"manual-update-discourse-cli",level:2}];function d(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Shenzhen, China",src:n(691165).A+"",width:"1500",height:"671"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"#install-discourse",children:"Install Discourse"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"#setting-up-an-smtp-email-server",children:"Setting Up an SMTP EMail Server"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"#edit-discourse-configuration",children:"Edit Discourse Configuration"})}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.a,{href:"#start-discourse",children:"Start Discourse"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"#register-new-account-and-become-admin",children:"Register New Account and Become Admin"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"#manual-update-discourse-cli",children:"Manual Update (Discourse CLI)"})}),"\n"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["See also ",(0,i.jsx)(s.a,{href:"/docs/DevOps/Provisioning/2019-06-15--installing-discourse-on-centos8/2019-06-15/",children:"Installing Discourse on Centos 8"})]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"install-discourse",children:"Install Discourse"}),"\n",(0,i.jsxs)(s.p,{children:["Clone the ",(0,i.jsx)(s.a,{href:"https://github.com/discourse/discourse_docker",children:"Official Discourse Docker Image"})," into ",(0,i.jsx)(s.code,{children:"/opt/discourse"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"mkdir /opt/discourse\r\ngit clone https://github.com/discourse/discourse_docker.git /opt/discourse\r\ncd /opt/discourse\n"})}),"\n",(0,i.jsx)(s.h2,{id:"setting-up-an-smtp-email-server",children:"Setting Up an SMTP EMail Server"}),"\n",(0,i.jsxs)(s.p,{children:["Already have a mail server? Great. Use your existing mail server credentials. (Free email services like Gmail/Outlook/Yahoo do not support transactional emails.) No existing mail server? Check out the ",(0,i.jsx)(s.a,{href:"https://meta.discourse.org/t/troubleshooting-email-on-a-new-discourse-install/16326",children:"Email Troubleshooting Guide"}),"."]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Also make sure that you have a valid Domain pointing to your Discourse server"})}),"\n",(0,i.jsx)(s.h2,{id:"edit-discourse-configuration",children:"Edit Discourse Configuration"}),"\n",(0,i.jsx)(s.p,{children:"Launch the setup tool at"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"./discourse-setup\n"})}),"\n",(0,i.jsx)(s.p,{children:"Answer the following questions when prompted:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-yml",children:"Hostname for your Discourse? [discourse.example.com]: \r\nEmail address for admin account(s)? [me@example.com,you@example.com]: \r\nSMTP server address? [smtp.example.com]: \r\nSMTP port? [587]: \r\nSMTP user name? [user@example.com]: \r\nSMTP password? [pa$$word]: \r\nnotification email address? [noreply@forum.instar.com]:\r\nLet's Encrypt account email? (ENTER to skip) [me@example.com]: \n"})}),"\n",(0,i.jsxs)(s.p,{children:["You'll get the SMTP details from your email setup, be sure to ",(0,i.jsx)(s.a,{href:"#setting-up-an-smtp-email-server",children:"complete that section"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["This will generate an app.yml configuration file on your behalf, and then kicks off bootstrap. ",(0,i.jsx)(s.strong,{children:"Bootstrapping takes between 2-8 minutes"})," to set up your Discourse. If you need to change these settings after bootstrapping, you can run ",(0,i.jsx)(s.code,{children:"/opt/discourse/discourse-setup"})," again (it will re-use your previous values from the file) or edit ",(0,i.jsx)(s.code,{children:"/opt/discourse/containers/app.yml"})," manually with nano and then ",(0,i.jsx)(s.code,{children:"/opt/discourse/launcher rebuild app"}),", otherwise your changes will not take effect."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"ERROR"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"Updates successful. Rebuilding in 5 seconds.\r\nBuilding app\r\nx86_64 arch detected.\r\nEnsuring launcher is up to date\r\nFetching origin\r\nLauncher is up-to-date\r\n(<unknown>): did not find expected key while parsing a block mapping at line 40 column 3 -e LANG=en_US.UTF-8\r\nYAML syntax error. Please check your containers/*.yml config files.\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsx)(s.p,{children:"Make sure not to put single quotes around your admin email accounts!"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Wrong way:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-yml",children:"Email address for admin account(s)? [me@example.com,you@example.com]: 'me@example.com,you@example.com'\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Go to ",(0,i.jsx)(s.code,{children:"/opt/discourse/containers/app.yml"})," and remove the double single-quotes around your emails and re-run ",(0,i.jsx)(s.code,{children:"./discourse-setup"}),"."]}),"\n",(0,i.jsx)(s.h2,{id:"start-discourse",children:"Start Discourse"}),"\n",(0,i.jsxs)(s.p,{children:["Once bootstrapping is complete, your Discourse should be accessible in your web browser via the domain name ",(0,i.jsx)(s.code,{children:"discourse.example.com"})," you entered earlier."]}),"\n",(0,i.jsx)(s.h3,{id:"register-new-account-and-become-admin",children:"Register New Account and Become Admin"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Installing a Discourse Forum",src:n(990292).A+"",width:"1145",height:"438"})}),"\n",(0,i.jsx)(s.h2,{id:"manual-update-discourse-cli",children:"Manual Update (Discourse CLI)"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"cd /opt/discourse\r\n./launcher rebuild app\n"})}),"\n",(0,i.jsx)(s.p,{children:"If you are running low on disk space:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"./launcher cleanup\n"})})]})}function u(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},990292:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/Discourse_Forum_01-c706d4c9c608b8d9344607b5cfaeb415.png"},691165:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-bac99ee9472bf0354e396ff811a46d92.jpg"},28453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>a});var i=n(296540);const r={},o=i.createContext(r);function t(e){const s=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:s},e.children)}}}]);