<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Development/Graphs/2020-05-01--getting-to-know-neo4j/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Getting to Know Neo4j | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/Development/Graphs/2020-05-01--getting-to-know-neo4j/2020-05-01"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Getting to Know Neo4j | Mike Polinowski"><meta data-rh="true" name="description" content="Mongkok, Hong Kong"><meta data-rh="true" property="og:description" content="Mongkok, Hong Kong"><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/Development/Graphs/2020-05-01--getting-to-know-neo4j/2020-05-01"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/Development/Graphs/2020-05-01--getting-to-know-neo4j/2020-05-01" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/Development/Graphs/2020-05-01--getting-to-know-neo4j/2020-05-01" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.08c8c484.css">
<script src="/assets/js/runtime~main.ab71403f.js" defer="defer"></script>
<script src="/assets/js/main.88c0252d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/development">Development</a><button aria-label="Collapse sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/javascript">Javascript</a><button aria-label="Expand sidebar category &#x27;Javascript&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/python">Python</a><button aria-label="Expand sidebar category &#x27;Python&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/go">Go</a><button aria-label="Expand sidebar category &#x27;Go&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/graphs">Graphs</a><button aria-label="Collapse sidebar category &#x27;Graphs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Graphs/2020-05-05--graphql-queries-and-mutations/2020-05-05">GraphQL Queries and Mutations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Graphs/2020-05-04--neo4j-corona-tracing/2020-05-04">Neo4j Corona Tracing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Graphs/2020-05-03--neo4j-cheat-sheet/2020-05-03">Neo4j Cypher Cheat Sheet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Development/Graphs/2020-05-02--neo4j-movie-graph/2020-05-02">Neo4j Movie Graph</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Development/Graphs/2020-05-01--getting-to-know-neo4j/2020-05-01">Getting to Know Neo4j</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/react-native">React Native</a><button aria-label="Expand sidebar category &#x27;React Native&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/magento">Magento</a><button aria-label="Expand sidebar category &#x27;Magento&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/misc">Misc</a><button aria-label="Expand sidebar category &#x27;Misc&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/devops">DevOps</a><button aria-label="Expand sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/machine-learning-ai-and-computer-vision">Machine Learning, AI and Computer Vision</a><button aria-label="Expand sidebar category &#x27;Machine Learning, AI and Computer Vision&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/automation-deep-vision-and-robotics">Automation, Deep Vision and Robotics</a><button aria-label="Expand sidebar category &#x27;Automation, Deep Vision and Robotics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/development"><span itemprop="name">Development</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/graphs"><span itemprop="name">Graphs</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Getting to Know Neo4j</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Getting to Know Neo4j</h1></header><p><img alt="Mongkok, Hong Kong" src="/assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-cfa958512a1425cc02b1dd65aee8b14b.jpg" width="1500" height="607"></p>
<ul>
<li><a href="#running-in-docker">Running in Docker</a></li>
<li><a href="#cypher">Cypher</a>
<ul>
<li><a href="#create">CREATE</a></li>
<li><a href="#match">MATCH</a></li>
<li><a href="#merge">MERGE</a></li>
<li><a href="#where-with-and-and">WHERE, WITH and AND</a></li>
<li><a href="#set">SET</a></li>
<li><a href="#remove">REMOVE</a></li>
<li><a href="#with">WITH</a></li>
<li><a href="#delete">DELETE</a></li>
<li><a href="#null">NULL</a></li>
<li><a href="#nth-degree-relationships">Nth Degree Relationships</a></li>
</ul>
</li>
<li><a href="#importing-scripts">Importing Scripts</a></li>
</ul>
<h2 id="running-in-docker">Running in Docker</h2>
<p>Create the folders Neo4j will need to persists it&#x27;s data:</p>
<pre><code class="language-bash">mkdir /opt/neo4j/data
mkdir /opt/neo4j/logs
mkdir /opt/neo4j/import
mkdir /opt/neo4j/plugins
</code></pre>
<p><code>chown 101:101</code> all folders to make them available for your Docker user.</p>
<p>Pull and run the latest version of Neo4j from Docker Hub.</p>
<pre><code class="language-bash">docker run \
    --name neo4j \
    -p7474:7474 -p7687:7687 \
    -d \
    -v /opt/neo4j/data:/data \
    -v /opt/neo4j/logs:/logs \
    -v /opt/neo4j/import:/var/lib/neo4j/import \
    -v /opt/neo4j/plugins:/plugins \
    --env NEO4J_AUTH=neo4j/password \
    neo4j:latest
</code></pre>
<p>By default, the Docker image exposes three ports for remote access:</p>
<ul>
<li>
<p>7474 for HTTP</p>
</li>
<li>
<p>7473 for HTTPS</p>
</li>
<li>
<p>7687 for Bolt</p>
</li>
</ul>
<p>Now head over to <code>localhost:7474</code> with your browser and login with <code>neo4j/password</code>.</p>
<h2 id="cypher">Cypher</h2>
<h3 id="create">CREATE</h3>
<p>Use the <strong>Create</strong> command to create nodes with properties and relationships.</p>
<pre><code class="language-bash">CREATE(p1: Person{name:&#x27;Susanne Colgate&#x27;}) -[r:UNIVERSITY_BERKELEY{attr:&#x27;Susanne followed Simon&#x27;}]-&gt; (p2: Person{name: &#x27;Simon Scabourough&#x27;}) RETURN p1,p2,r
</code></pre>
<p>Create two nodes of type <strong>Person</strong> and the property <strong>Name</strong> and set them into a <strong>Relationship</strong>, e.g. both persons went to the same university. The return command allows us to see a visualization of the result of our query.</p>
<h3 id="match">MATCH</h3>
<p>Use the <strong>Match</strong> command to find pattern among your nodes.</p>
<pre><code class="language-bash">MATCH (p1: Person {name:&#x27;Simon Scabourough&#x27;}), (p2:Person {name: &#x27;Susanne Colgate&#x27;})
CREATE (p1) -[r:APPLIED_PHYSICS{attr:&#x27;Susanne invited Simon&#x27;}]-&gt; (p2)
RETURN p1,p2,r
</code></pre>
<p>Find two nodes of type <strong>Person</strong> with specific <strong>Name</strong> properties and add a new relationship between them - a shared course at the university.</p>
<pre><code class="language-bash">MATCH (p1:Person {name: &#x27;Simon Scabourough&#x27;})-[r:APPLIED_PHYSICS]-&gt;(p2)
RETURN p2
</code></pre>
<p>Show me who joined Simon in his AP1 course.</p>
<pre><code class="language-bash">MATCH ()-[r:UNIVERSITY_BERKLY]-&gt;(p2)
RETURN p2
</code></pre>
<p>Show me everyone who was invited into Berkley.</p>
<h3 id="merge">MERGE</h3>
<p>Just like the match operator you get the nodes or relationships returned. But unlike match, if the node, property or relationship does not exist it will be created by the merge query:</p>
<pre><code class="language-bash">MATCH (person:Person{name:&#x27;Josefine Strudelbäcker&#x27;})
RETURN person
</code></pre>
<p>Does not find anything - Merge creates the node for you:</p>
<pre><code class="language-bash">MERGE (person:Person{name:&#x27;Josefine Strudelbäcker&#x27;})
MERGE (bäckerei:Work{name:&#x27;Zum Zipfelkratsch&#x27;})
MERGE (person)-[:Worked_IN]-&gt;(bäckerei)
RETURN person, bäckerei
</code></pre>
<p><strong>ON CREATE SET</strong></p>
<p>The Merge Operator will either create the node or update it if it already exists. Everything after On Create will only be executed if the node does not yet exists:</p>
<pre><code class="language-bash">MERGE (location:Location{name: &#x27;Linz&#x27;})
ON CREATE SET location.created_at = timestamp(), location.created_by = &#x27;GPS100x5&#x27;
RETURN location
</code></pre>
<p><strong>ON MATCH SET</strong></p>
<p>If we want to update a property every time we get a match:</p>
<pre><code class="language-bash">MERGE (location:Location{name: &#x27;Linz&#x27;})
ON CREATE SET location.created_at = timestamp(), location.update_count = 0
ON MATCH SET location.modified_at = timestamp(), location.update_count = (location.update_count + 1)
RETURN location
</code></pre>
<p>How often die Keanu Reeves watch Top Gun? Increment a relationship property every time a query is run:</p>
<pre><code class="language-bash">MATCH (actor:Person{name: &#x27;Keanu Reeves&#x27;})
MATCH (movie:Movie{title: &#x27;Top Gun&#x27;})
MERGE (actor)-[rel:VIEWED]-&gt;(movie)
ON CREATE SET rel.count = 1
ON MATCH SET rel.count = (rel.count + 1) 
RETURN actor, movie
</code></pre>
<p><img alt="Getting to know Neo4j" src="/assets/images/Getting_to_know_Cypher_03-e4e99a1fb150824abd04fe243248b487.png" width="1142" height="603"></p>
<h3 id="where-with-and-and">WHERE, WITH and AND</h3>
<pre><code class="language-bash">MATCH (a:Person),(b:Person)
WHERE a.name=&#x27;Simon Scabourough&#x27; AND b.name=&#x27;Susanne Colgate&#x27;
WITH a,b
CREATE (a) -[r:ANALYTICAL_CHEMISTRY]-&gt;(b)
RETURN a,b,r
</code></pre>
<h3 id="set">SET</h3>
<p>Use the <strong>Set</strong> command to change a property of a node.</p>
<pre><code class="language-bash">MATCH (p:Person{name: &#x27;Susanne Colgate&#x27;})
SET p.name= &#x27;Susan Colgate&#x27;
RETURN p
</code></pre>
<p><strong>Set</strong> can also be used to create an property:</p>
<pre><code class="language-bash">MATCH (p:Person {name: &#x27;Susan Colgate&#x27;})
SET p.title = &#x27;Freshman&#x27;
RETURN p
</code></pre>
<p>Or to set a relationship:</p>
<pre><code class="language-bash">MATCH (director:Person{name:&#x27;Clint Eastwood&#x27;}),
(movies:Movie)&lt;-[rel:DIRECTED]-(director)
SET rel.rating = 5
</code></pre>
<p>Or to set another label:</p>
<pre><code class="language-bash">MATCH (director:Person{name:&#x27;Clint Eastwood&#x27;}),
(movies:Movie)&lt;-[rel:DIRECTED]-(director)
SET director:Hero
</code></pre>
<p>Setting a relationship to a new type is not supported by Neo4j. But you can create a new relationship and copy over the old properties:</p>
<pre><code class="language-bash">MATCH (actor1:Person{name:&#x27;Tom Hanks&#x27;})-[old_rel:HAS_CONTACT]-&gt;(actor2:Person{name:&#x27;Al Pacino&#x27;})
CREATE (actor1)-[new_rel:OLD_CONTACT]-&gt;(actor2)
SET new_rel=old_rel
DELETE old_rel
RETURN actor1, actor2
</code></pre>
<h3 id="remove">REMOVE</h3>
<p>Remove a relationship:</p>
<pre><code class="language-bash">MATCH (director:Person{name:&#x27;Clint Eastwood&#x27;}),
(movies:Movie)&lt;-[rel:DIRECTED]-(director)
REMOVE rel.rating
</code></pre>
<p>Remove a label:</p>
<pre><code class="language-bash">MATCH (director:Person{name:&#x27;Clint Eastwood&#x27;}),
(movies:Movie)&lt;-[rel:DIRECTED]-(director)
REMOVE director:Hero
</code></pre>
<h3 id="with">WITH</h3>
<p>Set dynamic properties to nodes with the <strong>WITH</strong> operator:</p>
<pre><code class="language-bash">MATCH (actor:Person{name:&#x27;Tom Hanks&#x27;})-[rel:ACTED_IN]-&gt;(movie)
WITH actor, count(movie) AS num_of_movies
SET actor.num_of_movies = num_of_movies
RETURN actor
</code></pre>
<p><img alt="Getting to know Neo4j" src="/assets/images/Getting_to_know_Cypher_02-398c07f9fcba1cdc3c71dc109672fd0e.png" width="1416" height="929"></p>
<h3 id="delete">DELETE</h3>
<pre><code class="language-bash">MATCH (n)
DELETE n
</code></pre>
<p>Only works if Nodes don&#x27;t have any relations - otherwise those have to be selected and deleted as well.</p>
<p><strong>Delete All</strong>:</p>
<pre><code class="language-bash">MATCH (n)
OPTIONAL MATCH (n)-[r]-()
DELETE n,r
</code></pre>
<p>Select all nodes and relationships and delete the selection.</p>
<p>Or short - remove node and cut all relations that were attached to it:</p>
<pre><code>MATCH (node)
DETACH DELETE node
</code></pre>
<p>Selective delete:</p>
<pre><code class="language-bash">MATCH (actor:Person{name:&#x27;Tom Cruise&#x27;}),
(movies:Movie)&lt;-[:ACTED_IN]-(actor)
DETACH DELETE movies
</code></pre>
<h3 id="null">NULL</h3>
<p>Give me all person nodes that have a earnings property that is not undefined:</p>
<pre><code class="language-bash">MATCH (person:Person)
WHERE person.earnings IS NOT NULL
RETURN person
</code></pre>
<h3 id="nth-degree-relationships">Nth Degree Relationships</h3>
<p>Get all 1st degree contacts of actor Keanu Reeves:</p>
<pre><code class="language-bash">MATCH (actor:Person{name:&#x27;Keanu Reeves&#x27;})-[:HAS_CONTACT]-&gt;(contact)
RETURN actor, contact
</code></pre>
<p>Get all 2nd degree contacts:</p>
<pre><code class="language-bash">MATCH (actor:Person{name:&#x27;Keanu Reeves&#x27;})-[:HAS_CONTACT]-&gt;(contact)-[:HAS_CONTACT]-&gt;(contact2)
RETURN actor, contact2
</code></pre>
<p>Get the nth degree contacts by simply adding <strong>*n</strong> to the relationship in question - e.g. get the 5th degree contacts:</p>
<pre><code class="language-bash">MATCH (actor:Person{name:&#x27;Keanu Reeves&#x27;})-[rel:HAS_CONTACT*5]-&gt;(contact)
RETURN actor, rel, contact
LIMIT 1
</code></pre>
<p>Show all 0 - 2nd degree contacts:</p>
<pre><code class="language-bash">MATCH (actor:Person{name:&#x27;Keanu Reeves&#x27;})-[rel:HAS_CONTACT*0..2]-&gt;(contact)
RETURN actor, rel, contact
LIMIT 5
</code></pre>
<p><strong>PATH</strong></p>
<p>How many contacts are between Keanu Reeves and Tom Cruise:</p>
<pre><code class="language-bash">MATCH (neo:Person{name:&#x27;Keanu Reeves&#x27;})
MATCH (maverick:Person{name:&#x27;Tom Cruise&#x27;})
MATCH path=((neo)-[rel:HAS_CONTACT*]-&gt;(maverick))
RETURN length(path)
LIMIT 1
</code></pre>
<p>To find the shortest path limit the degree of contact until no path can be found anymore:</p>
<pre><code class="language-bash">MATCH (neo:Person{name:&#x27;Keanu Reeves&#x27;})
MATCH (maverick:Person{name:&#x27;Tom Cruise&#x27;})
MATCH path=((neo)-[rel:HAS_CONTACT*..2]-&gt;(maverick))
RETURN length(path) AS path_length
LIMIT 1
</code></pre>
<p>The minimum path length is 2.</p>
<p>The easier way to find the path length is the <strong>SHORTEST PATH</strong> function:</p>
<pre><code class="language-bash">MATCH (neo:Person{name:&#x27;Keanu Reeves&#x27;})
MATCH (maverick:Person{name:&#x27;Tom Cruise&#x27;})
MATCH path=shortestPath((neo)-[rel:HAS_CONTACT*..20]-&gt;(maverick))
RETURN length(path) AS path_length
</code></pre>
<p>Since there might be several shortest paths we can use the <strong>allShortestPath</strong> function to resolve all of them:</p>
<pre><code class="language-bash">MATCH (neo:Person{name:&#x27;Keanu Reeves&#x27;})
MATCH (maverick:Person{name:&#x27;Tom Cruise&#x27;})
MATCH path=allShortestPaths((neo)-[rel:HAS_CONTACT*..20]-&gt;(maverick))
RETURN path, length(path) AS path_length
</code></pre>
<p>Get the shortest path between actors that acted in the movie The Matrix and actors from the movie Top Gun:</p>
<pre><code class="language-bash">MATCH (actor1:Person)-[:ACTED_IN]-&gt;(movie1:Movie{title:&#x27;Top Gun&#x27;}),(actor2:Person)-[:ACTED_IN]-&gt;(movie2:Movie{title:&#x27;The Matrix&#x27;}), path = shortestPath((actor1)-[:HAS_CONTACT*..20]-&gt;(actor2))
RETURN path, movie1, movie2, length(path) AS pathLength
ORDER BY pathLength
LIMIT 2
</code></pre>
<p>To exclude path where an actor worked in both movies:</p>
<pre><code class="language-bash">MATCH (actor1:Person)-[:ACTED_IN]-&gt;(movie1:Movie{title:&#x27;Top Gun&#x27;}),(actor2:Person)-[:ACTED_IN]-&gt;(movie2:Movie{title:&#x27;The Matrix&#x27;}), path = shortestPath((actor1)-[:HAS_CONTACT*..20]-&gt;(actor2))
WHERE actor1 &lt;&gt; actor2
RETURN path, movie1, movie2, length(path) AS pathLength
ORDER BY pathLength
LIMIT 1
</code></pre>
<p><img alt="Getting to know Neo4j" src="/assets/images/Getting_to_know_Cypher_04-e4c5578c61c2b3134ed19a5b482e2fa8.png" width="1143" height="729"></p>
<h2 id="importing-scripts">Importing Scripts</h2>
<p>Just write down all your Cypher queries into a text file. Add a comment on top to name the script:</p>
<pre><code class="language-bash">// Neo4j Sample Data
CREATE(p1: Person{name:&#x27;Susanne Colgate&#x27;}) -[r:UNIVERSITY_BERKELEY{attr:&#x27;Susanne followed Simon&#x27;}]-&gt; (p2: Person{name: &#x27;Simon Scabourough&#x27;})
MATCH (p1: Person {name:&#x27;Simon Scabourough&#x27;}), (p2:Person {name: &#x27;Susanne Colgate&#x27;})
CREATE (p1) -[r:APPLIED_PHYSICS{attr:&#x27;Susanne invited Simon&#x27;}]-&gt; (p2)
MATCH (p1:Person {name: &#x27;Simon Scabourough&#x27;})-[r:APPLIED_PHYSICS]-&gt;(p2)
MATCH (a:Person),(b:Person)
WHERE a.name=&#x27;Simon Scabourough&#x27; AND b.name=&#x27;Susanne Colgate&#x27;
WITH a,b
CREATE (a) -[r:ANALYTICAL_CHEMISTRY]-&gt;(b)
MATCH (p:Person{name: &#x27;Susanne Colgate&#x27;})
SET p.name= &#x27;Susan Colgate&#x27;
MATCH (p:Person {name: &#x27;Susan Colgate&#x27;})
SET p.title = &#x27;Freshman&#x27;
</code></pre>
<p>And drag&amp;drop them into the favorite section of the Neo4j web interface:</p>
<p><img alt="Getting to know Neo4j" src="/assets/images/Getting_to_know_Cypher_01-8cd9e3a0c10843f7daee34a6dff3eab1.png" width="1185" height="621"></p>
<p>You can run all scripts at once by clicking on the play button next to your scripts name.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/databases">Databases</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/neo-4-j">Neo4j</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/docker">Docker</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Development/Graphs/2020-05-01--getting-to-know-neo4j/index.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Development/Graphs/2020-05-02--neo4j-movie-graph/2020-05-02"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Neo4j Movie Graph</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/react-native"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">React Native</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#running-in-docker" class="table-of-contents__link toc-highlight">Running in Docker</a></li><li><a href="#cypher" class="table-of-contents__link toc-highlight">Cypher</a><ul><li><a href="#create" class="table-of-contents__link toc-highlight">CREATE</a></li><li><a href="#match" class="table-of-contents__link toc-highlight">MATCH</a></li><li><a href="#merge" class="table-of-contents__link toc-highlight">MERGE</a></li><li><a href="#where-with-and-and" class="table-of-contents__link toc-highlight">WHERE, WITH and AND</a></li><li><a href="#set" class="table-of-contents__link toc-highlight">SET</a></li><li><a href="#remove" class="table-of-contents__link toc-highlight">REMOVE</a></li><li><a href="#with" class="table-of-contents__link toc-highlight">WITH</a></li><li><a href="#delete" class="table-of-contents__link toc-highlight">DELETE</a></li><li><a href="#null" class="table-of-contents__link toc-highlight">NULL</a></li><li><a href="#nth-degree-relationships" class="table-of-contents__link toc-highlight">Nth Degree Relationships</a></li></ul></li><li><a href="#importing-scripts" class="table-of-contents__link toc-highlight">Importing Scripts</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
</body>
</html>