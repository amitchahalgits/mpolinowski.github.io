<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-DevOps/Zabbix/2020-07-20--zabbix-behind-nginx/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Zabbix Multi-Tenant NGINX Docker Ingress | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/DevOps/Zabbix/2020-07-20--zabbix-behind-nginx/2020-07-20"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Zabbix Multi-Tenant NGINX Docker Ingress | Mike Polinowski"><meta data-rh="true" name="description" content="Mong Kok, Hong Kong"><meta data-rh="true" property="og:description" content="Mong Kok, Hong Kong"><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/DevOps/Zabbix/2020-07-20--zabbix-behind-nginx/2020-07-20"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/DevOps/Zabbix/2020-07-20--zabbix-behind-nginx/2020-07-20" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/DevOps/Zabbix/2020-07-20--zabbix-behind-nginx/2020-07-20" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.08c8c484.css">
<script src="/assets/js/runtime~main.37984c46.js" defer="defer"></script>
<script src="/assets/js/main.b3107e46.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/development">Development</a><button aria-label="Expand sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/devops">DevOps</a><button aria-label="Collapse sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/hashicorp">Hashicorp</a><button aria-label="Expand sidebar category &#x27;Hashicorp&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/zabbix">Zabbix</a><button aria-label="Collapse sidebar category &#x27;Zabbix&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-07-15-zabbix-for-zimbra/2022-07-15">Zabbix &lt;3 Zimbra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-01-16--zabbix-v6-baseline-monitoring/2022-01-16">Zabbix v6 Creating triggers for Baseline monitoring and Anomaly detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-01-15--zabbix-v6-smart-hdd-check/2022-01-15">Zabbix v6 SMART HDD Check</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-01-15--zabbix-v6-slack-notifications/2022-01-15">Zabbix v6 Slack Notifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-01-15--zabbix-v6-email-notifications/2022-01-15">Zabbix v6 Email Notifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-01-15--zabbix-grafana-dashboard/2022-01-15">Grafana Dashboard for Zabbix v6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-01-14--zabbix-nginx-monitor/2022-01-14">Zabbix v6 NGINX Monitor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-01-14--zabbix-http-cert-monitor/2022-01-14">Zabbix HTTPS Certificate Monitor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-01-14--zabbix-docker-monitor/2022-01-14">Zabbix v6 Docker Monitor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-01-14--zabbix-apache2-monitor/2022-01-14">Zabbix v6 Apache 2 Monitor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-01-13--zabbix-server-v6/2022-01-13">Zabbix v6 Docker-Compose Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2022-01-13--zabbix-api-testing/2022-01-13">Testing the Zabbix API with Postman</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2021-10-13--zabbix-compose-setup/2021-10-13">Zabbix Docker-Compose Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2021-01-14--zabbix-apache2-monitor/2021-10-14">Zabbix Apache 2 Monitor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2020-09-05--slack-notifications-in-devops/2020-09-05">Slack Notifications in DevOps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/DevOps/Zabbix/2020-07-20--zabbix-behind-nginx/2020-07-20">Zabbix Multi-Tenant NGINX Docker Ingress</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2020-07-19--zabbix-company-logo/2020-07-19">Zabbix Company Logo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2020-07-18--zabbix-email-notification/2020-07-18">Zabbix Email Notifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2020-07-17--zabbix-website-monitor/2020-07-17">Zabbix Monitoring a Website</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2020-07-16--zabbix-agent/2020-07-16">Zabbix Agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2020-07-15--zabbix-docker-installation/2020-07-15">Zabbix Docker Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2020-07-14--nagios-ubuntu-install/2020-07-14">Installing Nagios4 on Ubuntu Server 20.04</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Zabbix/2020-07-12--nagios-docker-install/2020-07-12">Installing Nagios4 with Docker</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/server-provisioning">Server Provisioning</a><button aria-label="Expand sidebar category &#x27;Server Provisioning&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/gitops">GitOps</a><button aria-label="Expand sidebar category &#x27;GitOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/kubernetes">Kubernetes</a><button aria-label="Expand sidebar category &#x27;Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/nginx">NGINX</a><button aria-label="Expand sidebar category &#x27;NGINX&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/elasticsearch">Elasticsearch</a><button aria-label="Expand sidebar category &#x27;Elasticsearch&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/ansible">Ansible</a><button aria-label="Expand sidebar category &#x27;Ansible&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/server-security">Server Security</a><button aria-label="Expand sidebar category &#x27;Server Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/linux">Linux</a><button aria-label="Expand sidebar category &#x27;Linux&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/windows">Windows</a><button aria-label="Expand sidebar category &#x27;Windows&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/tomcat">Tomcat</a><button aria-label="Expand sidebar category &#x27;Tomcat&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/salt">Salt</a><button aria-label="Expand sidebar category &#x27;Salt&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/machine-learning-ai-and-computer-vision">Machine Learning, AI and Computer Vision</a><button aria-label="Expand sidebar category &#x27;Machine Learning, AI and Computer Vision&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/automation-deep-vision-and-robotics">Automation, Deep Vision and Robotics</a><button aria-label="Expand sidebar category &#x27;Automation, Deep Vision and Robotics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/devops"><span itemprop="name">DevOps</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/zabbix"><span itemprop="name">Zabbix</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Zabbix Multi-Tenant NGINX Docker Ingress</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Zabbix Multi-Tenant NGINX Docker Ingress</h1></header><p><img alt="Mong Kok, Hong Kong" src="/assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-f985125af0f6a52c9cbf979638322176.jpg" width="1500" height="453"></p>
<p>I set up a Zabbix server using the official Compose file. The docker container managed by this file are already set up to use SSL certificates to enable you to access the web frontend using HTTPS. But my server already runs other services behind an NGINX proxy and I would like to just add an URL prefix and host the Zabbix frontend on the same URL that is already managed by this proxy.</p>
<ul>
<li><a href="#nginx-setup">NGINX Setup</a></li>
<li><a href="#the-virtual-app-network">The Virtual App Network</a>
<ul>
<li><a href="#adding-your-zabbix-frontend">Adding your Zabbix Frontend</a></li>
</ul>
</li>
<li><a href="#complete-zabbix-server-compose-file">Complete Zabbix Server Compose File</a></li>
</ul>
<h2 id="nginx-setup">NGINX Setup</h2>
<p>I do have the following NGINX server block that host 3 Node.js web application on different prefix URLs on the same domain - currently this is <code>localhost</code> in my testing environment and will be switched to an external URL with an CA certificate later. All I did below is that I added a fourth location block to the configuration file for my Zabbix frontend running on Port <code>8080</code>:</p>
<pre><code class="language-cfg">server {
    listen       80;
    listen  [::]:80;
    server_name  localhost;

    charset koi8-r;

    # Gzip Compression
    gzip                                    on;
    gzip_disable                            &quot;MSIE [1-6]\.(?!.*SV1)&quot;;
    gzip_proxied                            no-cache no-store private expired;
    gzip_buffers                            16 8k;
    gzip_comp_level                         6;
    gzip_types                              text/plain application/javascript application/x-javascript text/javascript text/xml text/css;
    gzip_vary                               on;

    location / {
        rewrite   ^/(.*)$  /en/$1  permanent;
    }

    root                                        /opt/wiki/wiki-en/public;

    location /en/ {
        add_header                              Cache-Control  &quot;public, must-revalidate, proxy-revalidate, max-age=0&quot;;
        proxy_set_header                        X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header                        X-NginX-Proxy true;
        proxy_set_header                        X-Real-IP $remote_addr;
        proxy_set_header                        X-Forwarded-Proto http;
        proxy_hide_header                       X-Frame-Options;
        proxy_set_header                        Accept-Encoding &quot;&quot;;
        proxy_http_version                      1.1;
        proxy_set_header                        Upgrade $http_upgrade;
        proxy_set_header                        Connection &quot;upgrade&quot;;
        proxy_set_header                        Host $host;
        proxy_cache_bypass                      $http_upgrade;
        proxy_max_temp_file_size                0;
        proxy_redirect                          off;
        proxy_read_timeout                      240s;
        proxy_pass                              http://wiki_en:8888/;
    }

    location /fr/ {
        add_header                              Cache-Control  &quot;public, must-revalidate, proxy-revalidate, max-age=0&quot;;
        proxy_set_header                        X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header                        X-NginX-Proxy true;
        proxy_set_header                        X-Real-IP $remote_addr;
        proxy_set_header                        X-Forwarded-Proto http;
        proxy_hide_header                       X-Frame-Options;
        proxy_set_header                        Accept-Encoding &quot;&quot;;
        proxy_http_version                      1.1;
        proxy_set_header                        Upgrade $http_upgrade;
        proxy_set_header                        Connection &quot;upgrade&quot;;
        proxy_set_header                        Host $host;
        proxy_cache_bypass                      $http_upgrade;
        proxy_max_temp_file_size                0;
        proxy_redirect                          off;
        proxy_read_timeout                      240s;
        proxy_pass                              http://wiki_fr:8888/;
        root                                    /opt/wiki/wiki-fr/public;
    }

    location /de/ {
        add_header                              Cache-Control  &quot;public, must-revalidate, proxy-revalidate, max-age=0&quot;;
        proxy_set_header                        X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header                        X-NginX-Proxy true;
        proxy_set_header                        X-Real-IP $remote_addr;
        proxy_set_header                        X-Forwarded-Proto http;
        proxy_hide_header                       X-Frame-Options;
        proxy_set_header                        Accept-Encoding &quot;&quot;;
        proxy_http_version                      1.1;
        proxy_set_header                        Upgrade $http_upgrade;
        proxy_set_header                        Connection &quot;upgrade&quot;;
        proxy_set_header                        Host $host;
        proxy_cache_bypass                      $http_upgrade;
        proxy_max_temp_file_size                0;
        proxy_redirect                          off;
        proxy_read_timeout                      240s;
        proxy_pass                              http://wiki_de:8888/;
        root                                    /opt/wiki/wiki-de/public;
    }

    location /zabbix/ {
        add_header                              Cache-Control  &quot;public, must-revalidate, proxy-revalidate, max-age=0&quot;;
        proxy_set_header                        X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header                        X-NginX-Proxy true;
        proxy_set_header                        X-Real-IP $remote_addr;
        proxy_set_header                        X-Forwarded-Proto http;
        proxy_hide_header                       X-Frame-Options;
        proxy_set_header                        Accept-Encoding &quot;&quot;;
        proxy_http_version                      1.1;
        proxy_set_header                        Upgrade $http_upgrade;
        proxy_set_header                        Connection &quot;upgrade&quot;;
        proxy_set_header                        Host $host;
        proxy_cache_bypass                      $http_upgrade;
        proxy_max_temp_file_size                0;
        proxy_redirect                          off;
        proxy_read_timeout                      240s;
        proxy_pass                              http://docker-zabbix_zabbix-web-apache-pgsql_1:8080/;
    }

    error_page  404              /de/404.html;

    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
    root   /usr/share/nginx/html;
    }
}
</code></pre>
<p>The issue here is that all my apps are running inside virtual network that cannot be accessed from my host system. And at the moment the zabbix frontend is not connected to this network - this means my <code>proxy_pass</code> to <code>docker-zabbix_zabbix-web-apache-pgsql_1:8080</code> is going to fail.</p>
<h2 id="the-virtual-app-network">The Virtual App Network</h2>
<p>The virtual network is created with another compose file that is setting up my web applications:</p>
<pre><code class="language-yml">version: &#x27;3.8&#x27;
services:
  wiki_en:
    image: my.gitlab.com:12345/wiki/wiki_container:latest
    container_name: wiki_en
    networks:
      - gateway
    restart: unless-stopped
    volumes:
      - /opt/wiki/wiki-en/public:/wiki/public

  wiki_fr:
    image: my.gitlab.com:12345/wiki/wiki_container:latest
    container_name: wiki_fr
    networks:
      - gateway
    restart: unless-stopped
    volumes:
      - /opt/wiki/wiki-fr/public:/wiki/public

  wiki_de:
    image: my.gitlab.com:12345/wiki/wiki_container:latest
    container_name: wiki_de
    networks:
      - gateway
    restart: unless-stopped
    volumes:
      - /opt/wiki/wiki-de/public:/wiki/public

  ingress:
    image: nginx:stable-alpine
    container_name: ingress
    networks:
      - gateway
    ports:
      - &#x27;80:80&#x27;
    restart: unless-stopped
    volumes:
      - /opt/wiki/docker_ingress:/etc/nginx/conf.d
      - /opt/wiki/wiki-en:/opt/wiki/wiki-en
      - /opt/wiki/wiki-fr:/opt/wiki/wiki-fr
      - /opt/wiki/wiki-de:/opt/wiki/wiki-de

networks:
  gateway: {}
</code></pre>
<h3 id="adding-your-zabbix-frontend">Adding your Zabbix Frontend</h3>
<p>To add my Zabbix frontend to this virtual network I need to modify the <a href="#complete-zabbix-server-compose-file">Zabbix Server Compose file</a>:</p>
<pre><code class="language-yml">zabbix-web-apache-pgsql:
  image: zabbix/zabbix-web-apache-pgsql:alpine-5.0-latest
  networks:
    zbx_net_backend:
      ipv4_address: 172.16.239.104
      aliases:
        - zabbix-web-apache-pgsql
        - zabbix-web-apache-alpine-pgsql
        - zabbix-web-apache-pgsql-alpine
    zbx_net_frontend:
      ipv4_address: 172.16.238.104
    wiki_gateway:
      ipv4_address: 172.20.0.6
</code></pre>
<p>I added the <code>wiki_gateway</code> as well as an IPv4 address - to check what IP addresses are available inside an Docker network you can inspect it. I simply added the Zabbix frontend container to my Wiki network manually and ran the inspect command to see what address was assigned to the container.</p>
<p>First run <code>docker ps</code> to find out your frontends Docker <strong>Container ID</strong> and <strong>Container Name</strong>:</p>
<pre><code class="language-bash">docker ps
CONTAINER ID        IMAGE                                             NAMES
44dfd075af57        zabbix/zabbix-web-apache-pgsql:alpine-5.0-latest  docker-zabbix_zabbix-web-apache-pgsql_1
</code></pre>
<p>Then add the <strong>Container ID</strong> to the virtual network and inspect the network to see if it worked:</p>
<pre><code class="language-bash">docker network connect wiki_gateway 44dfd075af57

docker inspect wiki_gateway
</code></pre>
<pre><code class="language-json">[
  {
    &quot;Name&quot;: &quot;wiki_gateway&quot;,
    &quot;Id&quot;: &quot;98f70ca5f7baf4f676029c31c9c68f3b3743521975becef326f97312a41c669b&quot;,
    &quot;Created&quot;: &quot;2020-10-07T09:53:17.531329441Z&quot;,
    &quot;Scope&quot;: &quot;local&quot;,
    &quot;Driver&quot;: &quot;bridge&quot;,
    &quot;EnableIPv6&quot;: false,
    &quot;IPAM&quot;: {
      &quot;Driver&quot;: &quot;default&quot;,
      &quot;Options&quot;: null,
      &quot;Config&quot;: [
        {
          &quot;Subnet&quot;: &quot;172.20.0.0/16&quot;,
          &quot;Gateway&quot;: &quot;172.20.0.1&quot;
        }
      ]
    },
    &quot;Internal&quot;: false,
    &quot;Attachable&quot;: true,
    &quot;Ingress&quot;: false,
    &quot;ConfigFrom&quot;: {
      &quot;Network&quot;: &quot;&quot;
    },
    &quot;ConfigOnly&quot;: false,
    &quot;Containers&quot;: {
      &quot;15c50c7d5997e3a7562e3b121cb795e9d22fdb614a869a532ca93a1d92637390&quot;: {
        &quot;Name&quot;: &quot;wiki_de&quot;,
        &quot;EndpointID&quot;: &quot;4eb0596b1cc0aaa046f9077512eb283a1063916e6072d707a97196ad40021e2e&quot;,
        &quot;MacAddress&quot;: &quot;02:42:ac:14:00:03&quot;,
        &quot;IPv4Address&quot;: &quot;172.20.0.3/16&quot;,
        &quot;IPv6Address&quot;: &quot;&quot;
      },
      &quot;1af00ce71d4da9ccfe9800ebf1fcba5dbfd842d90b0fbe92e27f7bd1dac7c691&quot;: {
        &quot;Name&quot;: &quot;wiki_fr&quot;,
        &quot;EndpointID&quot;: &quot;c888701c3717aa73fcc3ce6b682626b8f31506935d6dd5cb3f9acae4ce62e5a7&quot;,
        &quot;MacAddress&quot;: &quot;02:42:ac:14:00:02&quot;,
        &quot;IPv4Address&quot;: &quot;172.20.0.2/16&quot;,
        &quot;IPv6Address&quot;: &quot;&quot;
      },
      &quot;44dfd075af5789dab49f9e083d6fbb60ab4f5f74206a9190634675db48354636&quot;: {
        &quot;Name&quot;: &quot;docker-zabbix_zabbix-web-apache-pgsql_1&quot;,
        &quot;EndpointID&quot;: &quot;5c4a8b866d4f584d24d78a41d2aee06035899f0d14825dd698d99ee7689ae7ba&quot;,
        &quot;MacAddress&quot;: &quot;02:42:ac:14:00:06&quot;,
        &quot;IPv4Address&quot;: &quot;172.20.0.6/16&quot;,
        &quot;IPv6Address&quot;: &quot;&quot;
      },
      &quot;9419eb378185058c9159ac9ec43d9e69725b55b7d454b901b01e815ffd3b7954&quot;: {
        &quot;Name&quot;: &quot;ingress&quot;,
        &quot;EndpointID&quot;: &quot;ca7898a11610bc10b6cd3be8e3de0274b82905998e90af91d333e063f7b75185&quot;,
        &quot;MacAddress&quot;: &quot;02:42:ac:14:00:05&quot;,
        &quot;IPv4Address&quot;: &quot;172.20.0.5/16&quot;,
        &quot;IPv6Address&quot;: &quot;&quot;
      },
      &quot;d4ef7e3026a15b845e6d7bb2af0a9376d1482b67b3af1fa84ab546f45dc64470&quot;: {
        &quot;Name&quot;: &quot;wiki_en&quot;,
        &quot;EndpointID&quot;: &quot;5bacfc78a7cc4db5e57b33de499809d8b66f0d1198aed11a7c1a26f73663c68d&quot;,
        &quot;MacAddress&quot;: &quot;02:42:ac:14:00:04&quot;,
        &quot;IPv4Address&quot;: &quot;172.20.0.4/16&quot;,
        &quot;IPv6Address&quot;: &quot;&quot;
      }
    },
    &quot;Options&quot;: {},
    &quot;Labels&quot;: {
      &quot;com.docker.compose.network&quot;: &quot;gateway&quot;,
      &quot;com.docker.compose.project&quot;: &quot;wiki&quot;,
      &quot;com.docker.compose.version&quot;: &quot;1.26.2&quot;
    }
  }
]
</code></pre>
<p>You can see that the frontend container is now connected to the virtual network and assigned the following IP address (that I already used in the compose file above):</p>
<pre><code class="language-json">&quot;IPv4Address&quot;: &quot;172.20.0.6/16&quot;,
</code></pre>
<p>Now <code>docker-compose down</code> and <code>docker-compose up -d</code> your Zabbix Server environemt and your frontend will automatically be connected to your virtual network and you should be able to access it with the <code>/zabbix/</code> URL prefix on Port 80!</p>
<p>I am now able to close the Port that I was previously using to access the Zabbix frontend and use my NGINX ingress on port 80 instead. I am happy with that :)</p>
<h2 id="complete-zabbix-server-compose-file">Complete Zabbix Server Compose File</h2>
<pre><code class="language-yml">version: &#x27;3.5&#x27;
services:
 zabbix-server:
  image: zabbix/zabbix-server-pgsql:alpine-5.0-latest
  ports:
   - &quot;10051:10051&quot;
  volumes:
   - /etc/localtime:/etc/localtime:ro
   - /etc/timezone:/etc/timezone:ro
   - ./zbx_env/usr/lib/zabbix/alertscripts:/usr/lib/zabbix/alertscripts:ro
   - ./zbx_env/usr/lib/zabbix/externalscripts:/usr/lib/zabbix/externalscripts:ro
   - ./zbx_env/var/lib/zabbix/export:/var/lib/zabbix/export:rw
   - ./zbx_env/var/lib/zabbix/modules:/var/lib/zabbix/modules:ro
   - ./zbx_env/var/lib/zabbix/enc:/var/lib/zabbix/enc:ro
   - ./zbx_env/var/lib/zabbix/ssh_keys:/var/lib/zabbix/ssh_keys:ro
   - ./zbx_env/var/lib/zabbix/mibs:/var/lib/zabbix/mibs:ro
  links:
   - postgres-server:postgres-server
   - zabbix-java-gateway:zabbix-java-gateway
  ulimits:
   nproc: 65535
   nofile:
    soft: 20000
    hard: 40000
  deploy:
   resources:
    limits:
      cpus: &#x27;0.70&#x27;
      memory: 1G
    reservations:
      cpus: &#x27;0.5&#x27;
      memory: 512M
  env_file:
   - .env_db_pgsql
   - .env_srv
  secrets:
   - POSTGRES_USER
   - POSTGRES_PASSWORD
  depends_on:
   - postgres-server
   - zabbix-java-gateway
  networks:
   zbx_net_backend:
     ipv4_address: 172.16.239.101
     aliases:
      - zabbix-server
      - zabbix-server-pgsql
      - zabbix-server-alpine-pgsql
      - zabbix-server-pgsql-alpine
   zbx_net_frontend:
     ipv4_address: 172.16.238.101
  stop_grace_period: 30s
  sysctls:
   - net.ipv4.ip_local_port_range=1024 65000
   - net.ipv4.conf.all.accept_redirects=0
   - net.ipv4.conf.all.secure_redirects=0
   - net.ipv4.conf.all.send_redirects=0
  labels:
   com.zabbix.description: &quot;Zabbix server with PostgreSQL database support&quot;
   com.zabbix.company: &quot;Zabbix LLC&quot;
   com.zabbix.component: &quot;zabbix-server&quot;
   com.zabbix.dbtype: &quot;pgsql&quot;
   com.zabbix.os: &quot;alpine&quot;

 zabbix-proxy-sqlite3:
  image: zabbix/zabbix-proxy-sqlite3:alpine-5.0-latest
  ports:
   - &quot;10061:10051&quot;
  volumes:
   - /etc/localtime:/etc/localtime:ro
   - /etc/timezone:/etc/timezone:ro
   - ./zbx_env/usr/lib/zabbix/externalscripts:/usr/lib/zabbix/externalscripts:ro
   - ./zbx_env/var/lib/zabbix/modules:/var/lib/zabbix/modules:ro
   - ./zbx_env/var/lib/zabbix/enc:/var/lib/zabbix/enc:ro
   - ./zbx_env/var/lib/zabbix/ssh_keys:/var/lib/zabbix/ssh_keys:ro
   - ./zbx_env/var/lib/zabbix/mibs:/var/lib/zabbix/mibs:ro
  links:
   - zabbix-server:zabbix-server
   - zabbix-java-gateway:zabbix-java-gateway
  ulimits:
   nproc: 65535
   nofile:
    soft: 20000
    hard: 40000
  deploy:
   resources:
    limits:
      cpus: &#x27;0.70&#x27;
      memory: 512M
    reservations:
      cpus: &#x27;0.3&#x27;
      memory: 256M
  env_file:
   - .env_prx
   - .env_prx_sqlite3
  depends_on:
   - zabbix-java-gateway
  networks:
   zbx_net_backend:
    ipv4_address: 172.16.239.102
    aliases:
     - zabbix-proxy-sqlite3
     - zabbix-proxy-alpine-sqlite3
     - zabbix-proxy-sqlite3-alpine
   zbx_net_frontend:
    ipv4_address: 172.16.238.102
  stop_grace_period: 30s
  labels:
   com.zabbix.description: &quot;Zabbix proxy with SQLite3 database support&quot;
   com.zabbix.company: &quot;Zabbix LLC&quot;
   com.zabbix.component: &quot;zabbix-proxy&quot;
   com.zabbix.dbtype: &quot;sqlite3&quot;
   com.zabbix.os: &quot;alpine&quot;

 zabbix-proxy-mysql:
  image: zabbix/zabbix-proxy-mysql:alpine-5.0-latest
  ports:
   - &quot;10071:10051&quot;
  volumes:
   - /etc/localtime:/etc/localtime:ro
   - /etc/timezone:/etc/timezone:ro
   - ./zbx_env/usr/lib/zabbix/externalscripts:/usr/lib/zabbix/externalscripts:ro
   - ./zbx_env/var/lib/zabbix/modules:/var/lib/zabbix/modules:ro
   - ./zbx_env/var/lib/zabbix/enc:/var/lib/zabbix/enc:ro
   - ./zbx_env/var/lib/zabbix/ssh_keys:/var/lib/zabbix/ssh_keys:ro
   - ./zbx_env/var/lib/zabbix/mibs:/var/lib/zabbix/mibs:ro
  links:
   - zabbix-server:zabbix-server
   - zabbix-java-gateway:zabbix-java-gateway
  ulimits:
   nproc: 65535
   nofile:
    soft: 20000
    hard: 40000
  deploy:
   resources:
    limits:
      cpus: &#x27;0.70&#x27;
      memory: 512M
    reservations:
      cpus: &#x27;0.3&#x27;
      memory: 256M
  env_file:
   - .env_db_mysql_proxy
   - .env_prx
   - .env_prx_mysql
  secrets:
   - MYSQL_USER
   - MYSQL_PASSWORD
   - MYSQL_ROOT_PASSWORD
  depends_on:
   - mysql-server
   - zabbix-java-gateway
  networks:
   zbx_net_backend:
    ipv4_address: 172.16.239.103
    aliases:
     - zabbix-proxy-mysql
     - zabbix-proxy-alpine-mysql
     - zabbix-proxy-mysql-alpine
   zbx_net_frontend:
    ipv4_address: 172.16.238.103
  stop_grace_period: 30s
  labels:
   com.zabbix.description: &quot;Zabbix proxy with MySQL database support&quot;
   com.zabbix.company: &quot;Zabbix LLC&quot;
   com.zabbix.component: &quot;zabbix-proxy&quot;
   com.zabbix.dbtype: &quot;mysql&quot;
   com.zabbix.os: &quot;alpine&quot;

 zabbix-web-apache-pgsql:
  image: zabbix/zabbix-web-apache-pgsql:alpine-5.0-latest
  ports:
   - &quot;7777:8080&quot;
   - &quot;7778:8443&quot;
  links:
   - postgres-server:postgres-server
   - zabbix-server:zabbix-server
  volumes:
   - /etc/localtime:/etc/localtime:ro
   - /etc/timezone:/etc/timezone:ro
   - ./zbx_env/etc/ssl/apache2:/etc/ssl/apache2:ro
   - ./zbx_env/usr/share/zabbix/modules/:/usr/share/zabbix/modules/:ro
  deploy:
   resources:
    limits:
      cpus: &#x27;0.70&#x27;
      memory: 512M
    reservations:
      cpus: &#x27;0.5&#x27;
      memory: 256M
  env_file:
   - .env_db_pgsql
   - .env_web
  secrets:
   - POSTGRES_USER
   - POSTGRES_PASSWORD
  depends_on:
   - postgres-server
   - zabbix-server
  healthcheck:
   test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:8080/&quot;]
   interval: 10s
   timeout: 5s
   retries: 3
   start_period: 30s
  networks:
   zbx_net_backend:
    ipv4_address: 172.16.239.104
    aliases:
     - zabbix-web-apache-pgsql
     - zabbix-web-apache-alpine-pgsql
     - zabbix-web-apache-pgsql-alpine
   zbx_net_frontend:
    ipv4_address: 172.16.238.104
   wiki_gateway:
    ipv4_address: 172.20.0.6
  stop_grace_period: 10s
  sysctls:
   - net.core.somaxconn=65535
  labels:
   com.zabbix.description: &quot;Zabbix frontend on Apache web-server with PostgreSQL database support&quot;
   com.zabbix.company: &quot;Zabbix LLC&quot;
   com.zabbix.component: &quot;zabbix-frontend&quot;
   com.zabbix.webserver: &quot;apache2&quot;
   com.zabbix.dbtype: &quot;pgsql&quot;
   com.zabbix.os: &quot;alpine&quot;

 zabbix-web-nginx-pgsql:
  image: zabbix/zabbix-web-nginx-pgsql:alpine-5.0-latest
  ports:
   - &quot;8081:8080&quot;
   - &quot;8443:8443&quot;
  links:
   - postgres-server:postgres-server
   - zabbix-server:zabbix-server
  volumes:
   - /etc/localtime:/etc/localtime:ro
   - /etc/timezone:/etc/timezone:ro
   - ./zbx_env/etc/ssl/nginx:/etc/ssl/nginx:ro
   - ./zbx_env/usr/share/zabbix/modules/:/usr/share/zabbix/modules/:ro
  deploy:
   resources:
    limits:
      cpus: &#x27;0.70&#x27;
      memory: 512M
    reservations:
      cpus: &#x27;0.5&#x27;
      memory: 256M
  env_file:
   - .env_db_pgsql
   - .env_web
  secrets:
   - POSTGRES_USER
   - POSTGRES_PASSWORD
  depends_on:
   - postgres-server
   - zabbix-server
  healthcheck:
   test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:8080/&quot;]
   interval: 10s
   timeout: 5s
   retries: 3
   start_period: 30s
  networks:
   zbx_net_backend:
    ipv4_address: 172.16.239.105
    aliases:
     - zabbix-web-nginx-pgsql
     - zabbix-web-nginx-alpine-pgsql
     - zabbix-web-nginx-pgsql-alpine
   zbx_net_frontend:
    ipv4_address: 172.16.238.105
  stop_grace_period: 10s
  sysctls:
   - net.core.somaxconn=65535
  labels:
   com.zabbix.description: &quot;Zabbix frontend on Nginx web-server with PostgreSQL database support&quot;
   com.zabbix.company: &quot;Zabbix LLC&quot;
   com.zabbix.component: &quot;zabbix-frontend&quot;
   com.zabbix.webserver: &quot;nginx&quot;
   com.zabbix.dbtype: &quot;pgsql&quot;
   com.zabbix.os: &quot;alpine&quot;

 zabbix-agent:
  privileged: true
  image: zabbix/zabbix-agent:alpine-5.0-latest
  ports:
   - &quot;10050:10050&quot;
  volumes:
   - /etc/localtime:/etc/localtime:ro
   - /etc/timezone:/etc/timezone:ro
   - ./zbx_env/etc/zabbix/zabbix_agentd.d:/etc/zabbix/zabbix_agentd.d:ro
   - ./zbx_env/var/lib/zabbix/modules:/var/lib/zabbix/modules:ro
   - ./zbx_env/var/lib/zabbix/enc:/var/lib/zabbix/enc:ro
   - ./zbx_env/var/lib/zabbix/ssh_keys:/var/lib/zabbix/ssh_keys:ro
  links:
   - zabbix-server:zabbix-server
  deploy:
   resources:
    limits:
      cpus: &#x27;0.2&#x27;
      memory: 128M
    reservations:
      cpus: &#x27;0.1&#x27;
      memory: 64M
   mode: global
  env_file:
   - .env_agent
  privileged: true
  pid: &quot;host&quot;
  networks:
   zbx_net_backend:
    ipv4_address: 172.16.239.106
    aliases:
     - zabbix-agent
     - zabbix-agent-passive
     - zabbix-agent-alpine
  stop_grace_period: 5s
  labels:
   com.zabbix.description: &quot;Zabbix agent&quot;
   com.zabbix.company: &quot;Zabbix LLC&quot;
   com.zabbix.component: &quot;zabbix-agentd&quot;
   com.zabbix.os: &quot;alpine&quot;

 zabbix-java-gateway:
  image: zabbix/zabbix-java-gateway:alpine-5.0-latest
  ports:
   - &quot;10052:10052&quot;
  deploy:
   resources:
    limits:
      cpus: &#x27;0.5&#x27;
      memory: 512M
    reservations:
      cpus: &#x27;0.25&#x27;
      memory: 256M
  env_file:
   - .env_java
  networks:
   zbx_net_backend:
    ipv4_address: 172.16.239.107
    aliases:
     - zabbix-java-gateway
     - zabbix-java-gateway-alpine
  stop_grace_period: 5s
  labels:
   com.zabbix.description: &quot;Zabbix Java Gateway&quot;
   com.zabbix.company: &quot;Zabbix LLC&quot;
   com.zabbix.component: &quot;java-gateway&quot;
   com.zabbix.os: &quot;alpine&quot;

 mysql-server:
  image: mysql:8.0
  command:
   - mysqld
   - --character-set-server=utf8
   - --collation-server=utf8_bin
   - --default-authentication-plugin=mysql_native_password
  volumes:
   - ./zbx_env/var/lib/mysql:/var/lib/mysql:rw
  env_file:
   - .env_db_mysql
  secrets:
   - MYSQL_USER
   - MYSQL_PASSWORD
   - MYSQL_ROOT_PASSWORD
  stop_grace_period: 1m
  networks:
   zbx_net_backend:
    ipv4_address: 172.16.239.109
    aliases:
     - mysql-server
     - zabbix-database
     - mysql-database

 postgres-server:
  image: postgres:latest
  volumes:
   - ./zbx_env/var/lib/postgresql/data:/var/lib/postgresql/data:rw
   - ./.ZBX_DB_CA_FILE:/run/secrets/root-ca.pem:ro
   - ./.ZBX_DB_CERT_FILE:/run/secrets/server-cert.pem:ro
   - ./.ZBX_DB_KEY_FILE:/run/secrets/server-key.pem:ro
  env_file:
   - .env_db_pgsql
  secrets:
   - POSTGRES_USER
   - POSTGRES_PASSWORD
  stop_grace_period: 1m
  networks:
   zbx_net_backend:
    ipv4_address: 172.16.239.110
    aliases:
     - postgres-server
     - pgsql-server
     - pgsql-database

 db_data_mysql:
  image: busybox
  volumes:
   - ./zbx_env/var/lib/mysql:/var/lib/mysql:rw

 db_data_pgsql:
  image: busybox
  volumes:
   - ./zbx_env/var/lib/postgresql/data:/var/lib/postgresql/data:rw

networks:
  zbx_net_frontend:
    driver: bridge
    driver_opts:
      com.docker.network.enable_ipv6: &quot;false&quot;
    ipam:
      driver: default
      config:
      - subnet: 172.16.238.0/24
  zbx_net_backend:
    driver: bridge
    driver_opts:
      com.docker.network.enable_ipv6: &quot;false&quot;
    internal: true
    ipam:
      driver: default
      config:
      - subnet: 172.16.239.0/24
  wiki_gateway:
    external: true
    name: wiki_gateway

secrets:
  MYSQL_USER:
    file: ./.MYSQL_USER
  MYSQL_PASSWORD:
    file: ./.MYSQL_PASSWORD
  MYSQL_ROOT_PASSWORD:
    file: ./.MYSQL_ROOT_PASSWORD
  POSTGRES_USER:
    file: ./.POSTGRES_USER
  POSTGRES_PASSWORD:
    file: ./.POSTGRES_PASSWORD
</code></pre></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/linux">LINUX</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/zabbix">Zabbix</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Zabbix/2020-07-20--zabbix-behind-nginx/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/DevOps/Zabbix/2020-09-05--slack-notifications-in-devops/2020-09-05"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Slack Notifications in DevOps</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/DevOps/Zabbix/2020-07-19--zabbix-company-logo/2020-07-19"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Zabbix Company Logo</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#nginx-setup" class="table-of-contents__link toc-highlight">NGINX Setup</a></li><li><a href="#the-virtual-app-network" class="table-of-contents__link toc-highlight">The Virtual App Network</a><ul><li><a href="#adding-your-zabbix-frontend" class="table-of-contents__link toc-highlight">Adding your Zabbix Frontend</a></li></ul></li><li><a href="#complete-zabbix-server-compose-file" class="table-of-contents__link toc-highlight">Complete Zabbix Server Compose File</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
</body>
</html>