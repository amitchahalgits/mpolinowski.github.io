<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-DevOps/Elasticsearch/2021-03-21-logstash-digesting-data/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Logstash 7 Digesting Webserver Logs | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/DevOps/Elasticsearch/2021-03-21-logstash-digesting-data/2021-03-21"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Logstash 7 Digesting Webserver Logs | Mike Polinowski"><meta data-rh="true" name="description" content="Guangzhou, China"><meta data-rh="true" property="og:description" content="Guangzhou, China"><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/DevOps/Elasticsearch/2021-03-21-logstash-digesting-data/2021-03-21"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/DevOps/Elasticsearch/2021-03-21-logstash-digesting-data/2021-03-21" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/DevOps/Elasticsearch/2021-03-21-logstash-digesting-data/2021-03-21" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.08c8c484.css">
<script src="/assets/js/runtime~main.ab71403f.js" defer="defer"></script>
<script src="/assets/js/main.88c0252d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/development">Development</a><button aria-label="Expand sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/devops">DevOps</a><button aria-label="Collapse sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/hashicorp">Hashicorp</a><button aria-label="Expand sidebar category &#x27;Hashicorp&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/zabbix">Zabbix</a><button aria-label="Expand sidebar category &#x27;Zabbix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/server-provisioning">Server Provisioning</a><button aria-label="Expand sidebar category &#x27;Server Provisioning&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/gitops">GitOps</a><button aria-label="Expand sidebar category &#x27;GitOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/kubernetes">Kubernetes</a><button aria-label="Expand sidebar category &#x27;Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/nginx">NGINX</a><button aria-label="Expand sidebar category &#x27;NGINX&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/elasticsearch">Elasticsearch</a><button aria-label="Collapse sidebar category &#x27;Elasticsearch&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2023-02-10--meili-rusty-elastic-docker/2023-02-10">Introduction to MeiLi Search with Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2022-10-12--opensearch-rest-api/2022-10-12">Opensearch Rest API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2022-10-11--opensearch-docker-compose/2022-10-11">Opensearch &amp; Dashboard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2022-02-06--elasticsearch-v8-data-ingestion-apache/2022-02-06">Elasticsearch v8, Filebeat (Docker) and Apache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2022-02-05--kibana-v8-index-management/2022-02-05">Elasticsearch &amp; Kibana v8 Index Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2022-02-04--kibana-v8-search-queries/2022-02-04">Elasticsearch &amp; Kibana v8 Search Cheat Sheet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2022-02-03--elasticsearch-v8-data-ingestion/2022-02-03">Elasticsearch v8, Filebeat (Docker) and NGINX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2022-02-02--elasticsearch-v8-upgrade/2022-02-02">Performing an Elasticsearch v8 Upgrade</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-04-01-elastic-filebeats-for-nginx-logs/2021-04-01">Elastic Filebeat and NGINX Access Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-31-elastic-filebeats-for-apache-logs/2021-03-31">Elastic Filebeat and Apache Access Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-30-elasticsearch7-and-filebeats/2021-03-30">Elasticsearch 7 and Filebeats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-29-elasticsearch7-data-transformations/2021-03-29">Elasticsearch 7 Data Transformation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-28-elasticsearch7-timeseries/2021-03-28">Elasticsearch 7 Timeseries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-27-elasticsearch7-aggregations/2021-03-27">Elasticsearch 7 Aggregations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-26-elasticsearch7-for-syslog-messages/2021-03-26">Elasticsearch 7 to log Linux System Events</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-25-elasticsearch7-activate-logging-of-search-queries/2021-03-25">Log all the searches going through Elasticsearch</a><button aria-label="Expand sidebar category &#x27;Log all the searches going through Elasticsearch&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-24-logstash-common-grok-pattern/2021-03-24">Logstash 7 and Common Log Pattern</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-23-logstash-working-with-unstructured-data/2021-03-23">Logstash 7 Working with Unstructured Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-22-logstash-working-with-structured-data/2021-03-22">Logstash 7 Working with Structured Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-21-logstash-digesting-data/2021-03-21">Logstash 7 Digesting Webserver Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2021-03-20-elasticsearch-7-refresher/2021-03-20">Elasticsearch 7 Refresher</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2020-06-01--elasticsearch-docker/2020-06-01">Elasticsearch in Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2019-09-08--elasticsearch_7-5_docker/2019-09-08">Elasticsearch 7 with Docker Compose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2018-01-01--securing-elasticsearch-readonlyrest/2018-01-01">Securing Elasticsearch with ReadOnlyREST</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2017-12-31--securing-elasticsearch-xpack/2017-12-31">Securing Elasticsearch with X-Pack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2017-12-26--elasticsearch-kibana/2017-12-16">Elasticsearch and Kibana</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2017-12-05--elasticsearch-react-example/2017-12-05">React Search Interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/Elasticsearch/2017-10-03--search-engine-setup-and-configuration/2017-10-03">Search Engine Setup and Configuration</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/ansible">Ansible</a><button aria-label="Expand sidebar category &#x27;Ansible&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/server-security">Server Security</a><button aria-label="Expand sidebar category &#x27;Server Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/linux">Linux</a><button aria-label="Expand sidebar category &#x27;Linux&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/windows">Windows</a><button aria-label="Expand sidebar category &#x27;Windows&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/tomcat">Tomcat</a><button aria-label="Expand sidebar category &#x27;Tomcat&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/salt">Salt</a><button aria-label="Expand sidebar category &#x27;Salt&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/machine-learning-ai-and-computer-vision">Machine Learning, AI and Computer Vision</a><button aria-label="Expand sidebar category &#x27;Machine Learning, AI and Computer Vision&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/automation-deep-vision-and-robotics">Automation, Deep Vision and Robotics</a><button aria-label="Expand sidebar category &#x27;Automation, Deep Vision and Robotics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/devops"><span itemprop="name">DevOps</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/elasticsearch"><span itemprop="name">Elasticsearch</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Logstash 7 Digesting Webserver Logs</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Logstash 7 Digesting Webserver Logs</h1></header><p><img alt="Guangzhou, China" src="/assets/images/photo-456tdsfggd_67gfh6dgdf4_d-173870f4fc20686d0a5e5aa08fcf7552.jpg" width="1500" height="616"></p>
<ul>
<li><a href="#setup-elasticsearch">Setup Elasticsearch</a>
<ul>
<li><a href="#use-curl-to-upload-and-query-data">Use CURL to Upload and Query Data</a></li>
</ul>
</li>
<li><a href="#setup-logstash">Setup Logstash</a>
<ul>
<li><a href="#preparing-the-configuration-files">Preparing the Configuration Files</a></li>
</ul>
</li>
<li><a href="#setup-kibana">Setup Kibana</a></li>
</ul>
<h2 id="setup-elasticsearch">Setup Elasticsearch</h2>
<p><a href="/docs/DevOps/Elasticsearch/2021-03-20-elasticsearch-7-refresher/2021-03-20">Before I was using an existing ELK Cluster</a> and it is working well in production. But I have difficulties connecting to it through CURL (I am using Kibana to manage it so I never noticed):</p>
<pre><code class="language-bash">curl localhost:9200

curl: (7) Failed to connect to localhost port 9200: Connection refused
</code></pre>
<p>So I now set up a fresh version of the Elasticsearch Docker Container :</p>
<pre><code class="language-bash">docker pull elasticsearch:7.13.4
docker pull logstash:7.13.4
docker pull kibana:7.13.4
</code></pre>
<pre><code class="language-bash">docker run -d \
       --name elasticsearch \
       --privileged \
       --net=host\
       -e &quot;discovery.type=single-node&quot; \
       -e &quot;XPACK_SECURITY_ENABLED=false&quot; \
       -e &quot;XPACK_REPORTING_ENABLED=false&quot; \
       -e &quot;XPACK_MONITORING_ENABLED=false&quot; \
       elasticsearch:7.13.4
</code></pre>
<p>And tada! Now - without all the virtual network trickery - it works:</p>
<pre><code class="language-json">curl localhost:9200

{
  &quot;name&quot; : &quot;Debian11&quot;,
  &quot;cluster_name&quot; : &quot;docker-cluster&quot;,
  &quot;cluster_uuid&quot; : &quot;3Gi_d-bqT06e3qJwNai6hw&quot;,
  &quot;version&quot; : {
    &quot;number&quot; : &quot;7.13.4&quot;,
    &quot;build_flavor&quot; : &quot;default&quot;,
    &quot;build_type&quot; : &quot;docker&quot;,
    &quot;build_hash&quot; : &quot;c5f60e894ca0c61cdbae4f5a686d9f08bcefc942&quot;,
    &quot;build_date&quot; : &quot;2021-07-14T18:33:36.673943207Z&quot;,
    &quot;build_snapshot&quot; : false,
    &quot;lucene_version&quot; : &quot;8.8.2&quot;,
    &quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;,
    &quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot;
  },
  &quot;tagline&quot; : &quot;You Know, for Search&quot;
}
</code></pre>
<p>To make sure my installation is save (without any security settings) I will close the door to the outside world:</p>
<pre><code class="language-bash">ufw deny 9200/tcp

Rule updated
Rule updated (v6)

ufw deny 9300/tcp

Rule updated
Rule updated (v6)
</code></pre>
<h3 id="use-curl-to-upload-and-query-data">Use CURL to Upload and Query Data</h3>
<p><a href="/docs/DevOps/Elasticsearch/2021-03-20-elasticsearch-7-refresher/2021-03-20">Before I was using a dataset</a> that was too big to be used in Kibana and had to be broken up. The Data that is <a href="http://media.sundog-soft.com/es7/shakespeare_7.0.json">available for download here</a>. Just download the mapping and data to your server:</p>
<pre><code class="language-bash">curl http://media.sundog-soft.com/es7/shakes-mapping.json &gt;&gt; shakespeare_mapping.json
curl http://media.sundog-soft.com/es7/shakespeare_7.0.json &gt;&gt; shakespeare.json
</code></pre>
<p>We can now use CURL against the Elasticsearch REST API to create our Shakespeare index:</p>
<pre><code class="language-bash">curl -H &quot;Content-Type: application/json&quot; -XPUT 127.0.0.1:9200/shakespeare --data-binary @shakespeare_mapping.json

{&quot;acknowledged&quot;:true,&quot;shards_acknowledged&quot;:true,&quot;index&quot;:&quot;shakespeare&quot;}
</code></pre>
<pre><code class="language-bash">curl -H &quot;Content-Type: application/json&quot; -XPOST 127.0.0.1:9200/shakespeare/_bulk --data-binary @shakespeare.json

{&quot;acknowledged&quot;:true,&quot;shards_acknowledged&quot;:true,&quot;index&quot;:&quot;shakespeare&quot;}
</code></pre>
<p>We can now query the index:</p>
<pre><code class="language-bash">curl -H &quot;Content-Type: application/json&quot; -XGET &#x27;127.0.0.1:9200/shakespeare/_search?pretty&#x27; -d &#x27;{&quot;query&quot;: {&quot;match_phrase&quot;: {&quot;text_entry&quot;: &quot;Juliet is the sun.&quot;}}}&#x27;
</code></pre>
<p>And get the response:</p>
<pre><code class="language-json">{
  &quot;took&quot; : 35,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 16.28321,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;shakespeare&quot;,
        &quot;_type&quot; : &quot;_doc&quot;,
        &quot;_id&quot; : &quot;86136&quot;,
        &quot;_score&quot; : 16.28321,
        &quot;_source&quot; : {
          &quot;type&quot; : &quot;line&quot;,
          &quot;line_id&quot; : 86137,
          &quot;play_name&quot; : &quot;Romeo and Juliet&quot;,
          &quot;speech_number&quot; : 1,
          &quot;line_number&quot; : &quot;2.2.3&quot;,
          &quot;speaker&quot; : &quot;ROMEO&quot;,
          &quot;text_entry&quot; : &quot;It is the east, and Juliet is the sun.&quot;
        }
      }
    ]
  }
}
</code></pre>
<h2 id="setup-logstash">Setup Logstash</h2>
<h3 id="preparing-the-configuration-files">Preparing the Configuration Files</h3>
<p>Before we start the Logstash container we first have to add two configuration files. Start by creating the following directories:</p>
<pre><code class="language-bash">mkdir -p /opt/logstash/pipeline
</code></pre>
<p>We can download some Apache log sample data from <a href="http://media.sundog-soft.com/es/access_log">here</a>:</p>
<pre><code class="language-bash">curl http://media.sundog-soft.com/es/access_log &gt;&gt; /opt/logstash/access_log
</code></pre>
<p>It is essential to place your pipeline configuration where it can be found by Logstash. By default, the container will look in <code>/usr/share/logstash/pipeline/</code> for pipeline configuration files. If you don’t provide configuration to Logstash, it will run with a minimal config that listens for messages from the Beats input plugin and echoes any that are received to <code>stdout</code>.</p>
<pre><code class="language-bash">nano /opt/logstash/pipeline/logstash.conf
</code></pre>
<pre><code class="language-json">input {
  file {
    path =&gt; &quot;/usr/share/logstash/access_log&quot;
    start_position =&gt; &quot;beginning&quot;
  }
}

filter {
  grok {
    match =&gt; {&quot;message&quot; =&gt; &quot;%{COMBINEDAPACHELOG}&quot;}
  }
  date {
    match =&gt; [&quot;timestamp&quot;, &quot;dd/MMM/yyyy:HH:mm:ss Z&quot;]
  }
}

output {
  elasticsearch {
    hosts =&gt; [&quot;http://localhost:9200&quot;]
    }
    stdout {
      codec =&gt; rubydebug
    }
}
</code></pre>
<p>Now we can run the countainer while mounting our configuration file + sample log data:</p>
<blockquote>
<p>Bind-mounted configuration files will retain the same permissions and ownership within the container that they have on the host system. Be sure to set permissions such that the files will be readable and, ideally, not writeable by the container’s logstash user (UID 1000).</p>
</blockquote>
<pre><code class="language-bash">chown -R 1000:1000 /opt/logstash
</code></pre>
<pre><code class="language-bash">docker run \
   --name logstash \
   --net=host \
   --rm -it \
   -v /opt/logstash/pipeline/logstash.conf:/usr/share/logstash/pipeline/logstash.conf \
   -v /opt/logstash/access_log:/usr/share/logstash/access_log \
   -e &quot;ELASTIC_HOST=localhost:9200&quot; \
   -e &quot;XPACK_SECURITY_ENABLED=false&quot; \
   -e &quot;XPACK_REPORTING_ENABLED=false&quot; \
   -e &quot;XPACK_MONITORING_ENABLED=false&quot; \
   -e &quot;XPACK_MONITORING_ELASTICSEARCH_USERNAME=elastic&quot; \
   -e &quot;XPACK_MONITORING_ELASTICSEARCH_PASSWORD=changeme&quot; \
   logstash:7.13.4
</code></pre>
<blockquote>
<p>This is the point where <strong>I abandoned my meek virtual online server</strong>. Every time I tried starting Logstash, Elasticsearch ran out of memory and crashed. So I continue on my local Intel NUC (equivalent) that brings the power to handle this setup.</p>
</blockquote>
<p>Once I rebuild my setup here I was able to start Logstash and see that it started working on the Apache Log:</p>
<pre><code class="language-bash">2021/07/28 11:53:58 Setting &#x27;xpack.monitoring.enabled&#x27; from environment.
2021/07/28 11:53:58 Setting &#x27;xpack.monitoring.elasticsearch.username&#x27; from environment.
2021/07/28 11:53:58 Setting &#x27;xpack.monitoring.elasticsearch.password&#x27; from environment.
Using bundled JDK: /usr/share/logstash/jdk
OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
Sending Logstash logs to /usr/share/logstash/logs which is now configured via log4j2.properties
[2021-07-28T11:54:14,361][INFO ][logstash.runner          ] Log4j configuration path used is: /usr/share/logstash/config/log4j2.properties
[2021-07-28T11:54:14,370][INFO ][logstash.runner          ] Starting Logstash {&quot;logstash.version&quot;=&gt;&quot;7.13.4&quot;, &quot;jruby.version&quot;=&gt;&quot;jruby 9.2.16.0 (2.5.7) 2021-03-03 f82228dc32 OpenJDK 64-Bit Server VM 11.0.11+9 on 11.0.11+9 +indy +jit [linux-x86_64]&quot;}
[2021-07-28T11:54:14,391][INFO ][logstash.setting.writabledirectory] Creating directory {:setting=&gt;&quot;path.queue&quot;, :path=&gt;&quot;/usr/share/logstash/data/queue&quot;}
[2021-07-28T11:54:14,403][INFO ][logstash.setting.writabledirectory] Creating directory {:setting=&gt;&quot;path.dead_letter_queue&quot;, :path=&gt;&quot;/usr/share/logstash/data/dead_letter_queue&quot;}
[2021-07-28T11:54:14,722][INFO ][logstash.agent           ] No persistent UUID file found. Generating new UUID {:uuid=&gt;&quot;b0829cb5-dc99-4b99-a2f2-8b5d0f6acfcb&quot;, :path=&gt;&quot;/usr/share/logstash/data/uuid&quot;}
[2021-07-28T11:54:15,418][INFO ][logstash.agent           ] Successfully started Logstash API endpoint {:port=&gt;9600}
[2021-07-28T11:54:16,074][INFO ][org.reflections.Reflections] Reflections took 39 ms to scan 1 urls, producing 24 keys and 48 values 
[2021-07-28T11:54:17,018][WARN ][deprecation.logstash.outputs.elasticsearch] Relying on default value of `pipeline.ecs_compatibility`, which may change in a future major release of Logstash. To avoid unexpected changes when upgrading Logstash, please explicitly declare your desired ECS Compatibility mode.
[2021-07-28T11:54:17,223][INFO ][logstash.outputs.elasticsearch][main] New Elasticsearch output {:class=&gt;&quot;LogStash::Outputs::ElasticSearch&quot;, :hosts=&gt;[&quot;http://localhost:9200&quot;]}
[2021-07-28T11:54:17,573][INFO ][logstash.outputs.elasticsearch][main] Elasticsearch pool URLs updated {:changes=&gt;{:removed=&gt;[], :added=&gt;[http://localhost:9200/]}}
[2021-07-28T11:54:17,729][WARN ][logstash.outputs.elasticsearch][main] Restored connection to ES instance {:url=&gt;&quot;http://localhost:9200/&quot;}
[2021-07-28T11:54:17,795][INFO ][logstash.outputs.elasticsearch][main] Elasticsearch version determined (7.13.4) {:es_version=&gt;7}
[2021-07-28T11:54:17,797][WARN ][logstash.outputs.elasticsearch][main] Detected a 6.x and above cluster: the `type` event field won&#x27;t be used to determine the document _type {:es_version=&gt;7}
[2021-07-28T11:54:17,898][WARN ][logstash.outputs.elasticsearch][main] Configuration is data stream compliant but due backwards compatibility Logstash 7.x will not assume writing to a data-stream, default behavior will change on Logstash 8.0 (set `data_stream =&gt; true/false` to disable this warning)
[2021-07-28T11:54:17,899][WARN ][logstash.outputs.elasticsearch][main] Configuration is data stream compliant but due backwards compatibility Logstash 7.x will not assume writing to a data-stream, default behavior will change on Logstash 8.0 (set `data_stream =&gt; true/false` to disable this warning)
[2021-07-28T11:54:17,917][WARN ][deprecation.logstash.filters.grok][main] Relying on default value of `pipeline.ecs_compatibility`, which may change in a future major release of Logstash. To avoid unexpected changes when upgrading Logstash, please explicitly declare your desired ECS Compatibility mode.
[2021-07-28T11:54:17,966][INFO ][logstash.outputs.elasticsearch][main] Using a default mapping template {:es_version=&gt;7, :ecs_compatibility=&gt;:disabled}
[2021-07-28T11:54:18,082][INFO ][logstash.outputs.elasticsearch][main] Installing Elasticsearch template {:name=&gt;&quot;logstash&quot;}
[2021-07-28T11:54:18,179][INFO ][logstash.javapipeline    ][main] Starting pipeline {:pipeline_id=&gt;&quot;main&quot;, &quot;pipeline.workers&quot;=&gt;4, &quot;pipeline.batch.size&quot;=&gt;125, &quot;pipeline.batch.delay&quot;=&gt;50, &quot;pipeline.max_inflight&quot;=&gt;500, &quot;pipeline.sources&quot;=&gt;[&quot;/usr/share/logstash/pipeline/logstash.conf&quot;], :thread=&gt;&quot;#&lt;Thread:0x5dc1d77c run&gt;&quot;}[2021-07-28T11:54:18,431][INFO ][logstash.outputs.elasticsearch][main] Created rollover alias {:name=&gt;&quot;&lt;logstash-{now/d}-000001&gt;&quot;}
[2021-07-28T11:54:18,467][INFO ][logstash.outputs.elasticsearch][main] Installing ILM policy {&quot;policy&quot;=&gt;{&quot;phases&quot;=&gt;{&quot;hot&quot;=&gt;{&quot;actions&quot;=&gt;{&quot;rollover&quot;=&gt;{&quot;max_size&quot;=&gt;&quot;50gb&quot;, &quot;max_age&quot;=&gt;&quot;30d&quot;}}}}}} {:name=&gt;&quot;logstash-policy&quot;}
[2021-07-28T11:54:19,417][INFO ][logstash.javapipeline    ][main] Pipeline Java execution initialization time {&quot;seconds&quot;=&gt;1.23}
[2021-07-28T11:54:19,619][INFO ][logstash.inputs.file     ][main] No sincedb_path set, generating one based on the &quot;path&quot; setting {:sincedb_path=&gt;&quot;/usr/share/logstash/data/plugins/inputs/file/.sincedb_3c3582877a316ab29d93318b4e2f134b&quot;, :path=&gt;[&quot;/usr/share/logstash/access_log&quot;]}
[2021-07-28T11:54:19,640][INFO ][logstash.javapipeline    ][main] Pipeline started {&quot;pipeline.id&quot;=&gt;&quot;main&quot;}
[2021-07-28T11:54:19,699][INFO ][filewatch.observingtail  ][main][d3d6ab5c59cc3016c39f3dda745d68e612eae8fca705ae266565c45069b70e27] START, creating Discoverer, Watch with file and sincedb collections
[2021-07-28T11:54:19,706][INFO ][logstash.agent           ] Pipelines running {:count=&gt;1, :running_pipelines=&gt;[:main], :non_running_pipelines=&gt;[]}
{
       &quot;response&quot; =&gt; &quot;200&quot;,
           &quot;host&quot; =&gt; &quot;debian11&quot;,
          &quot;ident&quot; =&gt; &quot;-&quot;,
           &quot;auth&quot; =&gt; &quot;-&quot;,
    &quot;httpversion&quot; =&gt; &quot;1.1&quot;,
      &quot;timestamp&quot; =&gt; &quot;30/Apr/2017:04:28:11 +0000&quot;,
       &quot;referrer&quot; =&gt; &quot;\&quot;-\&quot;&quot;,
       &quot;@version&quot; =&gt; &quot;1&quot;,
     &quot;@timestamp&quot; =&gt; 2017-04-30T04:28:11.000Z,
          &quot;agent&quot; =&gt; &quot;\&quot;Mozilla/5.0 (compatible; DotBot/1.1; http://www.opensiteexplorer.org/dotbot, help@moz.com)\&quot;&quot;,
       &quot;clientip&quot; =&gt; &quot;216.244.66.246&quot;,
           &quot;path&quot; =&gt; &quot;/usr/share/logstash/access_log&quot;,
           &quot;verb&quot; =&gt; &quot;GET&quot;,
        &quot;request&quot; =&gt; &quot;/docs/triton/pages.html&quot;,
        &quot;message&quot; =&gt; &quot;216.244.66.246 - - [30/Apr/2017:04:28:11 +0000] \&quot;GET /docs/triton/pages.html HTTP/1.1\&quot; 200 5639 \&quot;-\&quot; \&quot;Mozilla/5.0 (compatible; DotBot/1.1; http://www.opensiteexplorer.org/dotbot, help@moz.com)\&quot;&quot;,
          &quot;bytes&quot; =&gt; &quot;5639&quot;
}
{
       &quot;response&quot; =&gt; &quot;200&quot;,
           &quot;host&quot; =&gt; &quot;debian11&quot;,
          &quot;ident&quot; =&gt; &quot;-&quot;,
           &quot;auth&quot; =&gt; &quot;-&quot;,
    &quot;httpversion&quot; =&gt; &quot;1.1&quot;,
      &quot;timestamp&quot; =&gt; &quot;30/Apr/2017:04:30:31 +0000&quot;,
       &quot;referrer&quot; =&gt; &quot;\&quot;-\&quot;&quot;,
       &quot;@version&quot; =&gt; &quot;1&quot;,
     &quot;@timestamp&quot; =&gt; 2017-04-30T04:30:31.000Z,
          &quot;agent&quot; =&gt; &quot;\&quot;Mozilla/5.0 (compatible; AhrefsBot/5.2; +http://ahrefs.com/robot/)\&quot;&quot;,
       &quot;clientip&quot; =&gt; &quot;217.182.132.36&quot;,
           &quot;path&quot; =&gt; &quot;/usr/share/logstash/access_log&quot;,
           &quot;verb&quot; =&gt; &quot;GET&quot;,
        &quot;request&quot; =&gt; &quot;/2012/08/sundog-software-featured-in-august-2012-issue-of-develop/&quot;,
        &quot;message&quot; =&gt; &quot;217.182.132.36 - - [30/Apr/2017:04:30:31 +0000] \&quot;GET /2012/08/sundog-software-featured-in-august-2012-issue-of-develop/ HTTP/1.1\&quot; 200 14326 \&quot;-\&quot; \&quot;Mozilla/5.0 (compatible; AhrefsBot/5.2; +http://ahrefs.com/robot/)\&quot;&quot;,
          &quot;bytes&quot; =&gt; &quot;14326&quot;
}


...

</code></pre>
<p><strong>Fantastic!</strong> And checking Elasticsearch I am able to see that the Logstash index was successfully generated:</p>
<pre><code class="language-bash">curl &#x27;localhost:9200/_cat/indices?v&#x27;

health status index                      uuid                   pri rep docs.count docs.deleted store.size pri.store.size
yellow open   logstash-2021.07.28-000001 7jZ-amZEQZCKqNxk8wFPGA   1   1     102972            0     28.1mb         28.1mb
yellow open   shakespeare                xkrzXAdeSWKmYiEUUA4N7g   1   1     111396            0     18.9mb         18.9mb
</code></pre>
<p>The index was generated and we are able to search it:</p>
<pre><code class="language-bash">curl -XGET &#x27;localhost:9200/logstash-2021.07.28-000001/_search?pretty&#x27;                                                                                      
{
  &quot;took&quot; : 22,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 10000,
      &quot;relation&quot; : &quot;gte&quot;
    },
    &quot;max_score&quot; : 1.0,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;logstash-2021.07.28-000001&quot;,
        &quot;_type&quot; : &quot;_doc&quot;,
        &quot;_id&quot; : &quot;q_b37HoBWtrhasx0jqIE&quot;,
        &quot;_score&quot; : 1.0,
        &quot;_source&quot; : {
          &quot;response&quot; : &quot;200&quot;,
          &quot;host&quot; : &quot;debian11&quot;,
          &quot;ident&quot; : &quot;-&quot;,
          &quot;auth&quot; : &quot;-&quot;,
          &quot;httpversion&quot; : &quot;1.1&quot;,
          &quot;timestamp&quot; : &quot;02/May/2017:03:41:24 +0000&quot;,
          &quot;referrer&quot; : &quot;\&quot;http://sundog-soft.com/wp-cron.php?doing_wp_cron=1493696484.8063950538635253906250\&quot;&quot;,
          &quot;@version&quot; : &quot;1&quot;,
          &quot;@timestamp&quot; : &quot;2017-05-02T03:41:24.000Z&quot;,
          &quot;agent&quot; : &quot;\&quot;WordPress/4.7.4; http://sundog-soft.com\&quot;&quot;,
          &quot;clientip&quot; : &quot;54.210.20.202&quot;,
          &quot;path&quot; : &quot;/usr/share/logstash/access_log&quot;,
          &quot;verb&quot; : &quot;POST&quot;,
          &quot;request&quot; : &quot;/wp-cron.php?doing_wp_cron=1493696484.8063950538635253906250&quot;,
          &quot;message&quot; : &quot;54.210.20.202 - - [02/May/2017:03:41:24 +0000] \&quot;POST /wp-cron.php?doing_wp_cron=1493696484.8063950538635253906250 HTTP/1.1\&quot; 200 - \&quot;http://sundog-soft.com/wp-cron.php?doing_wp_cron=1493696484.8063950538635253906250\&quot; \&quot;WordPress/4.7.4; http://sundog-soft.com\&quot;&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;logstash-2021.07.28-000001&quot;,
        &quot;_type&quot; : &quot;_doc&quot;,
        &quot;_id&quot; : &quot;CPb37HoBWtrhasx0jqOZ&quot;,
        &quot;_score&quot; : 1.0,
        &quot;_source&quot; : {
          &quot;response&quot; : &quot;301&quot;,
          &quot;host&quot; : &quot;debian11&quot;,
          &quot;ident&quot; : &quot;-&quot;,
          &quot;auth&quot; : &quot;-&quot;,
          &quot;httpversion&quot; : &quot;1.1&quot;,
          &quot;timestamp&quot; : &quot;02/May/2017:03:47:28 +0000&quot;,
          &quot;referrer&quot; : &quot;\&quot;-\&quot;&quot;,
          &quot;@version&quot; : &quot;1&quot;,
          &quot;@timestamp&quot; : &quot;2017-05-02T03:47:28.000Z&quot;,
          &quot;agent&quot; : &quot;\&quot;Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)\&quot;&quot;,
          &quot;clientip&quot; : &quot;180.76.15.32&quot;,
          &quot;path&quot; : &quot;/usr/share/logstash/access_log&quot;,
          &quot;verb&quot; : &quot;GET&quot;,
          &quot;request&quot; : &quot;/?utm_source=newsletter&amp;utm_medium=email&amp;utm_campaign=triton-151&quot;,
          &quot;message&quot; : &quot;180.76.15.32 - - [02/May/2017:03:47:28 +0000] \&quot;GET /?utm_source=newsletter&amp;utm_medium=email&amp;utm_campaign=triton-151 HTTP/1.1\&quot; 301 - \&quot;-\&quot; \&quot;Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)\&quot;&quot;
        }
      },


      ...

</code></pre>
<p>To search for e.g. the responses you got for a certain campaign, run the following POST search query:</p>
<pre><code class="language-bash">curl -u elastic:changeme http://localhost:9200/logstash-2021.07.28-000001/_doc/_search?pretty=true -H &#x27;Content-Type: application/json&#x27; -d &#x27;{
    &quot;query&quot;: {
        &quot;query_string&quot;: {&quot;query&quot;: &quot;triton-151&quot;}
    }
}&#x27;
</code></pre>
<h2 id="setup-kibana">Setup Kibana</h2>
<p>We can now start the Kibana container:</p>
<pre><code class="language-bash">docker run -d \
  --name kibana \
  --net=host \
  -e &quot;ELASTICSEARCH_HOSTS=http://localhost:9200&quot; \
  -e &quot;XPACK_MONITORING_ELASTICSEARCH_USERNAME=elastic&quot; \
  -e &quot;XPACK_MONITORING_ELASTICSEARCH_PASSWORD=changeme&quot; \
  kibana:7.13.4
</code></pre>
<p>And create the <strong>Index Pattern</strong> with <strong>timestamp</strong> as our primary field:</p>
<p><img alt="Elastic Logstash" src="/assets/images/Elastic_Logstash_01-a9ec36842c035e05cbdb8f9adaf54593.png" width="1016" height="684"></p>
<p>We can now re-run our campaign search query from before and will get nice graphic showing us exactly when those campaign URL&#x27;s were hit:</p>
<p><img alt="Elastic Logstash" src="/assets/images/Elastic_Logstash_02-ed74de28e440d6929089a34383939443.png" width="1359" height="835"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/linux">LINUX</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/elasticsearch">Elasticsearch</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/Elasticsearch/2021-03-21-logstash-digesting-data/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/DevOps/Elasticsearch/2021-03-22-logstash-working-with-structured-data/2021-03-22"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Logstash 7 Working with Structured Data</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/DevOps/Elasticsearch/2021-03-20-elasticsearch-7-refresher/2021-03-20"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Elasticsearch 7 Refresher</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#setup-elasticsearch" class="table-of-contents__link toc-highlight">Setup Elasticsearch</a><ul><li><a href="#use-curl-to-upload-and-query-data" class="table-of-contents__link toc-highlight">Use CURL to Upload and Query Data</a></li></ul></li><li><a href="#setup-logstash" class="table-of-contents__link toc-highlight">Setup Logstash</a><ul><li><a href="#preparing-the-configuration-files" class="table-of-contents__link toc-highlight">Preparing the Configuration Files</a></li></ul></li><li><a href="#setup-kibana" class="table-of-contents__link toc-highlight">Setup Kibana</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
</body>
</html>