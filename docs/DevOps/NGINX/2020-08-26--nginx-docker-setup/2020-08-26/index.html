<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-DevOps/NGINX/2020-08-26--nginx-docker-setup/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">NGINX Docker Setup | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/DevOps/NGINX/2020-08-26--nginx-docker-setup/2020-08-26"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="NGINX Docker Setup | Mike Polinowski"><meta data-rh="true" name="description" content="Victoria Harbour, Hong Kong"><meta data-rh="true" property="og:description" content="Victoria Harbour, Hong Kong"><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/DevOps/NGINX/2020-08-26--nginx-docker-setup/2020-08-26"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/DevOps/NGINX/2020-08-26--nginx-docker-setup/2020-08-26" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/DevOps/NGINX/2020-08-26--nginx-docker-setup/2020-08-26" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.08c8c484.css">
<script src="/assets/js/runtime~main.839e810d.js" defer="defer"></script>
<script src="/assets/js/main.9aa3fe7c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/development">Development</a><button aria-label="Expand sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/devops">DevOps</a><button aria-label="Collapse sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/hashicorp">Hashicorp</a><button aria-label="Expand sidebar category &#x27;Hashicorp&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/zabbix">Zabbix</a><button aria-label="Expand sidebar category &#x27;Zabbix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/server-provisioning">Server Provisioning</a><button aria-label="Expand sidebar category &#x27;Server Provisioning&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/gitops">GitOps</a><button aria-label="Expand sidebar category &#x27;GitOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/kubernetes">Kubernetes</a><button aria-label="Expand sidebar category &#x27;Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/nginx">NGINX</a><button aria-label="Collapse sidebar category &#x27;NGINX&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2023-06-13-nginx-docker-ingress/2023-06-13">NGINX HTTP/2 Docker Ingress</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2022-12-08-nginx-websocket-proxy/2022-12-08">NGINX Websocket Proxy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2022-11-17-nginx-udp-tcp-load-balancing/2022-11-17">NGINX TCP/UDP Load Balancing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2021-02-23-nginx-agent-redirect/2021-02-23">NGINX Redirect based on User Agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2021-07-29--certbot-nginx-autorenewal/2021-07-29">Setting up Certbot Auto-renewal for NGINX (Maintenance Mode)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2021-02-22-nginx-docker-ingress/2021-02-22">NGINX Docker Ingress for your Gatsby Build</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2020-08-30--nginx-docker-multihost/2020-08-30">NGINX Docker Multihost</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2020-08-28--nginx-docker-certbot/2020-08-27">NGINX Docker with Certbot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2020-08-27--nginx-docker-ssl-certs-self-signed/2020-08-27">NGINX Docker with SSL Encryption (Self-signed)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/DevOps/NGINX/2020-08-26--nginx-docker-setup/2020-08-26">NGINX Docker Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2020-07-29--securing-apache-and-nginx/2020-07-29">Securing Webservers - Apache and NGINX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2019-11-08--nginx-rtmp-website/2019-11-08">Adding an OBS Stream to your Website</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2019-11-07--nginx-rtmp-streaming-container/2019-11-07">Building an RTMP Streaming Server with Podman</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2019-02-05--nginx-ingress-cert-manager/2019-02-05">NGINX Ingress with Cert-Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2017-12-24--nginx-node-security/2017-12-24">NGINX, Node.js &amp; Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/NGINX/2017-10-01--using-nginx-as-proxy-for-your-nodejs-apps/2017-10-01">Using NGINX as proxy for your nodejs apps</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/elasticsearch">Elasticsearch</a><button aria-label="Expand sidebar category &#x27;Elasticsearch&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/ansible">Ansible</a><button aria-label="Expand sidebar category &#x27;Ansible&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/server-security">Server Security</a><button aria-label="Expand sidebar category &#x27;Server Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/linux">Linux</a><button aria-label="Expand sidebar category &#x27;Linux&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/windows">Windows</a><button aria-label="Expand sidebar category &#x27;Windows&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/tomcat">Tomcat</a><button aria-label="Expand sidebar category &#x27;Tomcat&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/salt">Salt</a><button aria-label="Expand sidebar category &#x27;Salt&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/machine-learning-ai-and-computer-vision">Machine Learning, AI and Computer Vision</a><button aria-label="Expand sidebar category &#x27;Machine Learning, AI and Computer Vision&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/automation-deep-vision-and-robotics">Automation, Deep Vision and Robotics</a><button aria-label="Expand sidebar category &#x27;Automation, Deep Vision and Robotics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/devops"><span itemprop="name">DevOps</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/nginx"><span itemprop="name">NGINX</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">NGINX Docker Setup</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>NGINX Docker Setup</h1></header><p><img alt="Victoria Harbour, Hong Kong" src="/assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-b57dcf7a42ddd712383aadde6d3ef4c8.jpg" width="1500" height="509"></p>
<ul>
<li><a href="#nginx-configuration-overview">NGINX Configuration Overview</a></li>
<li><a href="#testing-configuration">Testing Configuration</a></li>
<li><a href="#location-context-modifier">Location Context Modifier</a>
<ul>
<li><a href="#prefix">Prefix</a></li>
<li><a href="#exact-value">Exact Value</a></li>
<li><a href="#case-sensitive-regular-expression">Case Sensitive Regular Expression</a></li>
<li><a href="#case-insensitive-regular-expression">Case Insensitive Regular Expression</a></li>
</ul>
</li>
<li><a href="#try-files-directive">Try Files Directive</a></li>
<li><a href="#structuring-the-main-configuration-file">Structuring the Main Configuration File</a>
<ul>
<li><a href="#etcnginxnginxconf">/etc/nginx/nginx.conf</a></li>
<li><a href="#etcnginxconfdbuffersconf">/etc/nginx/conf.d/buffers.conf</a></li>
<li><a href="#etcnginxconfdtimeoutsconf">/etc/nginx/conf.d/timeouts.conf</a></li>
<li><a href="#etcnginxconfdcacheconf">/etc/nginx/conf.d/cache.conf</a></li>
<li><a href="#etcnginxconfdgzipconf">/etc/nginx/conf.d/gzip.conf</a></li>
</ul>
</li>
<li><a href="#setting-up-the-server-context">Setting up the Server Context</a>
<ul>
<li><a href="#etcnginxconfddefaultconf">/etc/nginx/conf.d/default.conf</a></li>
<li><a href="#etcnginxconfdheaderconf">/etc/nginx/conf.d/header.conf</a></li>
</ul>
</li>
<li><a href="#docker-compose">Docker Compose</a></li>
</ul>
<p>I want to create a template configuration for the Alpine-based NGINX Docker image from DockerHub: <code>nginx:stable-alpine</code>. The idea is to have folder with configuration files that I can modify - according to my project - and then mount as a volume into vanilla NGINX container to proxy my web applications:</p>
<pre><code class="language-bash">docker run -d -p 80:80 -v /opt/nginx_config:/etc/nginx/conf.d --name nginx nginx:stable-alpine
</code></pre>
<h2 id="nginx-configuration-overview">NGINX Configuration Overview</h2>
<p>The default NGINX configuration file is structured like this:</p>
<pre><code class="language-cfg"># main
...
events {
    ...
}


http {
    server {
        location {
            ...
        }
    }
}
</code></pre>
<p>Each <strong>Block</strong> in the configuration file:</p>
<pre><code class="language-cfg">main {{events {http { server { location {}}}}}}
</code></pre>
<p>Is called a <strong>Context</strong>. Each Context holds <strong>Directives</strong> which are parameter / value pairs like <code>server_name localhost;</code>. Such blocks can be separated from the main configuration file and then included using the include keyword:</p>
<pre><code class="language-bash">include /etc/nginx/conf.d/*.conf;
</code></pre>
<h2 id="testing-configuration">Testing Configuration</h2>
<p>After make changes to your configuration file you can validate it in NGINX without having to reload your service:</p>
<pre><code class="language-bash">nginx -t
</code></pre>
<p>To apply those changes you have to reload or restart the NGINX service. The restart will stop the service and start it again, while the reload will keep the original process running. In the latter case, if something goes wrong with the configuration update, it will simply be discarded and your server stays online with the old configuration:</p>
<pre><code class="language-bash">systemctl reload nginx
systemctl restart nginx
</code></pre>
<p>However, since the Docker image does not use SystemD to run the service, you can test the configuration inside the NGINX docker container but then have to restart the container to have it take effect.</p>
<pre><code class="language-bash">docker exec -ti name-or-id-of-my-nginx-container nginx -t

nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
</code></pre>
<pre><code class="language-bash">docker stop name-or-id-of-my-nginx-container
docker start name-or-id-of-my-nginx-container
</code></pre>
<h2 id="location-context-modifier">Location Context Modifier</h2>
<p>The location match defines what NGINX checks the incoming request against. How the match is applied can be influenced by a modifier:</p>
<table><thead><tr><th>Modifier</th><th>Description</th></tr></thead><tbody><tr><td>none</td><td>matched as prefix value</td></tr><tr><td><code>=</code></td><td>matched as an exact value</td></tr><tr><td><code>~</code></td><td>matched as case sensitive regular expression</td></tr><tr><td><code>~*</code></td><td>matched as case insensitive regular expression</td></tr><tr><td><code>^~</code></td><td>matched as prefix value with higher importance than a regular expression</td></tr></tbody></table>
<p>The modifiers are processed in the following order:</p>
<table><thead><tr><th>Order</th><th>Modifier</th></tr></thead><tbody><tr><td>1</td><td><code>=</code></td></tr><tr><td>2</td><td><code>^~</code></td></tr><tr><td>3</td><td><code>~</code> and <code>~*</code></td></tr><tr><td>4</td><td>none</td></tr></tbody></table>
<h3 id="prefix">Prefix</h3>
<pre><code class="language-cfg">location /de {

}
</code></pre>
<p>No modifier matches as a prefix example matches are:</p>
<pre><code class="language-bash">http://URL/de
http://URL/de123
http://URL/deutsch
etc.
</code></pre>
<h3 id="exact-value">Exact Value</h3>
<pre><code class="language-cfg">location = /de {

}
</code></pre>
<p>Only an exact match will pass:</p>
<pre><code class="language-bash">http://URL/de
</code></pre>
<h3 id="case-sensitive-regular-expression">Case Sensitive Regular Expression</h3>
<pre><code class="language-cfg">location ~ /de[0-9] {

}
location ~ /de[a-z] {

}
</code></pre>
<p>This regular expression expects that the <code>/de</code> is either followed by numbers or by non-capital letters. Capital letters or mixed numbers and small letters will not match:</p>
<pre><code class="language-bash">http://URL/de122
http://URL/deutsch
etc.
</code></pre>
<h3 id="case-insensitive-regular-expression">Case Insensitive Regular Expression</h3>
<pre><code class="language-cfg">location ~ /de[0-9] {

}
location ~ /de[a-z] {

}
</code></pre>
<p>This regular expression expects that the <code>/de</code> is either followed by numbers or by letters. Mixed numbers and small letters will not match:</p>
<pre><code class="language-bash">http://URL/de122
http://URL/deutsch
http://URL/deUTSCH
etc.
</code></pre>
<h2 id="try-files-directive">Try Files Directive</h2>
<p>The <code>try_files</code> directive to match the incoming URL to different setups - for example to <code>$uri</code> or <code>$uri/</code> with a trailing backslash or to a static file:</p>
<pre><code class="language-cfg">location / {
    try_files $uri $uri/ /index.html;
}
</code></pre>
<p>NGINX will first try to find an exact match. Then try to add a trailing backslash. And lastly redirect you to the front page if no other fit was found.</p>
<h2 id="structuring-the-main-configuration-file">Structuring the Main Configuration File</h2>
<h3 id="etcnginxnginxconf">/etc/nginx/nginx.conf</h3>
<pre><code class="language-cfg">user  nginx;
worker_processes  auto;
worker_rlimit_nofile  15000;
pid  /var/run/nginx.pid;
include /usr/share/nginx/modules/*.conf;


events {
    worker_connections  2048;
    multi_accept on;
    use epoll;
}


http {
    default_type   application/octet-stream;
    # access_log   /var/log/nginx/access.log;
    # activate the server access log only when needed
    access_log     off;
    error_log      /var/log/nginx/error.log;
    # don&#x27;t display server version on error pages
    server_tokens  off;
    server_names_hash_bucket_size 64;
    include        /etc/nginx/mime.types;
    sendfile       on;
    tcp_nopush     on;
    tcp_nodelay    on;

    charset utf-8;
    source_charset utf-8;
    charset_types text/xml text/plain text/vnd.wap.wml application/javascript application/rss+xml;

    include /etc/nginx/conf.d/default.conf;
    include /etc/nginx/conf.d/buffers.conf;
    include /etc/nginx/conf.d/timeouts.conf;
    # Only activate caching in production
    # include /etc/nginx/conf.d/cache.conf;
    include /etc/nginx/conf.d/gzip.conf;
}
</code></pre>
<blockquote>
<p>Set SELinux policy to allow setrlimit (<code>worker_rlimit_nofile</code>): <code>setsebool -P https_setrlimit 1</code>. A low r limit might lead to an error message of too many open files under load.</p>
</blockquote>
<p>This configuration file is missing the server and location context. Both of them will reside in a separate file in the included <code>conf.d</code> directory called <code>default.conf</code>. Along side we also include a couple of configuration files:</p>
<h3 id="etcnginxconfdbuffersconf">/etc/nginx/conf.d/buffers.conf</h3>
<pre><code class="language-cfg">client_body_buffer_size 10k;
client_header_buffer_size 1k;
client_max_body_size 8m;
large_client_header_buffers 2                                   1k;
# large_client_header_buffers directive needs to be increased
# large_client_header_buffers                                   4 32k;
</code></pre>
<h3 id="etcnginxconfdtimeoutsconf">/etc/nginx/conf.d/timeouts.conf</h3>
<pre><code class="language-cfg">client_header_timeout 3m;
client_body_timeout 3m;
keepalive_timeout 100;
keepalive_requests 1000;
send_timeout 3m;
</code></pre>
<h3 id="etcnginxconfdcacheconf">/etc/nginx/conf.d/cache.conf</h3>
<pre><code class="language-cfg">open_file_cache max=1500 inactive=20s;
open_file_cache_valid 30s;
open_file_cache_min_uses 5;
open_file_cache_errors off;
</code></pre>
<h3 id="etcnginxconfdgzipconf">/etc/nginx/conf.d/gzip.conf</h3>
<pre><code class="language-cfg">gzip on;
gzip_disable &quot;MSIE [1-6]\.(?!.*SV1)&quot;;;
gzip_vary on;
gzip_proxied no-cache no-store private expired;
gzip_comp_level 5;
gzip_min_length 256;
gzip_buffers 16 8k;
gzip_http_version 1.1;
gzip_types text/plain text/css application/json application/javascript
text/xml application/xml application/xml+rss text/javascript
image/svg+xml application/xhtml+xml application/atom+xml application/x-javascript;
</code></pre>
<h2 id="setting-up-the-server-context">Setting up the Server Context</h2>
<p>The application that I am serving has a path prefix to <code>/en/</code>. That means I have to redirect all incoming traffic on <code>/</code> to <code>/en/</code>. The static HTML content that I am serving lies in <code>/opt/test-static/public</code> and has to be set as the root directory for my server.</p>
<h3 id="etcnginxconfddefaultconf">/etc/nginx/conf.d/default.conf</h3>
<pre><code class="language-cfg">server {
    listen       80 default_server;
    listen       [::]:80 default_server;
    server_name  localhost;
    root         /opt/test-static/public;
    index        index.html;

    location = / {
        rewrite   ^/(.*)$  /en/$1  permanent;
    }

    location /en/ {
        try_files  $uri $uri/ $uri.html =404;
        include    /etc/nginx/conf.d/header.conf;
    }

    location ~ /en/download_area/.* {
        root /opt/downloads;
        # deactivate autoindex to use try_files
        # try_files $uri /en/download_area/morning.gif;
        autoindex on;
        autoindex_exact_size off;
        autoindex_format html;
        autoindex_localtime on;
    }

    error_page  404              /en/404.html;
    error_page  500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }
}
</code></pre>
<h3 id="etcnginxconfdheaderconf">/etc/nginx/conf.d/header.conf</h3>
<pre><code class="language-cfg">add_header                Cache-Control  &quot;public, must-revalidate, proxy-revalidate, max-age=0&quot;;
proxy_set_header          X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header          X-NginX-Proxy true;
proxy_set_header          X-Real-IP $remote_addr;
proxy_set_header          X-Forwarded-Proto http;
proxy_hide_header         X-Frame-Options;
proxy_set_header          Accept-Encoding &quot;&quot;;
proxy_http_version        1.1;
proxy_set_header          Upgrade $http_upgrade;
proxy_set_header          Connection &quot;upgrade&quot;;
proxy_set_header          Host $host;
proxy_cache_bypass        $http_upgrade;
proxy_max_temp_file_size  0;
proxy_redirect            off;
proxy_read_timeout        240s;
</code></pre>
<h2 id="docker-compose">Docker Compose</h2>
<pre><code class="language-yml">version: &#x27;3.8&#x27;
services:
  ingress:
    image: nginx:stable-alpine
    container_name: ingress
    networks:
      - gateway
    ports:
      - &#x27;80:80&#x27;
      - &#x27;443:443&#x27;
    restart: unless-stopped
    volumes:
      - /opt/docker-ingress/configuration/conf.d:/etc/nginx/conf.d
      - /opt/docker-ingress/configuration/nginx.conf:/etc/nginx/nginx.conf
      - /opt/test-static/public:/opt/test-static/public
      - /opt/downloads:/opt/downloads

networks:
  gateway: {}
</code></pre>
<p>Tree structure for the mounted download directory:</p>
<pre><code class="language-bash">/opt/downloads
└── en
    └── download_area
        ├── morning.gif
        └── top-cat.png

2 directories, 2 files
</code></pre></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/linux">LINUX</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/nginx">NGINX</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/docker">Docker</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DevOps/NGINX/2020-08-26--nginx-docker-setup/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/DevOps/NGINX/2020-08-27--nginx-docker-ssl-certs-self-signed/2020-08-27"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">NGINX Docker with SSL Encryption (Self-signed)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/DevOps/NGINX/2020-07-29--securing-apache-and-nginx/2020-07-29"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Securing Webservers - Apache and NGINX</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#nginx-configuration-overview" class="table-of-contents__link toc-highlight">NGINX Configuration Overview</a></li><li><a href="#testing-configuration" class="table-of-contents__link toc-highlight">Testing Configuration</a></li><li><a href="#location-context-modifier" class="table-of-contents__link toc-highlight">Location Context Modifier</a><ul><li><a href="#prefix" class="table-of-contents__link toc-highlight">Prefix</a></li><li><a href="#exact-value" class="table-of-contents__link toc-highlight">Exact Value</a></li><li><a href="#case-sensitive-regular-expression" class="table-of-contents__link toc-highlight">Case Sensitive Regular Expression</a></li><li><a href="#case-insensitive-regular-expression" class="table-of-contents__link toc-highlight">Case Insensitive Regular Expression</a></li></ul></li><li><a href="#try-files-directive" class="table-of-contents__link toc-highlight">Try Files Directive</a></li><li><a href="#structuring-the-main-configuration-file" class="table-of-contents__link toc-highlight">Structuring the Main Configuration File</a><ul><li><a href="#etcnginxnginxconf" class="table-of-contents__link toc-highlight">/etc/nginx/nginx.conf</a></li><li><a href="#etcnginxconfdbuffersconf" class="table-of-contents__link toc-highlight">/etc/nginx/conf.d/buffers.conf</a></li><li><a href="#etcnginxconfdtimeoutsconf" class="table-of-contents__link toc-highlight">/etc/nginx/conf.d/timeouts.conf</a></li><li><a href="#etcnginxconfdcacheconf" class="table-of-contents__link toc-highlight">/etc/nginx/conf.d/cache.conf</a></li><li><a href="#etcnginxconfdgzipconf" class="table-of-contents__link toc-highlight">/etc/nginx/conf.d/gzip.conf</a></li></ul></li><li><a href="#setting-up-the-server-context" class="table-of-contents__link toc-highlight">Setting up the Server Context</a><ul><li><a href="#etcnginxconfddefaultconf" class="table-of-contents__link toc-highlight">/etc/nginx/conf.d/default.conf</a></li><li><a href="#etcnginxconfdheaderconf" class="table-of-contents__link toc-highlight">/etc/nginx/conf.d/header.conf</a></li></ul></li><li><a href="#docker-compose" class="table-of-contents__link toc-highlight">Docker Compose</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
</body>
</html>