<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-IoT-and-Machine-Learning/AIOps/2023-06-18-automl-with-autogluon-tabular-data/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">AutoML with AutoGluon for Tabular Data | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/AIOps/2023-06-18-automl-with-autogluon-tabular-data/2023-06-18"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="AutoML with AutoGluon for Tabular Data | Mike Polinowski"><meta data-rh="true" name="description" content="Using Amazon SageMaker / AutoGluon to find your perfect model fit."><meta data-rh="true" property="og:description" content="Using Amazon SageMaker / AutoGluon to find your perfect model fit."><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/AIOps/2023-06-18-automl-with-autogluon-tabular-data/2023-06-18"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/AIOps/2023-06-18-automl-with-autogluon-tabular-data/2023-06-18" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/AIOps/2023-06-18-automl-with-autogluon-tabular-data/2023-06-18" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.08c8c484.css">
<script src="/assets/js/runtime~main.003ec094.js" defer="defer"></script>
<script src="/assets/js/main.0363f805.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/development">Development</a><button aria-label="Expand sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/devops">DevOps</a><button aria-label="Expand sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/machine-learning-ai-and-computer-vision">Machine Learning, AI and Computer Vision</a><button aria-label="Collapse sidebar category &#x27;Machine Learning, AI and Computer Vision&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/machine-learning">Machine Learning</a><button aria-label="Expand sidebar category &#x27;Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/aiops">AIOps</a><button aria-label="Collapse sidebar category &#x27;AIOps&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-09-27-zenml-intro-sklearn-pipeline/2023-09-27">MLOps with ZenML - SKLearn Classifier Pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-08-19-tensorflow-serving-api/2023-08-19">Tensorflow Serving API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-07-12-scikit-image-model-deployment-part2/2023-07-12">Serving your SciKit Image Model as a Prediction API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-07-10-scikit-image-model-deployment-part1/2023-07-10">Serving your SciKit Image Model as a Prediction API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-06-23-automl-with-autogluon-timeseries-forecast/2023-06-23">AutoML with AutoGluon for Timeseries Forecasts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-06-21-automl-with-autogluon-multiclass-nlp/2023-06-21">AutoML with AutoGluon for Multi-Modal Data NLP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-06-18-automl-with-autogluon-tabular-data/2023-06-18">AutoML with AutoGluon for Tabular Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-06-17-scikit-learn-model-deployment/2023-06-17">Serving your SciKit Learn Model as a Prediction API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-03-27-deploying-prediction-apis-with-flask/2023-03-27">Deploying Prediction APIs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-02-09-mlflow-introduction/2023-02-09">MLflow 2.1 Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-02-06-apache-airflow-dynamic-dags/2023-02-06">Apache Airflow Dynamic DAGs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-02-05-apache-airflow-scheduler/2023-02-05">Apache Airflow DAG Scheduling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-02-04-apache-airflow-data-pipelines/2023-02-04">Apache Airflow Data Pipelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-02-01-apache-airflow-introduction/2023-02-01">Apache Airflow Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-01-31-python-ray-model-serving/2023-01-31">Python Ray Model Serving</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-01-29-python-ray-deployments/2023-01-29">Python Ray Deployments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-01-26-python-ray-remote-actors/2023-01-26">Python Ray Remote Actors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-01-23-python-ray-remote-functions/2023-01-23">Python Ray Remote Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-01-22-python-ray-introduction/2023-01-22">Python Ray Basic Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-01-06-dvc-model-access/2023-01-05">DVC Model Access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-01-05-dvc-model-version-control/2023-01-05">Data Version Control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-01-04-tf-distributed-strategy/2023-01-04">Distributed training with TensorFlow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-01-03-tf-tensorboard/2023-01-03">Tensorflow Tensorboard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-01-02-tf-serve-own-models/2023-01-02">Tensorflow Serving REST API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/AIOps/2023-01-01-tf-model-server/2023-01-01">Tensorflow Docker Model Server</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/automation-deep-vision-and-robotics">Automation, Deep Vision and Robotics</a><button aria-label="Expand sidebar category &#x27;Automation, Deep Vision and Robotics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/machine-learning-ai-and-computer-vision"><span itemprop="name">Machine Learning, AI and Computer Vision</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/aiops"><span itemprop="name">AIOps</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">AutoML with AutoGluon for Tabular Data</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p><img alt="TST, HongKong" src="/assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-a15d7463fa71afd7563b41d830022879.jpg" width="1500" height="575"></p>
<h1 id="automl-with-autogluon-for-tabular-data">AutoML with AutoGluon for Tabular Data</h1>
<ul>
<li>Part 1: AutoML with AutoGluon for Tabular Data</li>
<li>Part 2: <a href="/docs/IoT-and-Machine-Learning/AIOps/2023-06-21-automl-with-autogluon-multiclass-nlp/2023-06-21">AutoML with AutoGluon for Multi-Modal Data</a></li>
<li>Part 3: <a href="/docs/IoT-and-Machine-Learning/AIOps/2023-06-23-automl-with-autogluon-timeseries-forecast/2023-06-23">AutoML with AutoGluon for Timeseries Forecasts</a></li>
</ul>
<p><a href="https://github.com/autogluon/autogluon">AutoGluon</a> automates machine learning tasks enabling you to easily achieve strong predictive performance in your applications. With just a few lines of code, you can train and deploy high-accuracy machine learning and deep learning models on image, text, time series, and tabular data.</p>
<p><a href="https://github.com/mpolinowski/automl-gluon-tabular-data">Github Repository</a></p>
<ul>
<li><a href="#automl-with-autogluon-for-tabular-data">AutoML with AutoGluon for Tabular Data</a>
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#tabular-data-classification">Tabular Data Classification</a>
<ul>
<li><a href="#classification-model">Classification Model</a>
<ul>
<li><a href="#data-preprocessing">Data Preprocessing</a></li>
<li><a href="#model-training">Model Training</a></li>
<li><a href="#model-loading">Model Loading</a></li>
<li><a href="#model-testing">Model Testing</a></li>
<li><a href="#feature-interpretability">Feature Interpretability</a></li>
<li><a href="#running-predictions">Running Predictions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#tabular-data-regression">Tabular Data Regression</a>
<ul>
<li><a href="#data-preprocessing-1">Data Preprocessing</a></li>
<li><a href="#model-training-1">Model Training</a>
<ul>
<li><a href="#model-loading-1">Model Loading</a></li>
<li><a href="#model-testing-model-testing">Model Testing Model Testing</a></li>
<li><a href="#feature-interpretability-1">Feature Interpretability</a></li>
<li><a href="#running-predictions-1">Running Predictions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#customizations">Customizations</a>
<ul>
<li><a href="#inference-constraints">Inference Constraints</a></li>
<li><a href="#hyperparameter-tuning">Hyperparameter Tuning</a></li>
<li><a href="#autogluon-presets">AutoGluon Presets</a></li>
</ul>
</li>
<li><a href="#model-deployment">Model Deployment</a></li>
</ul>
</li>
</ul>
<h2 id="installation">Installation</h2>
<p><a href="https://auto.gluon.ai/stable/install.html">Installing AutoGluon</a> with GPU support:</p>
<pre><code class="language-bash">pip install -U pip
pip install -U setuptools wheel
pip install torch==1.13.1+cu117 torchvision==0.14.1+cu117 --extra-index-url https://download.pytorch.org/whl/cu117
pip install autogluon
# for visualizations
pip install bokeh==2.0.1&quot;
</code></pre>
<h2 id="tabular-data-classification">Tabular Data Classification</h2>
<pre><code class="language-python"># get dataset
!wget https://github.com/mpolinowski/hotel-booking-dataset/raw/master/datasets/hotel_bookings.csv -P datase
</code></pre>
<pre><code class="language-python">from autogluon.tabular import TabularDataset, TabularPredictor
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import seaborn as sns
</code></pre>
<pre><code class="language-python">SEED = 42
MODEL_PATH = &#x27;model&#x27;
</code></pre>
<h3 id="classification-model">Classification Model</h3>
<h4 id="data-preprocessing">Data Preprocessing</h4>
<pre><code class="language-python">data = TabularDataset(&#x27;dataset/hotel_bookings.csv&#x27;)
data.head(5).transpose()
</code></pre>
<table><thead><tr><th></th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th></tr></thead><tbody><tr><td>hotel</td><td>Resort Hotel</td><td>Resort Hotel</td><td>Resort Hotel</td><td>Resort Hotel</td><td>Resort Hotel</td></tr><tr><td>is_canceled</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>lead_time</td><td>342</td><td>737</td><td>7</td><td>13</td><td>14</td></tr><tr><td>arrival_date_year</td><td>2015</td><td>2015</td><td>2015</td><td>2015</td><td>2015</td></tr><tr><td>arrival_date_month</td><td>July</td><td>July</td><td>July</td><td>July</td><td>July</td></tr><tr><td>arrival_date_week_number</td><td>27</td><td>27</td><td>27</td><td>27</td><td>27</td></tr><tr><td>arrival_date_day_of_month</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr><tr><td>stays_in_weekend_nights</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>stays_in_week_nights</td><td>0</td><td>0</td><td>1</td><td>1</td><td>2</td></tr><tr><td>adults</td><td>2</td><td>2</td><td>1</td><td>1</td><td>2</td></tr><tr><td>children</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>babies</td><td>Model Testingype</td><td>No Deposit</td><td>No Deposit</td><td>No Deposit</td><td>No Deposit</td></tr><tr><td>agent</td><td>NaN</td><td>NaN</td><td>NaN</td><td>304.0</td><td>240.0</td></tr><tr><td>company</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td>days_in_waiting_list</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>customer_type</td><td>Transient</td><td>Transient</td><td>Transient</td><td>Transient</td><td>Transient</td></tr><tr><td>adr</td><td>0.0</td><td>0.0</td><td>75.0</td><td>75.0</td><td>98.0</td></tr><tr><td>required_car_parking_spaces</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>total_of_special_requests</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td></tr><tr><td>reservation_status</td><td>Check-Out</td><td>Check-Out</td><td>Check-Out</td><td>Check-Out</td><td>Check-Out</td></tr><tr><td>reservation_status_date</td><td>01-07-15</td><td>01-07-15</td><td>02-07-15</td><td>02-07-15</td><td>03-07-15</td></tr></tbody></table>
<pre><code class="language-python"># the are two columns for the label is_canceled and reservation_status
# only keep one and make it the true label
data = data.drop([&#x27;is_canceled&#x27;], axis=1)
data = data.drop([&#x27;reservation_status_date&#x27;], axis=1)
</code></pre>
<pre><code class="language-python">data.info()
# &lt;class &#x27;autogluon.core.dataset.TabularDataset&#x27;&gt;
# RangeIndex: 119390 entries, 0 to 119389
# Data columns (total 30 columns)
</code></pre>
<pre><code class="language-python"># take small random sample to get started =&gt; 10%
data_sample = data.sample(frac=0.1 , random_state=SEED)
data_sample.describe()
</code></pre>
<p>|  | lead_time | arrival_date_year | arrival_date_week_number | arrival_date_day_of_month | stays_in_weekend_nights | stays_in_week_nights | adults | children | babies | is_repeated_guest | previous_cancellations | pr_Reg
| min | 0.000000 | 2015.000000 | 1.000000 | 1.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 1.000000 | 9.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 |
| 25% | 19.000000 | 2016.000000 | 16.000000 | 8.000000 | 0.000000 | 1.000000 | 2.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 9.000000 | 67.000000 | 0.000000 | 69.000000 | 0.000000 | 0.000000 |
| 50% | 70.000000 | 2016.000000 | 27.000000 | 16.000000 | 1.000000 | 2.000000 | 2.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 14.000000 | 178.000000 | 0.000000 | 95.000000 | 0.000000 | 0.000000 |
| 75% | 162.000000 | 2017.000000 | 38.000000 | 24.000000 | 2.000000 | 3.000000 | 2.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 229.000000 | 254.000000 | 0.000000 | 126.000000 | 0.000000 | 1.000000 |
| max | 629.000000 | 2017.000000 | 53.000000 | 31.000000 | 12.000000 | 30.000000 | 55.000000 | 3.000000 | 9.000000 | 1.000000 | 26.000000 | 56.000000 | 14.000000 | 531.000000 | 525.000000 | 391.000000 | 451.500000 | 3.000000 | 5.000000 |</p>
<pre><code class="language-python"># train/test split
print(len(data_sample)*0.8)
# 9551.2
train_size = 9550
train_data = data_sample.sample(n=train_size, random_state=SEED)
test_data = data_sample.drop(train_data.index)
print(len(train_data), len(test_data))
# 9550 2389
</code></pre>
<h4 id="model-training">Model Training</h4>
<pre><code class="language-python"># train a binary classification model on booking cancellation
predictor = TabularPredictor(label=&#x27;reservation_status&#x27;, path=MODEL_PATH)
predictor.fit(train_data)

# AutoGluon infers your prediction problem is: &#x27;multiclass&#x27; (because dtype of label-column == object).
# 3 unique label values:  [&#x27;Check-Out&#x27;, &#x27;Canceled&#x27;, &#x27;No-Show&#x27;]
    
# AutoGluon training complete, total runtime = 56.25s ... Best model: &quot;WeightedEnsemble_L2&quot;
</code></pre>
<pre><code class="language-python">predictor.fit_summary()
</code></pre>
<p>Estimated performance of each model:</p>
<table><thead><tr><th></th><th>model</th><th>score_val</th><th>pred_time_val</th><th>fit_time</th><th>pred_time_val_marginal</th><th>fit_time_marginal</th><th>stack_level</th><th>can_infer</th><th>fit_order</th></tr></thead><tbody><tr><td>0</td><td>WeightedEnsemble_L2</td><td>0.875393</td><td>0.047837</td><td>17.448067</td><td>0.000508</td><td>0.399006</td><td>2</td><td>True</td><td>14</td></tr><tr><td>1</td><td>XGBoost</td><td>0.874346</td><td>0.028096</td><td>3.322933</td><td>0.028096</td><td>3.322933</td><td>1</td><td>True</td><td>11</td></tr><tr><td>2</td><td>LightGBMLarge</td><td>0.869110</td><td>0.036332</td><td>4.947290</td><td>0.036332</td><td>4.947290</td><td>1</td><td>True</td><td>13</td></tr><tr><td>3</td><td>LightGBM</td><td>0.865969</td><td>0.037277</td><td>2.222120</td><td>0.037277</td><td>2.222120</td><td>1</td><td>True</td><td>5</td></tr><tr><td>4</td><td>LightGBMXT</td><td>0.863874</td><td>0.055051</td><td>2.591614</td><td>0.055051</td><td>2.591614</td><td>1</td><td>True</td><td>4</td></tr><tr><td>5</td><td>RandomForestGini</td><td>0.857592</td><td>0.061962</td><td>0.840476</td><td>0.061962</td><td>0.840476</td><td>1</td><td>True</td><td>6</td></tr><tr><td>6</td><td>CatBoost</td><td>0.856545</td><td>0.011194</td><td>14.661669</td><td>0.011194</td><td>14.661669</td><td>1</td><td>True</td><td>8</td></tr><tr><td>7</td><td>RandomForestEntr</td><td>0.854450</td><td>0.062001</td><td>0.905256</td><td>0.062001</td><td>0.905256</td><td>1</td><td>True</td><td>7</td></tr><tr><td>8</td><td>ExtraTreesEntr</td><td>0.850262</td><td>0.062787</td><td>0.729818</td><td>0.062787</td><td>0.729818</td><td>1</td><td>True</td><td>10</td></tr><tr><td>9</td><td>ExtraTreesGini</td><td>0.849215</td><td>0.063442</td><td>0.799020</td><td>0.063442</td><td>0.799020</td><td>1</td><td>True</td><td>9</td></tr><tr><td>10</td><td>NeuralNetTorch</td><td>0.847120</td><td>0.019233</td><td>13.726129</td><td>0.019233</td><td>13.726129</td><td>1</td><td>True</td><td>12</td></tr><tr><td>11</td><td>NeuralNetFastAI</td><td>0.838743</td><td>0.018830</td><td>7.619330</td><td>0.018830</td><td>7.619330</td><td>1</td><td>True</td><td>3</td></tr><tr><td>12</td><td>KNeighborsDist</td><td>0.707853</td><td>0.013923</td><td>0.007954</td><td>0.013923</td><td>0.007954</td><td>1</td><td>True</td><td>2</td></tr><tr><td>13</td><td>KNeighborsUnif</td><td>0.689005</td><td>0.034556</td><td>0.009681</td><td>0.034556</td><td>0.009681</td><td>1</td><td>True</td><td>1</td></tr></tbody></table>
<p>Number of models trained: 14
Types of models trained:</p>
<!-- -->WeightedEnsembleModel<!-- -->
<pre><code class="language-python">leaderboard=pd.DataFrame(predictor.leaderboard())

plt.figure(figsize=(8, 7))

sns.set(style=&#x27;darkgrid&#x27;)

sns.scatterplot(
    x=&#x27;pred_time_val&#x27;,
    y=&#x27;score_val&#x27;,
    data=leaderboard,
    s=300,
    alpha=0.5,
    hue=&#x27;model&#x27;,
    palette=&#x27;tab20&#x27;,
    style=&#x27;fit_time&#x27;
)

plt.title(&#x27;Prediction Time vs Accuracy Score&#x27;)
plt.xlabel(&#x27;Average Time for Predictions&#x27;)
plt.ylabel(&#x27;Accuracy Score&#x27;)
plt.legend(bbox_to_anchor=(1.01,1.01))

plt.savefig(&#x27;assets/AutoML_with_AutoGluon_01.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="AutoML with AutoGluon for Tabular Data" src="/assets/images/AutoML_with_AutoGluon_01-c406a0ed439e3eb44650e81c3a3747a2.webp" width="977" height="730"></p>
<h4 id="model-loading">Model Loading</h4>
<pre><code class="language-python"># load best model
predictor = TabularPredictor.load(&quot;model/&quot;)
</code></pre>
<h4 id="model-testing">Model Testing</h4>
<pre><code class="language-python">X_test = test_data.drop(columns=[&#x27;reservation_status&#x27;] )
y_test = test_data[&#x27;reservation_status&#x27;]
</code></pre>
<pre><code class="language-python">y_pred = predictor.predict(X_test)
</code></pre>
<pre><code class="language-python">eval_metrics = predictor.evaluate_predictions(y_true=y_test, y_pred=y_pred, auxiliary_metrics=True)
</code></pre>
<pre><code class="language-python">array = np.array(list(eval_metrics.items()))
df = pd.DataFrame(array, columns = [&#x27;metric&#x27;,&#x27;value&#x27;]).sort_values(by=&#x27;value&#x27;)

plt.figure(figsize=(12,5))
plt.bar(df[&#x27;metric&#x27;], df[&#x27;value&#x27;])
plt.title(&#x27;Evaluation Metrics&#x27;)

plt.savefig(&#x27;assets/AutoML_with_AutoGluon_02.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="AutoML with AutoGluon for Tabular Data" src="data:image/webp;base64,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" width="1132" height="456"></p>
<h4 id="feature-interpretability">Feature Interpretability</h4>
<p>Get feature importance by conducting a <strong>Permutation-Shuffling</strong> test in AutoGluon. Shuffle one feature column, test how this effects prediction accuracy. The higher the effect the higher the features / columns importance. Negative effects show features that confuse the model, decrease the prediction accuracy and should be removed.</p>
<pre><code class="language-python"># add test dataset that must include the classifier (is_cancelled):
predictor.feature_importance(test_data)
</code></pre>
<table><thead><tr><th></th><th>importance</th><th>stddev</th><th>p_value</th><th>n</th><th>p99_high</th><th>p99_low</th></tr></thead><tbody><tr><td>country</td><td>0.061532</td><td>0.003076</td><td>7.468850e-07</td><td>5</td><td>0.067865</td><td>0.055199</td></tr><tr><td>deposit_type</td><td>0.058183</td><td>0.008815</td><td>6.133847e-05</td><td>5</td><td>0.076334</td><td>0.040033</td></tr><tr><td>total_of_special_requests</td><td>0.045626</td><td>0.006532</td><td>4.905663e-05</td><td>5</td><td>0.059075</td><td>0.032177</td></tr><tr><td>lead_time</td><td>0.038677</td><td>0.007045</td><td>1.264772e-04</td><td>5</td><td>0.053184</td><td>0.024171</td></tr><tr><td>agent</td><td>0.031394</td><td>0.003362</td><td>1.553978e-05</td><td>5</td><td>0.038316</td><td>0.024472</td></tr><tr><td>previous_cancellations</td><td>0.030222</td><td>0.002891</td><td>9.926338e-06</td><td>5</td><td>0.036174</td><td>0.024269</td></tr><tr><td>assigned_room_type</td><td>0.029217</td><td>0.003010</td><td>1.332357e-05</td><td>5</td><td>0.035414</td><td>0.023020</td></tr><tr><td>market_segment</td><td>0.028213</td><td>0.005106</td><td>1.233146e-04</td><td>5</td><td>0.038726</td><td>0.017699</td></tr><tr><td>reserved_room_type</td><td>0.023022</td><td>0.002529</td><td>1.719338e-05</td><td>5</td><td>0.028229</td><td>0.017815</td></tr><tr><td>required_car_parking_spaces</td><td>0.011469</td><td>0.001909</td><td>8.880361e-05</td><td>5</td><td>0.015400</td><td>0.007538</td></tr><tr><td>customer_type</td><td>0.010130</td><td>0.003593</td><td>1.619134e-03</td><td>5</td><td>0.017529</td><td>0.002731</td></tr><tr><td>arrival_date_year</td><td>0.007032</td><td>0.002703</td><td>2.173517e-03</td><td>5</td><td>0.012598</td><td>0.001467</td></tr><tr><td>booking_changes</td><td>0.006195</td><td>0.001711</td><td>6.319167e-04</td><td>5</td><td>0.009717</td><td>0.002673</td></tr><tr><td>adr</td><td>0.004604</td><td>0.002476</td><td>7.086297e-03</td><td>5</td><td>0.009703</td><td>-0.000494</td></tr><tr><td>previous_bookings_not_canceled</td><td>0.003767</td><td>0.001751</td><td>4.290459e-03</td><td>5</td><td>0.007373</td><td>0.000162</td></tr><tr><td>company</td><td>0.003684</td><td>0.001761</td><td>4.733895e-03</td><td>5</td><td>0.007310</td><td>0.000058</td></tr><tr><td>children</td><td>0.003014</td><td>0.000546</td><td>1.235932e-04</td><td>5</td><td>0.004138</td><td>0.001890</td></tr><tr><td>arrival_date_week_number</td><td>0.002260</td><td>0.002706</td><td>6.760071e-02</td><td>5</td><td>0.007833</td><td>-0.003312</td></tr><tr><td>meal</td><td>0.001005</td><td>0.001008</td><td>4.488794e-02</td><td>5</td><td>0.003080</td><td>-0.001071</td></tr><tr><td>stays_in_weekend_nights</td><td>0.000921</td><td>0.001659</td><td>1.411190e-01</td><td>5</td><td>0.004336</td><td>-0.002494</td></tr><tr><td>arrival_date_month</td><td>0.000670</td><td>0.001555</td><td>1.950213e-01</td><td>5</td><td>0.003871</td><td>-0.002532</td></tr><tr><td>is_repeated_guest</td><td>0.000419</td><td>0.001184</td><td>2.367137e-01</td><td>5</td><td>0.002856</td><td>-0.002019</td></tr><tr><td>distribution_channel</td><td>0.000335</td><td>0.001042</td><td>2.561126e-01</td><td>5</td><td>0.002481</td><td>-0.001811</td></tr><tr><td>days_in_waiting_list</td><td>-0.000335</td><td>0.000350</td><td>9.503497e-01</td><td>5</td><td>0.000386</td><td>-0.001056</td></tr><tr><td>babies</td><td>-0.000335</td><td>0.000459</td><td>9.110961e-01</td><td>5</td><td>0.000609</td><td>-0.001279</td></tr><tr><td>adults</td><td>-0.000753</td><td>0.002163</td><td>7.602366e-01</td><td>5</td><td>0.003700</td><td>-0.005207</td></tr><tr><td>stays_in_week_nights</td><td>-0.001005</td><td>0.002939</td><td>7.563611e-01</td><td>5</td><td>0.005047</td><td>-0.007056</td></tr><tr><td>arrival_date_day_of_month</td><td>-0.001005</td><td>0.002397</td><td>7.991062e-01</td><td>5</td><td>0.003931</td><td>-0.005941</td></tr><tr><td>hotel</td><td>-0.001088</td><td>0.002147</td><td>8.398613e-01</td><td>5</td><td>0.003332</td><td>-0.005508</td></tr></tbody></table>
<pre><code class="language-python">importance_df = predictor.feature_importance(test_data).reset_index()
</code></pre>
<pre><code class="language-python">plt.figure(figsize=(8,8))
plt.title(&#x27;Feature Importance&#x27;)
sns.set(style=&#x27;darkgrid&#x27;)
sns.barplot(
    data=importance_df,
    y=&#x27;index&#x27;,
    x=&#x27;importance&#x27;,
    orient=&#x27;horizontal&#x27;
).set_ylabel(&#x27;Feature&#x27;)

plt.savefig(&#x27;assets/AutoML_with_AutoGluon_03.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="AutoML with AutoGluon for Tabular Data" src="/assets/images/AutoML_with_AutoGluon_03-2f15b95d2ca582cda792504d2af3247b.webp" width="928" height="710"></p>
<h4 id="running-predictions">Running Predictions</h4>
<pre><code class="language-python">test_booking = {
  &quot;hotel&quot;: &quot;City Hotel&quot;,
  &quot;is_canceled&quot;: 0,
  &quot;lead_time&quot;: 214,
  &quot;arrival_date_year&quot;: 2017,
  &quot;arrival_date_month&quot;: &quot;June&quot;,
  &quot;arrival_date_week_number&quot;: 23,
  &quot;arrival_date_day_of_month&quot;: 9,
  &quot;stays_in_weekend_nights&quot;: 1,
  &quot;stays_in_week_nights&quot;: 2,
  &quot;adults&quot;: 2,
  &quot;children&quot;: 0,
  &quot;babies&quot;: 0,
  &quot;meal&quot;: &quot;BB&quot;,
  &quot;country&quot;: &quot;GBR&quot;,
  &quot;market_segment&quot;: &quot;Groups&quot;,
  &quot;distribution_channel&quot;: &quot;Direct&quot;,
  &quot;is_repeated_guest&quot;: 0,
  &quot;previous_cancellations&quot;: 0,
  &quot;previous_bookings_not_canceled&quot;: 0,
  &quot;reserved_room_type&quot;: &quot;D&quot;,
  &quot;assigned_room_type&quot;: &quot;D&quot;,
  &quot;booking_changes&quot;: 1,
  &quot;deposit_type&quot;: &quot;No Deposit&quot;,
  &quot;agent&quot;: 28,
  &quot;company&quot;: 153,
  &quot;days_in_waiting_list&quot;: 0,
  &quot;customer_type&quot;: &quot;Transient&quot;,
  &quot;adr&quot;: 118.13,
  &quot;required_car_parking_spaces&quot;: 0,
  &quot;total_of_special_requests&quot;: 0,
  &quot;reservation_status&quot;: &quot;Check-Out&quot;,
  &quot;reservation_status_date&quot;: &quot;12-06-17&quot;
}
</code></pre>
<pre><code class="language-python"># load booking into dataset
test_booking_df = TabularDataset.from_dict([test_booking])
test_booking_from_csv_df = TabularDataset(&#x27;dataset/test_booking.csv&#x27;)
</code></pre>
<pre><code class="language-python">predictor.predict(test_booking_df)
# 0    Check-Out &lt;- not cancelled
# Name: is_canceled, dtype: int64
</code></pre>
<pre><code class="language-python">predictor.predict(test_booking_from_csv_df)
# 0    Check-Out &lt;- not cancelled
# Name: is_canceled, dtype: int64
</code></pre>
<h2 id="tabular-data-regression">Tabular Data Regression</h2>
<pre><code class="language-python"># get dataset
! wget https://raw.githubusercontent.com/mgrafals/Uber-Data-Engineering-Project/main/uber_data.csv -P dataset
</code></pre>
<pre><code class="language-python">from autogluon.tabular import TabularDataset, TabularPredictor
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import seaborn as sns
</code></pre>
<pre><code class="language-python">SEED = 42
MODEL_PATH = &#x27;model&#x27;
</code></pre>
<h3 id="data-preprocessing-1">Data Preprocessing</h3>
<pre><code class="language-python">data = TabularDataset(&#x27;dataset/uber_data.csv&#x27;)
data.head().transpose()
</code></pre>
<table><thead><tr><th></th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th></tr></thead><tbody><tr><td>VendorID</td><td>1</td><td>1</td><td>2</td><td>2</td><td>2</td></tr><tr><td>tpep_pickup_datetime</td><td>2016-03-01 00:00:00</td><td>2016-03-01 00:00:00</td><td>2016-03-01 00:00:00</td><td>2016-03-01 00:00:00</td><td>2016-03-01 00:00:00</td></tr><tr><td>tpep_dropoff_datetime</td><td>2016-03-01 00:07:55</td><td>2016-03-01 00:11:06</td><td>2016-03-01 00:31:06</td><td>2016-03-01 00:00:00</td><td>2016-03-01 00:00:00</td></tr><tr><td>passenger_count</td><td>1</td><td>1</td><td>2</td><td>3</td><td>5</td></tr><tr><td>trip_distance</td><td>2.5</td><td>2.9</td><td>19.98</td><td>10.78</td><td>30.43</td></tr><tr><td>pickup_longitude</td><td>-73.976746</td><td>-73.983482</td><td>-73.782021</td><td>-73.863419</td><td>-73.971741</td></tr><tr><td>pickup_latitude</td><td>40.765152</td><td>40.767925</td><td>40.64481</td><td>40.769814</td><td>40.792183</td></tr><tr><td>RatecodeID</td><td>1</td><td>1</td><td>1</td><td>1</td><td>3</td></tr><tr><td>store_and_fwd_flag</td><td>N</td><td>N</td><td>N</td><td>N</td><td>N</td></tr><tr><td>dropoff_longitude</td><td>-74.004265</td><td>-74.005943</td><td>-73.974541</td><td>-73.96965</td><td>-74.17717</td></tr><tr><td>dropoff_latitude</td><td>40.746128</td><td>40.733166</td><td>40.67577</td><td>40.757767</td><td>40.695053</td></tr><tr><td>payment_type</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr><tr><td>fare_amount</td><td>9.0</td><td>11.0</td><td>54.5</td><td>31.5</td><td>98.0</td></tr><tr><td>extra</td><td>0.5</td><td>0.5</td><td>0.5</td><td>0.0</td><td>0.0</td></tr><tr><td>mta_tax</td><td>0.5</td><td>0.5</td><td>0.5</td><td>0.5</td><td>0.0</td></tr><tr><td>tip_amount</td><td>2.05</td><td>3.05</td><td>8.0</td><td>3.78</td><td>0.0</td></tr><tr><td>tolls_amount</td><td>0.0</td><td>0.0</td><td>0.0</td><td>5.54</td><td>15.5</td></tr><tr><td>improvement_surcharge</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.3</td></tr><tr><td>total_amount</td><td>12.35</td><td>15.35</td><td>63.8</td><td>41.62</td><td>113.8</td></tr></tbody></table>
<pre><code class="language-python"># there are two values that directly scale with the label
# of of passenger fare: fare_amount and total_amount -&gt; drop the latter
data = data.drop(&#x27;total_amount&#x27;, axis=1)
</code></pre>
<pre><code class="language-python">data.info()
# RangeIndex: 100000 entries, 0 to 99999
# Data columns (total 18 columns):
</code></pre>
<pre><code class="language-python">data_sample = data.sample(frac=0.5 , random_state=SEED)
data_sample.describe()
</code></pre>
<table><thead><tr><th></th><th>VendorID</th><th>passenger_count</th><th>trip_distance</th><th>pickup_longitude</th><th>pickup_latitude</th><th>RatecodeID</th><th>dropoff_longitude</th><th>dropoff_latitude</th><th>payment_type</th><th>fare_amount</th><th>extra</th><th>mta_tax</th><th>tip_amount</th><th>tolls_amount</th><th>improvement_surcharge</th><th>total_amount</th></tr></thead><tbody><tr><td>count</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td><td>50000.000000</td></tr><tr><td>mean</td><td>1.883160</td><td>1.926360</td><td>3.039138</td><td>-73.252772</td><td>40.355400</td><td>1.040780</td><td>-73.274211</td><td>40.367544</td><td>1.337420</td><td>13.287511</td><td>0.101730</td><td>0.496980</td><td>1.881304</td><td>0.367985</td><td>0.299484</td><td>16.434978</td></tr><tr><td>std</td><td>0.321233</td><td>1.586212</td><td>3.851644</td><td>7.268226</td><td>4.002437</td><td>0.284462</td><td>7.156534</td><td>3.940944</td><td>0.482423</td><td>12.104265</td><td>0.202674</td><td>0.042906</td><td>2.582070</td><td>1.521707</td><td>0.016749</td><td>14.779261</td></tr><tr><td>min</td><td>1.000000</td><td>0.000000</td><td>0.000000</td><td>-121.933151</td><td>0.000000</td><td>1.000000</td><td>-121.933327</td><td>0.000000</td><td>1.000000</td><td>-7.000000</td><td>-0.500000</td><td>-0.500000</td><td>-2.700000</td><td>0.000000</td><td>-0.300000</td><td>-10.140000</td></tr><tr><td>25%</td><td>2.000000</td><td>1.000000</td><td>1.000000</td><td>-73.990921</td><td>40.738933</td><td>1.000000</td><td>-73.990410</td><td>40.738776</td><td>1.000000</td><td>6.500000</td><td>0.000000</td><td>0.500000</td><td>0.000000</td><td>0.000000</td><td>0.300000</td><td>8.300000</td></tr><tr><td>50%</td><td>2.000000</td><td>1.000000</td><td>1.670000</td><td>-73.980164</td><td>40.755428</td><td>1.000000</td><td>-73.978409</td><td>40.755249</td><td>1.000000</td><td>9.500000</td><td>0.000000</td><td>0.500000</td><td>1.360000</td><td>0.000000</td><td>0.300000</td><td>11.800000</td></tr><tr><td>75%</td><td>2.000000</td><td>2.000000</td><td>3.200000</td><td>-73.964142</td><td>40.769090</td><td>1.000000</td><td>-73.962097</td><td>40.768002</td><td>2.000000</td><td>15.000000</td><td>0.000000</td><td>0.500000</td><td>2.460000</td><td>0.000000</td><td>0.300000</td><td>18.300000</td></tr><tr><td>max</td><td>2.000000</td><td>6.000000</td><td>160.800000</td><td>0.000000</td><td>41.204548</td><td>6.000000</td><td>0.000000</td><td>42.666893</td><td>4.000000</td><td>819.500000</td><td>4.500000</td><td>0.500000</td><td>47.560000</td><td>22.040000</td><td>0.300000</td><td>832.800000</td></tr></tbody></table>
<pre><code class="language-python"># 80:20 train test split
train_data = data_sample.sample(n=40000, random_state=SEED)
test_data = data_sample.drop(train_data.index)
</code></pre>
<h3 id="model-training-1">Model Training</h3>
<pre><code class="language-python">predictor = TabularPredictor(label=&#x27;fare_amount&#x27;, path=MODEL_PATH)
</code></pre>
<pre><code class="language-python">predictor.fit(train_data)

# AutoGluon infers your prediction problem is: &#x27;regression&#x27; (because dtype of label-column == float and label-values can&#x27;t be converted to int).
# Label info (max, min, mean, stddev): (819.5, -7.0, 13.23572, 11.96267)

# AutoGluon training complete, total runtime = 89.72s ... Best model: &quot;WeightedEnsemble_L2&quot;
</code></pre>
<pre><code class="language-python">leaderboard=pd.DataFrame(predictor.leaderboard())

plt.figure(figsize=(8, 7))

sns.set(style=&#x27;darkgrid&#x27;)

sns.scatterplot(
    x=&#x27;pred_time_val&#x27;,
    y=&#x27;score_val&#x27;,
    data=leaderboard,
    s=300,
    alpha=0.5,
    hue=&#x27;model&#x27;,
    palette=&#x27;tab20&#x27;,
    style=&#x27;fit_time&#x27;
)

plt.title(&#x27;Prediction Time vs Accuracy Score&#x27;)
plt.xlabel(&#x27;Average Time for Predictions&#x27;)
plt.ylabel(&#x27;Validation Score (-RMSE)&#x27;)
plt.legend(bbox_to_anchor=(1.01,1.01))

plt.savefig(&#x27;assets/AutoML_with_AutoGluon_01.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="AutoML with AutoGluon for Tabular Data" src="/assets/images/AutoML_with_AutoGluon_Reg_01-d6285c4a73c3e9748d080319974d5bfc.webp" width="956" height="640"></p>
<h4 id="model-loading-1">Model Loading</h4>
<pre><code class="language-python"># load best model
predictor = TabularPredictor.load(&quot;model/&quot;)
</code></pre>
<h4 id="model-testing-model-testing">Model Testing Model Testing</h4>
<pre><code class="language-python">X_test = test_data.drop(columns=[&#x27;fare_amount&#x27;] )
y_test = test_data[&#x27;fare_amount&#x27;]
</code></pre>
<pre><code class="language-python">y_pred = predictor.predict(X_test)
</code></pre>
<pre><code class="language-python">eval_metrics = predictor.evaluate_predictions(y_true=y_test, y_pred=y_pred, auxiliary_metrics=True)
</code></pre>
<pre><code class="language-python">array = np.array(list(eval_metrics.items()))
df = pd.DataFrame(array, columns = [&#x27;metric&#x27;,&#x27;value&#x27;]).sort_values(by=&#x27;value&#x27;)

plt.figure(figsize=(15,5))
plt.bar(df[&#x27;metric&#x27;], df[&#x27;value&#x27;])
plt.title(&#x27;Evaluation Metrics&#x27;)

plt.savefig(&#x27;assets/AutoML_with_AutoGluon_02.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="AutoML with AutoGluon for Tabular Data" src="/assets/images/AutoML_with_AutoGluon_Reg_02-014f8ca30dec8de54d7ddfd5720a315b.webp" width="1370" height="456"></p>
<h4 id="feature-interpretability-1">Feature Interpretability</h4>
<pre><code class="language-python"># add test dataset that must include the classifier (fare_amount):
importance_df = predictor.feature_importance(test_data).reset_index()
</code></pre>
<pre><code class="language-python">plt.figure(figsize=(8,8))
plt.title(&#x27;Feature Importance&#x27;)
sns.set(style=&#x27;darkgrid&#x27;)
sns.barplot(
    data=importance_df,
    y=&#x27;index&#x27;,
    x=&#x27;importance&#x27;,
    orient=&#x27;horizontal&#x27;
).set_ylabel(&#x27;Feature&#x27;)

plt.savefig(&#x27;assets/AutoML_with_AutoGluon_03.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="AutoML with AutoGluon for Tabular Data" src="/assets/images/AutoML_with_AutoGluon_Reg_03-909f3c0f2a1725d865dc49b955a21499.webp" width="863" height="710"></p>
<h4 id="running-predictions-1">Running Predictions</h4>
<pre><code class="language-python">test_drive = {
  &quot;VendorID&quot;: 2,
  &quot;tpep_pickup_datetime&quot;: &quot;2016-03-01 01:12:39&quot;,
  &quot;tpep_dropoff_datetime&quot;: &quot;2016-03-01 01:16:48&quot;,
  &quot;passenger_count&quot;: 5,
  &quot;trip_distance&quot;: 1.28,
  &quot;pickup_longitude&quot;: -73.97952270507811,
  &quot;pickup_latitude&quot;: 40.76089096069336,
  &quot;RatecodeID&quot;: 1,
  &quot;store_and_fwd_flag&quot;: &quot;N&quot;,
  &quot;dropoff_longitude&quot;: -73.99040985107422,
  &quot;dropoff_latitude&quot;: 40.77185821533203,
  &quot;payment_type&quot;: 1,
  &quot;fare_amount&quot;: 5.5,
  &quot;extra&quot;: 0.5,
  &quot;mta_tax&quot;: 0.5,
  &quot;tip_amount&quot;: 0.0,
  &quot;tolls_amount&quot;: 0.0,
  &quot;improvement_surcharge&quot;: 0.3,
  &quot;total_amount&quot;: 6.8
}
</code></pre>
<pre><code class="language-python"># load booking into dataset
test_drive_df = TabularDataset.from_dict([test_drive])
test_drive_from_csv_df = TabularDataset(&#x27;dataset/test_data.csv&#x27;)
</code></pre>
<pre><code class="language-python">predictor.predict(test_drive_df)
# 0    6.403378
# Name: fare_amount, dtype: float32
</code></pre>
<pre><code class="language-python">predictor.predict(test_drive_from_csv_df)
# 0    20.392935
# Name: fare_amount, dtype: float32
</code></pre>
<h2 id="customizations">Customizations</h2>
<pre><code class="language-python">leaderboard_results = predictor.leaderboard(test_data)
</code></pre>
<pre><code class="language-python">results_df = leaderboard_results[[&#x27;model&#x27;, &#x27;score_test&#x27;, &#x27;score_val&#x27;, &#x27;pred_time_test&#x27;, &#x27;fit_time&#x27;]]
results_df
</code></pre>
<table><thead><tr><th></th><th>model</th><th>score_test</th><th>score_val</th><th>pred_time_test</th><th>fit_time</th></tr></thead><tbody><tr><td>0</td><td>ExtraTreesMSE</td><td>-3.424482</td><td>-2.967295</td><td>0.336113</td><td>4.152885</td></tr><tr><td>1</td><td>RandomForestMSE</td><td>-3.496445</td><td>-3.421289</td><td>0.635791</td><td>14.147954</td></tr><tr><td>2</td><td>LightGBMLarge</td><td>-3.711858</td><td>-3.338691</td><td>0.114917</td><td>1.717049</td></tr><tr><td>3</td><td>WeightedEnsemble_L2</td><td>-3.869480</td><td>-2.766400</td><td>0.870554</td><td>56.528128</td></tr><tr><td>4</td><td>CatBoost</td><td>-3.875734</td><td>-3.246665</td><td>0.012133</td><td>26.307805</td></tr><tr><td>5</td><td>XGBoost</td><td>-4.003582</td><td>-3.211102</td><td>0.026592</td><td>0.405672</td></tr><tr><td>6</td><td>LightGBM</td><td>-4.547570</td><td>-3.245028</td><td>0.013185</td><td>0.341916</td></tr><tr><td>7</td><td>NeuralNetFastAI</td><td>-4.767402</td><td>-3.300341</td><td>0.160983</td><td>25.395540</td></tr><tr><td>8</td><td>LightGBMXT</td><td>-5.297554</td><td>-3.430323</td><td>0.016557</td><td>0.359552</td></tr><tr><td>9</td><td>NeuralNetTorch</td><td>-7.383115</td><td>-5.649417</td><td>0.050529</td><td>10.426494</td></tr><tr><td>10</td><td>KNeighborsUnif</td><td>-7.793495</td><td>-6.159739</td><td>0.330812</td><td>0.019789</td></tr><tr><td>11</td><td>KNeighborsDist</td><td>-8.238958</td><td>-7.202982</td><td>0.276046</td><td>0.018064</td></tr></tbody></table>
<h3 id="inference-constraints">Inference Constraints</h3>
<p>The <code>WeightedEnsemble_L2</code> model - which is an ensemble of different models used by AutoGluon - has the highest test accuracy but also takes by far the longest to return predictions. The &#x27;non-ensembled&#x27; model <code>ExtraTreesMSE</code> is not that far off when it comes to accuracy but more than twice as fast with predictions. We can set a restraint how much time is acceptable to remove &#x27;slow&#x27; models from the created weighted ensemble model.</p>
<pre><code class="language-python">fast_predictor = TabularPredictor(label=&#x27;fare_amount&#x27;, path=&#x27;model_fast&#x27;)
fast_predictor.fit(train_data, time_limit=30, infer_limit=0.000004, infer_limit_batch_size=10000)

# Removing 5/6 base models to satisfy inference constraint (constraint=1.651μs) ...
# 	0.092ms	-&gt; 0.058ms	(KNeighborsUnif)
# 	0.058ms	-&gt; 0.022ms	(KNeighborsDist)
# 	0.022ms	-&gt; 3.321μs	(RandomForestMSE)
# 	3.321μs	-&gt; 1.871μs	(LightGBMXT)
# 	1.871μs	-&gt; 1.177μs	(CatBoost)
</code></pre>
<pre><code class="language-python">eval_metrics_fast = fast_predictor.fit_summary()
</code></pre>
<table><thead><tr><th></th><th>model</th><th>score_val</th><th>pred_time_val</th><th>fit_time</th><th>pred_time_val_marginal</th><th>fit_time_marginal</th><th>stack_level</th><th>can_infer</th><th>fit_order</th></tr></thead><tbody><tr><td>0</td><td>LightGBM</td><td>-3.245028</td><td>0.003834</td><td>0.588395</td><td>0.003834</td><td>0.588395</td><td>1</td><td>True</td><td>4</td></tr><tr><td>1</td><td>WeightedEnsemble_L2</td><td>-3.245028</td><td>0.004205</td><td>0.594806</td><td>0.000371</td><td>0.006411</td><td>2</td><td>True</td><td>7</td></tr><tr><td>2</td><td>CatBoost</td><td>-3.266919</td><td>0.003005</td><td>8.212242</td><td>0.003005</td><td>8.212242</td><td>1</td><td>True</td><td>6</td></tr><tr><td>3</td><td>RandomForestMSE</td><td>-3.421289</td><td>0.073429</td><td>15.412317</td><td>0.073429</td><td>15.412317</td><td>1</td><td>True</td><td>5</td></tr><tr><td>4</td><td>LightGBMXT</td><td>-3.430323</td><td>0.004597</td><td>0.667201</td><td>0.004597</td><td>0.667201</td><td>1</td><td>True</td><td>3</td></tr><tr><td>5</td><td>KNeighborsUnif</td><td>-6.159739</td><td>0.134967</td><td>0.365208</td><td>0.134967</td><td>0.365208</td><td>1</td><td>True</td><td>1</td></tr><tr><td>6</td><td>KNeighborsDist</td><td>-7.202982</td><td>0.120473</td><td>0.394391</td><td>0.120473</td><td>0.394391</td><td>1</td><td>True</td><td>2</td></tr></tbody></table>
<p>Number of models trained: 7
Types of models trained:</p>
<!-- -->CatBoostModel<!-- -->
<pre><code class="language-python">eval_metrics = predictor.fit_summary()
</code></pre>
<table><thead><tr><th></th><th>model</th><th>score_val</th><th>pred_time_val</th><th>fit_time</th><th>pred_time_val_marginal</th><th>fit_time_marginal</th><th>stack_level</th><th>can_infer</th><th>fit_order</th></tr></thead><tbody><tr><td>0</td><td>WeightedEnsemble_L2</td><td>-2.766400</td><td>0.244695</td><td>56.528128</td><td>0.000308</td><td>0.246437</td><td>2</td><td>True</td><td>12</td></tr><tr><td>1</td><td>ExtraTreesMSE</td><td>-2.967295</td><td>0.060220</td><td>4.152885</td><td>0.060220</td><td>4.152885</td><td>1</td><td>True</td><td>7</td></tr><tr><td>2</td><td>XGBoost</td><td>-3.211102</td><td>0.005235</td><td>0.405672</td><td>0.005235</td><td>0.405672</td><td>1</td><td>True</td><td>9</td></tr><tr><td>3</td><td>LightGBM</td><td>-3.245028</td><td>0.003292</td><td>0.341916</td><td>0.003292</td><td>0.341916</td><td>1</td><td>True</td><td>4</td></tr><tr><td>4</td><td>CatBoost</td><td>-3.246665</td><td>0.004185</td><td>26.307805</td><td>0.004185</td><td>26.307805</td><td>1</td><td>True</td><td>6</td></tr><tr><td>5</td><td>NeuralNetFastAI</td><td>-3.300341</td><td>0.031887</td><td>25.395540</td><td>0.031887</td><td>25.395540</td><td>1</td><td>True</td><td>8</td></tr><tr><td>6</td><td>LightGBMLarge</td><td>-3.338691</td><td>0.024750</td><td>1.717049</td><td>0.024750</td><td>1.717049</td><td>1</td><td>True</td><td>11</td></tr><tr><td>7</td><td>RandomForestMSE</td><td>-3.421289</td><td>0.059909</td><td>14.147954</td><td>0.059909</td><td>14.147954</td><td>1</td><td>True</td><td>5</td></tr><tr><td>8</td><td>LightGBMXT</td><td>-3.430323</td><td>0.003857</td><td>0.359552</td><td>0.003857</td><td>0.359552</td><td>1</td><td>True</td><td>3</td></tr><tr><td>9</td><td>NeuralNetTorch</td><td>-5.649417</td><td>0.020283</td><td>10.426494</td><td>0.020283</td><td>10.426494</td><td>1</td><td>True</td><td>10</td></tr><tr><td>10</td><td>KNeighborsUnif</td><td>-6.159739</td><td>0.142860</td><td>0.019789</td><td>0.142860</td><td>0.019789</td><td>1</td><td>True</td><td>1</td></tr><tr><td>11</td><td>KNeighborsDist</td><td>-7.202982</td><td>0.113172</td><td>0.018064</td><td>0.113172</td><td>0.018064</td><td>1</td><td>True</td><td>2</td></tr></tbody></table>
<p>Number of models trained: 12
Types of models trained:</p>
<!-- -->TabularNeuralNetTorchModel<!-- -->
<p>Result: <em>Much faster but less accurate</em></p>
<ul>
<li><strong>WeightedEnsemble_L2</strong>:<!-- -->
<ul>
<li>score_val: <code>-2.766400</code> -&gt; <code>-3.245028</code></li>
<li>pred_time_val: <code>0.244695s</code> -&gt; <code>0.004205s</code></li>
<li>fit_time: <code>56.528128s</code> -&gt; <code>0.594806s</code></li>
</ul>
</li>
</ul>
<h3 id="hyperparameter-tuning">Hyperparameter Tuning</h3>
<pre><code class="language-python">hyperparameters_NN_Torch = {&quot;num_epochs&quot;: 1, &quot;learning_rate&quot;: 0.5}
hyperparameters_XGB = {} # use XGBoost with default values
hyperparameters = {&quot;NN_TORCH&quot;: hyperparameters_NN_Torch, &quot;XGB&quot;: hyperparameters_XGB}
</code></pre>
<pre><code class="language-python">tuned_predictor = TabularPredictor(label=&#x27;fare_amount&#x27;, path=&#x27;model_tuned&#x27;)
tuned_predictor.fit(
        train_data=train_data,
        hyperparameters=hyperparameters
    )
</code></pre>
<pre><code class="language-python">tuned_predictor.fit_summary()
# AutoGluon only trained the two configured model for one epoch 
</code></pre>
<table><thead><tr><th></th><th>model</th><th>score_val</th><th>pred_time_val</th><th>fit_time</th><th>pred_time_val_marginal</th><th>fit_time_marginal</th><th>stack_level</th><th>can_infer</th><th>fit_order</th></tr></thead><tbody><tr><td>0</td><td>XGBoost</td><td>-3.211102</td><td>0.003993</td><td>0.363999</td><td>0.003993</td><td>0.363999</td><td>1</td><td>True</td><td>1</td></tr><tr><td>1</td><td>WeightedEnsemble_L2</td><td>-3.211102</td><td>0.004304</td><td>0.434471</td><td>0.000311</td><td>0.070472</td><td>2</td><td>True</td><td>3</td></tr><tr><td>2</td><td>NeuralNetTorch</td><td>-23.769987</td><td>0.019870</td><td>0.935391</td><td>0.019870</td><td>0.935391</td><td>1</td><td>True</td><td>2</td></tr></tbody></table>
<h3 id="autogluon-presets">AutoGluon Presets</h3>
<blockquote>
<p>Available Presets: [<code>best_quality</code>, <code>high_quality</code>, <code>good_quality</code>, <code>medium_quality</code>, <code>optimize_for_deployment</code>, <code>interpretable</code>, <code>ignore_text</code>]</p>
</blockquote>
<pre><code class="language-python">presets = [&#x27;medium_quality&#x27;] # accept lower accuracy for speed
</code></pre>
<pre><code class="language-python">preset_predictor = TabularPredictor(label=&#x27;fare_amount&#x27;, path=&#x27;preset_model&#x27;)
preset_predictor.fit(
        train_data=train_data,
        presets=presets,
        included_model_types=[&#x27;GBM&#x27;, &#x27;FASTAI&#x27;, &#x27;NN_TORCH&#x27;], # only use those models
        # excluded_model_types=[&#x27;KNN&#x27;, &#x27;NN&#x27;, &#x27;XT&#x27;, &#x27;RF&#x27;, &#x27;FASTAI&#x27;] # use all but those models
    )
</code></pre>
<pre><code class="language-python">preset_predictor.fit_summary()
</code></pre>
<table><thead><tr><th></th><th>model</th><th>score_val</th><th>pred_time_val</th><th>fit_time</th><th>pred_time_val_marginal</th><th>fit_time_marginal</th><th>stack_level</th><th>can_infer</th><th>fit_order</th></tr></thead><tbody><tr><td>0</td><td>WeightedEnsemble_L2</td><td>-3.054243</td><td>0.083915</td><td>42.906133</td><td>0.000301</td><td>0.133571</td><td>2</td><td>True</td><td>6</td></tr><tr><td>1</td><td>LightGBM</td><td>-3.245028</td><td>0.003262</td><td>0.507183</td><td>0.003262</td><td>0.507183</td><td>1</td><td>True</td><td>2</td></tr><tr><td>2</td><td>NeuralNetFastAI</td><td>-3.300341</td><td>0.027946</td><td>26.112154</td><td>0.027946</td><td>26.112154</td><td>1</td><td>True</td><td>3</td></tr><tr><td>3</td><td>LightGBMLarge</td><td>-3.338691</td><td>0.026010</td><td>1.953629</td><td>0.026010</td><td>1.953629</td><td>1</td><td>True</td><td>5</td></tr><tr><td>4</td><td>LightGBMXT</td><td>-3.430323</td><td>0.004276</td><td>0.458992</td><td>0.004276</td><td>0.458992</td><td>1</td><td>True</td><td>1</td></tr><tr><td>5</td><td>NeuralNetTorch</td><td>-5.649417</td><td>0.022120</td><td>13.740605</td><td>0.022120</td><td>13.740605</td><td>1</td><td>True</td><td>4</td></tr></tbody></table>
<h2 id="model-deployment">Model Deployment</h2>
<pre><code class="language-python">predictor = TabularPredictor.load(&quot;model/&quot;)
</code></pre>
<pre><code class="language-python"># retain model on train + validation dataset
predictor.refit_full()
</code></pre>
<pre><code class="language-python"># strip all models not part of the `WeightedEnsemble_L2_FULL`
predictor.clone_for_deployment(&#x27;production_model&#x27;)
# Clone: Keeping minimum set of models required to predict with best model &#x27;WeightedEnsemble_L2_FULL&#x27;...
# To load the cloned predictor: predictor_clone = TabularPredictor.load(path=&quot;production_model&quot;)
</code></pre>
<pre><code class="language-python">predictor_clone = TabularPredictor.load(path=&quot;production_model&quot;)
</code></pre>
<pre><code class="language-python">test_data = TabularDataset(&#x27;dataset/test_data.csv&#x27;)
predictor_clone.predict(test_data)

# 0    20.425285
# Name: fare_amount, dtype: float32
</code></pre></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/python">Python</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/machine-learning">Machine Learning</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/auto-gluon">AutoGluon</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/cheating">Cheating</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/AIOps/2023-06-18-automl-with-autogluon-tabular-data/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/IoT-and-Machine-Learning/AIOps/2023-06-21-automl-with-autogluon-multiclass-nlp/2023-06-21"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">AutoML with AutoGluon for Multi-Modal Data NLP</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/IoT-and-Machine-Learning/AIOps/2023-06-17-scikit-learn-model-deployment/2023-06-17"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Serving your SciKit Learn Model as a Prediction API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installation" class="table-of-contents__link toc-highlight">Installation</a></li><li><a href="#tabular-data-classification" class="table-of-contents__link toc-highlight">Tabular Data Classification</a><ul><li><a href="#classification-model" class="table-of-contents__link toc-highlight">Classification Model</a></li></ul></li><li><a href="#tabular-data-regression" class="table-of-contents__link toc-highlight">Tabular Data Regression</a><ul><li><a href="#data-preprocessing-1" class="table-of-contents__link toc-highlight">Data Preprocessing</a></li><li><a href="#model-training-1" class="table-of-contents__link toc-highlight">Model Training</a></li></ul></li><li><a href="#customizations" class="table-of-contents__link toc-highlight">Customizations</a><ul><li><a href="#inference-constraints" class="table-of-contents__link toc-highlight">Inference Constraints</a></li><li><a href="#hyperparameter-tuning" class="table-of-contents__link toc-highlight">Hyperparameter Tuning</a></li><li><a href="#autogluon-presets" class="table-of-contents__link toc-highlight">AutoGluon Presets</a></li></ul></li><li><a href="#model-deployment" class="table-of-contents__link toc-highlight">Model Deployment</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
</body>
</html>