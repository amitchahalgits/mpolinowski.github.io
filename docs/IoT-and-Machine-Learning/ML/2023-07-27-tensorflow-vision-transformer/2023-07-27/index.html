<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-IoT-and-Machine-Learning/ML/2023-07-27-tensorflow-vision-transformer/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Tensorflow VITs | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2023-07-27-tensorflow-vision-transformer/2023-07-27"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tensorflow VITs | Mike Polinowski"><meta data-rh="true" name="description" content="ViT models apply the Transformer architecture with self-attention to sequences of image patches, without using convolution layers."><meta data-rh="true" property="og:description" content="ViT models apply the Transformer architecture with self-attention to sequences of image patches, without using convolution layers."><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2023-07-27-tensorflow-vision-transformer/2023-07-27"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2023-07-27-tensorflow-vision-transformer/2023-07-27" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2023-07-27-tensorflow-vision-transformer/2023-07-27" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.08c8c484.css">
<script src="/assets/js/runtime~main.afcb95e1.js" defer="defer"></script>
<script src="/assets/js/main.fb0a52c3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/development">Development</a><button aria-label="Expand sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/devops">DevOps</a><button aria-label="Expand sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/machine-learning-ai-and-computer-vision">Machine Learning, AI and Computer Vision</a><button aria-label="Collapse sidebar category &#x27;Machine Learning, AI and Computer Vision&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/machine-learning">Machine Learning</a><button aria-label="Collapse sidebar category &#x27;Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-10-01--delib-face-detection/2023-10-01">DLIB Face Recognition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-23--yolo8-listen/2023-09-23">Audio Classification with Computer Vision</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-21--cvat-automatic-annotation/2023-09-21">CVAT Semi-automatic and Automatic Annotation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-19--cvat-computer-vision-annotation-tool/2023-09-19">Computer Vision Annotation Tool (CVAT) Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-17--yolo8-nightshift/2023-09-17">YOLOv8 Nightshift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-15--yolo8-tracking-and-ocr/2023-09-15">YOLOv8 License Plate Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-10--model-explainability-shap/2023-09-11">Scikit-Learn ML Model Explainability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-05--semantic-segmentation-in-opencv/2023-09-05">Using Tensorflow Models in OpenCV</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-01--yolo-i-know-flowers/2023-09-01">YOLOv8 Image Classifier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-31--semantic_segmentation_detectron2_openimages_dataset/2023-08-31">Detectron Object Detection with OpenImages Dataset (WIP)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-30--instance_segmentation_detectron2_model_zoo_mask_rcnn/2023-08-30">Instance Segmentation with PyTorch (Mask RCNN)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-29--semantic-segmentation-detectron2-model-zoo-faster-rcnn/2023-08-29">Image Segmentation with PyTorch (Faster RCNN)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-28--semantic-segmentation-detectron2-model-zoo/2023-08-28">Image Segmentation with PyTorch (RCNN)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-27--image-segmentation-with-pytorch/2023-08-27">Image Segmentation with PyTorch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-21--pytorch-development-in-docker/2023-08-21">Containerized PyTorch Dev Workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-13-tensorflow-i-know-flowers-model-eval/2023-08-13">Tensorflow Image Classifier - Model Evaluation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-12-tensorflow-i-know-flowers-xception/2023-08-12">Tensorflow Image Classifier - Xception</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-11-tensorflow-i-know-flowers-vit/2023-08-11">Tensorflow Image Classifier - ViT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-10-tensorflow-i-know-flowers-nasnetmobile/2023-08-10">Tensorflow Image Classifier - NASNetMobile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-09-tensorflow-i-know-flowers-mobilenetv3small/2023-08-09">Tensorflow Image Classifier - MobileNetV3Small</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-08-tensorflow-i-know-flowers-mobilenetv3large/2023-08-08">Tensorflow Image Classifier - MobileNetV3Large</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-07-tensorflow-i-know-flowers-mobilenetv2/2023-08-07">Tensorflow Image Classifier - MobileNetV2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-06-tensorflow-i-know-flowers-inceptionv3/2023-08-06">Tensorflow Image Classifier - InceptionV3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-05-tensorflow-i-know-flowers-efficientnetv2s/2023-08-05">Tensorflow Image Classifier - EfficientNetV2S</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-04-tensorflow-i-know-flowers-efficientnetv2b0/2023-08-04">Tensorflow Image Classifier - EfficientNetV2B0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-03-tensorflow-i-know-flowers-deit/2023-08-03">Tensorflow Image Classifier - Data-efficient Image Transformers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-02-tensorflow-i-know-flowers-preprocessing/2023-08-02">Tensorflow Image Classifier - Data Pre-processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-01-tensorflow-i-know-flowers-intro/2023-08-01">Tensorflow Image Classifier - Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-07-27-tensorflow-vision-transformer/2023-07-27">Tensorflow VITs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-07-26-tensorflow-human-emotion-detector/2023-07-26">Human Emotion Detection with Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-07-25-onnx-models/2023-07-25">Working with ONNX Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-07-21-introduction-to-pytorch-caffe2/2023-07-21">Introduction to Caffe2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/2023-07-02">SQL in Data Science - Machine Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-06-30-sql-in-data-science-advanced/2023-06-30">SQL in Data Science - Slightly more Advanced Queries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-06-27-sql-in-data-science-basics/2023-06-27">SQL in Data Science - The Basics using Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-06-26-autogluon-transit-photometry-dataset/2023-06-26">Detection of Exoplanets using Transit Photometry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-19-tensorflow-natural-language-processing/2023-04-19">(Re) Introduction to Tensorflow Natural Language Processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-16-deep-3d-image-segmentation/2023-04-16">3D Image Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-14-manifold-learning-for-image-segmentation/2023-04-14">Dimensionality Reduction for Image Segmentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-13-fisher-discriminant-analysis/2023-04-13">Fisher Linear Discriminant Analysis (LDA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-13-isometric-mapping/2023-04-13">Isometric Mapping (ISOMAP)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-13-multi-dimensional-scaling/2023-04-13">Multidimensional Scaling (MDS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-12-tstochastic-neighbor-embedding/2023-04-12">tStochastic Neighbor Embedding (t-SNE)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-11-locally-linear-embedding/2023-04-11">Locally Linear Embedding (LLE)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-09-principal-component-analysis/2023-04-09">Principal Component Analysis (PCA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-26-tensorflow-unsupervised-learning-generative-adversial-networks/2023-03-26">Tensorflow 2 - Unsupervised Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-26-tensorflow-unsupervised-learning-autoencoders-super-resolution/2023-03-26">Tensorflow 2 - Unsupervised Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-24-tensorflow-unsupervised-learning-autoencoders/2023-03-24">Tensorflow 2 - Unsupervised Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-16-tensorflow-transfer-learning-scaling/2023-03-16">Tensorflow 2 - Transfer Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-11-tensorflow-transfer-learning-fine-tuning/2023-03-11">Tensorflow 2 - Transfer Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-06-tensorflow-transfer-learning-feature-extraction/2023-03-06">Tensorflow 2 - Transfer Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-05-tensorflow-convolutional-neural-network-multiclass-classifications/2023-03-05">Tensorflow 2 - Convolutional Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-03-tensorflow-convolutional-neural-network-binary-classifications/2023-03-03">Tensorflow 2 - Convolutional Neural Networks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-02-tensorflow-neural-network-multi-classification/2023-03-02">Tensorflow 2 - Neural Network Classifications</a><button aria-label="Expand sidebar category &#x27;Tensorflow 2 - Neural Network Classifications&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-28-tensorflow-neural-network-classification-model-evaluation/2023-02-28">Tensorflow 2 - Neural Network Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-27-tensorflow-neural-network-classification/2023-02-27">Tensorflow 2 - Neural Network Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-26-tensorflow-neural-network-regression-data-preprocessing/2023-02-26">Tensorflow 2 - Neural Network Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-26-tensorflow-neural-network-regression-real-dataset/2023-02-26">Tensorflow 2 - Neural Network Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-25-tensorflow-neural-network-regression-experiments/2023-02-25">Tensorflow 2 - Neural Network Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-24-tensorflow-neural-network-regression-evaluation/2023-02-24">Tensorflow 2 - Neural Network Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-23-tensorflow-neural-network-regression/2023-02-23">Tensorflow 2 - Neural Network Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-22-tensorflow-tensors-3/2023-02-22">Tensorflow 2 - An (Re)Introduction 2023 (3)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-21-tensorflow-tensors-2/2023-02-21">Tensorflow 2 - An (Re)Introduction 2023 (2)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-19-tensorflow-introduction/2023-02-19">Tensorflow 2 - An (Re)Introduction 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-18-keras-introduction-vgg16/2023-02-18">Keras for Tensorflow - VGG16 Network Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-18-keras-introduction-rnn/2023-02-18">Keras for Tensorflow - Recurrent Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-17-keras-introduction-cnn/2023-02-17">Keras for Tensorflow - Convolutional Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-16-keras-introduction-ann/2023-02-16">Keras for Tensorflow - Artificial Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-15-as-one-yolo-object-tracking/2023-02-15">YOLOv8 with AS-One</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-14-keras-introduction/2023-02-14">Keras for Tensorflow - An (Re)Introduction 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-30-predicting-wine-quality/2023-01-30">SciKit Wine Quality</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-28-opencv-coin-counter/2023-01-28">OpenCV Count My Money</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-14-yolov7_to_tensorflow/2023-01-14">YOLOv7 to Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-13-yolov7_data_conversion/2023-01-13">YOLOv7 Label Conversion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-10-yolov7_custom_data/2023-01-10">YOLOv7 Training with Custom Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-08-depth-vision-midas/2023-01-08">MiDaS Depth Vision</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-05-yolov7/2023-01-05">YOLOv7 Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-31-tf-rnn-text-generation/2022-12-31">Recurrent Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-28-tf-gan-image-generator/2022-12-28">Deep Convolutional Generative Adversarial Network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-21-tf-downsampling/2022-12-21">Tensorflow Downsampling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-21-tf-deepdream/2022-12-21">Tensorflow Deep Dream</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-20-tf-representation/2022-12-19">Tensorflow Representation Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-19-tf-hub/2022-12-19">Tensorflow Hub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-18-tf-transfer-learning/2022-12-18">Tensorflow Transfer Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-16-tf-cifar/2022-12-16">Tensorflow Image Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-12-tf-breast-cancer-classification-part6/2022-12-12">Breast Histopathology Image Segmentation Part 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-12-tf-breast-cancer-classification-part5/2022-12-12">Breast Histopathology Image Segmentation Part 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part4/2022-12-11">Breast Histopathology Image Segmentation Part 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part3/2022-12-11">Breast Histopathology Image Segmentation Part 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part2/2022-12-11">Breast Histopathology Image Segmentation Part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-10-tf-breast-cancer-classification-part1/2022-12-10">Breast Histopathology Image Segmentation Part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-11-27-containerized-deep-learning/2022-11-27">Deep Docker on Arch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-04-pytorch-face-restoration/2022-04-04">Face Restoration with GFPGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-03-pytorch-real-super-resolution/2022-04-03">Super Resolution with Real-ESRGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-02-pytorch-super-resolution/2022-04-02">Super Resolution with ESRGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-01-tensorflow-audio-classifier/2022-04-01">Deep Audio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-20--yolo-app-yolov5-data-prep/2022-02-20">Yolo App - YOLOv5 Data Preparation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-19--yolo-app-flask/2022-02-19">Yolo App - Flask Web Application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-18--yolo-app-ocr/2022-02-18">Yolo App - Tesseract Optical Character Recognition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-17--yolo-app-prediction-pipeline/2022-02-17">Yolo App - Pipeline Predictions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-16--yolo-app-tensorflow-model/2022-02-16">Yolo App - Train a Model with Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-15--yolo-app-get-data/2022-02-15">Yolo App - Data Collection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-10--opencv-optical-flow-tracking/2021-12-10">OpenCV Optical Flow Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-09--opencv-camshift-tracking/2021-12-09">OpenCV CAMshift Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-08--opencv-meanshift-tracking/2021-12-08">OpenCV Meanshift Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-07--opencv-detection-and-tracking/2021-12-07">OpenCV Object Detection and Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-06--opencv-object-tracking/2021-12-06">OpenCV Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-05--opencv-face-detection/2021-12-05">OpenCV Face Detection and Privacy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-04--opencv-image-objects/2021-12-04">OpenCV Image Objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-03--opencv-image-operations/2021-12-03">OpenCV Image Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-02--opencv-with-videos/2021-12-02">OpenCV, Streams and Video Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-01--opencv-with-images/2021-12-01">OpenCV and Images</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-15--facebook-prophet-introduction/2021-11-15">Introduction into FB Prophet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-14--tensorflow-model-for-tfjs/2021-11-14">Tensorflow.js React App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-13--tensorflow-model-zoo/2021-11-13">Tensorflow2 Model Zoo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-12--tensorflow-crash-course-part-v/2021-11-12">Tensorflow2 Crash Course - Part V</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-11--tensorflow-crash-course-part-iv/2021-11-11">Tensorflow2 Crash Course - Part IV</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-10--tensorflow-crash-course-part-iii/2021-11-10">Tensorflow2 Crash Course - Part III</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-09--tensorflow-crash-course-part-ii/2021-11-09">Tensorflow2 Crash Course - Part II</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/2021-11-08">Tensorflow Crash Course - Part I</a><button aria-label="Expand sidebar category &#x27;Tensorflow Crash Course - Part I&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-07--opencv-crash-course-part-ii/2021-11-07">OpenCV Crash Course Part II</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-06--opencv-crash-course-part-i/2021-11-06">OpenCV Crash Course Part I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-05--license-plates-yolov4-opencv-tesseract/2021-11-05">License Plate Recognition with YOLOv4, OpenCV and Tesseract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-04--installing-yolov4/2021-11-04">Installing YOLOv4 with Anaconda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-03--streamlit-opencv-mediapipe/2021-11-03">Streamlit user interface for openCV/Mediapipe face mesh app</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-02--spacy_ner_predictions/2021-11-02">spaCy NER Predictions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-01--spacy_natural_language_processing/2021-11-01">spaCy NER on Arch Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2019-04-01--introduction-to-keras/2019-04-01">Introduction to Keras</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-10-31--tesseract_ocr_arch_linux/2021-10-31">Tesseract OCR on Arch Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2019-03-31--introduction-to-tensorflow-2-beta/2019-03-31">Introduction to TensorFlow 2 Beta</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2018-01-02--machine-learning-with-python/2018-01-02">Machine Learning with SciKit Learn</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/aiops">AIOps</a><button aria-label="Expand sidebar category &#x27;AIOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/automation-deep-vision-and-robotics">Automation, Deep Vision and Robotics</a><button aria-label="Expand sidebar category &#x27;Automation, Deep Vision and Robotics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/machine-learning-ai-and-computer-vision"><span itemprop="name">Machine Learning, AI and Computer Vision</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/machine-learning"><span itemprop="name">Machine Learning</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Tensorflow VITs</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p><img alt="TST, Hong Kong" src="/assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-19827635eae5b5cb12f68c531f406341.jpg" width="1500" height="549"></p>
<h1 id="building-a-tensorflow-vision-transformer">Building a Tensorflow Vision Transformer</h1>
<blockquote>
<p><a href="https://arxiv.org/abs/2010.11929">An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale</a>: While the Transformer architecture has become the de-facto standard for natural language processing tasks, its applications to computer vision remain limited. In vision, attention is either applied in conjunction with convolutional networks, or used to replace certain components of convolutional networks while keeping their overall structure in place. We show that this reliance on CNNs is not necessary and a pure transformer applied directly to sequences of image patches can perform very well on image classification tasks. When pre-trained on large amounts of data and transferred to multiple mid-sized or small image recognition benchmarks (ImageNet, CIFAR-100, VTAB, etc.), Vision Transformer (ViT) attains excellent results compared to state-of-the-art convolutional networks while requiring substantially fewer computational resources to train.</p>
</blockquote>
<ul>
<li><a href="#building-a-tensorflow-vision-transformer">Building a Tensorflow Vision Transformer</a>
<ul>
<li><a href="#dataset">Dataset</a></li>
<li><a href="#data-preprocessing-extracting-patches">Data Preprocessing (Extracting Patches)</a></li>
<li><a href="#build-the-transformer-encoder">Build the Transformer Encoder</a></li>
<li><a href="#build-the-vit-model">Build the ViT Model</a></li>
<li><a href="#model-training">Model Training</a></li>
<li><a href="#vision-transformer-vit-base-patch16-224-in21k">Vision Transformer (vit-base-patch16-224-in21k)</a>
<ul>
<li><a href="#dataset-1">Dataset</a></li>
<li><a href="#vit-model">ViT Model</a></li>
<li><a href="#model-training-1">Model Training</a></li>
</ul>
</li>
<li><a href="#vision-transformer-deit">Vision Transformer (DeiT)</a>
<ul>
<li><a href="#dataset-2">Dataset</a></li>
<li><a href="#deit-model">DeiT Model</a></li>
<li><a href="#model-training-2">Model Training</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a href="https://github.com/mpolinowski/tf-i-know-flowers">Github Repository</a></p>
<blockquote>
<p><a href="https://arxiv.org/pdf/2010.11929.pdf">AN IMAGE IS WORTH 16X16 WORDS: TRANSFORMERS FOR IMAGE RECOGNITION AT SCALE</a></p>
</blockquote>
<br>
<p><em>&quot;Inspired by the Transformer scaling successes in NLP, we experiment with applying a standard Transformer directly to images, with the fewest possible modifications. To do so, we split an image into patches and provide the sequence of linear embeddings of these patches as an input to a Trans former. Image patches are treated the same way as tokens (words) in an NLP application. We train the model on image classification in supervised fashion.&quot;</em></p>
<br>
<p>Vision Transformers perform very poorly on small training datasets (smaller a couple of million images). So this ViT is not going to outperform the CNN from earlier. The next step - after this proof-of-concept is to use transfer-learning to build on a ViT that has already been trained on a huge dataset.</p>
<pre><code class="language-python">import cv2 as cv
import matplotlib.pyplot as plt
import numpy as np
from sklearn.metrics import (
    classification_report,
    confusion_matrix,
    ConfusionMatrixDisplay)
import tensorflow as tf
from tensorflow.keras import Sequential
from tensorflow.keras.layers import (
    Conv2D,
    BatchNormalization,
    LayerNormalization,
    Dense,
    Embedding,
    MultiHeadAttention,
    Layer,
    Add,
    Flatten,
    RandomFlip,
    RandomRotation,
    RandomContrast,
    RandomBrightness
)
from tensorflow.keras.losses import CategoricalCrossentropy
from tensorflow.keras.metrics import CategoricalAccuracy, TopKCategoricalAccuracy
from tensorflow.keras.models import Model
from tensorflow.keras.optimizers import Adam
from tensorflow.keras.utils import image_dataset_from_directory
</code></pre>
<pre><code class="language-python">SEED = 42
BATCH_SIZE = 32
SIZE = 256
LABELS = [&#x27;angry&#x27;, &#x27;happy&#x27;, &#x27;sad&#x27;]
NLABELS = len(LABELS)
EPOCHS = 20
LR = 0.001
IN_SIZE = 256
PATCH_SIZE = 16
NPATCHES = 256
NHEADS = 4 #8
NLAYERS = 2 #4
HIDDEN_SIZE = 768
DENSE_UNITS = 128 #1024
</code></pre>
<h2 id="dataset">Dataset</h2>
<pre><code class="language-python">train_directory = &#x27;./dataset/Emotions Dataset/Emotions Dataset/train&#x27;
test_directory = &#x27;./dataset/Emotions Dataset/Emotions Dataset/test&#x27;
</code></pre>
<pre><code class="language-python">train_dataset = image_dataset_from_directory(
    train_directory,
    labels=&#x27;inferred&#x27;,
    label_mode=&#x27;categorical&#x27;,
    class_names=LABELS,
    color_mode=&#x27;rgb&#x27;,
    batch_size=BATCH_SIZE,
    image_size=(SIZE, SIZE),
    shuffle=True,
    seed=SEED,
    interpolation=&#x27;bilinear&#x27;,
    follow_links=False,
    crop_to_aspect_ratio=False
)

# Found 6799 images belonging to 3 classes.
</code></pre>
<pre><code class="language-python">test_dataset = image_dataset_from_directory(
    test_directory,
    labels=&#x27;inferred&#x27;,
    label_mode=&#x27;categorical&#x27;,
    class_names=LABELS,
    color_mode=&#x27;rgb&#x27;,
    batch_size=BATCH_SIZE,
    image_size=(SIZE, SIZE),
    shuffle=True,
    seed=SEED
)

# Found 2278 images belonging to 3 classes.
</code></pre>
<pre><code class="language-python">data_augmentation = Sequential([
    RandomRotation(factor = (0.25),),
    RandomFlip(mode=&#x27;horizontal&#x27;,),
    RandomContrast(factor=0.1),
    RandomBrightness(0.1)
])
</code></pre>
<pre><code class="language-python">training_dataset = (
    train_dataset
    .map(lambda image, label: (data_augmentation(image), label))
    .prefetch(tf.data.AUTOTUNE)
)


testing_dataset = (
    test_dataset.prefetch(
        tf.data.AUTOTUNE
    )
)
</code></pre>
<h2 id="data-preprocessing-extracting-patches">Data Preprocessing (Extracting Patches)</h2>
<pre><code class="language-python">test_image = cv.cvtColor(cv.imread(&#x27;dataset/angry.jpg&#x27;), cv.COLOR_BGR2RGB)
test_image = cv.resize(test_image, (IN_SIZE, IN_SIZE))
</code></pre>
<pre><code class="language-python">patches = tf.image.extract_patches(
    images = tf.expand_dims(test_image, axis=0),
    sizes = [1, PATCH_SIZE, PATCH_SIZE, 1],
    strides = [1, PATCH_SIZE, PATCH_SIZE, 1],
    rates = [1, 1, 1, 1],
    padding = &#x27;VALID&#x27;
)
</code></pre>
<pre><code class="language-python">patches.shape
# TensorShape([1, 16, 16, 768])
# 1 image with 3 times (RGB) 16x16 patches =&gt; 3x16x16=786
</code></pre>
<pre><code class="language-python">patches = tf.reshape(patches, (patches.shape[0], 256, 768))
patches.shape
# TensorShape([1, 256, 768])
</code></pre>
<pre><code class="language-python">plt.figure(figsize=(8,8))

for i in range(patches.shape[1]):
    ax = plt.subplot(16,16, i+1)
    plt.imshow(tf.reshape(patches[0,i,:], (16,16,3)))
    plt.axis(&#x27;off&#x27;)
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="/assets/images/tf_Emotion_Detection_27-b3fc4637289c769e85e6d176ba73bbb4.webp" width="639" height="635"></p>
<pre><code class="language-python">class PatchEncoder(Layer):
    def __init__ (self, NPATCHES, HIDDEN_SIZE):
        super(PatchEncoder, self).__init__(name = &#x27;patch_encoder&#x27;) 
        
        self.linear_projection = Dense(HIDDEN_SIZE, name = &#x27;linear_projection&#x27;)       
        self.positional_embedding = Embedding(NPATCHES, HIDDEN_SIZE, name = &#x27;positional_embedding&#x27;)
        self.NPATCHES = NPATCHES
        
    def call(self, x):
        patches = tf.image.extract_patches(
            images = x,
            sizes = [1, PATCH_SIZE, PATCH_SIZE, 1],
            strides = [1, PATCH_SIZE, PATCH_SIZE, 1],
            rates = [1, 1, 1, 1],
            padding = &#x27;VALID&#x27;
        )
        
        patches = tf.reshape(patches, (tf.shape(patches)[0], -1, patches.shape[-1]))
        embedding_input = tf.range(start=0, limit=NPATCHES, delta=1)
        output = self.linear_projection(patches) + self.positional_embedding(embedding_input)
        
        return output
</code></pre>
<pre><code class="language-python"># test patch encoder
patch_enc = PatchEncoder(NPATCHES, HIDDEN_SIZE)
patch_enc(tf.zeros([32, 256, 256, 3]))
# &lt;tf.Tensor: shape=(32, 256, 768), dtype=float32
</code></pre>
<h2 id="build-the-transformer-encoder">Build the Transformer Encoder</h2>
<pre><code class="language-python">class TransformerEncoder(Layer):
    def __init__ (self, NHEADS, HIDDEN_SIZE):
        super(TransformerEncoder, self).__init__(name = &#x27;transformer_encoder&#x27;) 
        
        self.layer_norm_1 = LayerNormalization(name = &#x27;layer_normalization_1&#x27;)       
        self.layer_norm_2 = LayerNormalization(name = &#x27;layer_normalization_2&#x27;)
        
        self.multi_head_attention = MultiHeadAttention(
            num_heads = NHEADS,
            key_dim = HIDDEN_SIZE
        )
        
        self.dense_1 = Dense(HIDDEN_SIZE, activation=&#x27;gelu&#x27;)
        self.dense_2 = Dense(HIDDEN_SIZE, activation=&#x27;gelu&#x27;) #tf.nn.gelu
        
    def call(self, input):
        x_1 = self.layer_norm_1(input)
        x_1 = self.multi_head_attention(x_1, x_1)
        
        x_1 = Add()([x_1, input])
        
        x_2 = self.layer_norm_2(x_1)
        x_2 = self.dense_1(x_2)
        
        output = self.dense_2(x_2)
        output = Add()([output, x_2])
        
        return output
</code></pre>
<pre><code class="language-python"># test the transformer
trans_enc = TransformerEncoder(NHEADS, HIDDEN_SIZE)
trans_enc(tf.zeros([1, 256, 768]))
# &lt;tf.Tensor: shape=(1, 256, 768), dtype=float32
</code></pre>
<h2 id="build-the-vit-model">Build the ViT Model</h2>
<pre><code class="language-python">class ViT(Model):
    def __init__(self, NHEADS, HIDDEN_SIZE, NPATCHES, NLAYERS, NLABELS, DENSE_UNITS):
        super(ViT, self).__init__(name=&#x27;vision_transformer&#x27;)
        
        self.NLAYERS = NLAYERS
        self.patch_encoder = PatchEncoder(NPATCHES, HIDDEN_SIZE)
        self.trans_encs = [TransformerEncoder(NHEADS, HIDDEN_SIZE) for _ in range(NLAYERS)]
        self.dense_1 = Dense(DENSE_UNITS, activation=&#x27;gelu&#x27;)
        self.dense_2 = Dense(DENSE_UNITS, activation=&#x27;gelu&#x27;)
        self.dense_3 = Dense(NLABELS, activation=&#x27;softmax&#x27;)
        
    def call(self, input, training=True):
        x = self.patch_encoder(input)
        
        for i in range(self.NLAYERS):
            x = self.trans_encs[i](x)
            
        x = Flatten()(x)
        x = self.dense_1(x)
        x = self.dense_2(x)
        
        return self.dense_3(x)
</code></pre>
<pre><code class="language-python">vit = ViT(NHEADS, HIDDEN_SIZE, NPATCHES, NLAYERS, NLABELS, DENSE_UNITS)
</code></pre>
<pre><code class="language-python"># test the model
vit(tf.zeros([32,256,256,3]))
# &lt;tf.Tensor: shape=(32, 3), dtype=float32
</code></pre>
<pre><code class="language-python">vit.summary()
</code></pre>
<h2 id="model-training">Model Training</h2>
<pre><code class="language-python">loss_function = CategoricalCrossentropy()
</code></pre>
<pre><code class="language-python">metrics = [CategoricalAccuracy(name=&#x27;accuracy&#x27;), TopKCategoricalAccuracy(k=2, name=&#x27;topk_accuracy&#x27;)]
</code></pre>
<pre><code class="language-python">vit.compile(
    optimizer = Adam(learning_rate = LR),
    loss = loss_function,
    metrics = metrics
)
</code></pre>
<pre><code class="language-python">vit_history = vit.fit(
    training_dataset,
    validation_data = testing_dataset,
    epochs = EPOCHS,
    verbose = 1
)

# loss: 0.9974
# accuracy: 0.5126
# topk_accuracy: 0.8128
# val_loss: 0.9803
# val_accuracy: 0.5443
# val_topk_accuracy: 0.8090
</code></pre>
<pre><code class="language-python">vit.evaluate(testing_dataset)
# loss: 0.9803 - accuracy: 0.5443 - topk_accuracy: 0.8090
</code></pre>
<pre><code class="language-python">plt.plot(vit_history.history[&#x27;loss&#x27;])
plt.plot(vit_history.history[&#x27;val_loss&#x27;])
plt.title(&#x27;Model Loss&#x27;)
plt.ylabel(&#x27;loss&#x27;)
plt.xlabel(&#x27;epoch&#x27;)
plt.legend([&#x27;train_loss&#x27;, &#x27;val_loss&#x27;])
plt.show()
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="/assets/images/tf_Emotion_Detection_28-f663768d5da8016ad5baa1e29d20c673.webp" width="567" height="455"></p>
<pre><code class="language-python">plt.plot(vit_history.history[&#x27;accuracy&#x27;])
plt.plot(vit_history.history[&#x27;val_accuracy&#x27;])
plt.title(&#x27;Model Accuracy&#x27;)
plt.ylabel(&#x27;accuracy&#x27;)
plt.xlabel(&#x27;epoch&#x27;)
plt.legend([&#x27;train_accuracy&#x27;, &#x27;val_accuracy&#x27;])
plt.show()
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="/assets/images/tf_Emotion_Detection_29-2a9c32d34b9d483540f415cf9d7dde92.webp" width="575" height="455"></p>
<pre><code class="language-python">plt.figure(figsize=(16,16))

for images, labels in testing_dataset.take(1):
    for i in range(16):
        ax = plt.subplot(4,4,i+1)
        true = &quot;True: &quot; + LABELS[tf.argmax(labels[i], axis=0).numpy()]
        pred = &quot;Predicted: &quot; + LABELS[
            tf.argmax(vit(tf.expand_dims(images[i], axis=0)).numpy(), axis=1).numpy()[0]
        ]
        plt.title(
           true  + &quot;\n&quot; + pred
        )
        plt.imshow(images[i]/255.)
        plt.axis(&#x27;off&#x27;)
        
plt.savefig(&#x27;assets/tf_Emotion_Detection_30.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="/assets/images/tf_Emotion_Detection_30-8c0c2dd2fc5284cbfe004e1a71da0d8b.webp" width="1258" height="1295"></p>
<pre><code class="language-python">y_pred = []
y_test = []

for img, label in testing_dataset:
    y_pred.append(vit(img))
    y_test.append(label.numpy())
</code></pre>
<pre><code class="language-python">conf_mtx = ConfusionMatrixDisplay(
    confusion_matrix=confusion_matrix(
        np.argmax(y_test[:-1], axis=-1).flatten(),
        np.argmax(y_pred[:-1], axis=-1).flatten()
    ),
    display_labels=LABELS
)

fig, ax = plt.subplots(figsize=(16,12))
conf_mtx.plot(ax=ax, cmap=&#x27;plasma&#x27;, include_values=False)

plt.savefig(&#x27;assets/tf_Emotion_Detection_31.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="data:image/webp;base64,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" width="967" height="823"></p>
<h2 id="vision-transformer-vit-base-patch16-224-in21k">Vision Transformer (vit-base-patch16-224-in21k)</h2>
<blockquote>
<p><a href="https://arxiv.org/pdf/2010.11929.pdf">google/vit-base-patch16-224</a></p>
</blockquote>
<p><em>&quot;The Vision Transformer (ViT) is a transformer encoder model (BERT-like) pretrained on a large collection of images in a supervised fashion, namely ImageNet-21k, at a resolution of 224x224 pixels. Next, the model was fine-tuned on ImageNet (also referred to as ILSVRC2012), a dataset comprising 1 million images and 1,000 classes, also at resolution 224x224.&quot;</em></p>
<p>This is using the <a href="https://huggingface.co/docs/transformers/model_doc/vit">same transformer</a> as before - but is now pre-trained on a large dataset. Let&#x27;s see if this can beat the results I received from the not-pre-trained ViT before:</p>
<ul>
<li><code>loss: 0.9803 - accuracy: 0.5443 - topk_accuracy: 0.8090</code> (self-build: num_attention_heads=4,num_hidden_layers=2, hidden_size=144)</li>
<li><code>loss: 0.9404 - accuracy: 0.5610 - topk_accuracy: 0.8385</code> (hf model: num_attention_heads=4,num_hidden_layers=2, hidden_size=144)</li>
<li><code>loss: 0.9572 - accuracy: 0.5399 - topk_accuracy: 0.8306</code> (hf model: num_attention_heads=8,num_hidden_layers=4, hidden_size=144)</li>
<li><code>loss: 1.0289 - accuracy: 0.5000 - topk_accuracy: 0.7761</code> (hf model: num_attention_heads=8,num_hidden_layers=4, hidden_size=768)<!-- -->
<ul>
<li>The accuracy here is lower - but I massively reduced the learning rate and the accuracy was still rising steadily</li>
</ul>
</li>
<li><code>loss: 0.5340 - accuracy: 0.7730 - topk_accuracy: 0.9315</code> (hf model with pre-trained weights: num_attention_heads=8,num_hidden_layers=4, hidden_size=768)</li>
</ul>
<p>For the training with pretrained weights I increased the learning-rate again by a factor of 10. But I had to down-configure the model to prevent out-of-memory errors (configuration as seen below). So there is still room to improve the results on better hardware and with some tinkering. Still - this pre-trained model performs significantly better than the untrained transformer and already comes close to rival the CNN solution (MobileNetV3Small) used before:</p>
<ul>
<li><code>loss: 0.3906 - accuracy: 0.8455 - topk_accuracy: 0.9627</code> - <strong>MobileNetV3Small</strong> as reference</li>
</ul>
<pre><code class="language-python">@misc{wu2020visual,
      title={Visual Transformers: Token-based Image Representation and Processing for Computer Vision}, 
      author={Bichen Wu and Chenfeng Xu and Xiaoliang Dai and Alvin Wan and Peizhao Zhang and Zhicheng Yan and Masayoshi Tomizuka and Joseph Gonzalez and Kurt Keutzer and Peter Vajda},
      year={2020},
      eprint={2006.03677},
      archivePrefix={arXiv},
      primaryClass={cs.CV}
}

@misc{wu2020visual,
      title={Visual Transformers: Token-based Image Representation and Processing for Computer Vision}, 
      author={Bichen Wu and Chenfeng Xu and Xiaoliang Dai and Alvin Wan and Peizhao Zhang and Zhicheng Yan and Masayoshi Tomizuka and Joseph Gonzalez and Kurt Keutzer and Peter Vajda},
      year={2020},
      eprint={2006.03677},
      archivePrefix={arXiv},
      primaryClass={cs.CV}
}
</code></pre>
<pre><code class="language-python">!pip install transformers
</code></pre>
<pre><code class="language-python">import cv2 as cv
import matplotlib.pyplot as plt
import numpy as np
from sklearn.metrics import (
    classification_report,
    confusion_matrix,
    ConfusionMatrixDisplay)
import tensorflow as tf
from tensorflow.keras import Sequential
from tensorflow.keras.layers import (
    Conv2D,
    BatchNormalization,
    LayerNormalization,
    Dense,
    Input,
    Embedding,
    MultiHeadAttention,
    Layer,
    Add,
    Resizing,
    Rescaling,
    Permute,
    Flatten,
    RandomFlip,
    RandomRotation,
    RandomContrast,
    RandomBrightness
)
from tensorflow.keras.losses import CategoricalCrossentropy
from tensorflow.keras.metrics import CategoricalAccuracy, TopKCategoricalAccuracy
from tensorflow.keras.models import Model
from tensorflow.keras.optimizers import Adam
from tensorflow.keras.utils import image_dataset_from_directory

from transformers import ViTConfig, ViTModel, AutoImageProcessor, TFViTModel
</code></pre>
<pre><code class="language-python">SEED = 42
LABELS = [&#x27;angry&#x27;, &#x27;happy&#x27;, &#x27;sad&#x27;]
NLABELS = len(LABELS)
BATCH_SIZE = 32
SIZE = 224
EPOCHS = 20
LR = 5e-6 # default 0.001
HIDDEN_SIZE = 768 # default 768
NHEADS = 8 # default 12
NLAYERS = 4 # default 12
</code></pre>
<h3 id="dataset-1">Dataset</h3>
<pre><code class="language-python">train_directory = &#x27;./dataset/Emotions Dataset/Emotions Dataset/train&#x27;
test_directory = &#x27;./dataset/Emotions Dataset/Emotions Dataset/test&#x27;
</code></pre>
<pre><code class="language-python">train_dataset = image_dataset_from_directory(
    train_directory,
    labels=&#x27;inferred&#x27;,
    label_mode=&#x27;categorical&#x27;,
    class_names=LABELS,
    color_mode=&#x27;rgb&#x27;,
    batch_size=BATCH_SIZE,
    image_size=(SIZE, SIZE),
    shuffle=True,
    seed=SEED,
    interpolation=&#x27;bilinear&#x27;,
    follow_links=False,
    crop_to_aspect_ratio=False
)

# Found 6799 images belonging to 3 classes.
</code></pre>
<pre><code class="language-python">test_dataset = image_dataset_from_directory(
    test_directory,
    labels=&#x27;inferred&#x27;,
    label_mode=&#x27;categorical&#x27;,
    class_names=LABELS,
    color_mode=&#x27;rgb&#x27;,
    batch_size=BATCH_SIZE,
    image_size=(SIZE, SIZE),
    shuffle=True,
    seed=SEED
)

# Found 2278 images belonging to 3 classes.
</code></pre>
<pre><code class="language-python">data_augmentation = Sequential([
    RandomRotation(factor = (0.25),),
    RandomFlip(mode=&#x27;horizontal&#x27;,),
    RandomContrast(factor=0.1),
    RandomBrightness(0.1)
])
</code></pre>
<pre><code class="language-python">resize_rescale_reshape = Sequential([
    Resizing(SIZE, SIZE),
    Rescaling(1./255),
    # transformer expects image shape (3,224,224)
    Permute((3,1,2))
])
</code></pre>
<pre><code class="language-python">training_dataset = (
    train_dataset
    .map(lambda image, label: (data_augmentation(image), label))
    .prefetch(tf.data.AUTOTUNE)
)


testing_dataset = (
    test_dataset.prefetch(
        tf.data.AUTOTUNE
    )
)
</code></pre>
<h3 id="vit-model">ViT Model</h3>
<pre><code class="language-python"># Initializing a ViT vit-base-patch16-224 style configuration
configuration = ViTConfig(
    image_size=SIZE,
    hidden_size=HIDDEN_SIZE,
    num_attention_heads=NHEADS,
    num_hidden_layers=NLAYERS
)

# Initializing a model with random weights from the vit-base-patch16-224 style configuration
# base_model = TFViTModel(configuration)

# use pretrained weights for the model instead
base_model = TFViTModel.from_pretrained(&quot;google/vit-base-patch16-224-in21k&quot;, config=configuration)

# Accessing the model configuration
configuration = base_model.config
</code></pre>
<pre><code class="language-python">configuration
</code></pre>
<pre><code class="language-python">inputs = Input(shape=(224,224,3))
x = resize_rescale_reshape(inputs)
x = base_model.vit(x)[0][:,0,:]
output = Dense(NLABELS, activation=&#x27;softmax&#x27;)(x)

vit_model = Model(inputs=inputs, outputs=output)
</code></pre>
<pre><code class="language-python">vit_model.summary()
</code></pre>
<pre><code class="language-python"># testing the pretrained model
test_image = cv.imread(&#x27;./dataset/angry.jpg&#x27;)
test_image = cv.resize(test_image, (SIZE, SIZE))
</code></pre>
<pre><code class="language-python">vit_model(tf.expand_dims(test_image, axis = 0))
# numpy=array([[0.4467356 , 0.46105713, 0.09220731]]
</code></pre>
<h3 id="model-training-1">Model Training</h3>
<pre><code class="language-python">loss_function = CategoricalCrossentropy()
</code></pre>
<pre><code class="language-python">metrics = [CategoricalAccuracy(name=&#x27;accuracy&#x27;), TopKCategoricalAccuracy(k=2, name=&#x27;topk_accuracy&#x27;)]
</code></pre>
<pre><code class="language-python">vit_model.compile(
    optimizer = Adam(learning_rate = LR),
    loss = loss_function,
    metrics = metrics
)
</code></pre>
<pre><code class="language-python">vit_history = vit_model.fit(
    training_dataset,
    validation_data = testing_dataset,
    epochs = EPOCHS,
    verbose = 1
)

# loss: 0.5090
# accuracy: 0.7922
# topk_accuracy: 0.9384
# val_loss: 0.5340
# val_accuracy: 0.7730
# val_topk_accuracy: 0.9315
</code></pre>
<pre><code class="language-python">vit_model.evaluate(testing_dataset)
# loss: 0.5340 - accuracy: 0.7730 - topk_accuracy: 0.9315
</code></pre>
<pre><code class="language-python">plt.plot(vit_history.history[&#x27;loss&#x27;])
plt.plot(vit_history.history[&#x27;val_loss&#x27;])
plt.title(&#x27;Model Loss&#x27;)
plt.ylabel(&#x27;loss&#x27;)
plt.xlabel(&#x27;epoch&#x27;)
plt.legend([&#x27;train_loss&#x27;, &#x27;val_loss&#x27;])

plt.savefig(&#x27;assets/tf_Emotion_Detection_32.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="data:image/webp;base64,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" width="567" height="455"></p>
<pre><code class="language-python">plt.plot(vit_history.history[&#x27;accuracy&#x27;])
plt.plot(vit_history.history[&#x27;val_accuracy&#x27;])
plt.title(&#x27;Model Accuracy&#x27;)
plt.ylabel(&#x27;accuracy&#x27;)
plt.xlabel(&#x27;epoch&#x27;)
plt.legend([&#x27;train_accuracy&#x27;, &#x27;val_accuracy&#x27;])

plt.savefig(&#x27;assets/tf_Emotion_Detection_33.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="/assets/images/tf_Emotion_Detection_33-1e9c9b2c956df35a69892a8e0bb5be9a.webp" width="576" height="455"></p>
<pre><code class="language-python">plt.figure(figsize=(16,16))

for images, labels in testing_dataset.take(1):
    for i in range(16):
        ax = plt.subplot(4,4,i+1)
        true = &quot;True: &quot; + LABELS[tf.argmax(labels[i], axis=0).numpy()]
        pred = &quot;Predicted: &quot; + LABELS[
            tf.argmax(vit_model(tf.expand_dims(images[i], axis=0)).numpy(), axis=1).numpy()[0]
        ]
        plt.title(
           true  + &quot;\n&quot; + pred
        )
        plt.imshow(images[i]/255.)
        plt.axis(&#x27;off&#x27;)
        
plt.savefig(&#x27;assets/tf_Emotion_Detection_34.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="/assets/images/tf_Emotion_Detection_34-9775d1ae85328760cf7a4dad18a0272a.webp" width="1258" height="1295"></p>
<pre><code class="language-python">y_pred = []
y_test = []

for img, label in testing_dataset:
    y_pred.append(vit_model(img))
    y_test.append(label.numpy())
</code></pre>
<pre><code class="language-python">conf_mtx = ConfusionMatrixDisplay(
    confusion_matrix=confusion_matrix(
        np.argmax(y_test[:-1], axis=-1).flatten(),
        np.argmax(y_pred[:-1], axis=-1).flatten()
    ),
    display_labels=LABELS
)

fig, ax = plt.subplots(figsize=(16,12))
conf_mtx.plot(ax=ax, cmap=&#x27;plasma&#x27;, include_values=False)

plt.savefig(&#x27;assets/tf_Emotion_Detection_35.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="data:image/webp;base64,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" width="1160" height="987"></p>
<h2 id="vision-transformer-deit">Vision Transformer (DeiT)</h2>
<blockquote>
<p><a href="https://arxiv.org/pdf/2012.12877.pdf">Training data-efficient image transformers
&amp; distillation through attention</a></p>
<p><code>Hugo Touvron</code>, <code>Matthieu Cord</code>, <code>Matthijs Douze</code>, <code>Francisco Massa</code>, <code>Alexandre Sablayrolles</code>, <code>Herve J&#x27;egou</code></p>
</blockquote>
<p><em>&quot;Recently, neural networks purely based on attention were shown to address image understanding tasks such as image classification. These highperforming vision transformers are pre-trained with hundreds of millions of images using a large infrastructure, thereby limiting their adoption. In this work, we produce competitive convolution-free transformers by training on Imagenet only. We train them on a single computer in less than 3 days. Our reference vision transformer (86M parameters) achieves top-1 accuracy of 83.1% (single-crop) on ImageNet with no external data. More importantly, we introduce a teacher-student strategy specific to transformers. It relies on a distillation token ensuring that the student learns from the teacher through attention. We show the interest of this token-based distillation, especially when using a convnet as a teacher. This leads us to report results competitive with convnets for both Imagenet (where we obtain up to 85.2% accuracy) and when transferring to other tasks.&quot;</em></p>
<pre><code class="language-python">!pip install transformers
</code></pre>
<pre><code class="language-python">import cv2 as cv
import matplotlib.pyplot as plt
import numpy as np
from sklearn.metrics import (
    classification_report,
    confusion_matrix,
    ConfusionMatrixDisplay)
import tensorflow as tf
from tensorflow.keras import Sequential
from tensorflow.keras.layers import (
    Conv2D,
    BatchNormalization,
    LayerNormalization,
    Dense,
    Input,
    Embedding,
    MultiHeadAttention,
    Layer,
    Add,
    Resizing,
    Rescaling,
    Permute,
    Flatten,
    RandomFlip,
    RandomRotation,
    RandomContrast,
    RandomBrightness
)
from tensorflow.keras.losses import CategoricalCrossentropy
from tensorflow.keras.metrics import CategoricalAccuracy, TopKCategoricalAccuracy
from tensorflow.keras.models import Model
from tensorflow.keras.optimizers import Adam
from tensorflow.keras.utils import image_dataset_from_directory

from transformers import DeiTConfig, TFDeiTModel
</code></pre>
<pre><code class="language-python">SEED = 42
LABELS = [&#x27;angry&#x27;, &#x27;happy&#x27;, &#x27;sad&#x27;]
NLABELS = len(LABELS)
BATCH_SIZE = 32
SIZE = 256
EPOCHS = 20
LR = 5e-6 # default 0.001
HIDDEN_SIZE = 768 # default 768
NHEADS = 8 # default 12
NLAYERS = 4 # default 12
</code></pre>
<h3 id="dataset-2">Dataset</h3>
<pre><code class="language-python">train_directory = &#x27;./dataset/Emotions Dataset/Emotions Dataset/train&#x27;
test_directory = &#x27;./dataset/Emotions Dataset/Emotions Dataset/test&#x27;
</code></pre>
<pre><code class="language-python">train_dataset = image_dataset_from_directory(
    train_directory,
    labels=&#x27;inferred&#x27;,
    label_mode=&#x27;categorical&#x27;,
    class_names=LABELS,
    color_mode=&#x27;rgb&#x27;,
    batch_size=BATCH_SIZE,
    image_size=(SIZE, SIZE),
    shuffle=True,
    seed=SEED,
    interpolation=&#x27;bilinear&#x27;,
    follow_links=False,
    crop_to_aspect_ratio=False
)

# Found 6799 images belonging to 3 classes.
</code></pre>
<pre><code class="language-python">test_dataset = image_dataset_from_directory(
    test_directory,
    labels=&#x27;inferred&#x27;,
    label_mode=&#x27;categorical&#x27;,
    class_names=LABELS,
    color_mode=&#x27;rgb&#x27;,
    batch_size=BATCH_SIZE,
    image_size=(SIZE, SIZE),
    shuffle=True,
    seed=SEED
)

# Found 2278 images belonging to 3 classes.
</code></pre>
<pre><code class="language-python">data_augmentation = Sequential([
    RandomRotation(factor = (0.25),),
    RandomFlip(mode=&#x27;horizontal&#x27;,),
    RandomContrast(factor=0.1),
    RandomBrightness(0.1)
])
</code></pre>
<pre><code class="language-python">resize_rescale_reshape = Sequential([
    Resizing(SIZE, SIZE),
    Rescaling(1./255),
    # transformer expects image shape (3,224,224)
    Permute((3,1,2))
])
</code></pre>
<pre><code class="language-python">training_dataset = (
    train_dataset
    .map(lambda image, label: (data_augmentation(image), label))
    .prefetch(tf.data.AUTOTUNE)
)


testing_dataset = (
    test_dataset.prefetch(
        tf.data.AUTOTUNE
    )
)
</code></pre>
<h3 id="deit-model">DeiT Model</h3>
<pre><code class="language-python"># Initializing a ViT vit-base-patch16-224 style configuration
configuration = DeiTConfig(
    image_size=SIZE,
    hidden_size=HIDDEN_SIZE,
    num_attention_heads=NHEADS,
    num_hidden_layers=NLAYERS
)

# Initializing a model with random weights from the vit-base-patch16-224 style configuration
# base_model = TFViTModel(configuration)

# use pretrained weights for the model instead
base_model = TFDeiTModel.from_pretrained(&quot;facebook/deit-base-distilled-patch16-224&quot;, config=configuration)

# Accessing the model configuration
configuration = base_model.config
</code></pre>
<pre><code class="language-python">configuration
</code></pre>
<pre><code class="language-python">inputs = Input(shape=(256,256,3))
x = resize_rescale_reshape(inputs)
x = base_model.deit(x)[0][:,0,:]
output = Dense(NLABELS, activation=&#x27;softmax&#x27;)(x)

deit_model = Model(inputs=inputs, outputs=output)
</code></pre>
<pre><code class="language-python">deit_model.summary()
</code></pre>
<pre><code class="language-python"># testing the pretrained model
test_image = cv.imread(&#x27;./dataset/angry.jpg&#x27;)
test_image = cv.resize(test_image, (SIZE, SIZE))
</code></pre>
<pre><code class="language-python">deit_model(tf.expand_dims(test_image, axis = 0))
# numpy=array([[0.50628585, 0.13601433, 0.3576998 ]]
</code></pre>
<h3 id="model-training-2">Model Training</h3>
<pre><code class="language-python">loss_function = CategoricalCrossentropy()
</code></pre>
<pre><code class="language-python">metrics = [CategoricalAccuracy(name=&#x27;accuracy&#x27;), TopKCategoricalAccuracy(k=2, name=&#x27;topk_accuracy&#x27;)]
</code></pre>
<pre><code class="language-python">deit_model.compile(
    optimizer = Adam(learning_rate = LR),
    loss = loss_function,
    metrics = metrics
)
</code></pre>
<pre><code class="language-python">deit_history = deit_model.fit(
    training_dataset,
    validation_data = testing_dataset,
    epochs = EPOCHS,
    verbose = 1
)

# loss: 0.5912
# accuracy: 0.7438
# topk_accuracy: 0.9226
# val_loss: 0.6060
# val_accuracy: 0.7515
# val_topk_accuracy: 0.9227
</code></pre>
<pre><code class="language-python">deit_model.evaluate(testing_dataset)
# loss: 0.6060 - accuracy: 0.7515 - topk_accuracy: 0.9227
</code></pre>
<pre><code class="language-python">plt.plot(deit_history.history[&#x27;loss&#x27;])
plt.plot(deit_history.history[&#x27;val_loss&#x27;])
plt.title(&#x27;Model Loss&#x27;)
plt.ylabel(&#x27;loss&#x27;)
plt.xlabel(&#x27;epoch&#x27;)
plt.legend([&#x27;train_loss&#x27;, &#x27;val_loss&#x27;])

plt.savefig(&#x27;assets/tf_Emotion_Detection_36.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="data:image/webp;base64,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" width="567" height="455"></p>
<pre><code class="language-python">plt.plot(deit_history.history[&#x27;accuracy&#x27;])
plt.plot(deit_history.history[&#x27;val_accuracy&#x27;])
plt.title(&#x27;Model Accuracy&#x27;)
plt.ylabel(&#x27;accuracy&#x27;)
plt.xlabel(&#x27;epoch&#x27;)
plt.legend([&#x27;train_accuracy&#x27;, &#x27;val_accuracy&#x27;])

plt.savefig(&#x27;assets/tf_Emotion_Detection_37.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="/assets/images/tf_Emotion_Detection_37-a1f241dd238df0adf5683718a7d93969.webp" width="576" height="455"></p>
<pre><code class="language-python">plt.figure(figsize=(16,16))

for images, labels in testing_dataset.take(1):
    for i in range(16):
        ax = plt.subplot(4,4,i+1)
        true = &quot;True: &quot; + LABELS[tf.argmax(labels[i], axis=0).numpy()]
        pred = &quot;Predicted: &quot; + LABELS[
            tf.argmax(deit_model(tf.expand_dims(images[i], axis=0)).numpy(), axis=1).numpy()[0]
        ]
        plt.title(
           true  + &quot;\n&quot; + pred
        )
        plt.imshow(images[i]/255.)
        plt.axis(&#x27;off&#x27;)
        
plt.savefig(&#x27;assets/tf_Emotion_Detection_38.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="/assets/images/tf_Emotion_Detection_38-35757207e28459a19bd5b669e9796c20.webp" width="1258" height="1295"></p>
<pre><code class="language-python">y_pred = []
y_test = []

for img, label in testing_dataset:
    y_pred.append(deit_model(img))
    y_test.append(label.numpy())
</code></pre>
<pre><code class="language-python">conf_mtx = ConfusionMatrixDisplay(
    confusion_matrix=confusion_matrix(
        np.argmax(y_test[:-1], axis=-1).flatten(),
        np.argmax(y_pred[:-1], axis=-1).flatten()
    ),
    display_labels=LABELS
)

fig, ax = plt.subplots(figsize=(16,12))
conf_mtx.plot(ax=ax, cmap=&#x27;plasma&#x27;, include_values=False)

plt.savefig(&#x27;assets/tf_Emotion_Detection_39.webp&#x27;, bbox_inches=&#x27;tight&#x27;)
</code></pre>
<p><img alt="Building a Tensorflow VIT" src="data:image/webp;base64,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" width="1160" height="987"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/python">Python</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/machine-learning">Machine Learning</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2023-07-27-tensorflow-vision-transformer/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/IoT-and-Machine-Learning/ML/2023-08-01-tensorflow-i-know-flowers-intro/2023-08-01"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tensorflow Image Classifier - Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/IoT-and-Machine-Learning/ML/2023-07-26-tensorflow-human-emotion-detector/2023-07-26"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Human Emotion Detection with Tensorflow</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dataset" class="table-of-contents__link toc-highlight">Dataset</a></li><li><a href="#data-preprocessing-extracting-patches" class="table-of-contents__link toc-highlight">Data Preprocessing (Extracting Patches)</a></li><li><a href="#build-the-transformer-encoder" class="table-of-contents__link toc-highlight">Build the Transformer Encoder</a></li><li><a href="#build-the-vit-model" class="table-of-contents__link toc-highlight">Build the ViT Model</a></li><li><a href="#model-training" class="table-of-contents__link toc-highlight">Model Training</a></li><li><a href="#vision-transformer-vit-base-patch16-224-in21k" class="table-of-contents__link toc-highlight">Vision Transformer (vit-base-patch16-224-in21k)</a><ul><li><a href="#dataset-1" class="table-of-contents__link toc-highlight">Dataset</a></li><li><a href="#vit-model" class="table-of-contents__link toc-highlight">ViT Model</a></li><li><a href="#model-training-1" class="table-of-contents__link toc-highlight">Model Training</a></li></ul></li><li><a href="#vision-transformer-deit" class="table-of-contents__link toc-highlight">Vision Transformer (DeiT)</a><ul><li><a href="#dataset-2" class="table-of-contents__link toc-highlight">Dataset</a></li><li><a href="#deit-model" class="table-of-contents__link toc-highlight">DeiT Model</a></li><li><a href="#model-training-2" class="table-of-contents__link toc-highlight">Model Training</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
</body>
</html>