<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-IoT-and-Machine-Learning/ML/2023-03-16-tensorflow-transfer-learning-scaling/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Tensorflow 2 - Transfer Learning | Mike Polinowski</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2023-03-16-tensorflow-transfer-learning-scaling/2023-03-16"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tensorflow 2 - Transfer Learning | Mike Polinowski"><meta data-rh="true" name="description" content="Scale a pre-trained model to fit your needs"><meta data-rh="true" property="og:description" content="Scale a pre-trained model to fit your needs"><link data-rh="true" rel="icon" href="/img/icons/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2023-03-16-tensorflow-transfer-learning-scaling/2023-03-16"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2023-03-16-tensorflow-transfer-learning-scaling/2023-03-16" hreflang="en"><link data-rh="true" rel="alternate" href="https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2023-03-16-tensorflow-transfer-learning-scaling/2023-03-16" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Mike Polinowski RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Mike Polinowski Atom Feed">




<link rel="icon" href="/img/angular_momentum.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37,194,160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/angular_momentum.png">
<link rel="mask-icon" href="/img/angular_momentum.png" color="rgb(33,33,33)">
<meta name="msapplication-TileImage" content="/img/angular_momentum.png">
<meta name="msapplication-TileColor" content="#000">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P74BDWF0C6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P74BDWF0C6",{})</script><link rel="stylesheet" href="/assets/css/styles.08c8c484.css">
<script src="/assets/js/runtime~main.003ec094.js" defer="defer"></script>
<script src="/assets/js/main.0363f805.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/angular_momentum.png" alt="Mike Polinowski :: Dev Notebook" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mike Polinowski</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/tags">Tags</a><a class="navbar__item navbar__link" href="/Search">Search</a><a href="https://mpolinowski.github.io/Personal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/development">Development</a><button aria-label="Expand sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/devops">DevOps</a><button aria-label="Expand sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/machine-learning-ai-and-computer-vision">Machine Learning, AI and Computer Vision</a><button aria-label="Collapse sidebar category &#x27;Machine Learning, AI and Computer Vision&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/machine-learning">Machine Learning</a><button aria-label="Collapse sidebar category &#x27;Machine Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-10-01--delib-face-detection/2023-10-01">DLIB Face Recognition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-23--yolo8-listen/2023-09-23">Audio Classification with Computer Vision</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-21--cvat-automatic-annotation/2023-09-21">CVAT Semi-automatic and Automatic Annotation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-19--cvat-computer-vision-annotation-tool/2023-09-19">Computer Vision Annotation Tool (CVAT) Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-17--yolo8-nightshift/2023-09-17">YOLOv8 Nightshift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-15--yolo8-tracking-and-ocr/2023-09-15">YOLOv8 License Plate Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-10--model-explainability-shap/2023-09-11">Scikit-Learn ML Model Explainability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-05--semantic-segmentation-in-opencv/2023-09-05">Using Tensorflow Models in OpenCV</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-09-01--yolo-i-know-flowers/2023-09-01">YOLOv8 Image Classifier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-31--semantic_segmentation_detectron2_openimages_dataset/2023-08-31">Detectron Object Detection with OpenImages Dataset (WIP)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-30--instance_segmentation_detectron2_model_zoo_mask_rcnn/2023-08-30">Instance Segmentation with PyTorch (Mask RCNN)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-29--semantic-segmentation-detectron2-model-zoo-faster-rcnn/2023-08-29">Image Segmentation with PyTorch (Faster RCNN)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-28--semantic-segmentation-detectron2-model-zoo/2023-08-28">Image Segmentation with PyTorch (RCNN)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-27--image-segmentation-with-pytorch/2023-08-27">Image Segmentation with PyTorch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-21--pytorch-development-in-docker/2023-08-21">Containerized PyTorch Dev Workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-13-tensorflow-i-know-flowers-model-eval/2023-08-13">Tensorflow Image Classifier - Model Evaluation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-12-tensorflow-i-know-flowers-xception/2023-08-12">Tensorflow Image Classifier - Xception</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-11-tensorflow-i-know-flowers-vit/2023-08-11">Tensorflow Image Classifier - ViT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-10-tensorflow-i-know-flowers-nasnetmobile/2023-08-10">Tensorflow Image Classifier - NASNetMobile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-09-tensorflow-i-know-flowers-mobilenetv3small/2023-08-09">Tensorflow Image Classifier - MobileNetV3Small</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-08-tensorflow-i-know-flowers-mobilenetv3large/2023-08-08">Tensorflow Image Classifier - MobileNetV3Large</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-07-tensorflow-i-know-flowers-mobilenetv2/2023-08-07">Tensorflow Image Classifier - MobileNetV2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-06-tensorflow-i-know-flowers-inceptionv3/2023-08-06">Tensorflow Image Classifier - InceptionV3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-05-tensorflow-i-know-flowers-efficientnetv2s/2023-08-05">Tensorflow Image Classifier - EfficientNetV2S</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-04-tensorflow-i-know-flowers-efficientnetv2b0/2023-08-04">Tensorflow Image Classifier - EfficientNetV2B0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-03-tensorflow-i-know-flowers-deit/2023-08-03">Tensorflow Image Classifier - Data-efficient Image Transformers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-02-tensorflow-i-know-flowers-preprocessing/2023-08-02">Tensorflow Image Classifier - Data Pre-processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-08-01-tensorflow-i-know-flowers-intro/2023-08-01">Tensorflow Image Classifier - Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-07-27-tensorflow-vision-transformer/2023-07-27">Tensorflow VITs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-07-26-tensorflow-human-emotion-detector/2023-07-26">Human Emotion Detection with Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-07-25-onnx-models/2023-07-25">Working with ONNX Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-07-21-introduction-to-pytorch-caffe2/2023-07-21">Introduction to Caffe2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-07-02-sql-in-data-science-ml/2023-07-02">SQL in Data Science - Machine Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-06-30-sql-in-data-science-advanced/2023-06-30">SQL in Data Science - Slightly more Advanced Queries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-06-27-sql-in-data-science-basics/2023-06-27">SQL in Data Science - The Basics using Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-06-26-autogluon-transit-photometry-dataset/2023-06-26">Detection of Exoplanets using Transit Photometry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-19-tensorflow-natural-language-processing/2023-04-19">(Re) Introduction to Tensorflow Natural Language Processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-16-deep-3d-image-segmentation/2023-04-16">3D Image Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-14-manifold-learning-for-image-segmentation/2023-04-14">Dimensionality Reduction for Image Segmentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-13-fisher-discriminant-analysis/2023-04-13">Fisher Linear Discriminant Analysis (LDA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-13-isometric-mapping/2023-04-13">Isometric Mapping (ISOMAP)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-13-multi-dimensional-scaling/2023-04-13">Multidimensional Scaling (MDS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-12-tstochastic-neighbor-embedding/2023-04-12">tStochastic Neighbor Embedding (t-SNE)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-11-locally-linear-embedding/2023-04-11">Locally Linear Embedding (LLE)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-04-09-principal-component-analysis/2023-04-09">Principal Component Analysis (PCA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-26-tensorflow-unsupervised-learning-generative-adversial-networks/2023-03-26">Tensorflow 2 - Unsupervised Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-26-tensorflow-unsupervised-learning-autoencoders-super-resolution/2023-03-26">Tensorflow 2 - Unsupervised Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-24-tensorflow-unsupervised-learning-autoencoders/2023-03-24">Tensorflow 2 - Unsupervised Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-16-tensorflow-transfer-learning-scaling/2023-03-16">Tensorflow 2 - Transfer Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-11-tensorflow-transfer-learning-fine-tuning/2023-03-11">Tensorflow 2 - Transfer Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-06-tensorflow-transfer-learning-feature-extraction/2023-03-06">Tensorflow 2 - Transfer Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-05-tensorflow-convolutional-neural-network-multiclass-classifications/2023-03-05">Tensorflow 2 - Convolutional Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-03-tensorflow-convolutional-neural-network-binary-classifications/2023-03-03">Tensorflow 2 - Convolutional Neural Networks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-03-02-tensorflow-neural-network-multi-classification/2023-03-02">Tensorflow 2 - Neural Network Classifications</a><button aria-label="Expand sidebar category &#x27;Tensorflow 2 - Neural Network Classifications&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-28-tensorflow-neural-network-classification-model-evaluation/2023-02-28">Tensorflow 2 - Neural Network Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-27-tensorflow-neural-network-classification/2023-02-27">Tensorflow 2 - Neural Network Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-26-tensorflow-neural-network-regression-data-preprocessing/2023-02-26">Tensorflow 2 - Neural Network Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-26-tensorflow-neural-network-regression-real-dataset/2023-02-26">Tensorflow 2 - Neural Network Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-25-tensorflow-neural-network-regression-experiments/2023-02-25">Tensorflow 2 - Neural Network Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-24-tensorflow-neural-network-regression-evaluation/2023-02-24">Tensorflow 2 - Neural Network Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-23-tensorflow-neural-network-regression/2023-02-23">Tensorflow 2 - Neural Network Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-22-tensorflow-tensors-3/2023-02-22">Tensorflow 2 - An (Re)Introduction 2023 (3)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-21-tensorflow-tensors-2/2023-02-21">Tensorflow 2 - An (Re)Introduction 2023 (2)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-19-tensorflow-introduction/2023-02-19">Tensorflow 2 - An (Re)Introduction 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-18-keras-introduction-vgg16/2023-02-18">Keras for Tensorflow - VGG16 Network Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-18-keras-introduction-rnn/2023-02-18">Keras for Tensorflow - Recurrent Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-17-keras-introduction-cnn/2023-02-17">Keras for Tensorflow - Convolutional Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-16-keras-introduction-ann/2023-02-16">Keras for Tensorflow - Artificial Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-15-as-one-yolo-object-tracking/2023-02-15">YOLOv8 with AS-One</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-02-14-keras-introduction/2023-02-14">Keras for Tensorflow - An (Re)Introduction 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-30-predicting-wine-quality/2023-01-30">SciKit Wine Quality</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-28-opencv-coin-counter/2023-01-28">OpenCV Count My Money</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-14-yolov7_to_tensorflow/2023-01-14">YOLOv7 to Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-13-yolov7_data_conversion/2023-01-13">YOLOv7 Label Conversion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-10-yolov7_custom_data/2023-01-10">YOLOv7 Training with Custom Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-08-depth-vision-midas/2023-01-08">MiDaS Depth Vision</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2023-01-05-yolov7/2023-01-05">YOLOv7 Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-31-tf-rnn-text-generation/2022-12-31">Recurrent Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-28-tf-gan-image-generator/2022-12-28">Deep Convolutional Generative Adversarial Network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-21-tf-downsampling/2022-12-21">Tensorflow Downsampling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-21-tf-deepdream/2022-12-21">Tensorflow Deep Dream</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-20-tf-representation/2022-12-19">Tensorflow Representation Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-19-tf-hub/2022-12-19">Tensorflow Hub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-18-tf-transfer-learning/2022-12-18">Tensorflow Transfer Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-16-tf-cifar/2022-12-16">Tensorflow Image Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-12-tf-breast-cancer-classification-part6/2022-12-12">Breast Histopathology Image Segmentation Part 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-12-tf-breast-cancer-classification-part5/2022-12-12">Breast Histopathology Image Segmentation Part 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part4/2022-12-11">Breast Histopathology Image Segmentation Part 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part3/2022-12-11">Breast Histopathology Image Segmentation Part 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-11-tf-breast-cancer-classification-part2/2022-12-11">Breast Histopathology Image Segmentation Part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-12-10-tf-breast-cancer-classification-part1/2022-12-10">Breast Histopathology Image Segmentation Part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-11-27-containerized-deep-learning/2022-11-27">Deep Docker on Arch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-04-pytorch-face-restoration/2022-04-04">Face Restoration with GFPGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-03-pytorch-real-super-resolution/2022-04-03">Super Resolution with Real-ESRGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-02-pytorch-super-resolution/2022-04-02">Super Resolution with ESRGAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-04-01-tensorflow-audio-classifier/2022-04-01">Deep Audio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-20--yolo-app-yolov5-data-prep/2022-02-20">Yolo App - YOLOv5 Data Preparation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-19--yolo-app-flask/2022-02-19">Yolo App - Flask Web Application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-18--yolo-app-ocr/2022-02-18">Yolo App - Tesseract Optical Character Recognition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-17--yolo-app-prediction-pipeline/2022-02-17">Yolo App - Pipeline Predictions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-16--yolo-app-tensorflow-model/2022-02-16">Yolo App - Train a Model with Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2022-02-15--yolo-app-get-data/2022-02-15">Yolo App - Data Collection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-10--opencv-optical-flow-tracking/2021-12-10">OpenCV Optical Flow Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-09--opencv-camshift-tracking/2021-12-09">OpenCV CAMshift Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-08--opencv-meanshift-tracking/2021-12-08">OpenCV Meanshift Algorithm for Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-07--opencv-detection-and-tracking/2021-12-07">OpenCV Object Detection and Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-06--opencv-object-tracking/2021-12-06">OpenCV Object Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-05--opencv-face-detection/2021-12-05">OpenCV Face Detection and Privacy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-04--opencv-image-objects/2021-12-04">OpenCV Image Objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-03--opencv-image-operations/2021-12-03">OpenCV Image Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-02--opencv-with-videos/2021-12-02">OpenCV, Streams and Video Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-12-01--opencv-with-images/2021-12-01">OpenCV and Images</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-15--facebook-prophet-introduction/2021-11-15">Introduction into FB Prophet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-14--tensorflow-model-for-tfjs/2021-11-14">Tensorflow.js React App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-13--tensorflow-model-zoo/2021-11-13">Tensorflow2 Model Zoo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-12--tensorflow-crash-course-part-v/2021-11-12">Tensorflow2 Crash Course - Part V</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-11--tensorflow-crash-course-part-iv/2021-11-11">Tensorflow2 Crash Course - Part IV</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-10--tensorflow-crash-course-part-iii/2021-11-10">Tensorflow2 Crash Course - Part III</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-09--tensorflow-crash-course-part-ii/2021-11-09">Tensorflow2 Crash Course - Part II</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-08--tensorflow-crash-course-part-i/2021-11-08">Tensorflow Crash Course - Part I</a><button aria-label="Expand sidebar category &#x27;Tensorflow Crash Course - Part I&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-07--opencv-crash-course-part-ii/2021-11-07">OpenCV Crash Course Part II</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-06--opencv-crash-course-part-i/2021-11-06">OpenCV Crash Course Part I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-05--license-plates-yolov4-opencv-tesseract/2021-11-05">License Plate Recognition with YOLOv4, OpenCV and Tesseract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-04--installing-yolov4/2021-11-04">Installing YOLOv4 with Anaconda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-03--streamlit-opencv-mediapipe/2021-11-03">Streamlit user interface for openCV/Mediapipe face mesh app</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-02--spacy_ner_predictions/2021-11-02">spaCy NER Predictions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-11-01--spacy_natural_language_processing/2021-11-01">spaCy NER on Arch Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2019-04-01--introduction-to-keras/2019-04-01">Introduction to Keras</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2021-10-31--tesseract_ocr_arch_linux/2021-10-31">Tesseract OCR on Arch Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2019-03-31--introduction-to-tensorflow-2-beta/2019-03-31">Introduction to TensorFlow 2 Beta</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/IoT-and-Machine-Learning/ML/2018-01-02--machine-learning-with-python/2018-01-02">Machine Learning with SciKit Learn</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/aiops">AIOps</a><button aria-label="Expand sidebar category &#x27;AIOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/automation-deep-vision-and-robotics">Automation, Deep Vision and Robotics</a><button aria-label="Expand sidebar category &#x27;Automation, Deep Vision and Robotics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/machine-learning-ai-and-computer-vision"><span itemprop="name">Machine Learning, AI and Computer Vision</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/machine-learning"><span itemprop="name">Machine Learning</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Tensorflow 2 - Transfer Learning</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p><img alt="Victoria Harbour, Hongkong" src="/assets/images/photo-kt443t6d_64hdh43hfh6dgjdfhg4_d-0617c01f21d40c2f06bb85d06aa2619b.jpg" width="1500" height="618"></p>
<ul>
<li><a href="#tensorflow-transfer-learning">Tensorflow Transfer Learning</a>
<ul>
<li><a href="#model-scaling">Model Scaling</a>
<ul>
<li><a href="#get-data">Get Data</a></li>
<li><a href="#model-building-and-training">Model Building and Training</a></li>
<li><a href="#fine-tuning-the-model">Fine-tuning the Model</a></li>
<li><a href="#saving-and-restoring-the-trained-model">Saving and Restoring the Trained Model</a></li>
<li><a href="#evaluating-predictions">Evaluating Predictions</a>
<ul>
<li><a href="#accuracy-score">Accuracy Score</a></li>
<li><a href="#confusion-matrix">Confusion Matrix</a></li>
<li><a href="#scikit-learn-classification-report">SciKit Learn Classification Report</a></li>
</ul>
</li>
<li><a href="#run-predictions">Run Predictions</a></li>
<li><a href="#find-most-wrong-predictions">Find most Wrong Predictions</a></li>
<li><a href="#predict-custom-images">Predict Custom Images</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a href="https://github.com/mpolinowski/tf-2023">Github Repository</a></p>
<p><em>See also:</em></p>
<ul>
<li>Fun, fun, tensors: <a href="/docs/IoT-and-Machine-Learning/ML/2023-02-19-tensorflow-introduction/2023-02-19">Tensor Constants, Variables and Attributes</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-02-21-tensorflow-tensors-2/2023-02-21">Tensor Indexing, Expanding and Manipulations</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-02-22-tensorflow-tensors-3/2023-02-22">Matrix multiplications, Squeeze, One-hot and Numpy</a></li>
<li>Tensorflow 2 - Neural Network Regression: <a href="/docs/IoT-and-Machine-Learning/ML/2023-02-23-tensorflow-neural-network-regression/2023-02-23">Building a Regression Model</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-02-24-tensorflow-neural-network-regression-evaluation/2023-02-24">Model Evaluation</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-02-25-tensorflow-neural-network-regression-experiments/2023-02-25">Model Optimization</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-02-26-tensorflow-neural-network-regression-real-dataset/2023-02-26">Working with a &quot;Real&quot; Dataset</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-02-26-tensorflow-neural-network-regression-data-preprocessing/2023-02-26">Feature Scaling</a></li>
<li>Tensorflow 2 - Neural Network Classification: <a href="/docs/IoT-and-Machine-Learning/ML/2023-02-27-tensorflow-neural-network-classification/2023-02-27">Non-linear Data and Activation Functions</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-02-28-tensorflow-neural-network-classification-model-evaluation/2023-02-28">Model Evaluation and Performance Improvement</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-03-02-tensorflow-neural-network-multi-classification/2023-03-02">Multiclass Classification Problems</a></li>
<li>Tensorflow 2 - Convolutional Neural Networks: <a href="/docs/IoT-and-Machine-Learning/ML/2023-03-03-tensorflow-convolutional-neural-network-binary-classifications/2023-03-03">Binary Image Classification</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-03-05-tensorflow-convolutional-neural-network-multiclass-classifications/2023-03-05">Multiclass Image Classification</a></li>
<li>Tensorflow 2 - Transfer Learning: <a href="/docs/IoT-and-Machine-Learning/ML/2023-03-06-tensorflow-transfer-learning-feature-extraction/2023-03-06">Feature Extraction</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-03-11-tensorflow-transfer-learning-fine-tuning/2023-03-11">Fine-Tuning</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-03-16-tensorflow-transfer-learning-scaling/2023-03-16">Scaling</a></li>
<li>Tensorflow 2 - Unsupervised Learning: <a href="/docs/IoT-and-Machine-Learning/ML/2023-03-24-tensorflow-unsupervised-learning-autoencoders/2023-03-24">Autoencoder Feature Detection</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-03-26-tensorflow-unsupervised-learning-autoencoders-super-resolution/2023-03-26">Autoencoder Super-Resolution</a>, <a href="/docs/IoT-and-Machine-Learning/ML/2023-03-26-tensorflow-unsupervised-learning-generative-adversial-networks/2023-03-26">Generative Adverserial Networks</a></li>
</ul>
<h1 id="tensorflow-transfer-learning">Tensorflow Transfer Learning</h1>
<h2 id="model-scaling">Model Scaling</h2>
<ol>
<li>Pretraining EfficientNetB0 (10% of Dataset with 10 Classes)</li>
<li>Fine-Tuning (100% of Dataset with 10 Classes)</li>
<li>Scaling the Model to all 101 Classes (10% of Dataset with 101 Classes)</li>
</ol>
<pre><code class="language-python">import datetime
import matplotlib.image as mpimg
import matplotlib.pyplot as plt
import numpy as np
import os
import pandas as pd
import random
from sklearn.metrics import accuracy_score, classification_report
import tensorflow as tf
from tensorflow.keras.utils import image_dataset_from_directory
</code></pre>
<pre><code class="language-python"># export helper functions from above into helper script
from helper import (create_tensorboard_callback,
                    create_checkpoint_callback,
                    plot_accuracy_curves,
                    combine_training_curves,
                    data_augmentation_layer_no_rescaling,
                    plot_confusion_matrix)
</code></pre>
<pre><code class="language-python"># global variables
SEED = 42
BATCH_SIZE = 32
IMG_SHAPE = (224, 224)
</code></pre>
<h3 id="get-data">Get Data</h3>
<pre><code class="language-python"># preparing datasets
# wget https://storage.googleapis.com/ztm_tf_course/food_vision/101_food_classes_10_percent.zip

training_directory = &quot;../datasets/101_food_classes_10_percent/train&quot;
testing_directory = &quot;../datasets/101_food_classes_10_percent/test&quot;

training_data_101_10 = image_dataset_from_directory(training_directory,
                                              labels=&#x27;inferred&#x27;,
                                              label_mode=&#x27;categorical&#x27;,
                                              seed=SEED,
                                              shuffle=True,
                                              image_size=IMG_SHAPE,
                                              batch_size=BATCH_SIZE)

testing_data_101_10 = image_dataset_from_directory(testing_directory,
                                              labels=&#x27;inferred&#x27;,
                                              label_mode=&#x27;categorical&#x27;,
                                              seed=SEED,
                                              shuffle=False,
                                              image_size=IMG_SHAPE,
                                              batch_size=BATCH_SIZE)

# get class names
class_names_101_10 = training_data_101_10.class_names
len(class_names_101_10), class_names_101_10

# Found 7575 files belonging to 101 classes.
# Found 25250 files belonging to 101 classes.

# (101,
#  [&#x27;apple_pie&#x27;,
#   &#x27;baby_back_ribs&#x27;,
#   &#x27;baklava&#x27;,
#   &#x27;beef_carpaccio&#x27;,
#   &#x27;beef_tartare&#x27;,
#   &#x27;beet_salad&#x27;,
#   &#x27;beignets&#x27;,
#   &#x27;bibimbap&#x27;,
#   &#x27;bread_pudding&#x27;,
#   &#x27;breakfast_burrito&#x27;,
#   &#x27;bruschetta&#x27;,
#   &#x27;caesar_salad&#x27;,
#   &#x27;cannoli&#x27;,
#   &#x27;caprese_salad&#x27;,
#   &#x27;carrot_cake&#x27;,
#   &#x27;ceviche&#x27;,
#   &#x27;cheese_plate&#x27;,
#   &#x27;cheesecake&#x27;,
#   &#x27;chicken_curry&#x27;,
#   &#x27;chicken_quesadilla&#x27;,
#   &#x27;chicken_wings&#x27;,
#   &#x27;chocolate_cake&#x27;,
#   &#x27;chocolate_mousse&#x27;,
#   &#x27;churros&#x27;,
#   &#x27;clam_chowder&#x27;,
#   &#x27;club_sandwich&#x27;,
#   &#x27;crab_cakes&#x27;,
#   &#x27;creme_brulee&#x27;,
#   &#x27;croque_madame&#x27;,
#   &#x27;cup_cakes&#x27;,
#   &#x27;deviled_eggs&#x27;,
#   &#x27;donuts&#x27;,
#   &#x27;dumplings&#x27;,
#   &#x27;edamame&#x27;,
#   &#x27;eggs_benedict&#x27;,
#   &#x27;escargots&#x27;,
#   &#x27;falafel&#x27;,
#   &#x27;filet_mignon&#x27;,
#   &#x27;fish_and_chips&#x27;,
#   &#x27;foie_gras&#x27;,
#   &#x27;french_fries&#x27;,
#   &#x27;french_onion_soup&#x27;,
#   &#x27;french_toast&#x27;,
#   &#x27;fried_calamari&#x27;,
#   &#x27;fried_rice&#x27;,
#   &#x27;frozen_yogurt&#x27;,
#   &#x27;garlic_bread&#x27;,
#   &#x27;gnocchi&#x27;,
#   &#x27;greek_salad&#x27;,
#   &#x27;grilled_cheese_sandwich&#x27;,
#   &#x27;grilled_salmon&#x27;,
#   &#x27;guacamole&#x27;,
#   &#x27;gyoza&#x27;,
#   &#x27;hamburger&#x27;,
#   &#x27;hot_and_sour_soup&#x27;,
#   &#x27;hot_dog&#x27;,
#   &#x27;huevos_rancheros&#x27;,
#   &#x27;hummus&#x27;,
#   &#x27;ice_cream&#x27;,
#   &#x27;lasagna&#x27;,
#   &#x27;lobster_bisque&#x27;,
#   &#x27;lobster_roll_sandwich&#x27;,
#   &#x27;macaroni_and_cheese&#x27;,
#   &#x27;macarons&#x27;,
#   &#x27;miso_soup&#x27;,
#   &#x27;mussels&#x27;,
#   &#x27;nachos&#x27;,
#   &#x27;omelette&#x27;,
#   &#x27;onion_rings&#x27;,
#   &#x27;oysters&#x27;,
#   &#x27;pad_thai&#x27;,
#   &#x27;paella&#x27;,
#   &#x27;pancakes&#x27;,
#   &#x27;panna_cotta&#x27;,
#   &#x27;peking_duck&#x27;,
#   &#x27;pho&#x27;,
#   &#x27;pizza&#x27;,
#   &#x27;pork_chop&#x27;,
#   &#x27;poutine&#x27;,
#   &#x27;prime_rib&#x27;,
#   &#x27;pulled_pork_sandwich&#x27;,
#   &#x27;ramen&#x27;,
#   &#x27;ravioli&#x27;,
#   &#x27;red_velvet_cake&#x27;,
#   &#x27;risotto&#x27;,
#   &#x27;samosa&#x27;,
#   &#x27;sashimi&#x27;,
#   &#x27;scallops&#x27;,
#   &#x27;seaweed_salad&#x27;,
#   &#x27;shrimp_and_grits&#x27;,
#   &#x27;spaghetti_bolognese&#x27;,
#   &#x27;spaghetti_carbonara&#x27;,
#   &#x27;spring_rolls&#x27;,
#   &#x27;steak&#x27;,
#   &#x27;strawberry_shortcake&#x27;,
#   &#x27;sushi&#x27;,
#   &#x27;tacos&#x27;,
#   &#x27;takoyaki&#x27;,
#   &#x27;tiramisu&#x27;,
#   &#x27;tuna_tartare&#x27;,
#   &#x27;waffles&#x27;])
</code></pre>
<h3 id="model-building-and-training">Model Building and Training</h3>
<pre><code class="language-python"># create callbacks from helper.py
## checkpoint callback
checkpoint_callback = create_checkpoint_callback(
    dir_name=&#x27;../checkpoints/transfer_learning_scaling&#x27;,
    experiment_name=&#x27;101_classes_10_percent_dataset&#x27;)

## tensorboard callback
tensorboard_callback = create_tensorboard_callback(
    dir_name=&#x27;../tensorboard/transfer_learning_scaling&#x27;,
    experiment_name=&#x27;101_classes_10_percent_dataset&#x27;)
</code></pre>
<pre><code class="language-python"># get base model from keras applications
base_model = tf.keras.applications.efficientnet_v2.EfficientNetV2B0(
    include_top=False
)
base_model.trainable = False

# build model using keras functional API
input_layer = tf.keras.layers.Input(shape=IMG_SHAPE+(3,), name=&#x27;input_layer&#x27;)
# use image augmentation layer from helper.py
data = data_augmentation_layer_no_rescaling(input_layer)
# run in inference mode so batchnorm statistics don&#x27;t get updated
# even after unfreezing the base model for fine-tuning
data = base_model(data, training=False)
data = tf.keras.layers.GlobalAveragePooling2D(name=&quot;global_average_pooling_layer&quot;)(data)
output_layer = tf.keras.layers.Dense(len(class_names_101_10), activation=&quot;softmax&quot;, name=&quot;output_layer&quot;)(data)

model = tf.keras.Model(input_layer, output_layer)

# compile the model
model.compile(loss=&#x27;categorical_crossentropy&#x27;,
               optimizer=tf.keras.optimizers.Adam(),
               metrics=[&#x27;accuracy&#x27;])
</code></pre>
<pre><code class="language-python"># fit the model
tf.random.set_seed(SEED)
## training epochs before fine-tuning
pretraining_epochs = 5

history_model = model.fit(
                training_data_101_10,
                epochs=pretraining_epochs,
                steps_per_epoch=len(training_data_101_10),
                validation_data=testing_data_101_10,
                # evaluate performance on 15% of the testing dataset
                validation_steps=int(0.15 * len(testing_data_101_10)),
                callbacks=[tensorboard_callback,
                           checkpoint_callback])

# Epoch 5/5
# 73s 307ms/step - loss: 1.5557 - accuracy: 0.6176 - val_loss: 1.8671 - val_accuracy: 0.5246
</code></pre>
<pre><code class="language-python"># evaluate performance on whole dataset
pre_training_results = model.evaluate(testing_data_101_10)
print(pre_training_results)

# [1.5907552242279053, 0.5817425847053528]
</code></pre>
<h3 id="fine-tuning-the-model">Fine-tuning the Model</h3>
<pre><code class="language-python"># unfreeze entire model
base_model.trainable = True

# keep only the last 5 layers trainable
for layer in base_model.layers[:-5]:
    layer.trainable = False
</code></pre>
<pre><code class="language-python"># list all layers in model
for layer in model.layers:
    print(layer, layer.trainable)
    
# &lt;keras.engine.input_layer.InputLayer object at 0x7f695c39b370&gt; True
# &lt;keras.engine.sequential.Sequential object at 0x7f695c39a260&gt; True
# &lt;keras.engine.functional.Functional object at 0x7f6943f0d300&gt; True
# &lt;keras.layers.pooling.global_average_pooling2d.GlobalAveragePooling2D object at 0x7f6943f4e830&gt; True
# &lt;keras.layers.core.dense.Dense object at 0x7f69400c0520&gt; True
    
# layer 2 is the now only partly unfrozen imported model (efficientnetb0)
for layer_number, layer in enumerate(model.layers[2].layers):
    print(layer_number, layer.name, layer.trainable)
    
# 0 input_1 False
# 1 rescaling False
# 2 normalization False
# ...
# 262 block6h_se_excite False
# 263 block6h_project_conv False
# 264 block6h_project_bn False
# 265 block6h_drop True
# 266 block6h_add True
# 267 top_conv True
# 268 top_bn True
# 269 top_activation True
</code></pre>
<pre><code class="language-python"># recompile the model with the new basemodel
### to prevent overfitting / to better hold on to pre-training
### the learning rate during fine-tuning should be lowered 10x
### default Adam(lr)=1e-3 =&gt; 1e-4
model.compile(loss=&#x27;categorical_crossentropy&#x27;,
               optimizer=tf.keras.optimizers.Adam(learning_rate=1e-4),
               metrics=[&#x27;accuracy&#x27;])
</code></pre>
<pre><code class="language-python"># continue training
tf.random.set_seed(SEED)
fine_tuning_epochs = pretraining_epochs + 5

history_fine_tuning_model = model.fit(
                training_data_101_10,
                epochs=fine_tuning_epochs,
                # start from last pre-training checkpoint
                # training from epoch 6 - 10
                initial_epoch = history_model.epoch[-1],
                steps_per_epoch=len(training_data_101_10),
                validation_data=testing_data_101_10,
                # evaluate performance on 15% of the testing dataset
                validation_steps=int(0.15 * len(testing_data_101_10)),
                callbacks=[tensorboard_callback,
                           checkpoint_callback])

# Epoch 10/10
# 70s 294ms/step - loss: 1.3161 - accuracy: 0.6547 - val_loss: 1.7494 - val_accuracy: 0.5469
</code></pre>
<pre><code class="language-python"># evaluate performance on whole dataset
fine_tuning_results = model.evaluate(testing_data_101_10)
print(fine_tuning_results)

# pre_training_results
# [1.5907552242279053, 0.5817425847053528]

# fine_tuning_results
# [1.513363242149353, 0.5931881070137024]
</code></pre>
<pre><code class="language-python"># print accuracy curves
plot_accuracy_curves(history_model, &quot;Pre-Training&quot;, history_fine_tuning_model, &quot;Fine-Tuning&quot;)
</code></pre>
<p><img alt="Transfer Learning" src="/assets/images/04_Tensorflow_Transfer_Learning_13-8824025040dde3b775fb655ae0e6c10a.png" width="990" height="505"></p>
<pre><code class="language-python"># the validation accuracy increase keeps slowing while training
# accuracy goes up this points to an overfitting problem
combine_training_curves(history_model, history_fine_tuning_model, pretraining_epochs=5)
</code></pre>
<p><img alt="Transfer Learning" src="/assets/images/04_Tensorflow_Transfer_Learning_14-7ed644a206e1fb8bec377d851456fe34.png" width="671" height="701"></p>
<p>The model keeps improving but there is a growing gap between training and validation. This means that the model is overfitting the test data. Leading to worse results during the validation run.</p>
<h3 id="saving-and-restoring-the-trained-model">Saving and Restoring the Trained Model</h3>
<pre><code class="language-python"># saving the model
models_path = &quot;../saved_models/model_101_classes_10_percent_training_data&quot;
# model.save(models_path)
# INFO:tensorflow:Assets written to: ../saved_models/model_101_classes_10_percent_training_data/assets
</code></pre>
<pre><code class="language-python"># load the model
loaded_model = tf.keras.models.load_model(models_path)

# verify the model was loaded correctly
loaded_model_results = loaded_model.evaluate(testing_data_101_10)
print(loaded_model_results)

# fine_tuning_results to compare
# [1.513363242149353, 0.5931881070137024]

# loaded_model_results are the same - it worked!
# [1.513363242149353, 0.5931881070137024]
</code></pre>
<h3 id="evaluating-predictions">Evaluating Predictions</h3>
<pre><code class="language-python"># making predictions on all 25250 validation images for 101 classes
test_prediction_probabilities = loaded_model.predict(testing_data_101_10, verbose=1)
print(test_prediction_probabilities.shape)
# (25250, 101)
</code></pre>
<pre><code class="language-python"># display prediction probabilities for the first image
print(test_prediction_probabilities[:1])

# [[2.03596894e-03 3.65167543e-05 2.17581794e-01 5.17010115e-08
#   3.32512741e-06 2.29585039e-05 2.71960180e-05 1.80260338e-06
#   5.30003861e-04 2.73975573e-04 1.06404877e-05 6.97153791e-06
#   1.50283886e-04 2.78270818e-06 3.42393899e-03 2.25132797e-02
#   2.40503272e-04 2.13146021e-04 1.64284266e-03 9.58332021e-05
#   1.32550078e-03 2.55020423e-05 7.39933093e-05 1.92245971e-05
#   8.13204853e-04 1.93982956e-03 8.89056770e-04 6.18012882e-06
#   7.59714108e-04 8.36205290e-05 3.92342417e-06 2.00494527e-04
#   2.51588156e-03 6.87084466e-05 7.40043120e-04 4.45897895e-05
#   4.05072642e-04 4.21193661e-04 1.59948692e-02 2.43602030e-04
#   1.10967096e-03 6.28277950e-04 5.56461528e-05 6.36936966e-05
#   4.16825242e-05 8.82518361e-05 1.96498135e-04 4.21540433e-04
#   1.76622216e-05 1.82788055e-02 4.08739754e-04 2.77833984e-04
#   6.94064796e-02 7.92958029e-03 2.63221909e-06 3.67652555e-03
#   1.11585250e-04 1.25307284e-04 5.01443865e-03 2.33431001e-05
#   9.54853363e-07 6.14999968e-04 1.00202730e-03 6.56907330e-04
#   1.59870205e-03 9.99520998e-05 5.11349281e-05 3.93474428e-03
#   1.97406291e-04 3.40633960e-05 8.98707913e-06 1.06544203e-05
#   5.15696120e-05 1.98621456e-05 5.94679965e-04 3.69085114e-06
#   1.09817571e-04 2.08929856e-03 1.73596389e-04 2.66812931e-05
#   1.44478225e-03 1.20244418e-04 1.30806561e-03 2.10159646e-06
#   2.99385400e-04 5.72092354e-01 2.51285546e-02 1.11975627e-04
#   4.98035988e-05 2.09982645e-05 3.76860640e-08 3.77362909e-07
#   1.97288580e-03 1.36366225e-05 2.58001910e-05 1.10756594e-03
#   6.64085674e-04 9.06130299e-05 4.01897114e-06 8.89552932e-04
#   1.07155865e-04]]

# the highest probabilty is `5.72092354e-01`
</code></pre>
<pre><code class="language-python"># get position of the class with the highest probability
arr = np.array(test_prediction_probabilities[:1])
predicted_class = np.argmax(arr)
print(f&quot;INFO :: The predicted Class Number is: {predicted_class}&quot;)
# INFO :: The predicted Class Number is: 85
print(f&quot;INFO :: The predicted Class is: {class_names_101_10[predicted_class]}&quot;)
# INFO :: The predicted Class is: samosa
</code></pre>
<pre><code class="language-python"># get all predicted classes
predicted_classes = test_prediction_probabilities.argmax(axis=1)

# there are predicted classes for all validation images
print(predicted_classes.shape)
# (25250,)

# print the predicted classes for the first 10 images
print(predicted_classes[:10])
# [85  0  0  8  8 78 29 46  0  0]
</code></pre>
<pre><code class="language-python"># get all true labels from batched dataset
print(testing_data_101_10)
# &lt;BatchDataset element_spec=(TensorSpec(shape=(None, 224, 224, 3), dtype=tf.float32,name=None),
#                            TensorSpec(shape=(None, 101), dtype=tf.float32, name=None))&gt;

# get class_names index value from unbatched dataset
y_labels = []
for images, labels in testing_data_101_10.unbatch():
    y_labels.append(labels.numpy().argmax())

# display first result
print(y_labels[:10])

# these are the true labels and should be identical to `predicted_classes[:10]` above
# [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

# training dataset was not shuffled -&gt; all 10 belong to the same class:
# print(class_names_101_10[0])
# apple_pie
</code></pre>
<h4 id="accuracy-score">Accuracy Score</h4>
<p>Compare the predicted classes to the true classes to get the accuracy score for the model.</p>
<pre><code class="language-python"># use sklearn to determin the accuracy
sk_accuracy = accuracy_score(y_true=y_labels,
                            y_pred=predicted_classes)
print(sk_accuracy)
# 0.5931881188118812 =&gt; same as validation_accuracy from tensorflow
</code></pre>
<h4 id="confusion-matrix">Confusion Matrix</h4>
<pre><code class="language-python">plot_confusion_matrix(y_pred=y_labels, y_true=predicted_classes, classes=class_names_101_10)
</code></pre>
<p><img alt="Transfer Learning" src="/assets/images/04_Tensorflow_Transfer_Learning_15-75a1bf2813806c09cbbb56fbaf84021f.jpg" width="1099" height="952">
<img alt="Transfer Learning" src="/assets/images/hmmmm-0aa854f42905bbb37952c1b5e1e14729.gif" width="200" height="200"></p>
<pre><code class="language-python">plot_confusion_matrix(y_pred=y_labels,
                      y_true=predicted_classes,
                      classes=class_names_101_10,
                      figsize = (88, 88),
                      text_size=8)
</code></pre>
<p><img alt="Transfer Learning" src="/assets/images/04_Tensorflow_Transfer_Learning_16-13aa4dfcc5267593d99a60558fad138f.png" width="6373" height="6804"></p>
<p><em>open in new tab to zoom in</em></p>
<p>We can see that the results are overall impressive. The <code>59.3%</code> accuracy is mostly based on a couple of classes that might be hard to distinguish in general:</p>
<ul>
<li>spaghetti_carbonara &lt;-&gt; spaghetti_bolongnese</li>
<li>prime_rib &lt;-&gt; steak</li>
<li>steak &lt;-&gt; filet_mignon</li>
<li>chicken_quesadilla &lt;-&gt; breakfast_burrito</li>
<li>hamburger &lt;-&gt; pulled_pork_sandwich</li>
<li>club_sandwich &lt;-&gt; grilled_cheese_sandwich</li>
</ul>
<p>...</p>
<h4 id="scikit-learn-classification-report">SciKit Learn Classification Report</h4>
<pre><code class="language-python">print(classification_report(y_true=y_labels,
                            y_pred=predicted_classes))
</code></pre>
<table><thead><tr><th>class #</th><th>classname</th><th>precision</th><th>recall</th><th>f1-score</th><th>support</th></tr></thead><tbody><tr><td>0</td><td>apple_pie</td><td>0.36</td><td>0.25</td><td>0.29</td><td>250</td></tr><tr><td>1</td><td>baby_back_ribs</td><td>0.61</td><td>0.64</td><td>0.62</td><td>250</td></tr><tr><td>2</td><td>baklava</td><td>0.67</td><td>0.55</td><td>0.60</td><td>250</td></tr><tr><td>3</td><td>beef_carpaccio</td><td>0.69</td><td>0.57</td><td>0.62</td><td>250</td></tr><tr><td>4</td><td>beef_tartare</td><td>0.65</td><td>0.31</td><td>0.42</td><td>250</td></tr><tr><td>5</td><td>beet_salad</td><td>0.65</td><td>0.32</td><td>0.43</td><td>250</td></tr><tr><td>6</td><td>beignets</td><td>0.86</td><td>0.71</td><td>0.78</td><td>250</td></tr><tr><td>7</td><td>bibimbap</td><td>0.85</td><td>0.70</td><td>0.76</td><td>250</td></tr><tr><td>8</td><td>bread_pudding</td><td>0.30</td><td>0.52</td><td>0.38</td><td>250</td></tr><tr><td>9</td><td>breakfast_burrito</td><td>0.32</td><td>0.75</td><td>0.45</td><td>250</td></tr><tr><td>10</td><td>bruschetta</td><td>0.48</td><td>0.52</td><td>0.50</td><td>250</td></tr><tr><td>11</td><td>caesar_salad</td><td>0.63</td><td>0.62</td><td>0.62</td><td>250</td></tr><tr><td>12</td><td>cannoli</td><td>0.58</td><td>0.66</td><td>0.62</td><td>250</td></tr><tr><td>13</td><td>caprese_salad</td><td>0.53</td><td>0.60</td><td>0.56</td><td>250</td></tr><tr><td>14</td><td>carrot_cake</td><td>0.50</td><td>0.54</td><td>0.52</td><td>250</td></tr><tr><td>15</td><td>ceviche</td><td>0.36</td><td>0.31</td><td>0.33</td><td>250</td></tr><tr><td>16</td><td>cheese_plate</td><td>0.67</td><td>0.49</td><td>0.56</td><td>250</td></tr><tr><td>17</td><td>cheesecake</td><td>0.36</td><td>0.42</td><td>0.39</td><td>250</td></tr><tr><td>18</td><td>chicken_curry</td><td>0.65</td><td>0.35</td><td>0.46</td><td>250</td></tr><tr><td>19</td><td>chicken_quesadilla</td><td>0.70</td><td>0.38</td><td>0.49</td><td>250</td></tr><tr><td>20</td><td>chicken_wings</td><td>0.71</td><td>0.70</td><td>0.70</td><td>250</td></tr><tr><td>21</td><td>chocolate_cake</td><td>0.61</td><td>0.52</td><td>0.56</td><td>250</td></tr><tr><td>22</td><td>chocolate_mousse</td><td>0.44</td><td>0.35</td><td>0.39</td><td>250</td></tr><tr><td>23</td><td>churros</td><td>0.82</td><td>0.64</td><td>0.72</td><td>250</td></tr><tr><td>24</td><td>clam_chowder</td><td>0.71</td><td>0.78</td><td>0.74</td><td>250</td></tr><tr><td>25</td><td>club_sandwich</td><td>0.65</td><td>0.56</td><td>0.60</td><td>250</td></tr><tr><td>26</td><td>crab_cakes</td><td>0.36</td><td>0.55</td><td>0.43</td><td>250</td></tr><tr><td>27</td><td>creme_brulee</td><td>0.75</td><td>0.72</td><td>0.73</td><td>250</td></tr><tr><td>28</td><td>croque_madame</td><td>0.58</td><td>0.69</td><td>0.63</td><td>250</td></tr><tr><td>29</td><td>cup_cakes</td><td>0.66</td><td>0.82</td><td>0.73</td><td>250</td></tr><tr><td>30</td><td>deviled_eggs</td><td>0.89</td><td>0.55</td><td>0.68</td><td>250</td></tr><tr><td>31</td><td>donuts</td><td>0.74</td><td>0.74</td><td>0.74</td><td>250</td></tr><tr><td>32</td><td>dumplings</td><td>0.75</td><td>0.86</td><td>0.80</td><td>250</td></tr><tr><td>33</td><td>edamame</td><td>0.94</td><td>0.98</td><td>0.96</td><td>250</td></tr><tr><td>34</td><td>eggs_benedict</td><td>0.56</td><td>0.76</td><td>0.65</td><td>250</td></tr><tr><td>35</td><td>escargots</td><td>0.69</td><td>0.64</td><td>0.66</td><td>250</td></tr><tr><td>36</td><td>falafel</td><td>0.53</td><td>0.43</td><td>0.47</td><td>250</td></tr><tr><td>37</td><td>filet_mignon</td><td>0.27</td><td>0.51</td><td>0.35</td><td>250</td></tr><tr><td>38</td><td>fish_and_chips</td><td>0.60</td><td>0.75</td><td>0.66</td><td>250</td></tr><tr><td>39</td><td>foie_gras</td><td>0.42</td><td>0.16</td><td>0.23</td><td>250</td></tr><tr><td>40</td><td>french_fries</td><td>0.80</td><td>0.74</td><td>0.77</td><td>250</td></tr><tr><td>41</td><td>french_onion_soup</td><td>0.65</td><td>0.70</td><td>0.68</td><td>250</td></tr><tr><td>42</td><td>french_toast</td><td>0.54</td><td>0.50</td><td>0.52</td><td>250</td></tr><tr><td>43</td><td>fried_calamari</td><td>0.79</td><td>0.55</td><td>0.65</td><td>250</td></tr><tr><td>44</td><td>fried_rice</td><td>0.73</td><td>0.55</td><td>0.63</td><td>250</td></tr><tr><td>45</td><td>frozen_yogurt</td><td>0.83</td><td>0.82</td><td>0.82</td><td>250</td></tr><tr><td>46</td><td>garlic_bread</td><td>0.53</td><td>0.62</td><td>0.57</td><td>250</td></tr><tr><td>47</td><td>gnocchi</td><td>0.30</td><td>0.56</td><td>0.39</td><td>250</td></tr><tr><td>48</td><td>greek_salad</td><td>0.56</td><td>0.66</td><td>0.61</td><td>250</td></tr><tr><td>49</td><td>grilled_cheese_sandwich</td><td>0.37</td><td>0.45</td><td>0.41</td><td>250</td></tr><tr><td>50</td><td>grilled_salmon</td><td>0.53</td><td>0.34</td><td>0.42</td><td>250</td></tr><tr><td>51</td><td>guacamole</td><td>0.76</td><td>0.93</td><td>0.83</td><td>250</td></tr><tr><td>52</td><td>gyoza</td><td>0.62</td><td>0.58</td><td>0.60</td><td>250</td></tr><tr><td>53</td><td>hamburger</td><td>0.49</td><td>0.79</td><td>0.61</td><td>250</td></tr><tr><td>54</td><td>hot_and_sour_soup</td><td>0.72</td><td>0.86</td><td>0.78</td><td>250</td></tr><tr><td>55</td><td>hot_dog</td><td>0.65</td><td>0.88</td><td>0.75</td><td>250</td></tr><tr><td>56</td><td>huevos_rancheros</td><td>0.40</td><td>0.34</td><td>0.37</td><td>250</td></tr><tr><td>57</td><td>hummus</td><td>0.70</td><td>0.36</td><td>0.48</td><td>250</td></tr><tr><td>58</td><td>ice_cream</td><td>0.66</td><td>0.66</td><td>0.66</td><td>250</td></tr><tr><td>59</td><td>lasagna</td><td>0.48</td><td>0.49</td><td>0.49</td><td>250</td></tr><tr><td>60</td><td>lobster_bisque</td><td>0.77</td><td>0.67</td><td>0.71</td><td>250</td></tr><tr><td>61</td><td>lobster_roll_sandwich</td><td>0.69</td><td>0.64</td><td>0.66</td><td>250</td></tr><tr><td>62</td><td>macaroni_and_cheese</td><td>0.66</td><td>0.50</td><td>0.57</td><td>250</td></tr><tr><td>63</td><td>macarons</td><td>0.97</td><td>0.80</td><td>0.88</td><td>250</td></tr><tr><td>64</td><td>miso_soup</td><td>0.74</td><td>0.87</td><td>0.80</td><td>250</td></tr><tr><td>65</td><td>mussels</td><td>0.88</td><td>0.81</td><td>0.84</td><td>250</td></tr><tr><td>66</td><td>nachos</td><td>0.75</td><td>0.23</td><td>0.35</td><td>250</td></tr><tr><td>67</td><td>omelette</td><td>0.41</td><td>0.43</td><td>0.42</td><td>250</td></tr><tr><td>68</td><td>onion_rings</td><td>0.73</td><td>0.88</td><td>0.80</td><td>250</td></tr><tr><td>69</td><td>oysters</td><td>0.83</td><td>0.85</td><td>0.84</td><td>250</td></tr><tr><td>70</td><td>pad_thai</td><td>0.74</td><td>0.80</td><td>0.77</td><td>250</td></tr><tr><td>71</td><td>paella</td><td>0.86</td><td>0.45</td><td>0.59</td><td>250</td></tr><tr><td>72</td><td>pancakes</td><td>0.66</td><td>0.62</td><td>0.64</td><td>250</td></tr><tr><td>73</td><td>panna_cotta</td><td>0.56</td><td>0.44</td><td>0.49</td><td>250</td></tr><tr><td>74</td><td>peking_duck</td><td>0.58</td><td>0.59</td><td>0.59</td><td>250</td></tr><tr><td>75</td><td>pho</td><td>0.83</td><td>0.88</td><td>0.85</td><td>250</td></tr><tr><td>76</td><td>pizza</td><td>0.64</td><td>0.90</td><td>0.75</td><td>250</td></tr><tr><td>77</td><td>pork_chop</td><td>0.32</td><td>0.30</td><td>0.31</td><td>250</td></tr><tr><td>78</td><td>poutine</td><td>0.61</td><td>0.68</td><td>0.65</td><td>250</td></tr><tr><td>79</td><td>prime_rib</td><td>0.45</td><td>0.82</td><td>0.58</td><td>250</td></tr><tr><td>80</td><td>pulled_pork_sandwich</td><td>0.62</td><td>0.52</td><td>0.56</td><td>250</td></tr><tr><td>81</td><td>ramen</td><td>0.48</td><td>0.77</td><td>0.59</td><td>250</td></tr><tr><td>82</td><td>ravioli</td><td>0.36</td><td>0.29</td><td>0.32</td><td>250</td></tr><tr><td>83</td><td>red_velvet_cake</td><td>0.69</td><td>0.65</td><td>0.67</td><td>250</td></tr><tr><td>84</td><td>risotto</td><td>0.43</td><td>0.37</td><td>0.40</td><td>250</td></tr><tr><td>85</td><td>samosa</td><td>0.48</td><td>0.66</td><td>0.55</td><td>250</td></tr><tr><td>86</td><td>sashimi</td><td>0.88</td><td>0.77</td><td>0.82</td><td>250</td></tr><tr><td>87</td><td>scallops</td><td>0.37</td><td>0.33</td><td>0.35</td><td>250</td></tr><tr><td>88</td><td>seaweed_salad</td><td>0.91</td><td>0.77</td><td>0.83</td><td>250</td></tr><tr><td>89</td><td>shrimp_and_grits</td><td>0.44</td><td>0.43</td><td>0.43</td><td>250</td></tr><tr><td>90</td><td>spaghetti_bolognese</td><td>0.82</td><td>0.56</td><td>0.66</td><td>250</td></tr><tr><td>91</td><td>spaghetti_carbonara</td><td>0.66</td><td>0.96</td><td>0.78</td><td>250</td></tr><tr><td>92</td><td>spring_rolls</td><td>0.61</td><td>0.64</td><td>0.63</td><td>250</td></tr><tr><td>93</td><td>steak</td><td>0.32</td><td>0.29</td><td>0.31</td><td>250</td></tr><tr><td>94</td><td>strawberry_shortcake</td><td>0.54</td><td>0.58</td><td>0.56</td><td>250</td></tr><tr><td>95</td><td>sushi</td><td>0.74</td><td>0.51</td><td>0.61</td><td>250</td></tr><tr><td>96</td><td>tacos</td><td>0.69</td><td>0.32</td><td>0.44</td><td>250</td></tr><tr><td>97</td><td>takoyaki</td><td>0.75</td><td>0.57</td><td>0.65</td><td>250</td></tr><tr><td>98</td><td>tiramisu</td><td>0.42</td><td>0.47</td><td>0.45</td><td>250</td></tr><tr><td>99</td><td>tuna_tartare</td><td>0.36</td><td>0.35</td><td>0.35</td><td>250</td></tr><tr><td>100</td><td>waffles</td><td>0.79</td><td>0.65</td><td>0.71</td><td>250</td></tr><tr><td>____________</td><td>__________</td><td>__________</td><td>_________</td><td>_________</td><td>_________</td></tr><tr><td>accuracy</td><td></td><td></td><td></td><td>0.59</td><td>25250</td></tr><tr><td>macro avg</td><td></td><td>0.62</td><td>0.59</td><td>0.59</td><td>25250</td></tr><tr><td>weighted avg</td><td></td><td>0.62</td><td>0.59</td><td>0.59</td><td>25250</td></tr></tbody></table>
<pre><code class="language-python"># visualizing the F1 scores per class
classification_report_dict = classification_report(y_true=y_labels,
                                                  y_pred=predicted_classes,
                                                  output_dict=True)
# {&#x27;0&#x27;: {&#x27;precision&#x27;: 0.36257309941520466,
#   &#x27;recall&#x27;: 0.248,
#   &#x27;f1-score&#x27;: 0.29453681710213775,
#   &#x27;support&#x27;: 250},
#  &#x27;1&#x27;: {&#x27;precision&#x27;: 0.6060606060606061,
#   &#x27;recall&#x27;: 0.64,
#   &#x27;f1-score&#x27;: 0.622568093385214,
#   &#x27;support&#x27;: 250},
#    ...


# extract f1-scores from dictionary
class_f1_scores = {}

## loop through classification report
for k, v in classification_report_dict.items():
    # stop when you reach end of table =&gt; class# = accuracy
    if k == &quot;accuracy&quot;:
        break
    else:
        # get class name and f1 score for class #
        class_f1_scores[class_names_101_10[int(k)]] = v[&quot;f1-score&quot;]
        
# print(class_f1_scores)

# {&#x27;apple_pie&#x27;: 0.29453681710213775,
#  &#x27;baby_back_ribs&#x27;: 0.622568093385214,
#  &#x27;baklava&#x27;: 0.6008771929824562,
#  ...

# write it into a dataframe
f1_scores = pd.DataFrame({&quot;classname&quot;: list(class_f1_scores.keys()),
                         &quot;f1-score&quot;: list(class_f1_scores.values())}).sort_values(&quot;f1-score&quot;, ascending=False)

print(f1_scores)
</code></pre>
<table><thead><tr><th>class #</th><th>classname</th><th>f1-score</th></tr></thead><tbody><tr><td>33</td><td>edamame</td><td>0.958904</td></tr><tr><td>63</td><td>macarons</td><td>0.877729</td></tr><tr><td>75</td><td>pho</td><td>0.854369</td></tr><tr><td>65</td><td>mussels</td><td>0.844075</td></tr><tr><td>69</td><td>oysters</td><td>0.837945</td></tr><tr><td>..</td><td>...</td><td>...</td></tr><tr><td>82</td><td>ravioli</td><td>0.320713</td></tr><tr><td>77</td><td>pork_chop</td><td>0.309623</td></tr><tr><td>93</td><td>steak</td><td>0.307368</td></tr><tr><td>0</td><td>apple_pie</td><td>0.294537</td></tr><tr><td>39</td><td>foie_gras</td><td>0.228070</td></tr></tbody></table>
<pre><code class="language-python">f1_bar_chart = f1_scores.plot.bar(x=&#x27;classname&#x27;,
                                  y=&#x27;f1-score&#x27;,
                                  title=&quot;F1 Scores vs Class Names&quot;,
                                  rot=70, legend=True,
                                  figsize=(42,12))
</code></pre>
<p><img alt="Transfer Learning" src="/assets/images/04_Tensorflow_Transfer_Learning_17-ff63cbbffd4aa89f04f4621395e1fd66.png" width="3308" height="1161"></p>
<pre><code class="language-python">f1_scores_inverse = f1_scores.sort_values(by=[&#x27;f1-score&#x27;])
f1_bar_chart = f1_scores_inverse.plot.barh(x=&#x27;classname&#x27;,
                                  y=&#x27;f1-score&#x27;, fontsize=16,
                                  title=&quot;F1 Scores vs Class Names&quot;,
                                  rot=0, legend=True,
                                  figsize=(12,36))
</code></pre>
<p><img alt="Transfer Learning" src="/assets/images/04_Tensorflow_Transfer_Learning_18-bbcbddb578eeb29bd185b26a4e4672d6.png" width="1265" height="2844"></p>
<h3 id="run-predictions">Run Predictions</h3>
<pre><code class="language-python"># load and preprocess custom images
def load_and_preprocess_image(filename, img_shape=224, normalize=True):
    # load image
    image = tf.io.read_file(filename)
    
    # decode image into tensor
    image = tf.io.decode_image(image)
    
    # print(image.shape)
    # resize image
    # image = tf.image.resize(image, [img_shape[0], img_shape[1]])
    image = tf.image.resize(image, [img_shape, img_shape])
    # print(image.shape)
    # models like efficientnet don&#x27;t
    #  need normalization -&gt; make it optional
    if normalize:
        return image/255
    else:
        return image
</code></pre>
<pre><code class="language-python"># test prediction
file_path = &quot;../datasets/101_food_classes_10_percent/train/caesar_salad/621878.jpg&quot;
# load and preprocess images
test_image = load_and_preprocess_image(file_path, img_shape=224, normalize=False)
# test image is (224, 224, 3) but model expects batch shape (None, 224, 224, 3)
test_image_expanded = tf.expand_dims(test_image, axis=0)
# get probabilities over all classes
prediction_probabilities = model.predict(test_image_expanded)
print(prediction_probabilities)
# get classname for highest probability
predicted_class =  class_names_101_10[prediction_probabilities.argmax()]
print(prediction_probabilities.argmax())
print(predicted_class)

# 1/1 [==============================] - 2s 2s/step
# [[1.50316203e-06 6.54247488e-05 3.67346947e-05 2.69303378e-03
#   6.89498498e-04 1.87405187e-03 5.24590746e-07 9.33061761e-04
#   8.65595939e-06 3.25173722e-04 5.10892831e-04 3.65509897e-01
#   5.99349778e-06 7.83709735e-02 2.39862379e-06 5.81788830e-03
#   9.84990475e-05 3.48087779e-05 1.90171588e-04 1.23677682e-02
#   6.14877135e-05 2.40283384e-08 2.12790405e-06 1.13999391e-07
#   5.72356976e-06 7.92978518e-03 9.47913341e-03 7.58256647e-07
#   1.09906327e-02 7.71022357e-08 2.06695331e-05 5.95029064e-07
#   2.49674427e-04 6.92231743e-06 2.87168048e-04 3.15096986e-05
#   4.69330046e-03 6.78624609e-04 7.83884199e-04 1.68355810e-03
#   1.82755193e-05 9.03009493e-07 2.82402652e-05 1.71108084e-04
#   8.81860105e-05 3.58489638e-06 3.93012015e-05 4.95287916e-03
#   4.10611063e-01 2.75604805e-04 5.55841299e-03 1.80046377e-03
#   6.12967357e-04 1.32623117e-03 3.72738782e-07 7.42003205e-04
#   6.33771438e-03 1.89700077e-04 1.42778049e-06 1.78189657e-04
#   2.83671682e-08 5.77349402e-03 1.16270230e-05 1.74992886e-06
#   2.15548107e-06 1.77174807e-05 2.03449815e-03 7.82472896e-04
#   3.88388798e-07 1.51169850e-04 2.83787904e-05 9.07634239e-06
#   3.15053308e-06 2.30283586e-05 1.42191842e-04 3.49449765e-05
#   2.96340950e-05 3.22835840e-05 3.79087487e-06 3.55910415e-05
#   6.37637422e-05 1.73983644e-04 5.40133740e-04 6.14976784e-07
#   1.03683116e-04 9.38189216e-04 1.80834774e-02 7.08847656e-04
#   3.19155771e-03 3.94216222e-05 6.57606563e-07 1.21063601e-06
#   9.14987270e-03 7.52260457e-05 2.20976843e-04 2.03661504e-03
#   1.35101350e-02 1.15356571e-03 1.52835700e-08 1.37943309e-03
#   1.31967667e-04]]
# 48
# greek_salad

</code></pre>
<pre><code class="language-python"># run prediction on random test images
location = testing_directory

plt.figure(figsize=(17, 15))
# pick random test images in random class
for i in range(9):
    # get file paths
    class_name = random.choice(class_names_101_10)
    file_name = random.choice(os.listdir(location + &quot;/&quot; + class_name))
    file_path = location + &quot;/&quot; + class_name + &quot;/&quot; + file_name
    
    # load and preprocess images
    test_image = load_and_preprocess_image(file_path, img_shape=224, normalize=False)
    # test image is (224, 224, 3) but model expects batch shape (None, 224, 224, 3)
    test_image_expanded = tf.expand_dims(test_image, axis=0)
    # get probabilities over all classes
    prediction_probabilities = model.predict(test_image_expanded)
    # get classname for highest probability
    predicted_class =  class_names_101_10[prediction_probabilities.argmax()]
    plt.subplot(3, 3, i+1)
    # show normalized image
    plt.imshow(test_image/255.)
    if class_name == predicted_class:
        title_color = &#x27;green&#x27;
    else:
        title_color = &#x27;red&#x27;
    plt.title(f&quot;Pred: {predicted_class} ({prediction_probabilities.max()*100:.2f} %), True: {class_name}&quot;,
             c=title_color)
    plt.axis(False)

</code></pre>
<p><img alt="Transfer Learning" src="/assets/images/04_Tensorflow_Transfer_Learning_19-9f2ea5fab719b8878b3ad10b63b3d69e.png" width="1340" height="1197"></p>
<h3 id="find-most-wrong-predictions">Find most Wrong Predictions</h3>
<pre><code class="language-python"># get all images in the test dataset
test_files = testing_directory + &quot;/*/*.jpg&quot;
test_file_paths = []
for file_path in testing_data_101_10.list_files(test_files, shuffle=False):
    test_file_paths.append(file_path.numpy())
    
print(test_file_paths[:1])
# [b&#x27;../datasets/101_food_classes_10_percent/test/apple_pie/1011328.jpg&#x27;]
</code></pre>
<pre><code class="language-python"># create dataframe with filepaths and pred evals
prediction_quality = pd.DataFrame({&quot;img_path&quot;: test_file_paths,
                                  &quot;y_true&quot;: y_labels,
                                  &quot;y_pred&quot;: predicted_classes,
                                  &quot;pred_conf&quot;: test_prediction_probabilities.max(axis=1),
                                  &quot;y_true_classname&quot;: [class_names_101_10[i] for i in y_labels],
                                  &quot;y_pred_classname&quot;: [class_names_101_10[i] for i in predicted_classes]})

prediction_quality

# the &quot;most wrong&quot; predictions are those where the the predicted and
# true classname does not match but the prediction confidence is high:
</code></pre>
<table><thead><tr><th>#</th><th>img_path</th><th>y_true</th><th>y_pred</th><th>pred_conf</th><th>y_true_classname</th><th>y_pred_classname</th></tr></thead><tbody><tr><td>0</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>0</td><td>85</td><td>0.498493</td><td>apple_pie</td><td>samosa</td></tr><tr><td>1</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>0</td><td>0</td><td>0.821453</td><td>apple_pie</td><td>apple_pie</td></tr><tr><td>2</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>0</td><td>0</td><td>0.413805</td><td>apple_pie</td><td>apple_pie</td></tr><tr><td>3</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>0</td><td>0</td><td>0.242082</td><td>apple_pie</td><td>apple_pie</td></tr><tr><td>4</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>0</td><td>8</td><td>0.625819</td><td>apple_pie</td><td>bread_pudding</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><td>25245</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>100</td><td>100</td><td>0.860823</td><td>waffles</td><td>waffles</td></tr><tr><td>25246</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>100</td><td>100</td><td>0.969415</td><td>waffles</td><td>waffles</td></tr><tr><td>25247</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>100</td><td>74</td><td>0.259333</td><td>waffles</td><td>peking_duck</td></tr><tr><td>25248</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>100</td><td>100</td><td>0.266893</td><td>waffles</td><td>waffles</td></tr><tr><td>25249</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>100</td><td>100</td><td>0.248541</td><td>waffles</td><td>waffles</td></tr></tbody></table>
<pre><code class="language-python"># add bool comlumn for correct predictions
prediction_quality[&quot;pred_correct&quot;] = prediction_quality[&quot;y_true&quot;] == prediction_quality[&quot;y_pred&quot;]
</code></pre>
<pre><code class="language-python"># create new dataframe with the 100 most wrong predictions
top_100_wrong = prediction_quality[prediction_quality[&quot;pred_correct&quot;] == False].sort_values(&quot;pred_conf&quot;, ascending=False)[:100]
top_100_wrong
</code></pre>
<table><thead><tr><th>#</th><th>img_path</th><th>y_true</th><th>y_pred</th><th>pred_conf</th><th>y_true_classname</th><th>y_pred_classname</th><th>pred_correct</th></tr></thead><tbody><tr><td>23797</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>95</td><td>86</td><td>0.997811</td><td>sushi</td><td>sashimi</td><td>False</td></tr><tr><td>10880</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>43</td><td>68</td><td>0.997761</td><td>fried_calamari</td><td>onion_rings</td><td>False</td></tr><tr><td>14482</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>57</td><td>51</td><td>0.997528</td><td>hummus</td><td>guacamole</td><td>False</td></tr><tr><td>17897</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>71</td><td>65</td><td>0.996058</td><td>paella</td><td>mussels</td><td>False</td></tr><tr><td>18001</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>72</td><td>67</td><td>0.995309</td><td>pancakes</td><td>omelette</td><td>False</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><td>13199</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>52</td><td>9</td><td>0.947564</td><td>gyoza</td><td>breakfast_burrito</td><td>False</td></tr><tr><td>20551</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>82</td><td>83</td><td>0.947554</td><td>ravioli</td><td>red_velvet_cake</td><td>False</td></tr><tr><td>5114</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>20</td><td>38</td><td>0.947265</td><td>chicken_wings</td><td>fish_and_chips</td><td>False</td></tr><tr><td>548</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>2</td><td>67</td><td>0.947076</td><td>baklava</td><td>omelette</td><td>False</td></tr><tr><td>15750</td><td>b&#x27;../datasets/101_food_classes_10_percent/test...</td><td>63</td><td>29</td><td>0.946876</td><td>macarons</td><td>cup_cakes</td><td>False</td></tr></tbody></table>
<pre><code class="language-python">
# what predictions are most often wrong
grouped_top_100_wrong_pred = top_100_wrong.groupby([&#x27;y_pred&#x27;, &#x27;y_pred_classname&#x27;]).agg(&#x27;, &#x27;.join).reset_index()
grouped_top_100_wrong_pred
</code></pre>
<table><thead><tr><th>#</th><th>y_pred</th><th>y_pred_classname</th><th>y_true_classname</th></tr></thead><tbody><tr><td>0</td><td>2</td><td>baklava</td><td>garlic_bread</td></tr><tr><td>1</td><td>5</td><td>beet_salad</td><td>seaweed_salad</td></tr><tr><td>2</td><td>9</td><td>breakfast_burrito</td><td>chicken_quesadilla, pulled_pork_sandwich, chic...</td></tr><tr><td>3</td><td>12</td><td>cannoli</td><td>baklava</td></tr><tr><td>4</td><td>16</td><td>cheese_plate</td><td>cheesecake</td></tr><tr><td>5</td><td>20</td><td>chicken_wings</td><td>fish_and_chips, french_fries</td></tr><tr><td>6</td><td>26</td><td>crab_cakes</td><td>falafel</td></tr><tr><td>7</td><td>27</td><td>creme_brulee</td><td>hummus</td></tr><tr><td>8</td><td>28</td><td>croque_madame</td><td>poutine</td></tr><tr><td>9</td><td>29</td><td>cup_cakes</td><td>macarons, carrot_cake, macarons</td></tr><tr><td>10</td><td>31</td><td>donuts</td><td>escargots</td></tr><tr><td>11</td><td>32</td><td>dumplings</td><td>gyoza, macaroni_and_cheese</td></tr><tr><td>12</td><td>33</td><td>edamame</td><td>pho</td></tr><tr><td>13</td><td>38</td><td>fish_and_chips</td><td>chicken_wings</td></tr><tr><td>14</td><td>40</td><td>french_fries</td><td>macaroni_and_cheese, poutine</td></tr><tr><td>15</td><td>42</td><td>french_toast</td><td>waffles</td></tr><tr><td>16</td><td>45</td><td>frozen_yogurt</td><td>creme_brulee</td></tr><tr><td>17</td><td>46</td><td>garlic_bread</td><td>grilled_cheese_sandwich, grilled_cheese_sandwich</td></tr><tr><td>18</td><td>47</td><td>gnocchi</td><td>risotto, hummus</td></tr><tr><td>19</td><td>48</td><td>greek_salad</td><td>ceviche</td></tr><tr><td>20</td><td>51</td><td>guacamole</td><td>hummus, fried_rice, tuna_tartare, risotto, hum...</td></tr><tr><td>21</td><td>53</td><td>hamburger</td><td>pulled_pork_sandwich, eggs_benedict</td></tr><tr><td>22</td><td>54</td><td>hot_and_sour_soup</td><td>waffles, french_onion_soup, french_onion_soup</td></tr><tr><td>23</td><td>58</td><td>ice_cream</td><td>frozen_yogurt</td></tr><tr><td>24</td><td>64</td><td>miso_soup</td><td>cheesecake, scallops, lobster_bisque</td></tr><tr><td>25</td><td>65</td><td>mussels</td><td>paella, paella</td></tr><tr><td>26</td><td>67</td><td>omelette</td><td>pancakes, baklava</td></tr><tr><td>27</td><td>68</td><td>onion_rings</td><td>fried_calamari, fried_calamari, fried_calamari...</td></tr><tr><td>28</td><td>74</td><td>peking_duck</td><td>beef_carpaccio</td></tr><tr><td>29</td><td>75</td><td>pho</td><td>ramen, hot_and_sour_soup</td></tr><tr><td>30</td><td>76</td><td>pizza</td><td>chicken_quesadilla, french_onion_soup, hummus,...</td></tr><tr><td>31</td><td>78</td><td>poutine</td><td>peking_duck, takoyaki, spaghetti_bolognese, fr...</td></tr><tr><td>32</td><td>79</td><td>prime_rib</td><td>filet_mignon</td></tr><tr><td>33</td><td>81</td><td>ramen</td><td>miso_soup, chicken_curry</td></tr><tr><td>34</td><td>83</td><td>red_velvet_cake</td><td>cup_cakes, ravioli</td></tr><tr><td>35</td><td>85</td><td>samosa</td><td>peking_duck, spring_rolls, baklava</td></tr><tr><td>36</td><td>86</td><td>sashimi</td><td>sushi , sushi</td></tr><tr><td>37</td><td>91</td><td>spaghetti_carbonara</td><td>spaghetti_bolognese, spaghetti_bolognese, ravi...</td></tr><tr><td>38</td><td>92</td><td>spring_rolls</td><td>samosa</td></tr></tbody></table>
<pre><code class="language-python">
# what classes cause the most wrong predictions
grouped_top_100_wrong_cause = top_100_wrong.groupby([&#x27;y_true&#x27;, &#x27;y_true_classname&#x27;]).agg(&#x27;, &#x27;.join).reset_index()
grouped_top_100_wrong_cause
</code></pre>
<table><thead><tr><th>#</th><th>y_true</th><th>y_true_classname</th><th>y_pred_classname</th></tr></thead><tbody><tr><td>0</td><td>2</td><td>baklava</td><td>cannoli, samosa, omelette</td></tr><tr><td>1</td><td>3</td><td>beef_carpaccio</td><td>peking_duck</td></tr><tr><td>2</td><td>14</td><td>carrot_cake</td><td>cup_cakes</td></tr><tr><td>3</td><td>15</td><td>ceviche</td><td>greek_salad</td></tr><tr><td>4</td><td>17</td><td>cheesecake</td><td>miso_soup, cheese_plate</td></tr><tr><td>5</td><td>18</td><td>chicken_curry</td><td>ramen</td></tr><tr><td>6</td><td>19</td><td>chicken_quesadilla</td><td>breakfast_burrito, breakfast_burrito, pizza, g...</td></tr><tr><td>7</td><td>20</td><td>chicken_wings</td><td>fish_and_chips</td></tr><tr><td>8</td><td>23</td><td>churros</td><td>onion_rings, onion_rings, onion_rings</td></tr><tr><td>9</td><td>26</td><td>crab_cakes</td><td>spaghetti_carbonara</td></tr><tr><td>10</td><td>27</td><td>creme_brulee</td><td>frozen_yogurt</td></tr><tr><td>11</td><td>29</td><td>cup_cakes</td><td>red_velvet_cake</td></tr><tr><td>12</td><td>34</td><td>eggs_benedict</td><td>hamburger</td></tr><tr><td>13</td><td>35</td><td>escargots</td><td>donuts</td></tr><tr><td>14</td><td>36</td><td>falafel</td><td>crab_cakes, breakfast_burrito</td></tr><tr><td>15</td><td>37</td><td>filet_mignon</td><td>prime_rib</td></tr><tr><td>16</td><td>38</td><td>fish_and_chips</td><td>chicken_wings, breakfast_burrito</td></tr><tr><td>17</td><td>40</td><td>french_fries</td><td>chicken_wings, poutine</td></tr><tr><td>18</td><td>41</td><td>french_onion_soup</td><td>hot_and_sour_soup, pizza, hot_and_sour_soup</td></tr><tr><td>19</td><td>43</td><td>fried_calamari</td><td>onion_rings, onion_rings, onion_rings, onion_r...</td></tr><tr><td>20</td><td>44</td><td>fried_rice</td><td>guacamole</td></tr><tr><td>21</td><td>45</td><td>frozen_yogurt</td><td>ice_cream</td></tr><tr><td>22</td><td>46</td><td>garlic_bread</td><td>baklava</td></tr><tr><td>23</td><td>49</td><td>grilled_cheese_sandwich</td><td>garlic_bread, garlic_bread</td></tr><tr><td>24</td><td>52</td><td>gyoza</td><td>dumplings, breakfast_burrito, breakfast_burrito</td></tr><tr><td>25</td><td>54</td><td>hot_and_sour_soup</td><td>pho</td></tr><tr><td>26</td><td>56</td><td>huevos_rancheros</td><td>breakfast_burrito, breakfast_burrito</td></tr><tr><td>27</td><td>57</td><td>hummus</td><td>guacamole, creme_brulee, guacamole, pizza, gno...</td></tr><tr><td>28</td><td>59</td><td>lasagna</td><td>pizza</td></tr><tr><td>29</td><td>60</td><td>lobster_bisque</td><td>miso_soup</td></tr><tr><td>30</td><td>62</td><td>macaroni_and_cheese</td><td>french_fries, dumplings</td></tr><tr><td>31</td><td>63</td><td>macarons</td><td>cup_cakes, cup_cakes</td></tr><tr><td>32</td><td>64</td><td>miso_soup</td><td>ramen</td></tr><tr><td>33</td><td>67</td><td>omelette</td><td>spaghetti_carbonara</td></tr><tr><td>34</td><td>71</td><td>paella</td><td>mussels, mussels</td></tr><tr><td>35</td><td>72</td><td>pancakes</td><td>omelette</td></tr><tr><td>36</td><td>74</td><td>peking_duck</td><td>samosa, poutine</td></tr><tr><td>37</td><td>75</td><td>pho</td><td>edamame</td></tr><tr><td>38</td><td>78</td><td>poutine</td><td>croque_madame, french_fries</td></tr><tr><td>39</td><td>80</td><td>pulled_pork_sandwich</td><td>breakfast_burrito, hamburger</td></tr><tr><td>40</td><td>81</td><td>ramen</td><td>pho</td></tr><tr><td>41</td><td>82</td><td>ravioli</td><td>spaghetti_carbonara, spaghetti_carbonara, spag...</td></tr><tr><td>42</td><td>84</td><td>risotto</td><td>guacamole, gnocchi</td></tr><tr><td>43</td><td>85</td><td>samosa</td><td>spring_rolls</td></tr><tr><td>44</td><td>87</td><td>scallops</td><td>miso_soup</td></tr><tr><td>45</td><td>88</td><td>seaweed_salad</td><td>beet_salad</td></tr><tr><td>46</td><td>90</td><td>spaghetti_bolognese</td><td>spaghetti_carbonara, spaghetti_carbonara, spag...</td></tr><tr><td>47</td><td>92</td><td>spring_rolls</td><td>samosa</td></tr><tr><td>48</td><td>95</td><td>sushi</td><td>sashimi, sashimi</td></tr><tr><td>49</td><td>96</td><td>tacos</td><td>breakfast_burrito</td></tr><tr><td>50</td><td>97</td><td>takoyaki</td><td>poutine</td></tr><tr><td>51</td><td>99</td><td>tuna_tartare</td><td>guacamole</td></tr><tr><td>52</td><td>100</td><td>waffles</td><td>french_toast, hot_and_sour_soup</td></tr></tbody></table>
<pre><code class="language-python"># visualize test images
images_displayed = 12
start_index = 0
plt.figure(figsize=(15, 15))
# create tuples from each df row
for i, row in enumerate(top_100_wrong[start_index:start_index+images_displayed].itertuples()):
    plt.subplot(4, 3, i+1)
    # row[1] =&gt; 2nd cell in row = image path
    img = load_and_preprocess_image(row[1], normalize=False)
    # extract confidence and labels from row
    _, _, _, _, pred_conf, y_true_classname, y_pred_classname, _ = row
    plt.imshow(img/255.)
    plt.title(f&quot;Pred: {y_pred_classname} ({pred_conf*100:.2f} %),\nTrue: {y_true_classname}&quot;)
    plt.axis(False)
</code></pre>
<p><img alt="Transfer Learning" src="/assets/images/04_Tensorflow_Transfer_Learning_20-d0921bd7a21f17155873a7a67abfe0d5.png" width="1125" height="1218"></p>
<h3 id="predict-custom-images">Predict Custom Images</h3>
<pre><code class="language-python"># get list of custom image file paths
custom_images_path = &quot;../datasets/custom_images/&quot;
custom_images = [ custom_images_path + img_path for img_path in os.listdir(custom_images_path)]
custom_images

# [&#x27;../datasets/custom_images/cheesecake.jpg&#x27;,
#  &#x27;../datasets/custom_images/crema_catalana.jpg&#x27;,
#  &#x27;../datasets/custom_images/fish_and_chips.jpg&#x27;,
#  &#x27;../datasets/custom_images/jiaozi.jpg&#x27;,
#  &#x27;../datasets/custom_images/paella.jpg&#x27;,
#  &#x27;../datasets/custom_images/pho.jpg&#x27;,
#  &#x27;../datasets/custom_images/quesadilla.jpg&#x27;,
#  &#x27;../datasets/custom_images/ravioli.jpg&#x27;,
#  &#x27;../datasets/custom_images/waffles.jpg&#x27;]
</code></pre>
<pre><code class="language-python"># run prediction on custom images
for image in custom_images:
    image = load_and_preprocess_image(image, normalize=False)
    # test image is (224, 224, 3) but model expects batch shape (None, 224, 224, 3)
    image_expanded = tf.expand_dims(image, axis=0)
    # get probabilities over all classes
    prediction_probabilities = model.predict(image_expanded)
    # get classname for highest probability
    predicted_class =  class_names_101_10[prediction_probabilities.argmax()]
    # plot normalized image
    plt.figure()
    plt.imshow(image/255.)
    plt.title(f&quot;Pred: {predicted_class} ({prediction_probabilities.max()*100:.2f} %)&quot;)
    plt.axis(False)
</code></pre>
<p><img alt="Transfer Learning" src="/assets/images/04_Tensorflow_Transfer_Learning_21-bc16bf5ac7f720bc9e17e4cf84ea4a0b.png" width="1006" height="538"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/python">Python</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/machine-learning">Machine Learning</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/tensorflow">Tensorflow</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/IoT-and-Machine-Learning/ML/2023-03-16-tensorflow-transfer-learning-scaling/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/IoT-and-Machine-Learning/ML/2023-03-24-tensorflow-unsupervised-learning-autoencoders/2023-03-24"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tensorflow 2 - Unsupervised Learning</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/IoT-and-Machine-Learning/ML/2023-03-11-tensorflow-transfer-learning-fine-tuning/2023-03-11"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tensorflow 2 - Transfer Learning</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#model-scaling" class="table-of-contents__link toc-highlight">Model Scaling</a><ul><li><a href="#get-data" class="table-of-contents__link toc-highlight">Get Data</a></li><li><a href="#model-building-and-training" class="table-of-contents__link toc-highlight">Model Building and Training</a></li><li><a href="#fine-tuning-the-model" class="table-of-contents__link toc-highlight">Fine-tuning the Model</a></li><li><a href="#saving-and-restoring-the-trained-model" class="table-of-contents__link toc-highlight">Saving and Restoring the Trained Model</a></li><li><a href="#evaluating-predictions" class="table-of-contents__link toc-highlight">Evaluating Predictions</a></li><li><a href="#run-predictions" class="table-of-contents__link toc-highlight">Run Predictions</a></li><li><a href="#find-most-wrong-predictions" class="table-of-contents__link toc-highlight">Find most Wrong Predictions</a></li><li><a href="#predict-custom-images" class="table-of-contents__link toc-highlight">Predict Custom Images</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notebook</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/Curriculum-Vitae">CV</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mike-polinowski-6396ba121/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/MikePolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flickr.com/people/149680084@N06/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flickr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mpolinowski" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Mike Polinowski, INSTAR Deutschland GmbH, Shenzhen - China.</div></div></div></footer></div>
</body>
</html>